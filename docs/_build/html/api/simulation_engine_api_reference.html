<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
.chartjs-container {
    margin: 1.5em auto;
    padding: 1em;
    background: #f8f9fa;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.chart-note {
    text-align: center;
    color: #6c757d;
    font-size: 0.9em;
    margin-top: 0.5em;
}
</style>
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Simulation Engine API Reference - DIP_SMC_PSO Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5349f25f" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=f5a89ef9" />
    
    


<style>
  body {
    --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">DIP_SMC_PSO Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">DIP_SMC_PSO Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">📚 Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../README.html">Optimal Sliding Mode Control for a Double-Inverted Pendulum via PSO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory_overview.html">1. Theoretical Background â€” Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">3. System Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plant_model.html">1.x Plant Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hil_quickstart.html">Hardware-in-the-Loop (HIL) Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../streamlit_dashboard_guide.html">Streamlit Dashboard User Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">🎮 Control Systems &amp; Optimization</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../controllers/index.html">Controllers Module Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Controllers Module Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../controllers/classical_smc_technical_guide.html">Classical Sliding Mode Control Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/adaptive_smc_technical_guide.html">Adaptive Sliding Mode Control Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/sta_smc_technical_guide.html">Super-Twisting Sliding Mode Control Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/hybrid_smc_technical_guide.html">Hybrid Adaptive Super-Twisting SMC Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/mpc_technical_guide.html">Model Predictive Control Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/swing_up_smc_technical_guide.html">Swing-Up SMC Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/swing_up_smc_technical_guide.html#example-metadata">example-metadata:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/swing_up_smc_technical_guide.html#runnable-false">runnable: false</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_system_guide.html">SMC Controller Factory System Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/control_primitives_reference.html">Control Primitives Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mathematical_foundations/smc_complete_theory.html">Complete Sliding Mode Control Mathematical Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mathematical_foundations/controller_comparison_theory.html">SMC Controller Comparison Theory</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reference/controllers/index.html">Controllers Module</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Controllers Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/adaptive_smc.html">controllers.adaptive_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/classic_smc.html">controllers.classic_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory.html">controllers.factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/mpc_controller.html">controllers.mpc_controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/sta_smc.html">controllers.sta_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/swing_up_smc.html">controllers.swing_up_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/__init__.html">controllers.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/base_controller_interface.html">controllers.base.controller_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/base_control_primitives.html">controllers.base.control_primitives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/base___init__.html">controllers.base.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory_deprecation.html">controllers.factory.deprecation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory_fallback_configs.html">controllers.factory.fallback_configs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory_legacy_factory.html">controllers.factory.legacy_factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory_optimization.html">controllers.factory.optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory_pso_integration.html">controllers.factory.pso_integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory_smc_factory.html">controllers.factory.smc_factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory_thread_safety.html">controllers.factory.thread_safety</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory___init__.html">controllers.factory.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/mpc_mpc_controller.html">controllers.mpc.mpc_controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/mpc___init__.html">controllers.mpc.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_adaptive_smc.html">controllers.smc.adaptive_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_classic_smc.html">controllers.smc.classic_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_hybrid_adaptive_sta_smc.html">controllers.smc.hybrid_adaptive_sta_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_sta_smc.html">controllers.smc.sta_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc___init__.html">controllers.smc.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/specialized_swing_up_smc.html">controllers.specialized.swing_up_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/specialized___init__.html">controllers.specialized.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory_core_protocols.html">controllers.factory.core.protocols</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory_core_registry.html">controllers.factory.core.registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory_core_threading.html">controllers.factory.core.threading</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory_core_validation.html">controllers.factory.core.validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/factory_core___init__.html">controllers.factory.core.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms___init__.html">controllers.smc.algorithms.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_core_equivalent_control.html">controllers.smc.core.equivalent_control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_core_gain_validation.html">controllers.smc.core.gain_validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_core_sliding_surface.html">controllers.smc.core.sliding_surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_core_switching_functions.html">controllers.smc.core.switching_functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_core___init__.html">controllers.smc.core.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_adaptive_adaptation_law.html">controllers.smc.algorithms.adaptive.adaptation_law</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_adaptive_config.html">controllers.smc.algorithms.adaptive.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_adaptive_controller.html">controllers.smc.algorithms.adaptive.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_adaptive_parameter_estimation.html">controllers.smc.algorithms.adaptive.parameter_estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_adaptive___init__.html">controllers.smc.algorithms.adaptive.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_classical_boundary_layer.html">controllers.smc.algorithms.classical.boundary_layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_classical_config.html">controllers.smc.algorithms.classical.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_classical_controller.html">controllers.smc.algorithms.classical.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_classical___init__.html">controllers.smc.algorithms.classical.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_hybrid_config.html">controllers.smc.algorithms.hybrid.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_hybrid_controller.html">controllers.smc.algorithms.hybrid.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_hybrid_switching_logic.html">controllers.smc.algorithms.hybrid.switching_logic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_hybrid___init__.html">controllers.smc.algorithms.hybrid.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_super_twisting_config.html">controllers.smc.algorithms.super_twisting.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_super_twisting_controller.html">controllers.smc.algorithms.super_twisting.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_super_twisting_twisting_algorithm.html">controllers.smc.algorithms.super_twisting.twisting_algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/controllers/smc_algorithms_super_twisting___init__.html">controllers.smc.algorithms.super_twisting.<strong>init</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mathematical_foundations/index.html">Mathematical Foundations</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Mathematical Foundations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mathematical_foundations/smc_complete_theory.html">Complete Sliding Mode Control Mathematical Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mathematical_foundations/controller_comparison_theory.html">SMC Controller Comparison Theory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plant/models_guide.html">Plant Models Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimization_simulation/guide.html">Optimization &amp; Simulation Guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/controllers/index.html">Controllers Module</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Controllers Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/adaptive_smc.html">controllers.adaptive_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/classic_smc.html">controllers.classic_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory.html">controllers.factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/mpc_controller.html">controllers.mpc_controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/sta_smc.html">controllers.sta_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/swing_up_smc.html">controllers.swing_up_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/__init__.html">controllers.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/base_controller_interface.html">controllers.base.controller_interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/base_control_primitives.html">controllers.base.control_primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/base___init__.html">controllers.base.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory_deprecation.html">controllers.factory.deprecation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory_fallback_configs.html">controllers.factory.fallback_configs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory_legacy_factory.html">controllers.factory.legacy_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory_optimization.html">controllers.factory.optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory_pso_integration.html">controllers.factory.pso_integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory_smc_factory.html">controllers.factory.smc_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory_thread_safety.html">controllers.factory.thread_safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory___init__.html">controllers.factory.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/mpc_mpc_controller.html">controllers.mpc.mpc_controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/mpc___init__.html">controllers.mpc.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_adaptive_smc.html">controllers.smc.adaptive_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_classic_smc.html">controllers.smc.classic_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_hybrid_adaptive_sta_smc.html">controllers.smc.hybrid_adaptive_sta_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_sta_smc.html">controllers.smc.sta_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc___init__.html">controllers.smc.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/specialized_swing_up_smc.html">controllers.specialized.swing_up_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/specialized___init__.html">controllers.specialized.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory_core_protocols.html">controllers.factory.core.protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory_core_registry.html">controllers.factory.core.registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory_core_threading.html">controllers.factory.core.threading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory_core_validation.html">controllers.factory.core.validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/factory_core___init__.html">controllers.factory.core.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms___init__.html">controllers.smc.algorithms.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_core_equivalent_control.html">controllers.smc.core.equivalent_control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_core_gain_validation.html">controllers.smc.core.gain_validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_core_sliding_surface.html">controllers.smc.core.sliding_surface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_core_switching_functions.html">controllers.smc.core.switching_functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_core___init__.html">controllers.smc.core.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_adaptive_adaptation_law.html">controllers.smc.algorithms.adaptive.adaptation_law</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_adaptive_config.html">controllers.smc.algorithms.adaptive.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_adaptive_controller.html">controllers.smc.algorithms.adaptive.controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_adaptive_parameter_estimation.html">controllers.smc.algorithms.adaptive.parameter_estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_adaptive___init__.html">controllers.smc.algorithms.adaptive.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_classical_boundary_layer.html">controllers.smc.algorithms.classical.boundary_layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_classical_config.html">controllers.smc.algorithms.classical.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_classical_controller.html">controllers.smc.algorithms.classical.controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_classical___init__.html">controllers.smc.algorithms.classical.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_hybrid_config.html">controllers.smc.algorithms.hybrid.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_hybrid_controller.html">controllers.smc.algorithms.hybrid.controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_hybrid_switching_logic.html">controllers.smc.algorithms.hybrid.switching_logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_hybrid___init__.html">controllers.smc.algorithms.hybrid.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_super_twisting_config.html">controllers.smc.algorithms.super_twisting.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_super_twisting_controller.html">controllers.smc.algorithms.super_twisting.controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_super_twisting_twisting_algorithm.html">controllers.smc.algorithms.super_twisting.twisting_algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/controllers/smc_algorithms_super_twisting___init__.html">controllers.smc.algorithms.super_twisting.<strong>init</strong></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/optimizer/index.html">Optimizer Module</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Optimizer Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/optimizer/pso_optimizer.html">optimizer.pso_optimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/optimizer/__init__.html">optimizer.<strong>init</strong></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../analysis_plan.html">5. Analysis &amp; Verification Plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks_methodology.html">Benchmarks &amp; Methodology</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">🧪 Development &amp; Testing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../TESTING.html">Testing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../test_protocols.html">5.x Test Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use_cases.html">4. Use Cases &amp; Operating Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../context.html">2. Application Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault_detection_guide.html">Fault Detection &amp; Isolation (FDI) Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">📊 Research &amp; Theory</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../presentation/index.html">Research Presentation Materials</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Research Presentation Materials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../presentation/introduction.html">Abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/introduction.html#introduction-and-motivation">Introduction and Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/introduction.html#the-double-inverted-pendulum-as-a-canonical-control-problem">The Double Inverted Pendulum as a Canonical Control Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/introduction.html#the-primary-control-objectives-and-challenges">The Primary Control Objectives and Challenges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/introduction.html#sliding-mode-control-as-a-robust-solution">Sliding Mode Control as a Robust Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/introduction.html#the-gain-tuning-dilemma-and-the-need-for-optimization">The Gain Tuning Dilemma and the Need for Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/introduction.html#particle-swarm-optimization-for-automated-design">Particle Swarm Optimization for Automated Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/introduction.html#synthesis-and-motivation">Synthesis and Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/introduction.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/problem-statement.html">Problem Statement for Double‑Inverted Pendulum (DIP) Control with SMC and PSO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/previous-works.html">Previous Work Before the Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/system-modeling.html"><strong>A Comprehensive Technical Report on the Modeling and Configuration of a Cart‑Based Double Inverted Pendulum System</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/smc-theory.html">Sliding Mode Control for a Double‑Inverted Pendulum: Bridging Theory and Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/chattering-mitigation.html">Abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/chattering-mitigation.html#introduction">1 Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/chattering-mitigation.html#system-modelling-and-problem-formulation">2 System Modelling and Problem Formulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/chattering-mitigation.html#simulation-methodology">3 Simulation Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/chattering-mitigation.html#classic-sliding-mode-control">4 Classic Sliding Mode Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/chattering-mitigation.html#chattering-mitigation-strategy-i-boundary-layer-method">5 Chattering Mitigation Strategy I: Boundary Layer Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/chattering-mitigation.html#chattering-mitigation-strategy-ii-supertwisting-algorithm">6 Chattering Mitigation Strategy II: Super‑Twisting Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/chattering-mitigation.html#chattering-mitigation-strategy-iii-adaptive-sliding-mode-control">7 Chattering Mitigation Strategy III: Adaptive Sliding Mode Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/chattering-mitigation.html#chattering-mitigation-strategy-iv-hybrid-adaptivesta">8 Chattering Mitigation Strategy IV: Hybrid Adaptive–STA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/chattering-mitigation.html#synthesis-and-comparative-analysis">9 Synthesis and Comparative Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/chattering-mitigation.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/pso-optimization.html"><strong>Comprehensive Simulation Analysis and Enhancements for the Double Inverted Pendulum Control System</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/simulation-setup.html">Particle Swarm Optimization for Sliding‑Mode Controller Tuning of a Double Inverted Pendulum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/results-discussion.html">8 – Results and Discussion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../presentation/results-discussion.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/introduction.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/introduction.html#introduction-and-motivation">Introduction and Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/introduction.html#the-double-inverted-pendulum-as-a-canonical-control-problem">The Double Inverted Pendulum as a Canonical Control Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/introduction.html#the-primary-control-objectives-and-challenges">The Primary Control Objectives and Challenges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/introduction.html#sliding-mode-control-as-a-robust-solution">Sliding Mode Control as a Robust Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/introduction.html#the-gain-tuning-dilemma-and-the-need-for-optimization">The Gain Tuning Dilemma and the Need for Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/introduction.html#particle-swarm-optimization-for-automated-design">Particle Swarm Optimization for Automated Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/introduction.html#synthesis-and-motivation">Synthesis and Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/introduction.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/problem-statement.html">Problem Statement for Double‑Inverted Pendulum (DIP) Control with SMC and PSO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/previous-works.html">Previous Work Before the Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/system-modeling.html"><strong>A Comprehensive Technical Report on the Modeling and Configuration of a Cart‑Based Double Inverted Pendulum System</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/smc-theory.html">Sliding Mode Control for a Double‑Inverted Pendulum: Bridging Theory and Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/chattering-mitigation.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/chattering-mitigation.html#introduction">1 Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/chattering-mitigation.html#system-modelling-and-problem-formulation">2 System Modelling and Problem Formulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/chattering-mitigation.html#simulation-methodology">3 Simulation Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/chattering-mitigation.html#classic-sliding-mode-control">4 Classic Sliding Mode Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/chattering-mitigation.html#chattering-mitigation-strategy-i-boundary-layer-method">5 Chattering Mitigation Strategy I: Boundary Layer Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/chattering-mitigation.html#chattering-mitigation-strategy-ii-supertwisting-algorithm">6 Chattering Mitigation Strategy II: Super‑Twisting Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/chattering-mitigation.html#chattering-mitigation-strategy-iii-adaptive-sliding-mode-control">7 Chattering Mitigation Strategy III: Adaptive Sliding Mode Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/chattering-mitigation.html#chattering-mitigation-strategy-iv-hybrid-adaptivesta">8 Chattering Mitigation Strategy IV: Hybrid Adaptive–STA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/chattering-mitigation.html#synthesis-and-comparative-analysis">9 Synthesis and Comparative Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/chattering-mitigation.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/pso-optimization.html"><strong>Comprehensive Simulation Analysis and Enhancements for the Double Inverted Pendulum Control System</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/simulation-setup.html">Particle Swarm Optimization for Sliding‑Mode Controller Tuning of a Double Inverted Pendulum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/results-discussion.html">8 – Results and Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../presentation/results-discussion.html#references">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">📖 API Reference &amp; Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">API Reference Documentation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography &amp; Academic References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">🔧 Project Management</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing – ResearchPlanSpec Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../RELEASE_CHECKLIST.html">Release Checklist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../symbols.html">Symbols &amp; Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../results_readme.html">Results &amp; Plots</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">📚 Citations &amp; Attribution</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CITATIONS.html">Citations &amp; Academic Attribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CITATIONS_ACADEMIC.html">Academic Theory Citations &amp; References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DEPENDENCIES.html">Software Dependencies &amp; Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PATTERNS.html">Software Design Patterns &amp; Architecture Attribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LICENSES.html">License Compliance &amp; Attribution</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/theSadeQ/DIP_SMC_PSO/blob/main/docs/api/simulation_engine_api_reference.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/theSadeQ/DIP_SMC_PSO/edit/main/docs/api/simulation_engine_api_reference.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="simulation-engine-api-reference">
<h1>Simulation Engine API Reference<a class="headerlink" href="#simulation-engine-api-reference" title="Link to this heading">¶</a></h1>
<p><strong>Project:</strong> Double-Inverted Pendulum SMC Control System
<strong>Module:</strong> <code class="docutils literal notranslate"><span class="pre">src.simulation</span></code>
<strong>Version:</strong> 1.0
<strong>Date:</strong> 2025-10-07
<strong>Status:</strong> Production-Ready</p>
<hr class="docutils" />
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#overview-architecture">Overview &amp; Architecture</a></p></li>
<li><p><a class="reference internal" href="#core-simulation-engine-api">Core Simulation Engine API</a></p></li>
<li><p><a class="reference internal" href="#dynamics-model-api">Dynamics Model API</a></p></li>
<li><p><a class="reference internal" href="#orchestrator-system-api">Orchestrator System API</a></p></li>
<li><p><a class="reference internal" href="#integrator-system-api">Integrator System API</a></p></li>
<li><p><a class="reference internal" href="#result-container-api">Result Container API</a></p></li>
<li><p><a class="reference internal" href="#safety-monitoring-api">Safety &amp; Monitoring API</a></p></li>
<li><p><a class="reference internal" href="#complete-code-examples">Complete Code Examples</a></p></li>
<li><p><a class="reference internal" href="#9-integration-patterns"><span class="xref myst">Integration Patterns</span></a></p></li>
<li><p><a class="reference internal" href="#10-theory-cross-references--performance"><span class="xref myst">Theory Cross-References &amp; Performance</span></a></p></li>
</ol>
</section>
<hr class="docutils" />
<section id="overview-architecture">
<h2>1. Overview &amp; Architecture<a class="headerlink" href="#overview-architecture" title="Link to this heading">¶</a></h2>
<section id="introduction">
<h3>1.1 Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h3>
<p>The <strong>Simulation Engine</strong> is the core execution framework for the Double-Inverted Pendulum control system. It provides:</p>
<ul class="simple">
<li><p><strong>Flexible simulation execution</strong> strategies (sequential, batch, parallel, real-time)</p></li>
<li><p><strong>Multiple numerical integration</strong> methods (Euler, RK4, adaptive Runge-Kutta)</p></li>
<li><p><strong>Comprehensive dynamics models</strong> (simplified, full nonlinear, linearized)</p></li>
<li><p><strong>Safety monitoring</strong> and constraint enforcement</p></li>
<li><p><strong>Professional result management</strong> with export capabilities</p></li>
<li><p><strong>PSO optimization integration</strong> through batch execution</p></li>
<li><p><strong>Hardware-in-loop (HIL)</strong> real-time simulation support</p></li>
</ul>
<p><strong>Key Features:</strong></p>
<ul class="simple">
<li><p>✅ 45 Python modules providing complete simulation framework</p></li>
<li><p>✅ Backward-compatible with legacy <code class="docutils literal notranslate"><span class="pre">simulation_runner.py</span></code> interface</p></li>
<li><p>✅ Extensible architecture for research and production use</p></li>
<li><p>✅ Type-safe interfaces with comprehensive protocols</p></li>
<li><p>✅ Production-grade error handling and monitoring</p></li>
<li><p>✅ Memory-optimized for long-running simulations</p></li>
</ul>
</section>
<section id="system-architecture">
<h3>1.2 System Architecture<a class="headerlink" href="#system-architecture" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="err">┌────────────────────────────────────────────────────────────────────────┐</span>
<span class="err">│</span>                       <span class="n">SIMULATION</span> <span class="n">ENGINE</span> <span class="n">SYSTEM</span>                          <span class="err">│</span>
<span class="err">├────────────────────────────────────────────────────────────────────────┤</span>
<span class="err">│</span>                                                                         <span class="err">│</span>
<span class="err">│</span>  <span class="err">┌─────────────┐</span>     <span class="err">┌─────────────┐</span>     <span class="err">┌─────────────┐</span>            <span class="err">│</span>
<span class="err">│</span>  <span class="err">│</span> <span class="n">Controller</span>  <span class="err">│────▶│</span> <span class="n">Simulation</span>  <span class="err">│────▶│</span>  <span class="n">Dynamics</span>   <span class="err">│</span>            <span class="err">│</span>
<span class="err">│</span>  <span class="err">│</span>   <span class="n">Factory</span>   <span class="err">│</span>     <span class="err">│</span>   <span class="n">Runner</span>    <span class="err">│</span>     <span class="err">│</span>    <span class="n">Model</span>    <span class="err">│</span>            <span class="err">│</span>
<span class="err">│</span>  <span class="err">└─────────────┘</span>     <span class="err">└─────────────┘</span>     <span class="err">└─────────────┘</span>            <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>                    <span class="err">│</span>                    <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>                    <span class="err">▼</span>                    <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>            <span class="err">┌──────────────┐</span>            <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>            <span class="err">│</span> <span class="n">Orchestrator</span> <span class="err">│</span>            <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>            <span class="err">│</span>   <span class="n">Strategy</span>   <span class="err">│</span>            <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>            <span class="err">└──────────────┘</span>            <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>                    <span class="err">│</span>                    <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>         <span class="err">┌──────────┴──────────┐</span>        <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>         <span class="err">▼</span>                     <span class="err">▼</span>        <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>   <span class="err">┌───────────┐</span>        <span class="err">┌───────────┐</span>  <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>   <span class="err">│</span><span class="n">Sequential</span> <span class="err">│</span>        <span class="err">│</span>   <span class="n">Batch</span>   <span class="err">│</span>  <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>   <span class="err">│</span><span class="n">Orchestr</span><span class="o">.</span>  <span class="err">│</span>        <span class="err">│</span><span class="n">Orchestr</span><span class="o">.</span>  <span class="err">│</span>  <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>   <span class="err">└───────────┘</span>        <span class="err">└───────────┘</span>  <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>         <span class="err">│</span>                     <span class="err">│</span>        <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>         <span class="err">└──────────┬──────────┘</span>        <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>                    <span class="err">▼</span>                    <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>            <span class="err">┌──────────────┐</span>            <span class="err">│</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>            <span class="err">│</span>  <span class="n">Integrator</span>  <span class="err">│◀───────────┘</span>                   <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>            <span class="err">│</span>   <span class="n">Factory</span>    <span class="err">│</span>                                <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>            <span class="err">└──────────────┘</span>                                <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>                    <span class="err">│</span>                                       <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>         <span class="err">┌──────────┴──────────┐</span>                           <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>         <span class="err">▼</span>                     <span class="err">▼</span>                           <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>   <span class="err">┌───────────┐</span>        <span class="err">┌───────────┐</span>                     <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>   <span class="err">│</span>   <span class="n">Euler</span>   <span class="err">│</span>        <span class="err">│</span>    <span class="n">RK4</span>    <span class="err">│</span>                     <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>   <span class="err">│</span> <span class="p">(</span><span class="mi">1</span><span class="n">st</span> <span class="nb">ord</span><span class="p">)</span> <span class="err">│</span>        <span class="err">│</span> <span class="p">(</span><span class="mi">4</span><span class="n">th</span> <span class="nb">ord</span><span class="p">)</span> <span class="err">│</span>                     <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>   <span class="err">└───────────┘</span>        <span class="err">└───────────┘</span>                     <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>         <span class="err">│</span>                     <span class="err">│</span>                           <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>         <span class="err">└──────────┬──────────┘</span>                           <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>                    <span class="err">▼</span>                                       <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>            <span class="err">┌──────────────┐</span>                               <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>            <span class="err">│</span>    <span class="n">Safety</span>    <span class="err">│</span>                               <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>            <span class="err">│</span>    <span class="n">Guards</span>    <span class="err">│</span>                               <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>            <span class="err">└──────────────┘</span>                               <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>                                                            <span class="err">│</span>
<span class="err">│</span>         <span class="err">▼</span>                                                            <span class="err">│</span>
<span class="err">│</span>  <span class="err">┌─────────────┐</span>                                                    <span class="err">│</span>
<span class="err">│</span>  <span class="err">│</span>     <span class="n">PSO</span>     <span class="err">│</span>                                                    <span class="err">│</span>
<span class="err">│</span>  <span class="err">│</span><span class="n">Optimization</span> <span class="err">│</span>                                                    <span class="err">│</span>
<span class="err">│</span>  <span class="err">└─────────────┘</span>                                                    <span class="err">│</span>
<span class="err">│</span>         <span class="err">│</span>                                                            <span class="err">│</span>
<span class="err">│</span>         <span class="err">▼</span>                                                            <span class="err">│</span>
<span class="err">│</span>  <span class="err">┌─────────────┐</span>                                                    <span class="err">│</span>
<span class="err">│</span>  <span class="err">│</span>   <span class="n">Results</span>   <span class="err">│</span>                                                    <span class="err">│</span>
<span class="err">│</span>  <span class="err">│</span>  <span class="n">Container</span>  <span class="err">│</span>                                                    <span class="err">│</span>
<span class="err">│</span>  <span class="err">└─────────────┘</span>                                                    <span class="err">│</span>
<span class="err">│</span>                                                                      <span class="err">│</span>
<span class="err">└──────────────────────────────────────────────────────────────────────┘</span>
</pre></div>
</div>
</section>
<section id="module-relationships">
<h3>1.3 Module Relationships<a class="headerlink" href="#module-relationships" title="Link to this heading">¶</a></h3>
<p><strong>Core Components:</strong></p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">simulation_runner.py</span></code></strong> - Main simulation loop and legacy compatibility</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">simulation_context.py</span></code></strong> - Configuration management and orchestrator selection</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">interfaces.py</span></code></strong> - Protocol definitions for extensibility</p></li>
</ul>
<p><strong>Execution Strategies (Orchestrators):</strong></p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">orchestrators/sequential.py</span></code></strong> - Single-threaded step-by-step execution</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">orchestrators/batch.py</span></code></strong> - Vectorized multi-simulation execution</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">orchestrators/parallel.py</span></code></strong> - Multi-threaded parallel execution</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">orchestrators/real_time.py</span></code></strong> - Real-time constraint enforcement for HIL</p></li>
</ul>
<p><strong>Numerical Integration:</strong></p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">integrators/factory.py</span></code></strong> - Integrator creation and registry</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">integrators/fixed_step/euler.py</span></code></strong> - 1st-order Euler method</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">integrators/fixed_step/runge_kutta.py</span></code></strong> - 2nd and 4th-order Runge-Kutta</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">integrators/adaptive/runge_kutta.py</span></code></strong> - Adaptive step size with error control</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">integrators/discrete/zero_order_hold.py</span></code></strong> - Discrete-time control</p></li>
</ul>
<p><strong>Plant Dynamics:</strong></p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">plant/models/base/dynamics_interface.py</span></code></strong> - DynamicsModel protocol</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">plant/models/lowrank/dynamics.py</span></code></strong> - Simplified DIP dynamics</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">plant/models/full/dynamics.py</span></code></strong> - Full nonlinear DIP dynamics</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">plant/models/simplified/dynamics.py</span></code></strong> - Educational simplified model</p></li>
</ul>
<p><strong>Results &amp; Safety:</strong></p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">results/containers.py</span></code></strong> - StandardResultContainer, BatchResultContainer</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">results/exporters.py</span></code></strong> - CSV, HDF5 export functionality</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">safety/guards.py</span></code></strong> - NaN/Inf detection, energy bounds, state validation</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">safety/monitors.py</span></code></strong> - Performance monitoring and statistics</p></li>
</ul>
</section>
<section id="data-flow-diagram">
<h3>1.4 Data Flow Diagram<a class="headerlink" href="#data-flow-diagram" title="Link to this heading">¶</a></h3>
<section id="simulation-loop-execution-flow">
<h4>Simulation Loop Execution Flow<a class="headerlink" href="#simulation-loop-execution-flow" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">START</span>
  <span class="err">│</span>
  <span class="err">├─▶</span> <span class="n">Initialize</span> <span class="n">state</span> <span class="p">(</span><span class="n">x0</span><span class="p">)</span>
  <span class="err">│</span>
  <span class="err">├─▶</span> <span class="n">Initialize</span> <span class="n">controller</span> <span class="p">(</span><span class="n">state_vars</span><span class="p">,</span> <span class="n">history</span><span class="p">)</span>
  <span class="err">│</span>
  <span class="err">├─▶</span> <span class="n">FOR</span> <span class="n">each</span> <span class="n">timestep</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
  <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Measure</span> <span class="n">control</span> <span class="n">computation</span> <span class="n">time</span> <span class="p">(</span><span class="n">start</span> <span class="n">timer</span><span class="p">)</span>
  <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Compute</span> <span class="n">control</span><span class="p">:</span> <span class="n">u</span> <span class="o">=</span> <span class="n">controller</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
  <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">│</span>     <span class="err">├─▶</span> <span class="p">[</span><span class="n">Has</span> <span class="n">compute_control</span><span class="p">]</span> <span class="err">→</span> <span class="n">u</span><span class="p">,</span> <span class="n">state_vars</span><span class="p">,</span> <span class="n">history</span>
  <span class="err">│</span>     <span class="err">│</span>     <span class="err">└─▶</span> <span class="p">[</span><span class="n">Has</span> <span class="fm">__call__</span><span class="p">]</span> <span class="err">→</span> <span class="n">u</span> <span class="o">=</span> <span class="n">controller</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
  <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Check</span> <span class="n">latency</span> <span class="p">(</span><span class="n">end</span> <span class="n">timer</span><span class="p">)</span>
  <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">│</span>     <span class="err">└─▶</span> <span class="p">[</span><span class="n">Exceeds</span> <span class="n">dt</span> <span class="n">AND</span> <span class="n">fallback</span> <span class="n">available</span><span class="p">]</span> <span class="err">→</span> <span class="n">use</span> <span class="n">fallback_controller</span>
  <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Apply</span> <span class="n">control</span> <span class="n">saturation</span><span class="p">:</span> <span class="n">u</span> <span class="o">=</span> <span class="n">clip</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="o">-</span><span class="n">u_max</span><span class="p">,</span> <span class="n">u_max</span><span class="p">)</span>
  <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Apply</span> <span class="n">safety</span> <span class="n">guards</span> <span class="p">(</span><span class="n">NaN</span><span class="o">/</span><span class="n">Inf</span><span class="o">/</span><span class="n">Bounds</span> <span class="n">checks</span><span class="p">)</span>
  <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">│</span>     <span class="err">└─▶</span> <span class="p">[</span><span class="n">FAIL</span><span class="p">]</span> <span class="err">→</span> <span class="n">Truncate</span> <span class="n">trajectory</span> <span class="ow">and</span> <span class="k">return</span>
  <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Propagate</span> <span class="n">dynamics</span><span class="p">:</span> <span class="n">x_next</span> <span class="o">=</span> <span class="n">dynamics</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
  <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">│</span>     <span class="err">└─▶</span> <span class="p">[</span><span class="ne">Exception</span> <span class="ow">or</span> <span class="n">NaN</span><span class="o">/</span><span class="n">Inf</span><span class="p">]</span> <span class="err">→</span> <span class="n">Truncate</span> <span class="ow">and</span> <span class="k">return</span>
  <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Validate</span> <span class="n">result</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">x_next</span><span class="p">)</span>
  <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">│</span>     <span class="err">├─▶</span> <span class="p">[</span><span class="n">PASS</span><span class="p">]</span> <span class="err">→</span> <span class="n">Continue</span>
  <span class="err">│</span>     <span class="err">│</span>     <span class="err">└─▶</span> <span class="p">[</span><span class="n">FAIL</span><span class="p">]</span> <span class="err">→</span> <span class="n">Truncate</span> <span class="ow">and</span> <span class="k">return</span>
  <span class="err">│</span>     <span class="err">│</span>
  <span class="err">│</span>     <span class="err">└─▶</span> <span class="n">Store</span> <span class="n">trajectory</span><span class="p">:</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
  <span class="err">│</span>
  <span class="err">└─▶</span> <span class="n">Attach</span> <span class="n">final</span> <span class="n">history</span> <span class="n">to</span> <span class="n">controller</span> <span class="p">(</span><span class="k">if</span> <span class="n">available</span><span class="p">)</span>
      <span class="err">│</span>
      <span class="err">└─▶</span> <span class="n">Return</span><span class="p">:</span> <span class="p">(</span><span class="n">t_arr</span><span class="p">,</span> <span class="n">x_arr</span><span class="p">,</span> <span class="n">u_arr</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="batch-simulation-for-pso">
<h4>Batch Simulation for PSO<a class="headerlink" href="#batch-simulation-for-pso" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">PSO</span> <span class="n">Tuner</span>
    <span class="err">│</span>
    <span class="err">├─▶</span> <span class="n">Generate</span> <span class="n">N</span> <span class="n">particles</span> <span class="p">(</span><span class="n">gain</span> <span class="n">sets</span><span class="p">)</span>
    <span class="err">│</span>
    <span class="err">├─▶</span> <span class="n">Create</span> <span class="n">controller</span> <span class="n">factory</span><span class="p">:</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">create_controller</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
    <span class="err">│</span>
    <span class="err">├─▶</span> <span class="n">FOR</span> <span class="n">each</span> <span class="n">particle</span> <span class="n">p</span><span class="p">:</span>
    <span class="err">│</span>     <span class="err">│</span>
    <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Instantiate</span> <span class="n">controller</span><span class="p">:</span> <span class="n">ctrl</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="n">gains</span><span class="o">=</span><span class="n">particle_p</span><span class="p">)</span>
    <span class="err">│</span>     <span class="err">│</span>
    <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">BatchOrchestrator</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Initialize</span> <span class="n">batch_size</span> <span class="n">trajectories</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">FOR</span> <span class="n">each</span> <span class="n">step</span><span class="p">:</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Vectorized</span> <span class="n">control</span> <span class="n">computation</span> <span class="p">(</span><span class="n">batch_size</span> <span class="n">x</span><span class="p">)</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Safety</span> <span class="n">guard</span> <span class="n">check</span> <span class="p">(</span><span class="n">each</span> <span class="n">trajectory</span><span class="p">)</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Dynamics</span> <span class="n">step</span> <span class="p">(</span><span class="n">each</span> <span class="n">trajectory</span><span class="p">)</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>     <span class="err">└─▶</span> <span class="n">Collect</span> <span class="n">results</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">└─▶</span> <span class="n">Return</span> <span class="n">BatchResultContainer</span>
    <span class="err">│</span>     <span class="err">│</span>
    <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Compute</span> <span class="n">fitness</span> <span class="n">metrics</span><span class="p">:</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">│</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Settling</span> <span class="n">time</span> <span class="p">(</span><span class="mi">2</span><span class="o">%</span> <span class="n">threshold</span><span class="p">)</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Overshoot</span> <span class="p">(</span><span class="n">peak</span> <span class="n">deviation</span><span class="p">)</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">ISE</span> <span class="p">(</span><span class="n">Integral</span> <span class="n">Squared</span> <span class="n">Error</span><span class="p">)</span>
    <span class="err">│</span>     <span class="err">│</span>     <span class="err">└─▶</span> <span class="n">Control</span> <span class="n">effort</span> <span class="p">(</span><span class="nb">sum</span> <span class="o">|</span><span class="n">u</span><span class="o">|</span><span class="p">)</span>
    <span class="err">│</span>     <span class="err">│</span>
    <span class="err">│</span>     <span class="err">└─▶</span> <span class="n">Store</span> <span class="n">fitness</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_cost</span>
    <span class="err">│</span>
    <span class="err">└─▶</span> <span class="n">PSO</span> <span class="n">iteration</span><span class="p">:</span> <span class="n">Update</span> <span class="n">velocities</span> <span class="ow">and</span> <span class="n">positions</span>
        <span class="err">│</span>
        <span class="err">├─▶</span> <span class="n">Convergence</span> <span class="n">check</span> <span class="p">(</span><span class="n">EnhancedConvergenceAnalyzer</span><span class="p">)</span>
        <span class="err">│</span>     <span class="err">│</span>
        <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Population</span> <span class="n">diversity</span> <span class="o">&lt;</span> <span class="n">threshold</span>
        <span class="err">│</span>     <span class="err">├─▶</span> <span class="n">Fitness</span> <span class="n">stagnation</span> <span class="o">&gt;</span> <span class="n">N</span> <span class="n">iterations</span>
        <span class="err">│</span>     <span class="err">└─▶</span> <span class="n">Velocity</span> <span class="n">convergence</span> <span class="o">&lt;</span> <span class="n">threshold</span>
        <span class="err">│</span>
        <span class="err">└─▶</span> <span class="p">[</span><span class="n">Converged</span><span class="p">]</span> <span class="err">→</span> <span class="n">Return</span> <span class="n">optimal</span> <span class="n">gains</span>
            <span class="p">[</span><span class="n">Not</span> <span class="n">converged</span><span class="p">]</span> <span class="err">→</span> <span class="n">Continue</span> <span class="n">PSO</span> <span class="n">iteration</span>
</pre></div>
</div>
</section>
</section>
<section id="key-design-patterns">
<h3>1.5 Key Design Patterns<a class="headerlink" href="#key-design-patterns" title="Link to this heading">¶</a></h3>
<section id="protocol-based-interfaces">
<h4>1.5.1 Protocol-Based Interfaces<a class="headerlink" href="#protocol-based-interfaces" title="Link to this heading">¶</a></h4>
<p>All major components define protocols for extensibility:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Protocol</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DynamicsModel</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Protocol for plant dynamics models.&quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_dynamics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">control_input</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DynamicsResult</span><span class="p">:</span> <span class="o">...</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_physics_matrices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span> <span class="o">...</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>This allows:</p>
<ul class="simple">
<li><p>✅ Duck-typed dynamics models (no inheritance required)</p></li>
<li><p>✅ Easy integration of custom dynamics</p></li>
<li><p>✅ Type checker validation (mypy, pyright)</p></li>
</ul>
</section>
<section id="factory-pattern">
<h4>1.5.2 Factory Pattern<a class="headerlink" href="#factory-pattern" title="Link to this heading">¶</a></h4>
<p>Integrator and orchestrator creation uses factory pattern:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.integrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">IntegratorFactory</span>

<span class="n">integrator</span> <span class="o">=</span> <span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">create_integrator</span><span class="p">(</span><span class="s1">&#39;rk4&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
<p>Benefits:</p>
<ul class="simple">
<li><p>✅ Centralized integrator registry</p></li>
<li><p>✅ Consistent initialization</p></li>
<li><p>✅ Easy addition of new integrators</p></li>
<li><p>✅ Type safety and validation</p></li>
</ul>
</section>
<section id="strategy-pattern">
<h4>1.5.3 Strategy Pattern<a class="headerlink" href="#strategy-pattern" title="Link to this heading">¶</a></h4>
<p>Execution strategies encapsulated in orchestrators:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sequential execution</span>
<span class="n">seq_orchestrator</span> <span class="o">=</span> <span class="n">SequentialOrchestrator</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">seq_orchestrator</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">horizon</span><span class="p">)</span>

<span class="c1"># Batch execution</span>
<span class="n">batch_orchestrator</span> <span class="o">=</span> <span class="n">BatchOrchestrator</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">batch_orchestrator</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">batch_initial_states</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">horizon</span><span class="p">)</span>
</pre></div>
</div>
<p>Advantages:</p>
<ul class="simple">
<li><p>✅ Swappable execution strategies</p></li>
<li><p>✅ Common interface for all orchestrators</p></li>
<li><p>✅ Performance optimization per strategy</p></li>
</ul>
</section>
</section>
<section id="backward-compatibility">
<h3>1.6 Backward Compatibility<a class="headerlink" href="#backward-compatibility" title="Link to this heading">¶</a></h3>
<p><strong>Legacy Interface Support:</strong></p>
<p>The simulation engine maintains 100% backward compatibility with the original <code class="docutils literal notranslate"><span class="pre">simulation_runner.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="c1"># Legacy imports work unchanged</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_simulation</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">get_step_fn</span><span class="p">,</span> <span class="n">simulate</span>

<span class="c1"># Original function signatures preserved</span>
<span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span><span class="n">controller</span><span class="o">=...</span><span class="p">,</span> <span class="n">dynamics_model</span><span class="o">=...</span><span class="p">,</span> <span class="n">sim_time</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>

<span class="c1"># Legacy step function</span>
<span class="n">x_next</span> <span class="o">=</span> <span class="n">step</span><span class="p">(</span><span class="n">x_current</span><span class="p">,</span> <span class="n">u_current</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Migration Path:</strong></p>
<p>New code can use modern orchestrator interface:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">SequentialOrchestrator</span><span class="p">,</span> <span class="n">IntegratorFactory</span>

<span class="c1"># Modern interface</span>
<span class="n">orchestrator</span> <span class="o">=</span> <span class="n">SequentialOrchestrator</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orchestrator</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">horizon</span><span class="p">)</span>
</pre></div>
</div>
<p>Both interfaces coexist seamlessly for gradual migration.</p>
</section>
<section id="performance-characteristics">
<h3>1.7 Performance Characteristics<a class="headerlink" href="#performance-characteristics" title="Link to this heading">¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Execution Strategy</p></th>
<th class="head"><p>Single Sim</p></th>
<th class="head"><p>Batch (10x)</p></th>
<th class="head"><p>Batch (100x)</p></th>
<th class="head"><p>Use Case</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Sequential</p></td>
<td><p>Baseline</p></td>
<td><p>9.8x slower</p></td>
<td><p>98x slower</p></td>
<td><p>Single trajectory, debugging</p></td>
</tr>
<tr class="row-odd"><td><p>Batch</p></td>
<td><p>N/A</p></td>
<td><p>Baseline</p></td>
<td><p>9.5x faster</p></td>
<td><p>PSO optimization, Monte Carlo</p></td>
</tr>
<tr class="row-even"><td><p>Parallel (4 cores)</p></td>
<td><p>N/A</p></td>
<td><p>3.2x faster</p></td>
<td><p>24x faster</p></td>
<td><p>Large parameter sweeps</p></td>
</tr>
<tr class="row-odd"><td><p>Real-Time</p></td>
<td><p>Baseline</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>Hardware-in-loop, real systems</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Memory Footprint:</strong></p>
<ul class="simple">
<li><p>Sequential: ~5 MB per 10s simulation (6 states, 1000 steps)</p></li>
<li><p>Batch (10x): ~50 MB (scales linearly)</p></li>
<li><p>Batch (100x): ~500 MB (requires sufficient RAM)</p></li>
</ul>
<p><strong>Optimization Notes:</strong></p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">BatchOrchestrator</span></code> for PSO fitness evaluation (10-30x speedup)</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">ForwardEuler</span></code> for fast prototyping (5x faster than RK4)</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">DormandPrince45</span></code> for high-accuracy requirements (adaptive step size)</p></li>
<li><p>Employ <code class="docutils literal notranslate"><span class="pre">ParallelOrchestrator</span></code> for large-scale parameter studies</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="core-simulation-engine-api">
<h2>2. Core Simulation Engine API<a class="headerlink" href="#core-simulation-engine-api" title="Link to this heading">¶</a></h2>
<section id="run-simulation-function">
<h3>2.1 <code class="docutils literal notranslate"><span class="pre">run_simulation()</span></code> Function<a class="headerlink" href="#run-simulation-function" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/engines/simulation_runner.py:109</span></code></p>
<p>The main simulation function providing backward-compatible interface for controller-dynamics integration.</p>
<section id="function-signature">
<h4>2.1.1 Function Signature<a class="headerlink" href="#function-signature" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="k">def</span><span class="w"> </span><span class="nf">run_simulation</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">controller</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">dynamics_model</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">sim_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">u_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rng</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">latency_margin</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fallback_controller</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">_kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate a single controller trajectory using explicit Euler method.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="parameters">
<h4>2.1.2 Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">controller</span></code></p></td>
<td><p>Any</p></td>
<td><p>✅ Yes</p></td>
<td><p>-</p></td>
<td><p>Controller object with <code class="docutils literal notranslate"><span class="pre">__call__(t,</span> <span class="pre">x)</span></code> or <code class="docutils literal notranslate"><span class="pre">compute_control(x,</span> <span class="pre">state,</span> <span class="pre">hist)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dynamics_model</span></code></p></td>
<td><p>Any</p></td>
<td><p>✅ Yes</p></td>
<td><p>-</p></td>
<td><p>Dynamics object with <code class="docutils literal notranslate"><span class="pre">step(state,</span> <span class="pre">u,</span> <span class="pre">dt)</span></code> method</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sim_time</span></code></p></td>
<td><p>float</p></td>
<td><p>✅ Yes</p></td>
<td><p>-</p></td>
<td><p>Total simulation time horizon (seconds)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dt</span></code></p></td>
<td><p>float</p></td>
<td><p>✅ Yes</p></td>
<td><p>-</p></td>
<td><p>Integration timestep (seconds), must be &gt; 0</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">initial_state</span></code></p></td>
<td><p>array-like</p></td>
<td><p>✅ Yes</p></td>
<td><p>-</p></td>
<td><p>Initial state vector (flattened to 1D)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">u_max</span></code></p></td>
<td><p>float</p></td>
<td><p>❌ No</p></td>
<td><p>None</p></td>
<td><p>Control saturation limit; if None, uses <code class="docutils literal notranslate"><span class="pre">controller.max_force</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">seed</span></code></p></td>
<td><p>int</p></td>
<td><p>❌ No</p></td>
<td><p>None</p></td>
<td><p>(Deprecated) Random seed; use <code class="docutils literal notranslate"><span class="pre">rng</span></code> instead</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rng</span></code></p></td>
<td><p>np.random.Generator</p></td>
<td><p>❌ No</p></td>
<td><p>None</p></td>
<td><p>Random number generator for stochastic controllers</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">latency_margin</span></code></p></td>
<td><p>float</p></td>
<td><p>❌ No</p></td>
<td><p>None</p></td>
<td><p>(Unused) Reserved for future latency control</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fallback_controller</span></code></p></td>
<td><p>Callable</p></td>
<td><p>❌ No</p></td>
<td><p>None</p></td>
<td><p>Fallback controller invoked after deadline miss</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">**_kwargs</span></code></p></td>
<td><p>dict</p></td>
<td><p>❌ No</p></td>
<td><p>-</p></td>
<td><p>Additional kwargs ignored (backward compatibility)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="return-values">
<h4>2.1.3 Return Values<a class="headerlink" href="#return-values" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
    <span class="n">t_arr</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Time vector (n_steps+1,)</span>
    <span class="n">x_arr</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># State trajectory (n_steps+1, state_dim)</span>
    <span class="n">u_arr</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># Control sequence (n_steps,)</span>
</pre></div>
</div>
<p><strong>Notes:</strong></p>
<ul class="simple">
<li><p>If simulation fails or is truncated, arrays are trimmed to valid length</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t_arr[0]</span> <span class="pre">=</span> <span class="pre">0.0</span></code>, <code class="docutils literal notranslate"><span class="pre">t_arr[-1]</span> <span class="pre">=</span> <span class="pre">n_steps</span> <span class="pre">*</span> <span class="pre">dt</span></code> where <code class="docutils literal notranslate"><span class="pre">n_steps</span> <span class="pre">=</span> <span class="pre">int(round(sim_time</span> <span class="pre">/</span> <span class="pre">dt))</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x_arr[0]</span></code> contains <code class="docutils literal notranslate"><span class="pre">initial_state</span></code>, <code class="docutils literal notranslate"><span class="pre">x_arr[i+1]</span></code> contains state after step <code class="docutils literal notranslate"><span class="pre">i</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u_arr[i]</span></code> contains control applied at step <code class="docutils literal notranslate"><span class="pre">i</span></code></p></li>
</ul>
</section>
<section id="controller-interface-requirements">
<h4>2.1.4 Controller Interface Requirements<a class="headerlink" href="#controller-interface-requirements" title="Link to this heading">¶</a></h4>
<p>Controllers must implement <strong>one</strong> of these interfaces:</p>
<p><strong>Option 1: Callable Interface</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyController</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute control given time and state.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">control_value</span>
</pre></div>
</div>
<p><strong>Option 2: compute_control Interface</strong> (Preferred for stateful controllers)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">StatefulController</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">state_vars</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">history</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute control with state tracking.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">control_value</span><span class="p">,</span> <span class="n">updated_state</span><span class="p">,</span> <span class="n">updated_history</span>
</pre></div>
</div>
<p><strong>Optional Hooks:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">initialize_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize internal state variables (called once at start).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">initial_state_vars</span>

<span class="k">def</span><span class="w"> </span><span class="nf">initialize_history</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize history buffer (called once at start).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">initial_history</span>
</pre></div>
</div>
</section>
<section id="dynamics-model-interface-requirements">
<h4>2.1.5 Dynamics Model Interface Requirements<a class="headerlink" href="#dynamics-model-interface-requirements" title="Link to this heading">¶</a></h4>
<p>Dynamics models must provide:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyDynamics</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">u</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Integrate dynamics forward one timestep.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">next_state</span>
</pre></div>
</div>
<p><strong>Contract:</strong></p>
<ul class="simple">
<li><p>Input: <code class="docutils literal notranslate"><span class="pre">state</span></code> (n-dimensional), <code class="docutils literal notranslate"><span class="pre">u</span></code> (scalar or 1D array), <code class="docutils literal notranslate"><span class="pre">dt</span></code> (float)</p></li>
<li><p>Output: <code class="docutils literal notranslate"><span class="pre">next_state</span></code> (n-dimensional, same shape as input state)</p></li>
<li><p>Must handle exceptions gracefully (return NaN/Inf triggers truncation)</p></li>
</ul>
</section>
<section id="control-saturation-logic">
<h4>2.1.6 Control Saturation Logic<a class="headerlink" href="#control-saturation-logic" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="c1"># Priority hierarchy:</span>
<span class="c1"># 1. Explicit u_max parameter</span>
<span class="k">if</span> <span class="n">u_max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">u_limit</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">u_max</span><span class="p">)</span>
<span class="c1"># 2. Controller&#39;s max_force attribute</span>
<span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="s1">&#39;max_force&#39;</span><span class="p">):</span>
    <span class="n">u_limit</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">controller</span><span class="o">.</span><span class="n">max_force</span><span class="p">)</span>
<span class="c1"># 3. No saturation</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">u_limit</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Apply saturation</span>
<span class="k">if</span> <span class="n">u_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="o">-</span><span class="n">u_limit</span><span class="p">,</span> <span class="n">u_limit</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="latency-monitoring-and-fallback">
<h4>2.1.7 Latency Monitoring and Fallback<a class="headerlink" href="#latency-monitoring-and-fallback" title="Link to this heading">¶</a></h4>
<p><strong>Behavior:</strong></p>
<ul class="simple">
<li><p>Measures control computation time using <code class="docutils literal notranslate"><span class="pre">time.perf_counter()</span></code></p></li>
<li><p>If computation time exceeds <code class="docutils literal notranslate"><span class="pre">dt</span></code> on any step:</p>
<ul>
<li><p>Engages <code class="docutils literal notranslate"><span class="pre">fallback_controller</span></code> for all subsequent steps</p></li>
<li><p>Logs latency violation (if logging enabled)</p></li>
</ul>
</li>
</ul>
<p><strong>Example Use Case:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="c1"># Simple PD fallback controller</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pd_fallback</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">10</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># -Kp*x - Kd*x_dot</span>

<span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span>
    <span class="n">controller</span><span class="o">=</span><span class="n">complex_mpc_controller</span><span class="p">,</span>
    <span class="n">dynamics_model</span><span class="o">=</span><span class="n">dynamics</span><span class="p">,</span>
    <span class="n">sim_time</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
    <span class="n">fallback_controller</span><span class="o">=</span><span class="n">pd_fallback</span>  <span class="c1"># Engage if MPC exceeds 10ms</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="early-termination-conditions">
<h4>2.1.8 Early Termination Conditions<a class="headerlink" href="#early-termination-conditions" title="Link to this heading">¶</a></h4>
<p>Simulation terminates early if:</p>
<ol class="arabic">
<li><p><strong>Control computation fails:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">controller</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="c1"># Truncate and return</span>
</pre></div>
</div>
</li>
<li><p><strong>Dynamics propagation fails:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">x_next</span> <span class="o">=</span> <span class="n">dynamics</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="c1"># Truncate and return</span>
</pre></div>
</div>
</li>
<li><p><strong>Invalid state detected:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">x_next</span><span class="p">)):</span>
    <span class="c1"># Truncate and return (NaN or Inf detected)</span>
</pre></div>
</div>
</li>
</ol>
<p><strong>Truncated Return Behavior:</strong></p>
<ul class="simple">
<li><p>Arrays trimmed to last valid step</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t_arr</span></code> length: <code class="docutils literal notranslate"><span class="pre">i+1</span></code> (0 to current step)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x_arr</span></code> length: <code class="docutils literal notranslate"><span class="pre">i+1</span></code> (includes current state)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u_arr</span></code> length: <code class="docutils literal notranslate"><span class="pre">i</span></code> (excludes failed control)</p></li>
</ul>
</section>
<section id="memory-optimization">
<h4>2.1.9 Memory Optimization<a class="headerlink" href="#memory-optimization" title="Link to this heading">¶</a></h4>
<p><strong>Key Optimization (Line 202, 249, 309):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># MEMORY OPTIMIZATION: asarray creates view when input is already ndarray</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># View, not copy</span>
<span class="n">x_curr</span> <span class="o">=</span> <span class="n">x0</span>  <span class="c1"># View, immediately overwritten at line 323</span>
<span class="n">x_next</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x_next</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># View when possible</span>
</pre></div>
</div>
<p><strong>Impact:</strong></p>
<ul class="simple">
<li><p>Eliminates ~423 unnecessary array copies in typical 5s simulation</p></li>
<li><p>Reduces memory allocations by 30-40%</p></li>
<li><p>No performance degradation (validated by benchmarks)</p></li>
</ul>
<p><strong>Safety:</strong></p>
<ul class="simple">
<li><p>Guaranteed safe because:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x_curr</span></code> immediately overwritten before first use</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x_next</span></code> from dynamics is copied into <code class="docutils literal notranslate"><span class="pre">x_arr</span></code> before view reassignment</p></li>
</ul>
</li>
</ul>
</section>
<section id="complete-usage-example">
<h4>2.1.10 Complete Usage Example<a class="headerlink" href="#complete-usage-example" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_simulation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_controller</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.plant.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">LowRankDIPDynamics</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_config</span>

<span class="c1"># Load configuration</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="s1">&#39;config.yaml&#39;</span><span class="p">)</span>

<span class="c1"># Create controller</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span>
    <span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">gains</span><span class="o">=</span><span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Create dynamics model</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">LowRankDIPDynamics</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">plant</span><span class="p">)</span>

<span class="c1"># Run simulation</span>
<span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span>
    <span class="n">controller</span><span class="o">=</span><span class="n">controller</span><span class="p">,</span>
    <span class="n">dynamics_model</span><span class="o">=</span><span class="n">dynamics</span><span class="p">,</span>
    <span class="n">sim_time</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># Small perturbation</span>
    <span class="n">u_max</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>  <span class="c1"># Saturation limit</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>  <span class="c1"># Reproducibility</span>
<span class="p">)</span>

<span class="c1"># Analyze results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Simulation steps: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final state: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max control: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> N&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="simulationrunner-class">
<h3>2.2 <code class="docutils literal notranslate"><span class="pre">SimulationRunner</span></code> Class<a class="headerlink" href="#simulationrunner-class" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/engines/simulation_runner.py:333</span></code></p>
<p>Object-oriented wrapper around <code class="docutils literal notranslate"><span class="pre">run_simulation()</span></code> providing state tracking and compatibility with test cases.</p>
<section id="class-definition">
<h4>2.2.1 Class Definition<a class="headerlink" href="#class-definition" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">SimulationRunner</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Object-oriented wrapper around run_simulation function.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dynamics_model</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">max_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize simulation runner.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="initialization-parameters">
<h4>2.2.2 Initialization Parameters<a class="headerlink" href="#initialization-parameters" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dynamics_model</span></code></p></td>
<td><p>Any</p></td>
<td><p>required</p></td>
<td><p>Object with <code class="docutils literal notranslate"><span class="pre">step(state,</span> <span class="pre">u,</span> <span class="pre">dt)</span></code> method</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dt</span></code></p></td>
<td><p>float</p></td>
<td><p>0.01</p></td>
<td><p>Integration timestep (seconds)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">max_time</span></code></p></td>
<td><p>float</p></td>
<td><p>10.0</p></td>
<td><p>Maximum simulation time (seconds)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="attributes">
<h4>2.2.3 Attributes<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">dynamics_model</span><span class="p">:</span> <span class="n">Any</span>              <span class="c1"># Dynamics model instance</span>
<span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">:</span> <span class="nb">float</span>                        <span class="c1"># Integration timestep</span>
<span class="bp">self</span><span class="o">.</span><span class="n">max_time</span><span class="p">:</span> <span class="nb">float</span>                  <span class="c1"># Maximum simulation time</span>
<span class="bp">self</span><span class="o">.</span><span class="n">current_time</span><span class="p">:</span> <span class="nb">float</span>              <span class="c1"># Current simulation time (updated after run)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">step_count</span><span class="p">:</span> <span class="nb">int</span>                  <span class="c1"># Number of steps executed (updated after run)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">simulation_history</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>   <span class="c1"># History of all simulation runs</span>
</pre></div>
</div>
</section>
<section id="run-simulation-method">
<h4>2.2.4 <code class="docutils literal notranslate"><span class="pre">run_simulation()</span></code> Method<a class="headerlink" href="#run-simulation-method" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_simulation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">controller</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">reference</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run simulation using functional API.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p><strong>Returns:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>              <span class="c1"># Whether simulation completed without error</span>
    <span class="s1">&#39;states&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>         <span class="c1"># State trajectory (n_steps+1, state_dim)</span>
    <span class="s1">&#39;controls&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>       <span class="c1"># Control sequence (n_steps,)</span>
    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>           <span class="c1"># Time vector (n_steps+1,)</span>
    <span class="s1">&#39;final_state&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>    <span class="c1"># Final state (state_dim,)</span>
    <span class="s1">&#39;step_count&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>            <span class="c1"># Number of steps executed</span>
    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span>                  <span class="c1"># Error message (only if success=False)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="usage-example">
<h4>2.2.5 Usage Example<a class="headerlink" href="#usage-example" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimulationRunner</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.plant.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">LowRankDIPDynamics</span>

<span class="c1"># Create runner</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">LowRankDIPDynamics</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">plant</span><span class="p">)</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">SimulationRunner</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">max_time</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>

<span class="c1"># Run simulation</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">(</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
    <span class="n">controller</span><span class="o">=</span><span class="n">controller</span><span class="p">,</span>
    <span class="n">sim_time</span><span class="o">=</span><span class="mf">5.0</span>
<span class="p">)</span>

<span class="c1"># Check result</span>
<span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Simulation completed: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;step_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> steps&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final state: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;final_state&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Simulation failed: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Access history</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">run</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">runner</span><span class="o">.</span><span class="n">simulation_history</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Run </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">run</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> steps&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="legacy-compatibility-functions">
<h3>2.3 Legacy Compatibility Functions<a class="headerlink" href="#legacy-compatibility-functions" title="Link to this heading">¶</a></h3>
<section id="step-function">
<h4>2.3.1 <code class="docutils literal notranslate"><span class="pre">step()</span></code> Function<a class="headerlink" href="#step-function" title="Link to this heading">¶</a></h4>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/engines/simulation_runner.py:87</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Unified simulation step entry point.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Dispatches to appropriate dynamics implementation based on configuration.</p>
<p><strong>Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">step</span>

<span class="c1"># Single dynamics step</span>
<span class="n">x_next</span> <span class="o">=</span> <span class="n">step</span><span class="p">(</span><span class="n">x_current</span><span class="p">,</span> <span class="n">u_current</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="get-step-fn-function">
<h4>2.3.2 <code class="docutils literal notranslate"><span class="pre">get_step_fn()</span></code> Function<a class="headerlink" href="#get-step-fn-function" title="Link to this heading">¶</a></h4>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/engines/simulation_runner.py:75</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_step_fn</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return appropriate step function based on configuration.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Returns either <code class="docutils literal notranslate"><span class="pre">src.plant.models.dip_full.step</span></code> or <code class="docutils literal notranslate"><span class="pre">src.plant.models.dip_lowrank.step</span></code> based on <code class="docutils literal notranslate"><span class="pre">config.simulation.use_full_dynamics</span></code>.</p>
<p><strong>Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_step_fn</span>

<span class="c1"># Get configured step function</span>
<span class="n">step_fn</span> <span class="o">=</span> <span class="n">get_step_fn</span><span class="p">()</span>
<span class="n">x_next</span> <span class="o">=</span> <span class="n">step_fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="dynamics-model-api">
<h2>3. Dynamics Model API<a class="headerlink" href="#dynamics-model-api" title="Link to this heading">¶</a></h2>
<section id="dynamicsmodel-protocol">
<h3>3.1 <code class="docutils literal notranslate"><span class="pre">DynamicsModel</span></code> Protocol<a class="headerlink" href="#dynamicsmodel-protocol" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/plant/models/base/dynamics_interface.py:65</span></code></p>
<p>Protocol defining the interface all dynamics models must implement.</p>
<section id="protocol-definition">
<h4>3.1.1 Protocol Definition<a class="headerlink" href="#protocol-definition" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DynamicsModel</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Protocol for plant dynamics models.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compute_dynamics</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">control_input</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DynamicsResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute system dynamics at given state and input.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_physics_matrices</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get physics matrices M, C, G at current state.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate state vector format and bounds.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_state_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get dimension of state vector.&quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_control_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get dimension of control input vector.&quot;&quot;&quot;</span>
        <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="dynamicsresult-namedtuple">
<h4>3.1.2 <code class="docutils literal notranslate"><span class="pre">DynamicsResult</span></code> NamedTuple<a class="headerlink" href="#dynamicsresult-namedtuple" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">DynamicsResult</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Result of dynamics computation.&quot;&quot;&quot;</span>
    <span class="n">state_derivative</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>  <span class="c1"># dx/dt vector</span>
    <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span>                 <span class="c1"># Whether computation succeeded</span>
    <span class="n">info</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>         <span class="c1"># Additional diagnostic information</span>
</pre></div>
</div>
<p><strong>Factory Methods:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="c1"># Create successful result</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">DynamicsResult</span><span class="o">.</span><span class="n">success_result</span><span class="p">(</span>
    <span class="n">state_derivative</span><span class="o">=</span><span class="n">dx_dt</span><span class="p">,</span>
    <span class="n">time</span><span class="o">=</span><span class="n">t</span><span class="p">,</span>
    <span class="n">energy</span><span class="o">=</span><span class="n">total_energy</span>
<span class="p">)</span>

<span class="c1"># Create failure result</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">DynamicsResult</span><span class="o">.</span><span class="n">failure_result</span><span class="p">(</span>
    <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;Singular matrix detected&quot;</span><span class="p">,</span>
    <span class="n">condition_number</span><span class="o">=</span><span class="mf">1e15</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="basedynamicsmodel-abstract-class">
<h3>3.2 <code class="docutils literal notranslate"><span class="pre">BaseDynamicsModel</span></code> Abstract Class<a class="headerlink" href="#basedynamicsmodel-abstract-class" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/plant/models/base/dynamics_interface.py:130</span></code></p>
<p>Abstract base class providing common functionality for concrete dynamics implementations.</p>
<section id="id1">
<h4>3.2.1 Class Definition<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BaseDynamicsModel</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for dynamics models.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize dynamics model.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_validation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_monitoring</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="abstract-methods-must-implement">
<h4>3.2.2 Abstract Methods (Must Implement)<a class="headerlink" href="#abstract-methods-must-implement" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_dynamics</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">control_input</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DynamicsResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute system dynamics (must be implemented by subclasses).&quot;&quot;&quot;</span>
    <span class="k">pass</span>

<span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_physics_matrices</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get physics matrices (must be implemented by subclasses).&quot;&quot;&quot;</span>
    <span class="k">pass</span>

<span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_setup_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Setup state validation (must be implemented by subclasses).&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</section>
<section id="provided-methods">
<h4>3.2.3 Provided Methods<a class="headerlink" href="#provided-methods" title="Link to this heading">¶</a></h4>
<p><strong>State Validation:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="k">def</span><span class="w"> </span><span class="nf">validate_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate state vector using configured validator.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_state_validator&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_validator</span><span class="o">.</span><span class="n">validate_state</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_basic_state_validation</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">sanitize_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sanitize state vector if validator supports it.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_state_validator&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_validator</span><span class="o">.</span><span class="n">sanitize_state</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">state</span>
</pre></div>
</div>
<p><strong>Dimension Accessors:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_state_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get state vector dimension (default: 6 for DIP).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">6</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_control_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get control input dimension (default: 1 for DIP).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">1</span>
</pre></div>
</div>
<p><strong>Monitoring:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="k">def</span><span class="w"> </span><span class="nf">reset_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset monitoring statistics.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_stability_monitor&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stability_monitor</span><span class="o">.</span><span class="n">reset_statistics</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_monitoring_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get monitoring statistics.&quot;&quot;&quot;</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_stability_monitor&#39;</span><span class="p">):</span>
        <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;numerical_stability&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stability_monitor</span><span class="o">.</span><span class="n">get_statistics</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">stats</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="lowrankdipdynamics-implementation">
<h3>3.3 <code class="docutils literal notranslate"><span class="pre">LowRankDIPDynamics</span></code> Implementation<a class="headerlink" href="#lowrankdipdynamics-implementation" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/plant/models/lowrank/dynamics.py:27</span></code></p>
<p>Simplified double-inverted pendulum dynamics optimized for computational efficiency.</p>
<section id="id2">
<h4>3.3.1 Class Definition<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">LowRankDIPDynamics</span><span class="p">(</span><span class="n">BaseDynamicsModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Low-rank Double Inverted Pendulum Dynamics Model.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">config</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">LowRankDIPConfig</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
        <span class="n">enable_monitoring</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">enable_validation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize low-rank DIP dynamics.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="features">
<h4>3.3.2 Features<a class="headerlink" href="#features" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>✅ <strong>Fast computation</strong> with reduced complexity</p></li>
<li><p>✅ <strong>Essential dynamics preservation</strong> (qualitatively similar to full model)</p></li>
<li><p>✅ <strong>Optional linearization</strong> for stability analysis</p></li>
<li><p>✅ <strong>Small-angle approximations</strong> for efficiency</p></li>
<li><p>✅ <strong>Educational clarity</strong> with simplified physics</p></li>
</ul>
</section>
<section id="configuration">
<h4>3.3.3 Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.plant.models.lowrank</span><span class="w"> </span><span class="kn">import</span> <span class="n">LowRankDIPConfig</span><span class="p">,</span> <span class="n">LowRankDIPDynamics</span>

<span class="c1"># Create default configuration</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">LowRankDIPConfig</span><span class="o">.</span><span class="n">create_default</span><span class="p">()</span>

<span class="c1"># Or load from dictionary</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">LowRankDIPConfig</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span>
    <span class="s1">&#39;cart_mass&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s1">&#39;pole1_mass&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;pole2_mass&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;pole1_length&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="s1">&#39;pole2_length&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="s1">&#39;gravity&#39;</span><span class="p">:</span> <span class="mf">9.81</span><span class="p">,</span>
    <span class="s1">&#39;damping_cart&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;damping_pole1&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
    <span class="s1">&#39;damping_pole2&#39;</span><span class="p">:</span> <span class="mf">0.001</span>
<span class="p">})</span>

<span class="c1"># Initialize dynamics</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">LowRankDIPDynamics</span><span class="p">(</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">enable_monitoring</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>   <span class="c1"># Track performance statistics</span>
    <span class="n">enable_validation</span><span class="o">=</span><span class="kc">True</span>    <span class="c1"># Enable state validation</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="physics-computation">
<h4>3.3.4 Physics Computation<a class="headerlink" href="#physics-computation" title="Link to this heading">¶</a></h4>
<p><strong>State Vector:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">θ</span><span class="err">₁</span><span class="p">,</span> <span class="n">θ</span><span class="err">₂</span><span class="p">,</span> <span class="n">ẋ</span><span class="p">,</span> <span class="n">θ̇</span><span class="err">₁</span><span class="p">,</span> <span class="n">θ̇</span><span class="err">₂</span><span class="p">]</span><span class="n">ᵀ</span>

<span class="n">where</span><span class="p">:</span>
  <span class="n">x</span>   <span class="o">-</span> <span class="n">cart</span> <span class="n">position</span>
  <span class="n">θ</span><span class="err">₁</span>  <span class="o">-</span> <span class="n">pole</span> <span class="mi">1</span> <span class="n">angle</span> <span class="p">(</span><span class="kn">from</span><span class="w"> </span><span class="nn">vertical</span><span class="p">)</span>
  <span class="n">θ</span><span class="err">₂</span>  <span class="o">-</span> <span class="n">pole</span> <span class="mi">2</span> <span class="n">angle</span> <span class="p">(</span><span class="kn">from</span><span class="w"> </span><span class="nn">vertical</span><span class="p">)</span>
  <span class="n">ẋ</span>   <span class="o">-</span> <span class="n">cart</span> <span class="n">velocity</span>
  <span class="n">θ̇</span><span class="err">₁</span>  <span class="o">-</span> <span class="n">pole</span> <span class="mi">1</span> <span class="n">angular</span> <span class="n">velocity</span>
  <span class="n">θ̇</span><span class="err">₂</span>  <span class="o">-</span> <span class="n">pole</span> <span class="mi">2</span> <span class="n">angular</span> <span class="n">velocity</span>
</pre></div>
</div>
<p><strong>Dynamics Equations (Low-Rank Approximation):</strong></p>
<p>The low-rank model simplifies the full nonlinear dynamics using small-angle approximations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sin</span><span class="p">(</span><span class="n">θᵢ</span><span class="p">)</span> <span class="err">≈</span> <span class="n">θᵢ</span>
<span class="n">cos</span><span class="p">(</span><span class="n">θᵢ</span><span class="p">)</span> <span class="err">≈</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This yields linearized equations of motion suitable for fast computation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">M</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">q̈</span> <span class="o">=</span> <span class="o">-</span><span class="n">C</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ẋ</span><span class="p">)</span> <span class="n">ẋ</span> <span class="o">-</span> <span class="n">G</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">Bu</span>

<span class="n">where</span><span class="p">:</span>
  <span class="n">M</span> <span class="o">=</span> <span class="n">Simplified</span> <span class="n">mass</span> <span class="n">matrix</span> <span class="p">(</span><span class="mi">3</span><span class="n">x3</span><span class="p">)</span>
  <span class="n">C</span> <span class="o">=</span> <span class="n">Simplified</span> <span class="n">Coriolis</span><span class="o">/</span><span class="n">damping</span> <span class="n">matrix</span>
  <span class="n">G</span> <span class="o">=</span> <span class="n">Simplified</span> <span class="n">gravity</span> <span class="n">vector</span>
  <span class="n">B</span> <span class="o">=</span> <span class="n">Input</span> <span class="n">matrix</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="n">ᵀ</span>
  <span class="n">u</span> <span class="o">=</span> <span class="n">Control</span> <span class="n">force</span>
</pre></div>
</div>
</section>
<section id="method-compute-dynamics">
<h4>3.3.5 Method: <code class="docutils literal notranslate"><span class="pre">compute_dynamics()</span></code><a class="headerlink" href="#method-compute-dynamics" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_dynamics</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">control_input</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DynamicsResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute low-rank DIP dynamics.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p><strong>Returns DynamicsResult with:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">state_derivative</span></code>: 6-dimensional dx/dt vector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">success</span></code>: True if computation succeeded</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">info</span></code>: Dictionary with diagnostics (energy, conditioning, etc.)</p></li>
</ul>
</section>
<section id="method-get-physics-matrices">
<h4>3.3.6 Method: <code class="docutils literal notranslate"><span class="pre">get_physics_matrices()</span></code><a class="headerlink" href="#method-get-physics-matrices" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_physics_matrices</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get simplified physics matrices M, C, G.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p><strong>Returns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code>: Mass/inertia matrix (3x3)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">C</span></code>: Coriolis/damping matrix (3x3)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code>: Gravity vector (3,)</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="lineardynamicsmodel-base-class">
<h3>3.4 <code class="docutils literal notranslate"><span class="pre">LinearDynamicsModel</span></code> Base Class<a class="headerlink" href="#lineardynamicsmodel-base-class" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/plant/models/base/dynamics_interface.py:252</span></code></p>
<p>Base class for linear system dynamics: <code class="docutils literal notranslate"><span class="pre">ẋ</span> <span class="pre">=</span> <span class="pre">Ax</span> <span class="pre">+</span> <span class="pre">Bu</span> <span class="pre">+</span> <span class="pre">f(t)</span></code></p>
<section id="id3">
<h4>3.4.1 Class Definition<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">LinearDynamicsModel</span><span class="p">(</span><span class="n">BaseDynamicsModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for linear dynamics models.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">B</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize linear dynamics model.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span>  <span class="c1"># System matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span>  <span class="c1"># Input matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_matrices</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="linear-dynamics-computation">
<h4>3.4.2 Linear Dynamics Computation<a class="headerlink" href="#linear-dynamics-computation" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_dynamics</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">control_input</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DynamicsResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute linear dynamics: ẋ = Ax + Bu&quot;&quot;&quot;</span>
    <span class="n">state_derivative</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">@</span> <span class="n">state</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">@</span> <span class="n">control_input</span>

    <span class="c1"># Optional time-varying disturbance</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_compute_time_varying_terms&#39;</span><span class="p">):</span>
        <span class="n">disturbance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_time_varying_terms</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
        <span class="n">state_derivative</span> <span class="o">+=</span> <span class="n">disturbance</span>

    <span class="k">return</span> <span class="n">DynamicsResult</span><span class="o">.</span><span class="n">success_result</span><span class="p">(</span><span class="n">state_derivative</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id4">
<h4>3.4.3 Usage Example<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.plant.models.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearDynamicsModel</span>

<span class="c1"># Define linearized DIP system</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">14.7</span><span class="p">,</span> <span class="mf">14.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.4</span><span class="p">,</span> <span class="mf">14.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">14.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">44.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">]</span>
<span class="p">])</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

<span class="c1"># Create linear dynamics</span>
<span class="n">linear_dynamics</span> <span class="o">=</span> <span class="n">LinearDynamicsModel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">plant</span><span class="p">)</span>

<span class="c1"># Use with simulation</span>
<span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span>
    <span class="n">controller</span><span class="o">=</span><span class="n">linear_controller</span><span class="p">,</span>
    <span class="n">dynamics_model</span><span class="o">=</span><span class="n">linear_dynamics</span><span class="p">,</span>
    <span class="n">sim_time</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="orchestrator-system-api">
<h2>4. Orchestrator System API<a class="headerlink" href="#orchestrator-system-api" title="Link to this heading">¶</a></h2>
<section id="orchestrator-base-interface">
<h3>4.1 <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> Base Interface<a class="headerlink" href="#orchestrator-base-interface" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/core/interfaces.py:85</span></code></p>
<p>Base interface defining execution strategy protocol.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Orchestrator</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base interface for simulation execution strategies.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">control_inputs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ResultContainer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute simulation with specified strategy.&quot;&quot;&quot;</span>
        <span class="k">pass</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="sequentialorchestrator">
<h3>4.2 <code class="docutils literal notranslate"><span class="pre">SequentialOrchestrator</span></code><a class="headerlink" href="#sequentialorchestrator" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/orchestrators/sequential.py:18</span></code></p>
<p>Single-threaded step-by-step execution for standard simulations.</p>
<section id="id5">
<h4>4.2.1 Class Definition<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SequentialOrchestrator</span><span class="p">(</span><span class="n">BaseOrchestrator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sequential simulation orchestrator for single-threaded execution.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">control_inputs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ResultContainer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute sequential simulation.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="id6">
<h4>4.2.2 Parameters<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Shape</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">initial_state</span></code></p></td>
<td><p>np.ndarray</p></td>
<td><p>(n,)</p></td>
<td><p>Initial state vector</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">control_inputs</span></code></p></td>
<td><p>np.ndarray</p></td>
<td><p>(horizon,) or (horizon, m)</p></td>
<td><p>Control sequence</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dt</span></code></p></td>
<td><p>float</p></td>
<td><p>scalar</p></td>
<td><p>Time step</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">horizon</span></code></p></td>
<td><p>int</p></td>
<td><p>scalar</p></td>
<td><p>Number of simulation steps</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></p></td>
<td><p>dict</p></td>
<td><p>-</p></td>
<td><p>Additional options</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Optional Kwargs:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">safety_guards</span></code> (bool): Enable safety checking (default: True)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop_fn</span></code> (Callable): Custom stop condition function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t0</span></code> (float): Initial time (default: 0.0)</p></li>
</ul>
</section>
<section id="id7">
<h4>4.2.3 Features<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>✅ <strong>Step-by-step execution</strong> with full state tracking</p></li>
<li><p>✅ <strong>Safety guard integration</strong> (NaN/Inf detection)</p></li>
<li><p>✅ <strong>Early termination</strong> on stop condition</p></li>
<li><p>✅ <strong>Trajectory truncation</strong> on failure</p></li>
<li><p>✅ <strong>Compatible with all integrators</strong></p></li>
</ul>
</section>
<section id="id8">
<h4>4.2.4 Usage Example<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.orchestrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">SequentialOrchestrator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.integrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">IntegratorFactory</span>

<span class="c1"># Create orchestrator</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">create_integrator</span><span class="p">(</span><span class="s1">&#39;rk4&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">orchestrator</span> <span class="o">=</span> <span class="n">SequentialOrchestrator</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>

<span class="c1"># Execute simulation</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">controls</span> <span class="o">=</span> <span class="n">controller_sequence</span>  <span class="c1"># (horizon,) array</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orchestrator</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
    <span class="n">control_inputs</span><span class="o">=</span><span class="n">controls</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">horizon</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">safety_guards</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Access results</span>
<span class="n">states</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_states</span><span class="p">()</span>   <span class="c1"># (horizon+1, 6)</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_times</span><span class="p">()</span>     <span class="c1"># (horizon+1,)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="batchorchestrator">
<h3>4.3 <code class="docutils literal notranslate"><span class="pre">BatchOrchestrator</span></code><a class="headerlink" href="#batchorchestrator" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/orchestrators/batch.py:18</span></code></p>
<p>Vectorized execution for multiple simultaneous simulations (PSO optimization, Monte Carlo).</p>
<section id="id9">
<h4>4.3.1 Class Definition<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="k">class</span><span class="w"> </span><span class="nc">BatchOrchestrator</span><span class="p">(</span><span class="n">BaseOrchestrator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch simulation orchestrator for vectorized execution.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">control_inputs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ResultContainer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute batch simulation.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="id10">
<h4>4.3.2 Parameters<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Shape</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">initial_state</span></code></p></td>
<td><p>np.ndarray</p></td>
<td><p>(n,) or (batch_size, n)</p></td>
<td><p>Initial states</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">control_inputs</span></code></p></td>
<td><p>np.ndarray</p></td>
<td><p>(horizon,) or (batch_size, horizon, m)</p></td>
<td><p>Control sequences</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dt</span></code></p></td>
<td><p>float</p></td>
<td><p>scalar</p></td>
<td><p>Time step</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">horizon</span></code></p></td>
<td><p>int</p></td>
<td><p>scalar</p></td>
<td><p>Number of simulation steps</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></p></td>
<td><p>dict</p></td>
<td><p>-</p></td>
<td><p>Additional options</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Batch Size Handling:</strong></p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">initial_state.shape</span> <span class="pre">==</span> <span class="pre">(n,)</span></code>: Single simulation (batch_size=1)</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">initial_state.shape</span> <span class="pre">==</span> <span class="pre">(B,</span> <span class="pre">n)</span></code>: Batch of B simulations</p></li>
</ul>
</section>
<section id="id11">
<h4>4.3.3 Features<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>✅ <strong>Vectorized execution</strong> for multiple trajectories</p></li>
<li><p>✅ <strong>Active mask management</strong> (track which sims are active)</p></li>
<li><p>✅ <strong>Per-trajectory safety guards</strong></p></li>
<li><p>✅ <strong>Independent truncation</strong> (failures don’t affect other trajectories)</p></li>
<li><p>✅ <strong>Batch result aggregation</strong> in BatchResultContainer</p></li>
</ul>
</section>
<section id="id12">
<h4>4.3.4 Performance Characteristics<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Batch Size</p></th>
<th class="head"><p>Speedup vs Sequential</p></th>
<th class="head"><p>Memory Overhead</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>10x</p></td>
<td><p>9.5x faster</p></td>
<td><p>10x memory</p></td>
</tr>
<tr class="row-odd"><td><p>100x</p></td>
<td><p>95x faster</p></td>
<td><p>100x memory</p></td>
</tr>
<tr class="row-even"><td><p>1000x</p></td>
<td><p>850x faster</p></td>
<td><p>1000x memory (may require RAM upgrade)</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Optimal Batch Sizes:</strong></p>
<ul class="simple">
<li><p>PSO optimization: 20-50 particles</p></li>
<li><p>Monte Carlo: 100-1000 trials</p></li>
<li><p>Parameter sweeps: 100-500 combinations</p></li>
</ul>
</section>
<section id="usage-example-pso-optimization">
<h4>4.3.5 Usage Example: PSO Optimization<a class="headerlink" href="#usage-example-pso-optimization" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.orchestrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">BatchOrchestrator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.optimization</span><span class="w"> </span><span class="kn">import</span> <span class="n">PSOTuner</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>

<span class="c1"># Create batch orchestrator</span>
<span class="n">orchestrator</span> <span class="o">=</span> <span class="n">BatchOrchestrator</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>

<span class="c1"># Define fitness function using batch execution</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fitness_function</span><span class="p">(</span><span class="n">gains</span><span class="p">):</span>
    <span class="c1"># Create controller with candidate gains</span>
    <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">gains</span><span class="o">=</span><span class="n">gains</span><span class="p">)</span>

    <span class="c1"># Batch initial conditions (10 perturbations)</span>
    <span class="n">batch_initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>

    <span class="c1"># Generate control inputs</span>
    <span class="n">controls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">))</span>  <span class="c1"># (batch_size, horizon)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span>
            <span class="n">controls</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">controller</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">batch_initial</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="c1"># Batch execution</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">orchestrator</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="n">initial_state</span><span class="o">=</span><span class="n">batch_initial</span><span class="p">,</span>
        <span class="n">control_inputs</span><span class="o">=</span><span class="n">controls</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
        <span class="n">horizon</span><span class="o">=</span><span class="mi">500</span>
    <span class="p">)</span>

    <span class="c1"># Compute fitness (aggregate over 10 trials)</span>
    <span class="n">all_states</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_states</span><span class="p">()</span>  <span class="c1"># (10, 501, 6)</span>
    <span class="n">settling_times</span> <span class="o">=</span> <span class="n">compute_settling_times</span><span class="p">(</span><span class="n">all_states</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">settling_times</span><span class="p">)</span>

<span class="c1"># Use with PSO</span>
<span class="n">tuner</span> <span class="o">=</span> <span class="n">PSOTuner</span><span class="p">(</span><span class="n">fitness_fn</span><span class="o">=</span><span class="n">fitness_function</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">)]</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">optimise</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="parallelorchestrator">
<h3>4.4 <code class="docutils literal notranslate"><span class="pre">ParallelOrchestrator</span></code><a class="headerlink" href="#parallelorchestrator" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/orchestrators/parallel.py</span></code></p>
<p>Multi-threaded execution for large-scale parameter studies.</p>
<section id="id13">
<h4>4.4.1 Features<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>✅ <strong>Thread pool management</strong> (configurable pool size)</p></li>
<li><p>✅ <strong>Result synchronization</strong> across threads</p></li>
<li><p>✅ <strong>Load balancing</strong> for uneven workloads</p></li>
<li><p>✅ <strong>Exception handling</strong> per thread</p></li>
</ul>
</section>
<section id="id14">
<h4>4.4.2 Usage Example<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.orchestrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">ParallelOrchestrator</span>

<span class="c1"># Create parallel orchestrator (4 worker threads)</span>
<span class="n">orchestrator</span> <span class="o">=</span> <span class="n">ParallelOrchestrator</span><span class="p">(</span>
    <span class="n">dynamics</span><span class="o">=</span><span class="n">dynamics</span><span class="p">,</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">integrator</span><span class="p">,</span>
    <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span>
<span class="p">)</span>

<span class="c1"># Execute parameter sweep</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="n">generate_parameter_combinations</span><span class="p">()</span>  <span class="c1"># (1000, n_params)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">orchestrator</span><span class="o">.</span><span class="n">execute_parameter_sweep</span><span class="p">(</span><span class="n">param_grid</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Note:</strong> ParallelOrchestrator currently has thread-safety issues (see <a class="reference external" href="http://CLAUDE.md">CLAUDE.md</a> Section 9). Use only for read-only dynamics models or single-threaded with batch execution.</p>
</section>
</section>
<hr class="docutils" />
<section id="realtimeorchestrator">
<h3>4.5 <code class="docutils literal notranslate"><span class="pre">RealTimeOrchestrator</span></code><a class="headerlink" href="#realtimeorchestrator" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/orchestrators/real_time.py</span></code></p>
<p>Real-time constraint enforcement for hardware-in-loop (HIL) applications.</p>
<section id="id15">
<h4>4.5.1 Features<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>✅ <strong>Real-time timing</strong> synchronized with wall clock</p></li>
<li><p>✅ <strong>Deadline monitoring</strong> with configurable tolerance</p></li>
<li><p>✅ <strong>Late execution detection</strong> and logging</p></li>
<li><p>✅ <strong>Compatible with HIL interfaces</strong></p></li>
</ul>
</section>
<section id="id16">
<h4>4.5.2 Usage Example<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.orchestrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">RealTimeOrchestrator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.interfaces.hil</span><span class="w"> </span><span class="kn">import</span> <span class="n">PlantServer</span>

<span class="c1"># Create real-time orchestrator</span>
<span class="n">orchestrator</span> <span class="o">=</span> <span class="n">RealTimeOrchestrator</span><span class="p">(</span>
    <span class="n">dynamics</span><span class="o">=</span><span class="n">hardware_interface</span><span class="p">,</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">integrator</span><span class="p">,</span>
    <span class="n">real_time_factor</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>  <span class="c1"># Real-time (use 0.5 for slow-motion, 2.0 for fast)</span>
    <span class="n">deadline_tolerance</span><span class="o">=</span><span class="mf">0.001</span>  <span class="c1"># 1ms tolerance</span>
<span class="p">)</span>

<span class="c1"># Execute HIL simulation</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orchestrator</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
    <span class="n">control_inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># Generated dynamically</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">horizon</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">controller</span><span class="o">=</span><span class="n">controller</span>
<span class="p">)</span>

<span class="c1"># Check timing statistics</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">orchestrator</span><span class="o">.</span><span class="n">get_timing_stats</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deadline misses: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;deadline_misses&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average execution time: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;mean_exec_time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">ms&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="integrator-system-api">
<h2>5. Integrator System API<a class="headerlink" href="#integrator-system-api" title="Link to this heading">¶</a></h2>
<section id="integratorfactory">
<h3>5.1 <code class="docutils literal notranslate"><span class="pre">IntegratorFactory</span></code><a class="headerlink" href="#integratorfactory" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/integrators/factory.py:22</span></code></p>
<p>Factory pattern for creating numerical integrator instances with validation and consistency checking.</p>
<section id="integrator-registry">
<h4>5.1.1 Integrator Registry<a class="headerlink" href="#integrator-registry" title="Link to this heading">¶</a></h4>
<p>The factory maintains a registry of 7 integrator types:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Class</p></th>
<th class="head"><p>Order</p></th>
<th class="head"><p>Adaptive</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'euler'</span></code></p></td>
<td><p>ForwardEuler</p></td>
<td><p>1st</p></td>
<td><p>No</p></td>
<td><p>Simple forward Euler</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'forward_euler'</span></code></p></td>
<td><p>ForwardEuler</p></td>
<td><p>1st</p></td>
<td><p>No</p></td>
<td><p>Alias for euler</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'backward_euler'</span></code></p></td>
<td><p>BackwardEuler</p></td>
<td><p>1st</p></td>
<td><p>No</p></td>
<td><p>Implicit backward Euler</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'rk2'</span></code></p></td>
<td><p>RungeKutta2</p></td>
<td><p>2nd</p></td>
<td><p>No</p></td>
<td><p>Midpoint method</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'rk4'</span></code></p></td>
<td><p>RungeKutta4</p></td>
<td><p>4th</p></td>
<td><p>No</p></td>
<td><p>Classic 4th-order RK</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'runge_kutta_4'</span></code></p></td>
<td><p>RungeKutta4</p></td>
<td><p>4th</p></td>
<td><p>No</p></td>
<td><p>Alias for rk4</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'adaptive_rk'</span></code></p></td>
<td><p>AdaptiveRungeKutta</p></td>
<td><p>4th/5th</p></td>
<td><p>Yes</p></td>
<td><p>Variable step size</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'dormand_prince'</span></code></p></td>
<td><p>DormandPrince45</p></td>
<td><p>4th/5th</p></td>
<td><p>Yes</p></td>
<td><p>DP45 adaptive method</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'dp45'</span></code></p></td>
<td><p>DormandPrince45</p></td>
<td><p>4th/5th</p></td>
<td><p>Yes</p></td>
<td><p>Alias for dormand_prince</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">'zoh'</span></code></p></td>
<td><p>ZeroOrderHold</p></td>
<td><p>1st</p></td>
<td><p>No</p></td>
<td><p>Discrete-time control</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">'zero_order_hold'</span></code></p></td>
<td><p>ZeroOrderHold</p></td>
<td><p>1st</p></td>
<td><p>No</p></td>
<td><p>Alias for zoh</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="create-integrator-method">
<h4>5.1.2 <code class="docutils literal notranslate"><span class="pre">create_integrator()</span></code> Method<a class="headerlink" href="#create-integrator-method" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_integrator</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">integrator_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseIntegrator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create integrator instance of specified type.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">integrator_type</span></code> (str): Type identifier (case-insensitive, dash/space normalized)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dt</span></code> (float): Default integration timestep (stored as <code class="docutils literal notranslate"><span class="pre">integrator.default_dt</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>: Integrator-specific parameters</p></li>
</ul>
<p><strong>Returns:</strong> Configured BaseIntegrator instance</p>
<p><strong>Raises:</strong> ValueError if integrator_type not recognized</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.integrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">IntegratorFactory</span>

<span class="c1"># Create RK4 integrator</span>
<span class="n">rk4</span> <span class="o">=</span> <span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">create_integrator</span><span class="p">(</span><span class="s1">&#39;rk4&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># Create adaptive integrator with error tolerances</span>
<span class="n">dp45</span> <span class="o">=</span> <span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">create_integrator</span><span class="p">(</span>
    <span class="s1">&#39;dormand_prince&#39;</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
    <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span>
<span class="p">)</span>

<span class="c1"># Use with orchestrator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.orchestrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">SequentialOrchestrator</span>
<span class="n">orchestrator</span> <span class="o">=</span> <span class="n">SequentialOrchestrator</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span> <span class="n">rk4</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="utility-methods">
<h4>5.1.3 Utility Methods<a class="headerlink" href="#utility-methods" title="Link to this heading">¶</a></h4>
<p><strong>list_available_integrators()</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">list_available_integrators</span><span class="p">()</span>
<span class="c1"># Returns: [&#39;euler&#39;, &#39;forward_euler&#39;, &#39;backward_euler&#39;, &#39;rk2&#39;, &#39;rk4&#39;, ...]</span>
</pre></div>
</div>
<p><strong>get_integrator_info()</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">info</span> <span class="o">=</span> <span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">get_integrator_info</span><span class="p">(</span><span class="s1">&#39;rk4&#39;</span><span class="p">)</span>
<span class="c1"># Returns:</span>
<span class="c1"># {</span>
<span class="c1">#     &#39;class_name&#39;: &#39;RungeKutta4&#39;,</span>
<span class="c1">#     &#39;module&#39;: &#39;src.simulation.integrators.fixed_step.runge_kutta&#39;,</span>
<span class="c1">#     &#39;order&#39;: 4,</span>
<span class="c1">#     &#39;adaptive&#39;: False,</span>
<span class="c1">#     &#39;description&#39;: &#39;Classic 4th-order Runge-Kutta method&#39;</span>
<span class="c1"># }</span>
</pre></div>
</div>
<p><strong>register_integrator()</strong> (Advanced)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.integrators.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseIntegrator</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyCustomIntegrator</span><span class="p">(</span><span class="n">BaseIntegrator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom integration method.&quot;&quot;&quot;</span>
    <span class="n">ORDER</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">ADAPTIVE</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># ... implement integrate() method ...</span>

<span class="c1"># Register custom integrator</span>
<span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">register_integrator</span><span class="p">(</span><span class="s1">&#39;my_custom&#39;</span><span class="p">,</span> <span class="n">MyCustomIntegrator</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="fixed-step-integrators">
<h3>5.2 Fixed-Step Integrators<a class="headerlink" href="#fixed-step-integrators" title="Link to this heading">¶</a></h3>
<section id="forwardeuler">
<h4>5.2.1 <code class="docutils literal notranslate"><span class="pre">ForwardEuler</span></code><a class="headerlink" href="#forwardeuler" title="Link to this heading">¶</a></h4>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/integrators/fixed_step/euler.py</span></code></p>
<p>First-order explicit Euler method: <code class="docutils literal notranslate"><span class="pre">x_{n+1}</span> <span class="pre">=</span> <span class="pre">x_n</span> <span class="pre">+</span> <span class="pre">dt</span> <span class="pre">*</span> <span class="pre">f(x_n,</span> <span class="pre">u_n,</span> <span class="pre">t_n)</span></code></p>
<p><strong>Properties:</strong></p>
<ul class="simple">
<li><p>Order: 1</p></li>
<li><p>Stability: Conditionally stable (small dt required)</p></li>
<li><p>Performance: Fastest (5x faster than RK4)</p></li>
<li><p>Accuracy: Low (O(dt²) global error)</p></li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul class="simple">
<li><p>Fast prototyping</p></li>
<li><p>Non-stiff systems with small dt</p></li>
<li><p>Real-time applications with tight timing constraints</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">euler</span> <span class="o">=</span> <span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">create_integrator</span><span class="p">(</span><span class="s1">&#39;euler&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>  <span class="c1"># Small dt for stability</span>
</pre></div>
</div>
</section>
<section id="rungekutta2">
<h4>5.2.2 <code class="docutils literal notranslate"><span class="pre">RungeKutta2</span></code><a class="headerlink" href="#rungekutta2" title="Link to this heading">¶</a></h4>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/integrators/fixed_step/runge_kutta.py</span></code></p>
<p>Second-order midpoint method (improved Euler).</p>
<p><strong>Properties:</strong></p>
<ul class="simple">
<li><p>Order: 2</p></li>
<li><p>Stability: Better than Euler</p></li>
<li><p>Performance: 2x slower than Euler</p></li>
<li><p>Accuracy: Moderate (O(dt³) global error)</p></li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul class="simple">
<li><p>Balance between speed and accuracy</p></li>
<li><p>Educational demonstrations</p></li>
</ul>
</section>
<section id="rungekutta4">
<h4>5.2.3 <code class="docutils literal notranslate"><span class="pre">RungeKutta4</span></code><a class="headerlink" href="#rungekutta4" title="Link to this heading">¶</a></h4>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/integrators/fixed_step/runge_kutta.py</span></code></p>
<p>Classic 4th-order Runge-Kutta method (RK4) - <strong>Recommended default</strong>.</p>
<p><strong>Properties:</strong></p>
<ul class="simple">
<li><p>Order: 4</p></li>
<li><p>Stability: Excellent for non-stiff systems</p></li>
<li><p>Performance: Baseline reference</p></li>
<li><p>Accuracy: High (O(dt⁵) global error)</p></li>
</ul>
<p><strong>Algorithm:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">k1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x_n</span><span class="p">,</span> <span class="n">u_n</span><span class="p">,</span> <span class="n">t_n</span><span class="p">)</span>
<span class="n">k2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x_n</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k1</span><span class="p">,</span> <span class="n">u_n</span><span class="p">,</span> <span class="n">t_n</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">k3</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x_n</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k2</span><span class="p">,</span> <span class="n">u_n</span><span class="p">,</span> <span class="n">t_n</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">k4</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x_n</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k3</span><span class="p">,</span> <span class="n">u_n</span><span class="p">,</span> <span class="n">t_n</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">x_</span><span class="p">{</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span> <span class="o">=</span> <span class="n">x_n</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mi">6</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Use Cases:</strong></p>
<ul class="simple">
<li><p>Standard choice for most simulations</p></li>
<li><p>Good accuracy with reasonable performance</p></li>
<li><p>DIP control system simulations (dt=0.01s typical)</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rk4</span> <span class="o">=</span> <span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">create_integrator</span><span class="p">(</span><span class="s1">&#39;rk4&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="adaptive-integrators">
<h3>5.3 Adaptive Integrators<a class="headerlink" href="#adaptive-integrators" title="Link to this heading">¶</a></h3>
<section id="dormandprince45">
<h4>5.3.1 <code class="docutils literal notranslate"><span class="pre">DormandPrince45</span></code><a class="headerlink" href="#dormandprince45" title="Link to this heading">¶</a></h4>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/integrators/adaptive/runge_kutta.py</span></code></p>
<p>Dormand-Prince 4th/5th order adaptive Runge-Kutta method (DP45) - <strong>Recommended for high-accuracy requirements</strong>.</p>
<p><strong>Properties:</strong></p>
<ul class="simple">
<li><p>Order: 4th-order accurate, 5th-order error estimate</p></li>
<li><p>Adaptive: Yes (automatic step size adjustment)</p></li>
<li><p>Performance: 2-5x slower than RK4 (depending on error tolerance)</p></li>
<li><p>Accuracy: Excellent (user-controlled via tolerances)</p></li>
</ul>
<p><strong>Configuration:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp45</span> <span class="o">=</span> <span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">create_integrator</span><span class="p">(</span>
    <span class="s1">&#39;dormand_prince&#39;</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>           <span class="c1"># Initial step size</span>
    <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>         <span class="c1"># Absolute error tolerance</span>
    <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>         <span class="c1"># Relative error tolerance</span>
    <span class="n">min_step</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>     <span class="c1"># Minimum allowed step size</span>
    <span class="n">max_step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>      <span class="c1"># Maximum allowed step size</span>
    <span class="n">safety_factor</span><span class="o">=</span><span class="mf">0.9</span>  <span class="c1"># Step size adjustment factor</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Error Control:</strong></p>
<ul class="simple">
<li><p>Computes error estimate: <code class="docutils literal notranslate"><span class="pre">err</span> <span class="pre">=</span> <span class="pre">||x_5</span> <span class="pre">-</span> <span class="pre">x_4||</span> <span class="pre">/</span> <span class="pre">(atol</span> <span class="pre">+</span> <span class="pre">rtol</span> <span class="pre">*</span> <span class="pre">||x||)</span></code></p></li>
<li><p>Accepts step if <code class="docutils literal notranslate"><span class="pre">err</span> <span class="pre">&lt;</span> <span class="pre">1.0</span></code></p></li>
<li><p>Adjusts next step: <code class="docutils literal notranslate"><span class="pre">dt_next</span> <span class="pre">=</span> <span class="pre">dt</span> <span class="pre">*</span> <span class="pre">safety_factor</span> <span class="pre">*</span> <span class="pre">err^(-1/5)</span></code></p></li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul class="simple">
<li><p>High-accuracy simulations</p></li>
<li><p>Stiff dynamics (with small initial dt)</p></li>
<li><p>Variable dynamics (rapidly changing time constants)</p></li>
<li><p>Scientific validation and benchmarking</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.integrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">IntegratorFactory</span>

<span class="c1"># High-accuracy integration</span>
<span class="n">dp45</span> <span class="o">=</span> <span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">create_integrator</span><span class="p">(</span>
    <span class="s1">&#39;dp45&#39;</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">atol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span>   <span class="c1"># Tight tolerance</span>
    <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span>
<span class="p">)</span>

<span class="c1"># Use with orchestrator</span>
<span class="n">orchestrator</span> <span class="o">=</span> <span class="n">SequentialOrchestrator</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span> <span class="n">dp45</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orchestrator</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
    <span class="n">control_inputs</span><span class="o">=</span><span class="n">controls</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>  <span class="c1"># Initial dt (will adapt)</span>
    <span class="n">horizon</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>

<span class="c1"># Check integration statistics</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">dp45</span><span class="o">.</span><span class="n">get_statistics</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accepted steps: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;accepted_steps&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rejected steps: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;rejected_steps&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average step size: </span><span class="si">{</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;mean_step_size&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="adaptiverungekutta">
<h4>5.3.2 <code class="docutils literal notranslate"><span class="pre">AdaptiveRungeKutta</span></code><a class="headerlink" href="#adaptiverungekutta" title="Link to this heading">¶</a></h4>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/integrators/adaptive/runge_kutta.py</span></code></p>
<p>Generic adaptive RK integrator with configurable Butcher tableau.</p>
<p><strong>Use Cases:</strong></p>
<ul class="simple">
<li><p>Research and experimentation with custom RK methods</p></li>
<li><p>Implementing specialized adaptive methods</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="discrete-integrators">
<h3>5.4 Discrete Integrators<a class="headerlink" href="#discrete-integrators" title="Link to this heading">¶</a></h3>
<section id="zeroorderhold">
<h4>5.4.1 <code class="docutils literal notranslate"><span class="pre">ZeroOrderHold</span></code><a class="headerlink" href="#zeroorderhold" title="Link to this heading">¶</a></h4>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/integrators/discrete/zero_order_hold.py</span></code></p>
<p>Zero-order hold (ZOH) for discrete-time control systems.</p>
<p><strong>Properties:</strong></p>
<ul class="simple">
<li><p>Order: 1 (equivalent to Euler with ZOH control)</p></li>
<li><p>Discrete: Control held constant over interval</p></li>
<li><p>Performance: Fast (similar to Euler)</p></li>
</ul>
<p><strong>Behavior:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u_held</span> <span class="o">=</span> <span class="n">u_n</span>  <span class="c1"># Control held constant</span>
<span class="n">x_</span><span class="p">{</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span> <span class="o">=</span> <span class="n">x_n</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x_n</span><span class="p">,</span> <span class="n">u_held</span><span class="p">,</span> <span class="n">t_n</span><span class="p">)</span>  <span class="c1"># Euler step with held control</span>
</pre></div>
</div>
<p><strong>Use Cases:</strong></p>
<ul class="simple">
<li><p>Discrete-time controller testing</p></li>
<li><p>Sampled-data systems</p></li>
<li><p>Hardware-in-loop with discrete actuators</p></li>
</ul>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">zoh</span> <span class="o">=</span> <span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">create_integrator</span><span class="p">(</span><span class="s1">&#39;zoh&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># Typical use with discrete controller</span>
<span class="n">orchestrator</span> <span class="o">=</span> <span class="n">SequentialOrchestrator</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span> <span class="n">zoh</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">orchestrator</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
    <span class="n">control_inputs</span><span class="o">=</span><span class="n">discrete_controls</span><span class="p">,</span>  <span class="c1"># Piecewise constant</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">horizon</span><span class="o">=</span><span class="mi">500</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="integrator-selection-guide">
<h3>5.5 Integrator Selection Guide<a class="headerlink" href="#integrator-selection-guide" title="Link to this heading">¶</a></h3>
<section id="decision-tree">
<h4>5.5.1 Decision Tree<a class="headerlink" href="#decision-tree" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Need</span> <span class="n">adaptive</span> <span class="n">step</span> <span class="n">size</span><span class="err">?</span>
<span class="err">├─</span> <span class="n">YES</span> <span class="err">→</span> <span class="n">DormandPrince45</span> <span class="p">(</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="err">│</span>         <span class="n">Use</span> <span class="k">for</span><span class="p">:</span> <span class="n">High</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">stiff</span> <span class="n">systems</span><span class="p">,</span> <span class="n">variable</span> <span class="n">dynamics</span>
<span class="err">│</span>
<span class="err">└─</span> <span class="n">NO</span> <span class="err">→</span> <span class="n">Need</span> <span class="n">high</span> <span class="n">accuracy</span><span class="err">?</span>
    <span class="err">├─</span> <span class="n">YES</span> <span class="err">→</span> <span class="n">RungeKutta4</span> <span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.001</span><span class="o">-</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="err">│</span>         <span class="n">Use</span> <span class="k">for</span><span class="p">:</span> <span class="n">Standard</span> <span class="n">simulations</span><span class="p">,</span> <span class="n">balance</span> <span class="n">speed</span><span class="o">/</span><span class="n">accuracy</span>
    <span class="err">│</span>
    <span class="err">└─</span> <span class="n">NO</span> <span class="err">→</span> <span class="n">Need</span> <span class="n">maximum</span> <span class="n">speed</span><span class="err">?</span>
        <span class="err">├─</span> <span class="n">YES</span> <span class="err">→</span> <span class="n">ForwardEuler</span> <span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.0001</span><span class="o">-</span><span class="mf">0.001</span><span class="p">)</span>
        <span class="err">│</span>         <span class="n">Use</span> <span class="k">for</span><span class="p">:</span> <span class="n">Fast</span> <span class="n">prototyping</span><span class="p">,</span> <span class="n">real</span><span class="o">-</span><span class="n">time</span> <span class="n">constraints</span>
        <span class="err">│</span>
        <span class="err">└─</span> <span class="n">Discrete</span> <span class="n">control</span><span class="err">?</span> <span class="err">→</span> <span class="n">ZeroOrderHold</span> <span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="n">sampling</span> <span class="n">period</span><span class="p">)</span>
                                <span class="n">Use</span> <span class="k">for</span><span class="p">:</span> <span class="n">Discrete</span><span class="o">-</span><span class="n">time</span><span class="p">,</span> <span class="n">HIL</span><span class="p">,</span> <span class="n">sampled</span><span class="o">-</span><span class="n">data</span>
</pre></div>
</div>
</section>
<section id="performance-comparison">
<h4>5.5.2 Performance Comparison<a class="headerlink" href="#performance-comparison" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Integrator</p></th>
<th class="head"><p>Relative Speed</p></th>
<th class="head"><p>Accuracy</p></th>
<th class="head"><p>Memory</p></th>
<th class="head"><p>Recommended dt</p></th>
<th class="head"><p>Use Case</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ForwardEuler</p></td>
<td><p>5.0x</p></td>
<td><p>★☆☆☆☆</p></td>
<td><p>1x</p></td>
<td><p>0.0001s</p></td>
<td><p>Fast prototyping</p></td>
</tr>
<tr class="row-odd"><td><p>RungeKutta2</p></td>
<td><p>2.5x</p></td>
<td><p>★★☆☆☆</p></td>
<td><p>1x</p></td>
<td><p>0.001s</p></td>
<td><p>Educational</p></td>
</tr>
<tr class="row-even"><td><p>RungeKutta4</p></td>
<td><p>1.0x (baseline)</p></td>
<td><p>★★★★☆</p></td>
<td><p>1x</p></td>
<td><p>0.01s</p></td>
<td><p><strong>Standard choice</strong></p></td>
</tr>
<tr class="row-odd"><td><p>DormandPrince45</p></td>
<td><p>0.2-0.5x</p></td>
<td><p>★★★★★</p></td>
<td><p>2x</p></td>
<td><p>Adaptive</p></td>
<td><p>High-accuracy</p></td>
</tr>
<tr class="row-even"><td><p>ZeroOrderHold</p></td>
<td><p>4.5x</p></td>
<td><p>★☆☆☆☆</p></td>
<td><p>1x</p></td>
<td><p>Variable</p></td>
<td><p>Discrete control</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Benchmark:</strong> 1000-step DIP simulation on Intel i7-9700K</p>
</section>
<section id="accuracy-vs-performance-trade-off">
<h4>5.5.3 Accuracy vs. Performance Trade-off<a class="headerlink" href="#accuracy-vs-performance-trade-off" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">High</span> <span class="n">Accuracy</span> <span class="p">(</span><span class="n">atol</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">)</span>
    <span class="err">↑</span>
    <span class="err">│</span>  <span class="n">DP45</span> <span class="p">(</span><span class="n">adaptive</span><span class="p">)</span>
    <span class="err">│</span>     <span class="err">★</span>
    <span class="err">│</span>
    <span class="err">│</span>         <span class="n">RK4</span> <span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
    <span class="err">│</span>            <span class="err">★</span>
    <span class="err">│</span>
    <span class="err">│</span>                  <span class="n">RK4</span> <span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="err">│</span>                     <span class="err">★</span>
    <span class="err">│</span>
    <span class="err">│</span>                            <span class="n">Euler</span> <span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>
    <span class="err">│</span>                               <span class="err">★</span>
    <span class="err">│</span>
<span class="n">Low</span> <span class="n">Accuracy</span>                               <span class="n">Euler</span> <span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="err">└───────────────────────────────────────────★───────────▶</span>
         <span class="n">Slow</span>                                           <span class="n">Fast</span>
                        <span class="n">Performance</span>
</pre></div>
</div>
</section>
<section id="recommendation-by-application">
<h4>5.5.4 Recommendation by Application<a class="headerlink" href="#recommendation-by-application" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Application</p></th>
<th class="head"><p>Recommended Integrator</p></th>
<th class="head"><p>Configuration</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Standard DIP simulation</strong></p></td>
<td><p>RungeKutta4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dt=0.01</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>PSO optimization</strong></p></td>
<td><p>RungeKutta4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dt=0.01</span></code> (speed matters)</p></td>
</tr>
<tr class="row-even"><td><p><strong>Scientific validation</strong></p></td>
<td><p>DormandPrince45</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">atol=1e-8,</span> <span class="pre">rtol=1e-6</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Real-time HIL</strong></p></td>
<td><p>ForwardEuler or ZOH</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dt=0.001</span></code> (timing critical)</p></td>
</tr>
<tr class="row-even"><td><p><strong>Parameter studies</strong></p></td>
<td><p>RungeKutta4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dt=0.01</span></code> (batch execution)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Educational demos</strong></p></td>
<td><p>RungeKutta2 or RK4</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dt=0.01</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="result-container-api">
<h2>6. Result Container API<a class="headerlink" href="#result-container-api" title="Link to this heading">¶</a></h2>
<section id="resultcontainer-base-interface">
<h3>6.1 <code class="docutils literal notranslate"><span class="pre">ResultContainer</span></code> Base Interface<a class="headerlink" href="#resultcontainer-base-interface" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/core/interfaces.py:174</span></code></p>
<p>Abstract base class defining result storage protocol.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ResultContainer</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base interface for simulation result containers.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">times</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">**</span><span class="n">metadata</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a simulation trajectory to results.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_states</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get state trajectories.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_times</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get time vectors.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">format_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Export results to specified format.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="standardresultcontainer">
<h3>6.2 <code class="docutils literal notranslate"><span class="pre">StandardResultContainer</span></code><a class="headerlink" href="#standardresultcontainer" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/results/containers.py:15</span></code></p>
<p>Container for single simulation results.</p>
<section id="id17">
<h4>6.2.1 Attributes<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>     <span class="c1"># State trajectory (n_steps+1, state_dim)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>      <span class="c1"># Time vector (n_steps+1,)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">controls</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>   <span class="c1"># Control sequence (n_steps,)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>         <span class="c1"># Additional data</span>
</pre></div>
</div>
</section>
<section id="methods">
<h4>6.2.2 Methods<a class="headerlink" href="#methods" title="Link to this heading">¶</a></h4>
<p><strong>add_trajectory()</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">times</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">**</span><span class="n">metadata</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add trajectory data to container.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Stores states, times, and optional controls/metadata.</p>
<p><strong>get_states()</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_states</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get state trajectories.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Returns: State array (n_steps+1, state_dim) or empty array if no data.</p>
<p><strong>get_times()</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_times</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get time vectors.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Returns: Time array (n_steps+1,) or empty array if no data.</p>
<p><strong>export()</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">export</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">format_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Export results to specified format.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Supported formats: <code class="docutils literal notranslate"><span class="pre">'csv'</span></code>, <code class="docutils literal notranslate"><span class="pre">'hdf5'</span></code></p>
</section>
<section id="id18">
<h4>6.2.3 Usage Example<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardResultContainer</span>

<span class="c1"># Create container</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">StandardResultContainer</span><span class="p">()</span>

<span class="c1"># Add simulation data</span>
<span class="n">result</span><span class="o">.</span><span class="n">add_trajectory</span><span class="p">(</span>
    <span class="n">states</span><span class="o">=</span><span class="n">x_arr</span><span class="p">,</span>
    <span class="n">times</span><span class="o">=</span><span class="n">t_arr</span><span class="p">,</span>
    <span class="n">controls</span><span class="o">=</span><span class="n">u_arr</span><span class="p">,</span>
    <span class="n">controller_type</span><span class="o">=</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="n">x0</span>
<span class="p">)</span>

<span class="c1"># Access data</span>
<span class="n">states</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_states</span><span class="p">()</span>  <span class="c1"># (n_steps+1, 6)</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_times</span><span class="p">()</span>    <span class="c1"># (n_steps+1,)</span>

<span class="c1"># Export</span>
<span class="n">result</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span> <span class="s1">&#39;results/simulation_001.csv&#39;</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;results/simulation_001.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="batchresultcontainer">
<h3>6.3 <code class="docutils literal notranslate"><span class="pre">BatchResultContainer</span></code><a class="headerlink" href="#batchresultcontainer" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/results/containers.py:59</span></code></p>
<p>Container for multiple simulation results (batch execution).</p>
<section id="id19">
<h4>6.3.1 Attributes<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">batch_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>  <span class="c1"># Indexed simulation data</span>
<span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>               <span class="c1"># Global metadata</span>
</pre></div>
</div>
<p><strong>Structure:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;states&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="p">(</span><span class="n">n_steps</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">state_dim</span><span class="p">),</span>
        <span class="s1">&#39;times&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="p">(</span><span class="n">n_steps</span><span class="o">+</span><span class="mi">1</span><span class="p">,),</span>
        <span class="s1">&#39;controls&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="p">(</span><span class="n">n_steps</span><span class="p">,),</span>
        <span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
    <span class="p">},</span>
    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="p">},</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id20">
<h4>6.3.2 Methods<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h4>
<p><strong>add_trajectory()</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">times</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">**</span><span class="n">metadata</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add trajectory data to batch container.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Automatically assigns <code class="docutils literal notranslate"><span class="pre">batch_index</span></code> if not provided in metadata.</p>
<p><strong>get_states()</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_states</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get state trajectories for specific batch or all batches.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Returns:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">batch_index</span></code> specified: (n_steps+1, state_dim)</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">batch_index=None</span></code>: (batch_size, n_steps+1, state_dim)</p></li>
</ul>
<p><strong>get_times()</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get time vectors for specific batch or all batches.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Returns:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">batch_index</span></code> specified: (n_steps+1,)</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">batch_index=None</span></code>: (n_steps+1,) (assumes all batches have same times)</p></li>
</ul>
</section>
<section id="id21">
<h4>6.3.3 Usage Example<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">BatchResultContainer</span>

<span class="c1"># Create batch container</span>
<span class="n">batch_result</span> <span class="o">=</span> <span class="n">BatchResultContainer</span><span class="p">()</span>

<span class="c1"># Add multiple trajectories</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">batch_result</span><span class="o">.</span><span class="n">add_trajectory</span><span class="p">(</span>
        <span class="n">states</span><span class="o">=</span><span class="n">x_arr_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="n">times</span><span class="o">=</span><span class="n">t_arr</span><span class="p">,</span>
        <span class="n">controls</span><span class="o">=</span><span class="n">u_arr_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="n">batch_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
        <span class="n">initial_condition</span><span class="o">=</span><span class="n">ic_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="p">)</span>

<span class="c1"># Access specific trajectory</span>
<span class="n">states_3</span> <span class="o">=</span> <span class="n">batch_result</span><span class="o">.</span><span class="n">get_states</span><span class="p">(</span><span class="n">batch_index</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># (n_steps+1, 6)</span>

<span class="c1"># Access all trajectories</span>
<span class="n">all_states</span> <span class="o">=</span> <span class="n">batch_result</span><span class="o">.</span><span class="n">get_states</span><span class="p">()</span>  <span class="c1"># (10, n_steps+1, 6)</span>

<span class="c1"># Compute aggregate statistics</span>
<span class="n">settling_times</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">states_i</span> <span class="o">=</span> <span class="n">batch_result</span><span class="o">.</span><span class="n">get_states</span><span class="p">(</span><span class="n">batch_index</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="n">settling_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compute_settling_time</span><span class="p">(</span><span class="n">states_i</span><span class="p">))</span>

<span class="n">mean_settling</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">settling_times</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="result-exporters">
<h3>6.4 Result Exporters<a class="headerlink" href="#result-exporters" title="Link to this heading">¶</a></h3>
<section id="csv-exporter">
<h4>6.4.1 CSV Exporter<a class="headerlink" href="#csv-exporter" title="Link to this heading">¶</a></h4>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/results/exporters.py</span></code></p>
<p>Exports results to CSV format (human-readable, spreadsheet-compatible).</p>
<p><strong>Format:</strong></p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>time,x,theta1,theta2,x_dot,theta1_dot,theta2_dot,control
0.00,0.000,0.100,0.100,0.000,0.000,0.000,
0.01,0.000,0.099,0.098,0.001,0.012,0.015,12.5
0.02,0.000,0.096,0.094,0.002,0.024,0.030,15.2
...
</pre></div>
</div>
<p><strong>Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span> <span class="s1">&#39;results/sim_001.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="hdf5-exporter">
<h4>6.4.2 HDF5 Exporter<a class="headerlink" href="#hdf5-exporter" title="Link to this heading">¶</a></h4>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/results/exporters.py</span></code></p>
<p>Exports results to HDF5 format (binary, efficient, hierarchical).</p>
<p><strong>Structure:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simulation_001</span><span class="o">.</span><span class="n">h5</span>
<span class="err">├──</span> <span class="o">/</span><span class="n">states</span> <span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="n">n_steps</span><span class="o">+</span><span class="mi">1</span> <span class="n">x</span> <span class="mi">6</span><span class="p">)</span>
<span class="err">├──</span> <span class="o">/</span><span class="n">times</span> <span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="n">n_steps</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="err">├──</span> <span class="o">/</span><span class="n">controls</span> <span class="p">(</span><span class="n">dataset</span><span class="p">:</span> <span class="n">n_steps</span><span class="p">)</span>
<span class="err">└──</span> <span class="o">/</span><span class="n">metadata</span> <span class="p">(</span><span class="n">attributes</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Usage:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;results/sim_001.h5&#39;</span><span class="p">)</span>

<span class="c1"># Load with h5py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">h5py</span>
<span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;results/sim_001.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">states</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;states&#39;</span><span class="p">][:]</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">][:]</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Advantages:</strong></p>
<ul class="simple">
<li><p>✅ Fast read/write (10-100x faster than CSV for large datasets)</p></li>
<li><p>✅ Compression support (50-90% size reduction)</p></li>
<li><p>✅ Hierarchical structure (organize multiple simulations)</p></li>
<li><p>✅ Metadata storage (preserve all simulation parameters)</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section id="safety-monitoring-api">
<h2>7. Safety &amp; Monitoring API<a class="headerlink" href="#safety-monitoring-api" title="Link to this heading">¶</a></h2>
<section id="safety-guards">
<h3>7.1 Safety Guards<a class="headerlink" href="#safety-guards" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/safety/guards.py</span></code></p>
<section id="apply-safety-guards">
<h4>7.1.1 <code class="docutils literal notranslate"><span class="pre">apply_safety_guards()</span></code><a class="headerlink" href="#apply-safety-guards" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply_safety_guards</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">step_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply safety constraints to simulation state.&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Performs three checks:</p>
<ol class="arabic simple">
<li><p><strong>NaN/Inf Detection</strong> - <code class="docutils literal notranslate"><span class="pre">_guard_no_nan(state)</span></code></p></li>
<li><p><strong>Energy Bounds</strong> - <code class="docutils literal notranslate"><span class="pre">_guard_energy(state,</span> <span class="pre">config)</span></code></p></li>
<li><p><strong>State Bounds</strong> - <code class="docutils literal notranslate"><span class="pre">_guard_bounds(state,</span> <span class="pre">config)</span></code></p></li>
</ol>
<p><strong>Raises:</strong> <code class="docutils literal notranslate"><span class="pre">SafetyViolationError</span></code> if any guard fails</p>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.safety</span><span class="w"> </span><span class="kn">import</span> <span class="n">apply_safety_guards</span><span class="p">,</span> <span class="n">SafetyViolationError</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">apply_safety_guards</span><span class="p">(</span><span class="n">x_current</span><span class="p">,</span> <span class="n">step_idx</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="k">except</span> <span class="n">SafetyViolationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Safety violation at step </span><span class="si">{</span><span class="n">step_idx</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Truncate simulation</span>
</pre></div>
</div>
</section>
<section id="individual-guards">
<h4>7.1.2 Individual Guards<a class="headerlink" href="#individual-guards" title="Link to this heading">¶</a></h4>
<p><strong>_guard_no_nan()</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_guard_no_nan</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check for NaN or Inf values.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">state</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="n">SafetyViolationError</span><span class="p">(</span><span class="s2">&quot;State contains NaN or Inf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>_guard_energy()</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_guard_energy</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check total energy within bounds.&quot;&quot;&quot;</span>
    <span class="n">E_kinetic</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="n">x_dot</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">theta1_dot</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">theta2_dot</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">E_potential</span> <span class="o">=</span> <span class="n">m</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="p">(</span><span class="n">L1</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span> <span class="o">+</span> <span class="n">L2</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">))</span>
    <span class="n">E_total</span> <span class="o">=</span> <span class="n">E_kinetic</span> <span class="o">+</span> <span class="n">E_potential</span>

    <span class="k">if</span> <span class="n">E_total</span> <span class="o">&gt;</span> <span class="n">config</span><span class="o">.</span><span class="n">safety</span><span class="o">.</span><span class="n">max_energy</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">SafetyViolationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Energy </span><span class="si">{</span><span class="n">E_total</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">J exceeds </span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">safety</span><span class="o">.</span><span class="n">max_energy</span><span class="si">}</span><span class="s2">J&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>_guard_bounds()</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_guard_bounds</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check state within configured bounds.&quot;&quot;&quot;</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">safety</span><span class="o">.</span><span class="n">state_bounds</span>  <span class="c1"># [x_min, x_max, theta_min, theta_max, ...]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">min_val</span> <span class="o">&lt;=</span> <span class="n">val</span> <span class="o">&lt;=</span> <span class="n">max_val</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SafetyViolationError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;State[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">] = </span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> outside bounds [</span><span class="si">{</span><span class="n">min_val</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">max_val</span><span class="si">}</span><span class="s2">]&quot;</span>
            <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id22">
<h4>7.1.3 Configuration<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h4>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># config.yaml</span>
<span class="nt">safety</span><span class="p">:</span>
<span class="w">  </span><span class="nt">max_energy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100.0</span><span class="w">  </span><span class="c1"># Joules</span>
<span class="w">  </span><span class="nt">state_bounds</span><span class="p">:</span>
<span class="w">    </span><span class="nt">x</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-2.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2.0</span><span class="p p-Indicator">]</span><span class="w">        </span><span class="c1"># Cart position (m)</span>
<span class="w">    </span><span class="nt">theta1</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1.57</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.57</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># Pole 1 angle (rad, ±π/2)</span>
<span class="w">    </span><span class="nt">theta2</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1.57</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.57</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># Pole 2 angle (rad, ±π/2)</span>
<span class="w">    </span><span class="nt">x_dot</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-10.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10.0</span><span class="p p-Indicator">]</span><span class="w">  </span><span class="c1"># Cart velocity (m/s)</span>
<span class="w">    </span><span class="nt">theta1_dot</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-20.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">20.0</span><span class="p p-Indicator">]</span><span class="w">  </span><span class="c1"># Pole 1 angular velocity (rad/s)</span>
<span class="w">    </span><span class="nt">theta2_dot</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-20.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">20.0</span><span class="p p-Indicator">]</span><span class="w">  </span><span class="c1"># Pole 2 angular velocity (rad/s)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="performance-monitoring">
<h3>7.2 Performance Monitoring<a class="headerlink" href="#performance-monitoring" title="Link to this heading">¶</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">src/simulation/safety/monitors.py</span></code></p>
<section id="performancemonitor">
<h4>7.2.1 <code class="docutils literal notranslate"><span class="pre">PerformanceMonitor</span></code><a class="headerlink" href="#performancemonitor" title="Link to this heading">¶</a></h4>
<p>Tracks execution time and throughput for orchestrators and integrators.</p>
<p><strong>Methods:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="n">monitor</span> <span class="o">=</span> <span class="n">PerformanceMonitor</span><span class="p">()</span>

<span class="n">monitor</span><span class="o">.</span><span class="n">start_timing</span><span class="p">(</span><span class="s1">&#39;simulation&#39;</span><span class="p">)</span>
<span class="c1"># ... run simulation ...</span>
<span class="n">elapsed</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">end_timing</span><span class="p">(</span><span class="s1">&#39;simulation&#39;</span><span class="p">)</span>

<span class="n">stats</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">get_statistics</span><span class="p">()</span>
<span class="c1"># Returns:</span>
<span class="c1"># {</span>
<span class="c1">#     &#39;simulation&#39;: {</span>
<span class="c1">#         &#39;count&#39;: 100,</span>
<span class="c1">#         &#39;total_time&#39;: 12.5,</span>
<span class="c1">#         &#39;mean_time&#39;: 0.125,</span>
<span class="c1">#         &#39;std_time&#39;: 0.015,</span>
<span class="c1">#         &#39;min_time&#39;: 0.110,</span>
<span class="c1">#         &#39;max_time&#39;: 0.180</span>
<span class="c1">#     }</span>
<span class="c1"># }</span>
</pre></div>
</div>
<p><strong>Usage in Orchestrator:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SequentialOrchestrator</span><span class="p">(</span><span class="n">BaseOrchestrator</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">start_timing</span><span class="p">(</span><span class="s1">&#39;orchestrator_execute&#39;</span><span class="p">)</span>
        <span class="c1"># ... simulation loop ...</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor</span><span class="o">.</span><span class="n">end_timing</span><span class="p">(</span><span class="s1">&#39;orchestrator_execute&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="complete-code-examples">
<h2>8. Complete Code Examples<a class="headerlink" href="#complete-code-examples" title="Link to this heading">¶</a></h2>
<section id="example-1-basic-simulation">
<h3>8.1 Example 1: Basic Simulation<a class="headerlink" href="#example-1-basic-simulation" title="Link to this heading">¶</a></h3>
<p><strong>Objective:</strong> Run a single simulation with classical SMC controller and plot results.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example 1: Basic DIP Simulation</span>
<span class="sd">Demonstrates standard workflow: load config → create controller → create dynamics → simulate → plot</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_config</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_controller</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.plant.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">LowRankDIPDynamics</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_simulation</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># STEP 1: Load Configuration</span>
<span class="c1"># ============================================================================</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="s1">&#39;config.yaml&#39;</span><span class="p">)</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># STEP 2: Create Controller</span>
<span class="c1"># ============================================================================</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span>
    <span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">gains</span><span class="o">=</span><span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>  <span class="c1"># [k1, k2, λ1, λ2, K, kd]</span>
<span class="p">)</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># STEP 3: Create Dynamics Model</span>
<span class="c1"># ============================================================================</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">LowRankDIPDynamics</span><span class="p">(</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">plant</span><span class="p">,</span>
    <span class="n">enable_monitoring</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">enable_validation</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># STEP 4: Run Simulation</span>
<span class="c1"># ============================================================================</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="mf">0.0</span><span class="p">,</span>   <span class="c1"># x: cart position</span>
    <span class="mf">0.1</span><span class="p">,</span>   <span class="c1"># theta1: pole 1 angle (small perturbation)</span>
    <span class="mf">0.1</span><span class="p">,</span>   <span class="c1"># theta2: pole 2 angle (small perturbation)</span>
    <span class="mf">0.0</span><span class="p">,</span>   <span class="c1"># x_dot: cart velocity</span>
    <span class="mf">0.0</span><span class="p">,</span>   <span class="c1"># theta1_dot: pole 1 angular velocity</span>
    <span class="mf">0.0</span>    <span class="c1"># theta2_dot: pole 2 angular velocity</span>
<span class="p">])</span>

<span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span>
    <span class="n">controller</span><span class="o">=</span><span class="n">controller</span><span class="p">,</span>
    <span class="n">dynamics_model</span><span class="o">=</span><span class="n">dynamics</span><span class="p">,</span>
    <span class="n">sim_time</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>      <span class="c1"># 5 seconds</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>           <span class="c1"># 10ms timestep</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
    <span class="n">u_max</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>       <span class="c1"># 100N force limit</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>            <span class="c1"># Reproducibility</span>
<span class="p">)</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># STEP 5: Analyze Results</span>
<span class="c1"># ============================================================================</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SIMULATION RESULTS&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Simulation steps: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final time: </span><span class="si">{</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final state: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Max control: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">N&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean |control|: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">N&quot;</span><span class="p">)</span>

<span class="c1"># Compute performance metrics</span>
<span class="n">settling_time_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">0.02</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">settling_time_idx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">settling_time</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">settling_time_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Settling time (2% threshold): </span><span class="si">{</span><span class="n">settling_time</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># STEP 6: Plot Results</span>
<span class="c1"># ============================================================================</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Cart position</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cart Position (m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Pole angles</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pole 1&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pole 2&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Angles (deg)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Velocities</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cart&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pole 1&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pole 2&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Velocities&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="c1"># Control input</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">u</span><span class="p">,</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Control Force (N)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Limit&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;results/basic_simulation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Plot saved to: results/basic_simulation.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="example-2-batch-simulation-for-pso">
<h3>8.2 Example 2: Batch Simulation for PSO<a class="headerlink" href="#example-2-batch-simulation-for-pso" title="Link to this heading">¶</a></h3>
<p><strong>Objective:</strong> Use batch orchestrator for PSO fitness evaluation with vectorized execution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example 2: Batch Simulation for PSO Optimization</span>
<span class="sd">Demonstrates vectorized batch execution for parameter optimization</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_config</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_controller</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.plant.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">LowRankDIPDynamics</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.orchestrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">BatchOrchestrator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.integrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">IntegratorFactory</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.optimization</span><span class="w"> </span><span class="kn">import</span> <span class="n">PSOTuner</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># STEP 1: Configuration and Setup</span>
<span class="c1"># ============================================================================</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="s1">&#39;config.yaml&#39;</span><span class="p">)</span>
<span class="n">dynamics</span> <span class="o">=</span> <span class="n">LowRankDIPDynamics</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">plant</span><span class="p">)</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">IntegratorFactory</span><span class="o">.</span><span class="n">create_integrator</span><span class="p">(</span><span class="s1">&#39;rk4&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># STEP 2: Define Controller Factory for PSO</span>
<span class="c1"># ============================================================================</span>
<span class="k">def</span><span class="w"> </span><span class="nf">controller_factory</span><span class="p">(</span><span class="n">gains</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create controller instance with candidate gains.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">create_controller</span><span class="p">(</span>
        <span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span>
        <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="n">gains</span><span class="o">=</span><span class="n">gains</span>  <span class="c1"># [k1, k2, λ1, λ2, K, kd]</span>
    <span class="p">)</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># STEP 3: Define Fitness Function with Batch Execution</span>
<span class="c1"># ============================================================================</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fitness_function</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate controller gains using batch simulation.</span>

<span class="sd">    Args:</span>
<span class="sd">        gains: Controller gains to evaluate</span>
<span class="sd">        n_trials: Number of Monte Carlo trials (different ICs)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Fitness value (lower is better)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create controller</span>
    <span class="n">controller</span> <span class="o">=</span> <span class="n">controller_factory</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span>

    <span class="c1"># Generate batch of initial conditions (small perturbations)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># Reproducibility</span>
    <span class="n">batch_initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_trials</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">batch_initial</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">n_trials</span><span class="p">)</span>  <span class="c1"># theta1</span>
    <span class="n">batch_initial</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">n_trials</span><span class="p">)</span>  <span class="c1"># theta2</span>

    <span class="c1"># Precompute control sequence for all trials</span>
    <span class="n">horizon</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="n">controls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_trials</span><span class="p">,</span> <span class="n">horizon</span><span class="p">))</span>

    <span class="c1"># Temporary: compute control for each initial condition</span>
    <span class="c1"># (In practice, use controller in orchestrator loop)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
        <span class="n">x_temp</span> <span class="o">=</span> <span class="n">batch_initial</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">horizon</span><span class="p">):</span>
            <span class="n">controls</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">controller</span><span class="p">(</span><span class="n">j</span> <span class="o">*</span> <span class="n">dt</span><span class="p">,</span> <span class="n">x_temp</span><span class="p">)</span>
            <span class="c1"># Simple Euler prediction for next control (approximation)</span>
            <span class="n">x_temp</span> <span class="o">=</span> <span class="n">x_temp</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                <span class="n">x_temp</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">x_temp</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">x_temp</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
            <span class="p">])</span>

    <span class="c1"># Execute batch simulation</span>
    <span class="n">orchestrator</span> <span class="o">=</span> <span class="n">BatchOrchestrator</span><span class="p">(</span><span class="n">dynamics</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">orchestrator</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="n">initial_state</span><span class="o">=</span><span class="n">batch_initial</span><span class="p">,</span>
        <span class="n">control_inputs</span><span class="o">=</span><span class="n">controls</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
        <span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">,</span>
        <span class="n">safety_guards</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># Compute fitness metrics</span>
    <span class="n">all_states</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_states</span><span class="p">()</span>  <span class="c1"># (n_trials, horizon+1, 6)</span>

    <span class="n">fitness_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
        <span class="n">states_i</span> <span class="o">=</span> <span class="n">all_states</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># (horizon+1, 6)</span>

        <span class="c1"># Metric 1: Settling time (2% threshold)</span>
        <span class="n">settled_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">states_i</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">0.02</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">settled_mask</span><span class="p">):</span>
            <span class="n">settling_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">settled_mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">settling_time</span> <span class="o">=</span> <span class="n">settling_idx</span> <span class="o">*</span> <span class="n">dt</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">settling_time</span> <span class="o">=</span> <span class="mf">5.0</span>  <span class="c1"># Penalty if never settled</span>

        <span class="c1"># Metric 2: Peak overshoot</span>
        <span class="n">peak_overshoot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">states_i</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]))</span>

        <span class="c1"># Metric 3: Integral squared error</span>
        <span class="n">ise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">states_i</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">dt</span>

        <span class="c1"># Combined fitness (weighted sum)</span>
        <span class="n">fitness_i</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">2.0</span> <span class="o">*</span> <span class="n">settling_time</span> <span class="o">+</span>        <span class="c1"># Weight settling time heavily</span>
            <span class="mf">5.0</span> <span class="o">*</span> <span class="n">peak_overshoot</span> <span class="o">+</span>        <span class="c1"># Penalize overshoot</span>
            <span class="mf">0.1</span> <span class="o">*</span> <span class="n">ise</span>                     <span class="c1"># Penalize tracking error</span>
        <span class="p">)</span>

        <span class="n">fitness_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fitness_i</span><span class="p">)</span>

    <span class="c1"># Return mean fitness over all trials</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">fitness_values</span><span class="p">)</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># STEP 4: Configure and Run PSO Optimization</span>
<span class="c1"># ============================================================================</span>
<span class="c1"># Define gain bounds for classical SMC</span>
<span class="c1"># [k1, k2, λ1, λ2, K, kd]</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span>   <span class="c1"># k1: position gain</span>
    <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">),</span>   <span class="c1"># k2: position damping</span>
    <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">),</span>   <span class="c1"># λ1: angle gain 1</span>
    <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">40.0</span><span class="p">),</span>   <span class="c1"># λ2: angle gain 2</span>
    <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">),</span> <span class="c1"># K: switching gain</span>
    <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span>    <span class="c1"># kd: derivative gain</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PSO OPTIMIZATION WITH BATCH SIMULATION&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>

<span class="c1"># Create PSO tuner</span>
<span class="n">tuner</span> <span class="o">=</span> <span class="n">PSOTuner</span><span class="p">(</span>
    <span class="n">fitness_fn</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">fitness_function</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
    <span class="n">swarm_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Run optimization</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">optimise</span><span class="p">()</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># STEP 5: Display Results</span>
<span class="c1"># ============================================================================</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OPTIMIZATION RESULTS&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best fitness: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;best_fitness&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best gains: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;best_gains&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Convergence iteration: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;convergence_iter&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># ============================================================================</span>
<span class="c1"># STEP 6: Validate Optimal Gains</span>
<span class="c1"># ============================================================================</span>
<span class="n">optimal_controller</span> <span class="o">=</span> <span class="n">controller_factory</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;best_gains&#39;</span><span class="p">])</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_simulation</span>

<span class="n">t_val</span><span class="p">,</span> <span class="n">x_val</span><span class="p">,</span> <span class="n">u_val</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span>
    <span class="n">controller</span><span class="o">=</span><span class="n">optimal_controller</span><span class="p">,</span>
    <span class="n">dynamics_model</span><span class="o">=</span><span class="n">dynamics</span><span class="p">,</span>
    <span class="n">sim_time</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
    <span class="n">u_max</span><span class="o">=</span><span class="mf">100.0</span>
<span class="p">)</span>

<span class="c1"># Plot validation</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_val</span><span class="p">,</span> <span class="n">x_val</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pole 1&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_val</span><span class="p">,</span> <span class="n">x_val</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pole 2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Angles (deg)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Optimal Controller Performance&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_val</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">u_val</span><span class="p">,</span> <span class="s1">&#39;m-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Control (N)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;results/pso_batch_simulation.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Validation plot saved to: results/pso_batch_simulation.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<hr class="docutils" />
<p>(Continuing with Examples 3-5, Sections 9-10, and completion report…)</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Research Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Oct 08, 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Simulation Engine API Reference</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#overview-architecture">1. Overview &amp; Architecture</a><ul>
<li><a class="reference internal" href="#introduction">1.1 Introduction</a></li>
<li><a class="reference internal" href="#system-architecture">1.2 System Architecture</a></li>
<li><a class="reference internal" href="#module-relationships">1.3 Module Relationships</a></li>
<li><a class="reference internal" href="#data-flow-diagram">1.4 Data Flow Diagram</a><ul>
<li><a class="reference internal" href="#simulation-loop-execution-flow">Simulation Loop Execution Flow</a></li>
<li><a class="reference internal" href="#batch-simulation-for-pso">Batch Simulation for PSO</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-design-patterns">1.5 Key Design Patterns</a><ul>
<li><a class="reference internal" href="#protocol-based-interfaces">1.5.1 Protocol-Based Interfaces</a></li>
<li><a class="reference internal" href="#factory-pattern">1.5.2 Factory Pattern</a></li>
<li><a class="reference internal" href="#strategy-pattern">1.5.3 Strategy Pattern</a></li>
</ul>
</li>
<li><a class="reference internal" href="#backward-compatibility">1.6 Backward Compatibility</a></li>
<li><a class="reference internal" href="#performance-characteristics">1.7 Performance Characteristics</a></li>
</ul>
</li>
<li><a class="reference internal" href="#core-simulation-engine-api">2. Core Simulation Engine API</a><ul>
<li><a class="reference internal" href="#run-simulation-function">2.1 <code class="docutils literal notranslate"><span class="pre">run_simulation()</span></code> Function</a><ul>
<li><a class="reference internal" href="#function-signature">2.1.1 Function Signature</a></li>
<li><a class="reference internal" href="#parameters">2.1.2 Parameters</a></li>
<li><a class="reference internal" href="#return-values">2.1.3 Return Values</a></li>
<li><a class="reference internal" href="#controller-interface-requirements">2.1.4 Controller Interface Requirements</a></li>
<li><a class="reference internal" href="#dynamics-model-interface-requirements">2.1.5 Dynamics Model Interface Requirements</a></li>
<li><a class="reference internal" href="#control-saturation-logic">2.1.6 Control Saturation Logic</a></li>
<li><a class="reference internal" href="#latency-monitoring-and-fallback">2.1.7 Latency Monitoring and Fallback</a></li>
<li><a class="reference internal" href="#early-termination-conditions">2.1.8 Early Termination Conditions</a></li>
<li><a class="reference internal" href="#memory-optimization">2.1.9 Memory Optimization</a></li>
<li><a class="reference internal" href="#complete-usage-example">2.1.10 Complete Usage Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simulationrunner-class">2.2 <code class="docutils literal notranslate"><span class="pre">SimulationRunner</span></code> Class</a><ul>
<li><a class="reference internal" href="#class-definition">2.2.1 Class Definition</a></li>
<li><a class="reference internal" href="#initialization-parameters">2.2.2 Initialization Parameters</a></li>
<li><a class="reference internal" href="#attributes">2.2.3 Attributes</a></li>
<li><a class="reference internal" href="#run-simulation-method">2.2.4 <code class="docutils literal notranslate"><span class="pre">run_simulation()</span></code> Method</a></li>
<li><a class="reference internal" href="#usage-example">2.2.5 Usage Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#legacy-compatibility-functions">2.3 Legacy Compatibility Functions</a><ul>
<li><a class="reference internal" href="#step-function">2.3.1 <code class="docutils literal notranslate"><span class="pre">step()</span></code> Function</a></li>
<li><a class="reference internal" href="#get-step-fn-function">2.3.2 <code class="docutils literal notranslate"><span class="pre">get_step_fn()</span></code> Function</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#dynamics-model-api">3. Dynamics Model API</a><ul>
<li><a class="reference internal" href="#dynamicsmodel-protocol">3.1 <code class="docutils literal notranslate"><span class="pre">DynamicsModel</span></code> Protocol</a><ul>
<li><a class="reference internal" href="#protocol-definition">3.1.1 Protocol Definition</a></li>
<li><a class="reference internal" href="#dynamicsresult-namedtuple">3.1.2 <code class="docutils literal notranslate"><span class="pre">DynamicsResult</span></code> NamedTuple</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basedynamicsmodel-abstract-class">3.2 <code class="docutils literal notranslate"><span class="pre">BaseDynamicsModel</span></code> Abstract Class</a><ul>
<li><a class="reference internal" href="#id1">3.2.1 Class Definition</a></li>
<li><a class="reference internal" href="#abstract-methods-must-implement">3.2.2 Abstract Methods (Must Implement)</a></li>
<li><a class="reference internal" href="#provided-methods">3.2.3 Provided Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lowrankdipdynamics-implementation">3.3 <code class="docutils literal notranslate"><span class="pre">LowRankDIPDynamics</span></code> Implementation</a><ul>
<li><a class="reference internal" href="#id2">3.3.1 Class Definition</a></li>
<li><a class="reference internal" href="#features">3.3.2 Features</a></li>
<li><a class="reference internal" href="#configuration">3.3.3 Configuration</a></li>
<li><a class="reference internal" href="#physics-computation">3.3.4 Physics Computation</a></li>
<li><a class="reference internal" href="#method-compute-dynamics">3.3.5 Method: <code class="docutils literal notranslate"><span class="pre">compute_dynamics()</span></code></a></li>
<li><a class="reference internal" href="#method-get-physics-matrices">3.3.6 Method: <code class="docutils literal notranslate"><span class="pre">get_physics_matrices()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#lineardynamicsmodel-base-class">3.4 <code class="docutils literal notranslate"><span class="pre">LinearDynamicsModel</span></code> Base Class</a><ul>
<li><a class="reference internal" href="#id3">3.4.1 Class Definition</a></li>
<li><a class="reference internal" href="#linear-dynamics-computation">3.4.2 Linear Dynamics Computation</a></li>
<li><a class="reference internal" href="#id4">3.4.3 Usage Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#orchestrator-system-api">4. Orchestrator System API</a><ul>
<li><a class="reference internal" href="#orchestrator-base-interface">4.1 <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> Base Interface</a></li>
<li><a class="reference internal" href="#sequentialorchestrator">4.2 <code class="docutils literal notranslate"><span class="pre">SequentialOrchestrator</span></code></a><ul>
<li><a class="reference internal" href="#id5">4.2.1 Class Definition</a></li>
<li><a class="reference internal" href="#id6">4.2.2 Parameters</a></li>
<li><a class="reference internal" href="#id7">4.2.3 Features</a></li>
<li><a class="reference internal" href="#id8">4.2.4 Usage Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#batchorchestrator">4.3 <code class="docutils literal notranslate"><span class="pre">BatchOrchestrator</span></code></a><ul>
<li><a class="reference internal" href="#id9">4.3.1 Class Definition</a></li>
<li><a class="reference internal" href="#id10">4.3.2 Parameters</a></li>
<li><a class="reference internal" href="#id11">4.3.3 Features</a></li>
<li><a class="reference internal" href="#id12">4.3.4 Performance Characteristics</a></li>
<li><a class="reference internal" href="#usage-example-pso-optimization">4.3.5 Usage Example: PSO Optimization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parallelorchestrator">4.4 <code class="docutils literal notranslate"><span class="pre">ParallelOrchestrator</span></code></a><ul>
<li><a class="reference internal" href="#id13">4.4.1 Features</a></li>
<li><a class="reference internal" href="#id14">4.4.2 Usage Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#realtimeorchestrator">4.5 <code class="docutils literal notranslate"><span class="pre">RealTimeOrchestrator</span></code></a><ul>
<li><a class="reference internal" href="#id15">4.5.1 Features</a></li>
<li><a class="reference internal" href="#id16">4.5.2 Usage Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#integrator-system-api">5. Integrator System API</a><ul>
<li><a class="reference internal" href="#integratorfactory">5.1 <code class="docutils literal notranslate"><span class="pre">IntegratorFactory</span></code></a><ul>
<li><a class="reference internal" href="#integrator-registry">5.1.1 Integrator Registry</a></li>
<li><a class="reference internal" href="#create-integrator-method">5.1.2 <code class="docutils literal notranslate"><span class="pre">create_integrator()</span></code> Method</a></li>
<li><a class="reference internal" href="#utility-methods">5.1.3 Utility Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fixed-step-integrators">5.2 Fixed-Step Integrators</a><ul>
<li><a class="reference internal" href="#forwardeuler">5.2.1 <code class="docutils literal notranslate"><span class="pre">ForwardEuler</span></code></a></li>
<li><a class="reference internal" href="#rungekutta2">5.2.2 <code class="docutils literal notranslate"><span class="pre">RungeKutta2</span></code></a></li>
<li><a class="reference internal" href="#rungekutta4">5.2.3 <code class="docutils literal notranslate"><span class="pre">RungeKutta4</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#adaptive-integrators">5.3 Adaptive Integrators</a><ul>
<li><a class="reference internal" href="#dormandprince45">5.3.1 <code class="docutils literal notranslate"><span class="pre">DormandPrince45</span></code></a></li>
<li><a class="reference internal" href="#adaptiverungekutta">5.3.2 <code class="docutils literal notranslate"><span class="pre">AdaptiveRungeKutta</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#discrete-integrators">5.4 Discrete Integrators</a><ul>
<li><a class="reference internal" href="#zeroorderhold">5.4.1 <code class="docutils literal notranslate"><span class="pre">ZeroOrderHold</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#integrator-selection-guide">5.5 Integrator Selection Guide</a><ul>
<li><a class="reference internal" href="#decision-tree">5.5.1 Decision Tree</a></li>
<li><a class="reference internal" href="#performance-comparison">5.5.2 Performance Comparison</a></li>
<li><a class="reference internal" href="#accuracy-vs-performance-trade-off">5.5.3 Accuracy vs. Performance Trade-off</a></li>
<li><a class="reference internal" href="#recommendation-by-application">5.5.4 Recommendation by Application</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#result-container-api">6. Result Container API</a><ul>
<li><a class="reference internal" href="#resultcontainer-base-interface">6.1 <code class="docutils literal notranslate"><span class="pre">ResultContainer</span></code> Base Interface</a></li>
<li><a class="reference internal" href="#standardresultcontainer">6.2 <code class="docutils literal notranslate"><span class="pre">StandardResultContainer</span></code></a><ul>
<li><a class="reference internal" href="#id17">6.2.1 Attributes</a></li>
<li><a class="reference internal" href="#methods">6.2.2 Methods</a></li>
<li><a class="reference internal" href="#id18">6.2.3 Usage Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#batchresultcontainer">6.3 <code class="docutils literal notranslate"><span class="pre">BatchResultContainer</span></code></a><ul>
<li><a class="reference internal" href="#id19">6.3.1 Attributes</a></li>
<li><a class="reference internal" href="#id20">6.3.2 Methods</a></li>
<li><a class="reference internal" href="#id21">6.3.3 Usage Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#result-exporters">6.4 Result Exporters</a><ul>
<li><a class="reference internal" href="#csv-exporter">6.4.1 CSV Exporter</a></li>
<li><a class="reference internal" href="#hdf5-exporter">6.4.2 HDF5 Exporter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#safety-monitoring-api">7. Safety &amp; Monitoring API</a><ul>
<li><a class="reference internal" href="#safety-guards">7.1 Safety Guards</a><ul>
<li><a class="reference internal" href="#apply-safety-guards">7.1.1 <code class="docutils literal notranslate"><span class="pre">apply_safety_guards()</span></code></a></li>
<li><a class="reference internal" href="#individual-guards">7.1.2 Individual Guards</a></li>
<li><a class="reference internal" href="#id22">7.1.3 Configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#performance-monitoring">7.2 Performance Monitoring</a><ul>
<li><a class="reference internal" href="#performancemonitor">7.2.1 <code class="docutils literal notranslate"><span class="pre">PerformanceMonitor</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#complete-code-examples">8. Complete Code Examples</a><ul>
<li><a class="reference internal" href="#example-1-basic-simulation">8.1 Example 1: Basic Simulation</a></li>
<li><a class="reference internal" href="#example-2-batch-simulation-for-pso">8.2 Example 2: Batch Simulation for PSO</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=4ebf8126"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=08e7b316"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/back-to-top.js?v=840797bb"></script>
    <script src="../_static/lazy-load.js?v=dc25293c"></script>
    <script src="../_static/dark-mode.js?v=bf328970"></script>
    </body>
</html>