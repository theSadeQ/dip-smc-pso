<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
.chartjs-container {
    margin: 1.5em auto;
    padding: 1em;
    background: #f8f9fa;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.chart-note {
    text-align: center;
    color: #6c757d;
    font-size: 0.9em;
    margin-top: 0.5em;
}
</style>
<link rel="index" title="Index" href="genindex.html"><link rel="search" title="Search" href="search.html">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>Architecture Overview ### System Architecture The factory integration system follows enterprise-grade design patterns with clear separation of concerns: ``` - DIP_SMC_PSO Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5349f25f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=8a7e329d" />
    
    


<style>
  body {
    --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">DIP_SMC_PSO Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">DIP_SMC_PSO Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">üìö Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">Optimal Sliding Mode Control for a Double-Inverted Pendulum via PSO  ## How to validate a ResearchPlan JSON Run the validator locally: ```bash</a></li>
<li class="toctree-l1"><a class="reference internal" href="theory_overview.html">Theory Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">3. System Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="plant_model.html">1.x Plant Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="hil_quickstart.html">Hardware-in-the-Loop (HIL) Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="streamlit_dashboard_guide.html">Streamlit Dashboard User Guide</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/theSadeQ/DIP_SMC_PSO/blob/main/docs/factory_integration_documentation.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/theSadeQ/DIP_SMC_PSO/edit/main/docs/factory_integration_documentation.md" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <p>#==========================================================================================\<br />
#===================== docs/factory_integration_documentation.md =====================\<br />
#==========================================================================================\ # Factory Integration System Documentation ## Overview The Double-Inverted Pendulum (DIP) SMC-PSO project implements a factory integration system that provides robust, thread-safe controller instantiation with deep PSO optimization integration. This documentation covers the architecture, implementation patterns, and usage guidelines for the factory system that resolves GitHub issue #6. ## Table of Contents 1. <a class="reference internal" href="#architecture-overview"><span class="xref myst">Architecture Overview</span></a>
2. <a class="reference internal" href="#factory-pattern-implementation"><span class="xref myst">Factory Pattern Implementation</span></a>
3. <a class="reference internal" href="#pso-integration-patterns"><span class="xref myst">PSO Integration Patterns</span></a>
4. <a class="reference internal" href="#configuration-system-integration"><span class="xref myst">Configuration System Integration</span></a>
5. <a class="reference internal" href="#error-handling-and-robustness"><span class="xref myst">Error Handling and Robustness</span></a>
6. <a class="reference internal" href="#api-reference"><span class="xref myst">API Reference</span></a>
7. <a class="reference internal" href="#integration-points"><span class="xref myst">Integration Points</span></a>
8. <a class="reference internal" href="#troubleshooting-guide"><span class="xref myst">Troubleshooting Guide</span></a>
9. <a class="reference internal" href="#performance-considerations"><span class="xref myst">Performance Considerations</span></a>
10. <a class="reference internal" href="#testing-and-validation"><span class="xref myst">Testing and Validation</span></a></p>
<hr class="docutils" />
<section id="architecture-overview-system-architecture-the-factory-integration-system-follows-enterprise-grade-design-patterns-with-clear-separation-of-concerns">
<h1>Architecture Overview ### System Architecture The factory integration system follows enterprise-grade design patterns with clear separation of concerns: ```<a class="headerlink" href="#architecture-overview-system-architecture-the-factory-integration-system-follows-enterprise-grade-design-patterns-with-clear-separation-of-concerns" title="Link to this heading">¬∂</a></h1>
<p>Factory Integration System
‚îú‚îÄ‚îÄ Enterprise Controller Factory (src/controllers/factory.py)
‚îÇ ‚îú‚îÄ‚îÄ Thread-safe Operations (RLock with timeout)
‚îÇ ‚îú‚îÄ‚îÄ Type-safe Interfaces (Protocol-based design)
‚îÇ ‚îú‚îÄ‚îÄ Configuration Validation (Pydantic integration)
‚îÇ ‚îî‚îÄ‚îÄ PSO Optimization Integration (Native PSO support)
‚îú‚îÄ‚îÄ Controller Registry System
‚îÇ ‚îú‚îÄ‚îÄ Metadata Management (Gain specifications, requirements)
‚îÇ ‚îú‚îÄ‚îÄ Alias Resolution (Backward compatibility)
‚îÇ ‚îî‚îÄ‚îÄ Dynamic Registration (Extensible design)
‚îú‚îÄ‚îÄ Configuration Integration Layer
‚îÇ ‚îú‚îÄ‚îÄ Multi-source Configuration Resolution
‚îÇ ‚îú‚îÄ‚îÄ Deprecation Handling (Graceful migrations)
‚îÇ ‚îî‚îÄ‚îÄ Fallback Mechanisms (Graceful degradation)
‚îî‚îÄ‚îÄ PSO Integration Layer ‚îú‚îÄ‚îÄ Controller Wrapper System (PSO-compatible interfaces) ‚îú‚îÄ‚îÄ Gain Validation (Domain-specific validation) ‚îî‚îÄ‚îÄ Batch Creation (Performance optimization)</p>
<div class="highlight-### notranslate"><div class="highlight"><pre><span></span>2. **Type Safety**: Protocol-based interfaces with 95%+ type hint coverage
3. **PSO Optimization**: Native integration with particle swarm optimization workflows
4. **Backward Compatibility**: Legacy factory functions preserved for existing code
5. **Configuration-Driven**: YAML-based configuration with validation
6. **Extensibility**: Registry pattern for easy addition of new controllers
7. **Robustness**: Graceful degradation and fallback mechanisms

---

## Factory Pattern Implementation ### Core Factory Interface The primary factory function provides a clean, type-safe interface for controller creation: ```python
# example-metadata:
# runnable: false def create_controller( controller_type: str, config: Optional[Any] = None, gains: Optional[Union[list, np.ndarray]] = None
) -&gt; Any: &quot;&quot;&quot; Create a controller instance of the specified type. Thread-safe operation with validation. Args: controller_type: Type of controller (&#39;classical_smc&#39;, &#39;sta_smc&#39;, etc.) config: Configuration object (optional) gains: Controller gains array (optional) Returns: Configured controller instance Raises: ValueError: If controller_type is not recognized ImportError: If required dependencies are missing &quot;&quot;&quot;
``` ### Controller Registry System The registry provides metadata for each supported controller: ```python
# example-metadata:

# runnable: false CONTROLLER_REGISTRY = { &#39;classical_smc&#39;: { &#39;class&#39;: ModularClassicalSMC, &#39;config_class&#39;: ClassicalSMCConfig, &#39;default_gains&#39;: [20.0, 15.0, 12.0, 8.0, 35.0, 5.0], &#39;gain_count&#39;: 6, &#39;description&#39;: &#39;Classical sliding mode controller with boundary layer&#39;, &#39;supports_dynamics&#39;: True, &#39;required_params&#39;: [&#39;gains&#39;, &#39;max_force&#39;, &#39;boundary_layer&#39;] }, # ... additional controllers

}
``` ### Thread Safety Implementation Thread-safe operations using recursive locks with timeout protection: ```python
# Thread-safe factory operations
_factory_lock = threading.RLock()
_LOCK_TIMEOUT = 10.0 # seconds def create_controller(controller_type: str, config: Optional[Any] = None, gains: Optional[Union[list, np.ndarray]] = None) -&gt; Any: &quot;&quot;&quot;Thread-safe controller creation.&quot;&quot;&quot; with _factory_lock: # Controller creation logic protected by lock return _create_controller_impl(controller_type, config, gains)
``` ### Type System Integration Protocol-based design ensures type safety across the system: ```python
# example-metadata:

# runnable: false class ControllerProtocol(Protocol): &quot;&quot;&quot;Protocol defining the standard controller interface.&quot;&quot;&quot; def compute_control( self, state: StateVector, last_control: float, history: ConfigDict ) -&gt; ControlOutput: &quot;&quot;&quot;Compute control output for given state.&quot;&quot;&quot; ... def reset(self) -&gt; None: &quot;&quot;&quot;Reset controller internal state.&quot;&quot;&quot; ... @property def gains(self) -&gt; List[float]: &quot;&quot;&quot;Return controller gains.&quot;&quot;&quot; ...

</pre></div>
</div>
<hr class="docutils" />
</section>
<section id="pso-integration-patterns-native-pso-support-the-factory-system-provides-native-pso-integration-through-specialized-wrapper-classes-python">
<h1>PSO Integration Patterns ### Native PSO Support The factory system provides native PSO integration through specialized wrapper classes: ```python<a class="headerlink" href="#pso-integration-patterns-native-pso-support-the-factory-system-provides-native-pso-integration-through-specialized-wrapper-classes-python" title="Link to this heading">¬∂</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="example-metadata">
<h1>example-metadata:<a class="headerlink" href="#example-metadata" title="Link to this heading">¬∂</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="runnable-false-class-psocontrollerwrapper-wrapper-for-smc-controllers-to-provide-pso-compatible-interface-def-init-self-controller-n-gains-int-controller-type-str-self-controller-controller-self-n-gains-n-gains-self-controller-type-controller-type-self-max-force-getattr-controller-max-force-150-0-def-validate-gains-self-particles-np-ndarray-np-ndarray-validate-gain-particles-for-pso-optimization-domain-specific-validation-logic-return-valid-mask-def-compute-control-self-state-np-ndarray-np-ndarray-pso-compatible-control-computation-interface-standardized-interface-for-pso-fitness-evaluation-return-control-output">
<h1>runnable: false class PSOControllerWrapper: ‚Äú‚Äù‚ÄùWrapper for SMC controllers to provide PSO-compatible interface.‚Äù‚Äù‚Äù def <strong>init</strong>(self, controller, n_gains: int, controller_type: str): self.controller = controller self.n_gains = n_gains self.controller_type = controller_type self.max_force = getattr(controller, ‚Äòmax_force‚Äô, 150.0) def validate_gains(self, particles: np.ndarray) -&gt; np.ndarray: ‚Äú‚Äù‚ÄùValidate gain particles for PSO optimization.‚Äù‚Äù‚Äù # Domain-specific validation logic return valid_mask def compute_control(self, state: np.ndarray) -&gt; np.ndarray: ‚Äú‚Äù‚ÄùPSO-compatible control computation interface.‚Äù‚Äù‚Äù # Standardized interface for PSO fitness evaluation return control_output<a class="headerlink" href="#runnable-false-class-psocontrollerwrapper-wrapper-for-smc-controllers-to-provide-pso-compatible-interface-def-init-self-controller-n-gains-int-controller-type-str-self-controller-controller-self-n-gains-n-gains-self-controller-type-controller-type-self-max-force-getattr-controller-max-force-150-0-def-validate-gains-self-particles-np-ndarray-np-ndarray-validate-gain-particles-for-pso-optimization-domain-specific-validation-logic-return-valid-mask-def-compute-control-self-state-np-ndarray-np-ndarray-pso-compatible-control-computation-interface-standardized-interface-for-pso-fitness-evaluation-return-control-output" title="Link to this heading">¬∂</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">###</span> <span class="pre">PSO</span> <span class="pre">Factory</span> <span class="pre">Functions</span> <span class="pre">Specialized</span> <span class="pre">factory</span> <span class="pre">functions</span> <span class="pre">optimized</span> <span class="pre">for</span> <span class="pre">PSO</span> <span class="pre">workflows:</span></code>python</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>example-metadata:<a class="headerlink" href="#id1" title="Link to this heading">¬∂</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="runnable-false-def-create-smc-for-pso-smc-type-smctype-gains-union-list-np-ndarray-plant-config-or-model-optional-any-none-kwargs-any">
<h1>runnable: false def create_smc_for_pso( smc_type: SMCType, gains: Union[list, np.ndarray], plant_config_or_model: Optional[Any] = None, **kwargs: Any<a class="headerlink" href="#runnable-false-def-create-smc-for-pso-smc-type-smctype-gains-union-list-np-ndarray-plant-config-or-model-optional-any-none-kwargs-any" title="Link to this heading">¬∂</a></h1>
<p>) -&gt; Any: ‚Äú‚Äù‚ÄùCreate SMC controller optimized for PSO usage.‚Äù‚Äù‚Äù def create_pso_controller_factory( smc_type: SMCType, plant_config: Optional[Any] = None, **kwargs: Any
) -&gt; Callable: ‚Äú‚Äù‚ÄùCreate a PSO-optimized controller factory function.‚Äù‚Äù‚Äù
<code class="docutils literal notranslate"><span class="pre">###</span> <span class="pre">Gain</span> <span class="pre">Bounds</span> <span class="pre">and</span> <span class="pre">Validation</span> <span class="pre">PSO-specific</span> <span class="pre">gain</span> <span class="pre">bounds</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">control</span> <span class="pre">theory</span> <span class="pre">principles:</span></code>python</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id2">
<h1>example-metadata:<a class="headerlink" href="#id2" title="Link to this heading">¬∂</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="runnable-false-def-get-gain-bounds-for-pso-smc-type-smctype-tuple-list-float-list-float-get-pso-gain-bounds-for-a-controller-type-bounds-map-smctype-classical-lower-1-0-1-0-1-0-1-0-5-0-0-1-k1-k2-lam1-lam2-k-kd-upper-30-0-30-0-20-0-20-0-50-0-10-0-smctype-adaptive-lower-2-0-2-0-1-0-1-0-0-5-k1-k2-lam1-lam2-gamma-upper-40-0-40-0-25-0-25-0-10-0-additional-controller-types-return-bounds-map-smc-type-lower-bounds-map-smc-type-upper">
<h1>runnable: false def get_gain_bounds_for_pso(smc_type: SMCType) -&gt; Tuple[List[float], List[float]]: ‚Äú‚Äù‚ÄùGet PSO gain bounds for a controller type.‚Äù‚Äù‚Äù bounds_map = { SMCType.CLASSICAL: { ‚Äòlower‚Äô: [1.0, 1.0, 1.0, 1.0, 5.0, 0.1], # [k1, k2, lam1, lam2, K, kd] ‚Äòupper‚Äô: [30.0, 30.0, 20.0, 20.0, 50.0, 10.0] }, SMCType.ADAPTIVE: { ‚Äòlower‚Äô: [2.0, 2.0, 1.0, 1.0, 0.5], # [k1, k2, lam1, lam2, gamma] ‚Äòupper‚Äô: [40.0, 40.0, 25.0, 25.0, 10.0] }, # ‚Ä¶ additional controller types } return (bounds_map[smc_type][‚Äòlower‚Äô], bounds_map[smc_type][‚Äòupper‚Äô])<a class="headerlink" href="#runnable-false-def-get-gain-bounds-for-pso-smc-type-smctype-tuple-list-float-list-float-get-pso-gain-bounds-for-a-controller-type-bounds-map-smctype-classical-lower-1-0-1-0-1-0-1-0-5-0-0-1-k1-k2-lam1-lam2-k-kd-upper-30-0-30-0-20-0-20-0-50-0-10-0-smctype-adaptive-lower-2-0-2-0-1-0-1-0-0-5-k1-k2-lam1-lam2-gamma-upper-40-0-40-0-25-0-25-0-10-0-additional-controller-types-return-bounds-map-smc-type-lower-bounds-map-smc-type-upper" title="Link to this heading">¬∂</a></h1>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="o">---</span>

<span class="c1">## Configuration System Integration ### Multi-Source Configuration Resolution The factory system resolves configuration from multiple sources with priority: 1. **Explicit parameters** (highest priority)</span>

<span class="mf">2.</span> <span class="o">**</span><span class="n">Configuration</span> <span class="nb">object</span> <span class="n">attributes</span><span class="o">**</span>
<span class="mf">3.</span> <span class="o">**</span><span class="n">YAML</span> <span class="n">configuration</span> <span class="n">file</span><span class="o">**</span>
<span class="mf">4.</span> <span class="o">**</span><span class="n">Registry</span> <span class="n">defaults</span><span class="o">**</span> <span class="p">(</span><span class="n">lowest</span> <span class="n">priority</span><span class="p">)</span> <span class="err">```</span><span class="n">python</span>
<span class="c1"># example-metadata:</span>

<span class="c1"># runnable: false def _resolve_controller_gains( gains: Optional[Union[List[float], np.ndarray]], config: Optional[Any], controller_type: str, controller_info: Dict[str, Any]</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span> <span class="s2">&quot;&quot;&quot;Resolve controller gains from multiple sources.&quot;&quot;&quot;</span> <span class="c1"># Priority 1: Explicit gains if gains is not None: return gains.tolist() if isinstance(gains, np.ndarray) else gains # Priority 2: Configuration object if config is not None: extracted_gains = _extract_gains_from_config(config, controller_type) if extracted_gains is not None: return extracted_gains # Priority 3: Registry defaults return controller_info[&#39;default_gains&#39;]</span>
<span class="err">```</span> <span class="c1">### Configuration Validation Type-safe configuration validation using Pydantic models: ```python</span>
<span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false @dataclass(frozen=True)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ClassicalSMCConfig</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;Type-safe configuration for Classical SMC controller.&quot;&quot;&quot;</span> <span class="n">gains</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">()</span> <span class="c1"># [k1, k2, lam1, lam2, K, kd] max_force: float = field() # Control saturation limit boundary_layer: float = field() # Chattering reduction thickness dt: float = field(default=0.01) # Control timestep switch_method: Literal[&quot;tanh&quot;, &quot;linear&quot;, &quot;sign&quot;] = field(default=&quot;tanh&quot;) def __post_init__(self): &quot;&quot;&quot;Validate configuration after creation.&quot;&quot;&quot; self._validate_gains() self._validate_control_parameters() self._validate_stability_requirements()</span>
<span class="err">```</span> <span class="c1">### Deprecation Handling Graceful handling of deprecated configuration parameters: ```python</span>
<span class="c1"># example-metadata:</span>

<span class="c1"># runnable: false def check_deprecated_config(controller_type: str, params: Dict[str, Any]) -&gt; Dict[str, Any]: &quot;&quot;&quot;Check for deprecated parameters and apply migrations.&quot;&quot;&quot; # Handle deprecated parameter names deprecated_mappings = { &#39;use_equivalent&#39;: &#39;enable_equivalent_control&#39;, &#39;k_gain&#39;: &#39;switching_gain&#39;, &#39;lambda_gains&#39;: &#39;surface_gains&#39; } migrated_params = params.copy() for old_param, new_param in deprecated_mappings.items(): if old_param in migrated_params: migrated_params[new_param] = migrated_params.pop(old_param) logger.warning(f&quot;Parameter &#39;{old_param}&#39; is deprecated. Use &#39;{new_param}&#39; instead.&quot;) return migrated_params</span>

</pre></div>
</div>
<hr class="docutils" />
<section id="error-handling-and-robustness-graceful-degradation-the-factory-system-implements-multiple-layers-of-fallback-mechanisms-python">
<h2>Error Handling and Robustness ### Graceful Degradation The factory system implements multiple layers of fallback mechanisms: ```python<a class="headerlink" href="#error-handling-and-robustness-graceful-degradation-the-factory-system-implements-multiple-layers-of-fallback-mechanisms-python" title="Link to this heading">¬∂</a></h2>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id3">
<h1>example-metadata:<a class="headerlink" href="#id3" title="Link to this heading">¬∂</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="runnable-false-def-create-controller-controller-type-str-config-optional-any-none-gains-optional-union-list-np-ndarray-none-any-create-controller-with-graceful-degradation-try-attempt-full-configuration-creation-controller-config-create-full-config-controller-type-config-gains-return-controller-class-controller-config-except-exception-as-e-logger-warning-f-full-config-creation-failed-e-using-minimal-config-fallback-to-minimal-configuration-minimal-config-create-minimal-config-controller-type-gains-return-controller-class-minimal-config">
<h1>runnable: false def create_controller(controller_type: str, config: Optional[Any] = None, gains: Optional[Union[list, np.ndarray]] = None) -&gt; Any: ‚Äú‚Äù‚ÄùCreate controller with graceful degradation.‚Äù‚Äù‚Äù try: # Attempt full configuration creation controller_config = create_full_config(controller_type, config, gains) return controller_class(controller_config) except Exception as e: logger.warning(f‚ÄùFull config creation failed: {e}. Using minimal config.‚Äù) # Fallback to minimal configuration minimal_config = create_minimal_config(controller_type, gains) return controller_class(minimal_config)<a class="headerlink" href="#runnable-false-def-create-controller-controller-type-str-config-optional-any-none-gains-optional-union-list-np-ndarray-none-any-create-controller-with-graceful-degradation-try-attempt-full-configuration-creation-controller-config-create-full-config-controller-type-config-gains-return-controller-class-controller-config-except-exception-as-e-logger-warning-f-full-config-creation-failed-e-using-minimal-config-fallback-to-minimal-configuration-minimal-config-create-minimal-config-controller-type-gains-return-controller-class-minimal-config" title="Link to this heading">¬∂</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">###</span> <span class="pre">Import</span> <span class="pre">Error</span> <span class="pre">Handling</span> <span class="pre">Robust</span> <span class="pre">handling</span> <span class="pre">of</span> <span class="pre">optional</span> <span class="pre">dependencies:</span></code>python</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id4">
<h1>example-metadata:<a class="headerlink" href="#id4" title="Link to this heading">¬∂</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="runnable-false-optional-mpc-controller-import-with-graceful-fallback">
<h1>runnable: false # Optional MPC controller import with graceful fallback<a class="headerlink" href="#runnable-false-optional-mpc-controller-import-with-graceful-fallback" title="Link to this heading">¬∂</a></h1>
<p>try: from src.controllers.mpc.controller import MPCController MPC_AVAILABLE = True
except ImportError: MPCController = None MPC_AVAILABLE = False logger.debug(‚ÄúMPC controller not available - optional dependency‚Äù) # Registry entry with availability check
if MPC_AVAILABLE: CONTROLLER_REGISTRY[‚Äòmpc_controller‚Äô] = { ‚Äòclass‚Äô: MPCController, ‚Äòconfig_class‚Äô: MPCConfig, # ‚Ä¶ full configuration }
else: CONTROLLER_REGISTRY[‚Äòmpc_controller‚Äô] = { ‚Äòclass‚Äô: None, ‚Äòconfig_class‚Äô: UnavailableMPCConfig, ‚Äòdescription‚Äô: ‚ÄòModel predictive controller (unavailable)‚Äô, # ‚Ä¶ placeholder configuration }
<code class="docutils literal notranslate"><span class="pre">###</span> <span class="pre">Validation</span> <span class="pre">and</span> <span class="pre">Safety</span> <span class="pre">Checks</span> <span class="pre">validation</span> <span class="pre">at</span> <span class="pre">multiple</span> <span class="pre">levels:</span></code>python</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id5">
<h1>example-metadata:<a class="headerlink" href="#id5" title="Link to this heading">¬∂</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="runnable-false-def-validate-controller-gains-gains-list-float-controller-info-dict-str-any">
<h1>runnable: false def _validate_controller_gains( gains: List[float], controller_info: Dict[str, Any]<a class="headerlink" href="#runnable-false-def-validate-controller-gains-gains-list-float-controller-info-dict-str-any" title="Link to this heading">¬∂</a></h1>
<p>) -&gt; None: ‚Äú‚Äù‚ÄùValidate controller gains with domain-specific checks.‚Äù‚Äù‚Äù # Basic structural validation expected_count = controller_info[‚Äògain_count‚Äô] if len(gains) != expected_count: raise ValueError(f‚ÄùExpected {expected_count} gains, got {len(gains)}‚Äù) # Numerical validation if not all(isinstance(g, (int, float)) and np.isfinite(g) for g in gains): raise ValueError(‚ÄúAll gains must be finite numbers‚Äù) # Domain-specific validation if any(g &lt;= 0 for g in gains): raise ValueError(‚ÄúAll gains must be positive for SMC stability‚Äù)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="o">---</span>

<span class="c1">## API Reference ### Core Factory Functions #### `create_controller(controller_type, config=None, gains=None)` **Primary factory function for controller creation.** **Parameters:**</span>

<span class="o">-</span> <span class="err">`</span><span class="n">controller_type</span><span class="err">`</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Controller</span> <span class="nb">type</span> <span class="n">identifier</span> <span class="o">-</span> <span class="err">`</span><span class="s1">&#39;classical_smc&#39;</span><span class="err">`</span><span class="p">:</span> <span class="n">Classical</span> <span class="n">sliding</span> <span class="n">mode</span> <span class="n">controller</span> <span class="o">-</span> <span class="err">`</span><span class="s1">&#39;sta_smc&#39;</span><span class="err">`</span><span class="p">:</span> <span class="n">Super</span><span class="o">-</span><span class="n">twisting</span> <span class="n">sliding</span> <span class="n">mode</span> <span class="n">controller</span> <span class="o">-</span> <span class="err">`</span><span class="s1">&#39;adaptive_smc&#39;</span><span class="err">`</span><span class="p">:</span> <span class="n">Adaptive</span> <span class="n">sliding</span> <span class="n">mode</span> <span class="n">controller</span> <span class="o">-</span> <span class="err">`</span><span class="s1">&#39;hybrid_adaptive_sta_smc&#39;</span><span class="err">`</span><span class="p">:</span> <span class="n">Hybrid</span> <span class="n">adaptive</span><span class="o">-</span><span class="n">STA</span> <span class="n">controller</span> <span class="o">-</span> <span class="err">`</span><span class="s1">&#39;mpc_controller&#39;</span><span class="err">`</span><span class="p">:</span> <span class="n">Model</span> <span class="n">predictive</span> <span class="n">controller</span> <span class="p">(</span><span class="n">optional</span><span class="p">)</span> <span class="o">-</span> <span class="err">`</span><span class="n">config</span><span class="err">`</span> <span class="p">(</span><span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]):</span> <span class="n">Configuration</span> <span class="nb">object</span> <span class="n">containing</span> <span class="n">controller</span> <span class="n">parameters</span>
<span class="o">-</span> <span class="err">`</span><span class="n">gains</span><span class="err">`</span> <span class="p">(</span><span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]):</span> <span class="n">Controller</span> <span class="n">gain</span> <span class="n">array</span> <span class="o">**</span><span class="n">Returns</span><span class="p">:</span><span class="o">**</span>
<span class="o">-</span> <span class="n">Configured</span> <span class="n">controller</span> <span class="n">instance</span> <span class="n">implementing</span> <span class="err">`</span><span class="n">ControllerProtocol</span><span class="err">`</span> <span class="o">**</span><span class="n">Raises</span><span class="p">:</span><span class="o">**</span>
<span class="o">-</span> <span class="err">`</span><span class="ne">ValueError</span><span class="err">`</span><span class="p">:</span> <span class="n">Invalid</span> <span class="n">controller</span> <span class="nb">type</span> <span class="ow">or</span> <span class="n">parameters</span>
<span class="o">-</span> <span class="err">`</span><span class="ne">ImportError</span><span class="err">`</span><span class="p">:</span> <span class="n">Missing</span> <span class="n">required</span> <span class="n">dependencies</span> <span class="o">**</span><span class="n">Thread</span> <span class="n">Safety</span><span class="p">:</span><span class="o">**</span> <span class="err">‚úÖ</span> <span class="n">Thread</span><span class="o">-</span><span class="n">safe</span> <span class="k">with</span> <span class="n">timeout</span> <span class="n">protection</span> <span class="c1">#### `list_available_controllers()` **Get list of available controller types.** **Returns:**</span>
<span class="o">-</span> <span class="err">`</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="err">`</span><span class="p">:</span> <span class="n">List</span> <span class="n">of</span> <span class="n">available</span> <span class="n">controller</span> <span class="nb">type</span> <span class="n">identifiers</span> <span class="c1">#### `get_default_gains(controller_type)` **Get default gains for a specific controller type.** **Parameters:**</span>
<span class="o">-</span> <span class="err">`</span><span class="n">controller_type</span><span class="err">`</span> <span class="p">(</span><span class="nb">str</span><span class="p">):</span> <span class="n">Controller</span> <span class="nb">type</span> <span class="n">identifier</span> <span class="o">**</span><span class="n">Returns</span><span class="p">:</span><span class="o">**</span>
<span class="o">-</span> <span class="err">`</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="err">`</span><span class="p">:</span> <span class="n">Default</span> <span class="n">gain</span> <span class="n">values</span> <span class="k">for</span> <span class="n">the</span> <span class="n">controller</span> <span class="c1">### PSO Integration Functions #### `create_smc_for_pso(smc_type, gains, plant_config_or_model=None, **kwargs)` **Create SMC controller optimized for PSO usage.** **Parameters:**</span>
<span class="o">-</span> <span class="err">`</span><span class="n">smc_type</span><span class="err">`</span> <span class="p">(</span><span class="n">SMCType</span><span class="p">):</span> <span class="n">SMC</span> <span class="n">controller</span> <span class="nb">type</span> <span class="n">enum</span>
<span class="o">-</span> <span class="err">`</span><span class="n">gains</span><span class="err">`</span> <span class="p">(</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]):</span> <span class="n">Controller</span> <span class="n">gain</span> <span class="n">values</span>
<span class="o">-</span> <span class="err">`</span><span class="n">plant_config_or_model</span><span class="err">`</span> <span class="p">(</span><span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]):</span> <span class="n">Plant</span> <span class="n">configuration</span> <span class="ow">or</span> <span class="n">dynamics</span> <span class="n">model</span>
<span class="o">-</span> <span class="err">`</span><span class="o">**</span><span class="n">kwargs</span><span class="err">`</span><span class="p">:</span> <span class="n">Additional</span> <span class="n">controller</span> <span class="n">parameters</span> <span class="o">**</span><span class="n">Returns</span><span class="p">:</span><span class="o">**</span>
<span class="o">-</span> <span class="err">`</span><span class="n">PSOControllerWrapper</span><span class="err">`</span><span class="p">:</span> <span class="n">PSO</span><span class="o">-</span><span class="n">compatible</span> <span class="n">controller</span> <span class="n">wrapper</span> <span class="c1">#### `create_pso_controller_factory(smc_type, plant_config=None, **kwargs)` **Create a PSO-optimized controller factory function.** **Parameters:**</span>
<span class="o">-</span> <span class="err">`</span><span class="n">smc_type</span><span class="err">`</span> <span class="p">(</span><span class="n">SMCType</span><span class="p">):</span> <span class="n">SMC</span> <span class="n">controller</span> <span class="nb">type</span> <span class="n">enum</span>
<span class="o">-</span> <span class="err">`</span><span class="n">plant_config</span><span class="err">`</span> <span class="p">(</span><span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]):</span> <span class="n">Plant</span> <span class="n">configuration</span>
<span class="o">-</span> <span class="err">`</span><span class="o">**</span><span class="n">kwargs</span><span class="err">`</span><span class="p">:</span> <span class="n">Additional</span> <span class="n">controller</span> <span class="n">parameters</span> <span class="o">**</span><span class="n">Returns</span><span class="p">:</span><span class="o">**</span>
<span class="o">-</span> <span class="err">`</span><span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]],</span> <span class="n">Any</span><span class="p">]</span><span class="err">`</span><span class="p">:</span> <span class="n">Controller</span> <span class="n">factory</span> <span class="n">function</span> <span class="k">with</span> <span class="n">PSO</span> <span class="n">attributes</span> <span class="c1">#### `get_gain_bounds_for_pso(smc_type)` **Get PSO optimization bounds for controller gains.** **Parameters:**</span>
<span class="o">-</span> <span class="err">`</span><span class="n">smc_type</span><span class="err">`</span> <span class="p">(</span><span class="n">SMCType</span><span class="p">):</span> <span class="n">SMC</span> <span class="n">controller</span> <span class="nb">type</span> <span class="n">enum</span> <span class="o">**</span><span class="n">Returns</span><span class="p">:</span><span class="o">**</span>
<span class="o">-</span> <span class="err">`</span><span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span><span class="err">`</span><span class="p">:</span> <span class="p">(</span><span class="n">lower_bounds</span><span class="p">,</span> <span class="n">upper_bounds</span><span class="p">)</span> <span class="k">for</span> <span class="n">PSO</span> <span class="n">optimization</span> <span class="c1">### Controller Type Enums and Classes #### `SMCType` Enum ```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SMCType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span> <span class="s2">&quot;&quot;&quot;SMC Controller types enumeration.&quot;&quot;&quot;</span> <span class="n">CLASSICAL</span> <span class="o">=</span> <span class="s2">&quot;classical_smc&quot;</span> <span class="n">ADAPTIVE</span> <span class="o">=</span> <span class="s2">&quot;adaptive_smc&quot;</span> <span class="n">SUPER_TWISTING</span> <span class="o">=</span> <span class="s2">&quot;sta_smc&quot;</span> <span class="n">HYBRID</span> <span class="o">=</span> <span class="s2">&quot;hybrid_adaptive_sta_smc&quot;</span>
<span class="err">```</span> <span class="c1">#### `SMCConfig` Class ```python</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SMCConfig</span><span class="p">:</span> <span class="s2">&quot;&quot;&quot;Configuration class for SMC controllers.&quot;&quot;&quot;</span> <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gains</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">max_force</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">150.0</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># Configuration initialization</span>
<span class="err">```</span> <span class="c1">### Legacy Compatibility Functions #### `create_controller_legacy(controller_type, config=None, gains=None)` **Legacy factory function for backward compatibility.** #### `create_classical_smc_controller(config=None, gains=None)`</span>
<span class="c1">### `create_sta_smc_controller(config=None, gains=None)`</span>

<span class="c1">#### `create_adaptive_smc_controller(config=None, gains=None)` **Type-specific factory functions for backward compatibility.**</span>

<span class="o">---</span>

<span class="c1">## Integration Points ### Simulation Engine Integration The factory system integrates seamlessly with the simulation engine: ```python</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_controller</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.core.simulation_runner</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimulationRunner</span> <span class="c1"># Create controller through factory</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">sim_config</span><span class="p">)</span> <span class="c1"># Integrate with simulation engine</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">SimulationRunner</span><span class="p">(</span> <span class="n">controller</span><span class="o">=</span><span class="n">controller</span><span class="p">,</span> <span class="n">dynamics</span><span class="o">=</span><span class="n">dynamics_model</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">sim_config</span>
<span class="p">)</span> <span class="n">results</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">()</span>
<span class="err">```</span> <span class="c1">### PSO Optimization Integration Integration with PSO optimization workflows: ```python</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_pso_controller_factory</span><span class="p">,</span> <span class="n">SMCType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.optimization.algorithms.pso_optimizer</span><span class="w"> </span><span class="kn">import</span> <span class="n">PSOTuner</span> <span class="c1"># Create PSO-optimized factory</span>
<span class="n">controller_factory</span> <span class="o">=</span> <span class="n">create_pso_controller_factory</span><span class="p">(</span> <span class="n">SMCType</span><span class="o">.</span><span class="n">CLASSICAL</span><span class="p">,</span> <span class="n">plant_config</span><span class="o">=</span><span class="n">config</span>
<span class="p">)</span> <span class="c1"># Initialize PSO tuner</span>
<span class="n">tuner</span> <span class="o">=</span> <span class="n">PSOTuner</span><span class="p">(</span> <span class="n">controller_factory</span><span class="o">=</span><span class="n">controller_factory</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span>
<span class="p">)</span> <span class="c1"># Run optimization</span>
<span class="n">best_gains</span><span class="p">,</span> <span class="n">best_fitness</span> <span class="o">=</span> <span class="n">tuner</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>
<span class="err">```</span> <span class="c1">### Configuration System Integration Integration with YAML configuration system: ```yaml</span>
<span class="c1"># config.yaml</span>

<span class="n">controllers</span><span class="p">:</span> <span class="n">classical_smc</span><span class="p">:</span> <span class="n">gains</span><span class="p">:</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span> <span class="n">max_force</span><span class="p">:</span> <span class="mf">150.0</span> <span class="n">boundary_layer</span><span class="p">:</span> <span class="mf">0.02</span> <span class="n">dt</span><span class="p">:</span> <span class="mf">0.001</span>
<span class="err">```</span> <span class="err">```</span><span class="n">python</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_config</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_controller</span> <span class="c1"># Load configuration</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span> <span class="c1"># Create controller with configuration</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
<span class="err">```</span> <span class="c1">### Hardware-in-the-Loop Integration Integration with HIL systems: ```python</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_controller</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.hil.controller_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">ControllerClient</span> <span class="c1"># Create controller</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;adaptive_smc&#39;</span><span class="p">,</span> <span class="n">gains</span><span class="o">=</span><span class="n">optimized_gains</span><span class="p">)</span> <span class="c1"># HIL integration</span>
<span class="n">hil_client</span> <span class="o">=</span> <span class="n">ControllerClient</span><span class="p">(</span> <span class="n">controller</span><span class="o">=</span><span class="n">controller</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8888</span>
<span class="p">)</span> <span class="n">hil_client</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<hr class="docutils" />
<section id="troubleshooting-guide-common-issues-and-approaches-issue-valueerror-unknown-controller-type-symptoms">
<h2>Troubleshooting Guide ### Common Issues and approaches #### Issue: <code class="docutils literal notranslate"><span class="pre">ValueError:</span> <span class="pre">Unknown</span> <span class="pre">controller</span> <span class="pre">type</span></code> <strong>Symptoms:</strong><a class="headerlink" href="#troubleshooting-guide-common-issues-and-approaches-issue-valueerror-unknown-controller-type-symptoms" title="Link to this heading">¬∂</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="ne">ValueError</span><span class="p">:</span> <span class="n">Unknown</span> <span class="n">controller</span> <span class="nb">type</span> <span class="s1">&#39;classical&#39;</span><span class="o">.</span> <span class="n">Available</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;sta_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;adaptive_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;hybrid_adaptive_sta_smc&#39;</span><span class="p">]</span>
<span class="err">```</span> <span class="o">**</span><span class="n">Causes</span><span class="p">:</span><span class="o">**</span>
<span class="o">-</span> <span class="n">Incorrect</span> <span class="n">controller</span> <span class="nb">type</span> <span class="n">string</span>
<span class="o">-</span> <span class="n">Typo</span> <span class="ow">in</span> <span class="n">controller</span> <span class="n">name</span>
<span class="o">-</span> <span class="n">Missing</span> <span class="n">controller</span> <span class="n">registration</span> <span class="o">**</span><span class="n">Solutions</span><span class="p">:</span><span class="o">**</span>
<span class="mf">1.</span> <span class="o">**</span><span class="n">Check</span> <span class="n">available</span> <span class="n">controllers</span><span class="p">:</span><span class="o">**</span> <span class="err">```</span><span class="n">python</span> <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">list_available_controllers</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available controllers:&quot;</span><span class="p">,</span> <span class="n">list_available_controllers</span><span class="p">())</span> <span class="err">```</span> <span class="mf">2.</span> <span class="o">**</span><span class="n">Use</span> <span class="n">correct</span> <span class="n">controller</span> <span class="n">names</span><span class="p">:</span><span class="o">**</span> <span class="o">-</span> <span class="err">‚úÖ</span> <span class="err">`</span><span class="s1">&#39;classical_smc&#39;</span><span class="err">`</span> <span class="p">(</span><span class="n">correct</span><span class="p">)</span> <span class="o">-</span> <span class="err">‚ùå</span> <span class="err">`</span><span class="s1">&#39;classical&#39;</span><span class="err">`</span> <span class="p">(</span><span class="n">incorrect</span><span class="p">)</span> <span class="o">-</span> <span class="err">‚úÖ</span> <span class="err">`</span><span class="s1">&#39;sta_smc&#39;</span><span class="err">`</span> <span class="p">(</span><span class="n">correct</span><span class="p">)</span> <span class="o">-</span> <span class="err">‚ùå</span> <span class="err">`</span><span class="s1">&#39;super_twisting&#39;</span><span class="err">`</span> <span class="p">(</span><span class="n">incorrect</span><span class="p">)</span> <span class="mf">3.</span> <span class="o">**</span><span class="n">Check</span> <span class="n">controller</span> <span class="n">aliases</span><span class="p">:</span><span class="o">**</span> <span class="err">```</span><span class="n">python</span> <span class="c1"># These aliases are supported: &#39;classic_smc&#39; -&gt; &#39;classical_smc&#39; &#39;super_twisting&#39; -&gt; &#39;sta_smc&#39; &#39;adaptive&#39; -&gt; &#39;adaptive_smc&#39; &#39;hybrid&#39; -&gt; &#39;hybrid_adaptive_sta_smc&#39; ``` #### Issue: `ImportError: Controller class not available` **Symptoms:**</span>
</pre></div>
</div>
<p>ImportError: Controller class for mpc_controller is not available</p>
<div class="highlight-**Causes:** notranslate"><div class="highlight"><pre><span></span>- Missing optional dependencies
- Controller module not installed
- Import path issues **Solutions:**
1. **Check controller availability:** ```python from src.controllers.factory import CONTROLLER_REGISTRY controller_info = CONTROLLER_REGISTRY[&#39;mpc_controller&#39;] if controller_info[&#39;class&#39;] is None: print(&quot;Controller not available - check dependencies&quot;) ``` 2. **Install missing dependencies:** ```bash pip install -r requirements.txt ``` 3. **Verify module imports:** ```python try: from src.controllers.mpc.controller import MPCController print(&quot;MPC controller available&quot;) except ImportError as e: print(f&quot;MPC controller not available: {e}&quot;) ``` #### Issue: Gain validation failures **Symptoms:**
</pre></div>
</div>
<p>ValueError: Controller ‚Äòclassical_smc‚Äô requires 6 gains, got 5
ValueError: All gains must be positive</p>
<div class="highlight-**Causes:** notranslate"><div class="highlight"><pre><span></span>- Incorrect number of gains
- Invalid gain values (negative, NaN, infinite)
- Controller-specific validation failures **Solutions:**
1. **Check required gain count:** ```python from src.controllers.factory import get_default_gains default_gains = get_default_gains(&#39;classical_smc&#39;) print(f&quot;Required gains: {len(default_gains)}&quot;) print(f&quot;Default values: {default_gains}&quot;) ``` 2. **Validate gains before use:** ```python import numpy as np gains = [10.0, 8.0, 15.0, 12.0, 50.0, 5.0] # Check basic validity assert len(gains) == 6, f&quot;Expected 6 gains, got {len(gains)}&quot; assert all(isinstance(g, (int, float)) for g in gains), &quot;All gains must be numbers&quot; assert all(np.isfinite(g) for g in gains), &quot;All gains must be finite&quot; assert all(g &gt; 0 for g in gains), &quot;All gains must be positive&quot; ``` 3. **Use controller-specific validation:** ```python from src.controllers.factory import validate_smc_gains, SMCType is_valid = validate_smc_gains(SMCType.CLASSICAL, gains) if not is_valid: print(&quot;Gains failed validation&quot;) ``` #### Issue: Configuration conflicts **Symptoms:**
</pre></div>
</div>
<p>Warning: Could not create full config, using minimal config
TypeError: <strong>init</strong>() got an unexpected keyword argument</p>
<div class="highlight-**Causes:** notranslate"><div class="highlight"><pre><span></span>- Conflicting configuration sources
- Deprecated parameter names
- Missing required parameters **Solutions:**
1. **Check configuration priority:** ```python
# example-metadata:
# runnable: false # Priority order (highest to lowest): # 1. Explicit gains parameter # 2. Configuration object attributes # 3. YAML configuration file # 4. Registry defaults controller = create_controller( &#39;classical_smc&#39;, gains=[10, 8, 15, 12, 50, 5], # Highest priority config=config_object # Lower priority ) ``` 2. **Update deprecated parameters:** ```python # Deprecated -&gt; Current &#39;use_equivalent&#39; -&gt; &#39;enable_equivalent_control&#39; &#39;k_gain&#39; -&gt; &#39;switching_gain&#39; &#39;lambda_gains&#39; -&gt; &#39;surface_gains&#39; ``` 3. **Provide required parameters:** ```python # Classical SMC required parameters: config_params = { &#39;gains&#39;: [20.0, 15.0, 12.0, 8.0, 35.0, 5.0], &#39;max_force&#39;: 150.0, &#39;boundary_layer&#39;: 0.02, &#39;dt&#39;: 0.001 } ``` #### Issue: Thread safety problems **Symptoms:**
</pre></div>
</div>
<p>RuntimeError: Lock timeout exceeded
Deadlock in concurrent controller creation</p>
<div class="highlight-**Causes:** notranslate"><div class="highlight"><pre><span></span>- Concurrent factory calls
- Lock timeout exceeded
- Resource contention **Solutions:**
1. **Avoid excessive concurrent calls:** ```python # Instead of many concurrent calls: controllers = [] for i in range(100): controller = create_controller(&#39;classical_smc&#39;) # Can cause contention controllers.append(controller) # Use batch creation: from src.controllers.factory import create_all_smc_controllers controllers = create_all_smc_controllers(gains_dict) ``` 2. **Handle timeout gracefully:** ```python try: controller = create_controller(&#39;classical_smc&#39;) except RuntimeError as e: if &quot;timeout&quot; in str(e).lower(): # Retry with exponential backoff time.sleep(random.uniform(0.1, 0.5)) controller = create_controller(&#39;classical_smc&#39;) else: raise ``` 3. **Use pre-created controllers for PSO:** ```python # Pre-create factory function (once) factory = create_pso_controller_factory(SMCType.CLASSICAL) # Use factory in PSO fitness function (many times) def fitness_function(gains): controller = factory(gains) # Thread-safe, fast return evaluate_performance(controller) ``` ### Performance Optimization #### Memory Usage Optimization ```python
# example-metadata:
# runnable: false # Avoid creating unnecessary controllers
def optimize_controller_creation(): # ‚ùå Creates many controller instances controllers = [] for gains_set in gain_sets: controller = create_controller(&#39;classical_smc&#39;, gains=gains_set) controllers.append(controller) # ‚úÖ Use single factory function factory = create_pso_controller_factory(SMCType.CLASSICAL) controllers = [factory(gains_set) for gains_set in gain_sets]
``` #### Import Time Optimization ```python
# example-metadata:

# runnable: false # ‚ùå Imports all controllers at module level

from src.controllers.factory import ( create_controller, create_classical_smc_controller, create_sta_smc_controller, # ... all functions
) # ‚úÖ Import only what you need
from src.controllers.factory import create_controller # ‚úÖ Or use lazy imports
def get_factory_function(): from src.controllers.factory import create_pso_controller_factory return create_pso_controller_factory
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="performance-considerations-factory-creation-performance-the-factory-system-is-optimized-for-performance-critical-applications-python">
<h2>Performance Considerations ### Factory Creation Performance The factory system is optimized for performance-critical applications: ```python<a class="headerlink" href="#performance-considerations-factory-creation-performance-the-factory-system-is-optimized-for-performance-critical-applications-python" title="Link to this heading">¬∂</a></h2>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="performance-benchmarks-typical-values">
<h1>Performance benchmarks (typical values)<a class="headerlink" href="#performance-benchmarks-typical-values" title="Link to this heading">¬∂</a></h1>
<p>Single controller creation: ~1-2 ms
PSO factory creation: ~0.5-1 ms
Gain validation: ~0.1-0.2 ms
Configuration resolution: ~0.2-0.5 ms
<code class="docutils literal notranslate"><span class="pre">###</span> <span class="pre">Memory</span> <span class="pre">Usage</span> <span class="pre">Patterns</span></code>python</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id6">
<h1>example-metadata:<a class="headerlink" href="#id6" title="Link to this heading">¬∂</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="runnable-false-memory-efficient-patterns-1-reuse-factory-functions">
<h1>runnable: false # Memory-efficient patterns: # 1. Reuse factory functions<a class="headerlink" href="#runnable-false-memory-efficient-patterns-1-reuse-factory-functions" title="Link to this heading">¬∂</a></h1>
<p>factory = create_pso_controller_factory(SMCType.CLASSICAL)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="use-factory-many-times-without-recreating-2-use-minimal-configurations-when-possible">
<h1>Use factory many times without recreating # 2. Use minimal configurations when possible<a class="headerlink" href="#use-factory-many-times-without-recreating-2-use-minimal-configurations-when-possible" title="Link to this heading">¬∂</a></h1>
<p>controller = create_controller(‚Äòclassical_smc‚Äô, gains=simple_gains)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="avoid-complex-config-objects-for-simple-use-cases-3-batch-operations">
<h1>Avoid complex config objects for simple use cases # 3. Batch operations<a class="headerlink" href="#avoid-complex-config-objects-for-simple-use-cases-3-batch-operations" title="Link to this heading">¬∂</a></h1>
<p>controllers = create_all_smc_controllers(gains_dict)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="more-efficient-than-individual-creation">
<h1>More efficient than individual creation<a class="headerlink" href="#more-efficient-than-individual-creation" title="Link to this heading">¬∂</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">###</span> <span class="pre">Concurrency</span> <span class="pre">Performance</span></code>python</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id7">
<h1>example-metadata:<a class="headerlink" href="#id7" title="Link to this heading">¬∂</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="runnable-false-thread-safe-patterns-1-pre-create-factories-for-concurrent-use">
<h1>runnable: false # Thread-safe patterns: # 1. Pre-create factories for concurrent use<a class="headerlink" href="#runnable-false-thread-safe-patterns-1-pre-create-factories-for-concurrent-use" title="Link to this heading">¬∂</a></h1>
<p>factories = { SMCType.CLASSICAL: create_pso_controller_factory(SMCType.CLASSICAL), SMCType.ADAPTIVE: create_pso_controller_factory(SMCType.ADAPTIVE),
} # 2. Use factories in parallel PSO
def parallel_fitness_evaluation(gains_batch): factory = factories[controller_type] return [evaluate_controller(factory(gains)) for gains in gains_batch]</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="o">---</span>

<span class="c1">## Testing and Validation ### Unit Testing Patterns The factory system includes testing: ```python</span>

<span class="c1"># example-metadata:</span>

<span class="c1"># runnable: false # Test controller creation</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_controller_creation</span><span class="p">():</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">)</span> <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="s1">&#39;compute_control&#39;</span><span class="p">)</span> <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="s1">&#39;gains&#39;</span><span class="p">)</span> <span class="c1"># Test gain validation</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_gain_validation</span><span class="p">():</span> <span class="n">valid_gains</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">50.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="n">gains</span><span class="o">=</span><span class="n">valid_gains</span><span class="p">)</span> <span class="k">assert</span> <span class="n">controller</span><span class="o">.</span><span class="n">gains</span> <span class="o">==</span> <span class="n">valid_gains</span> <span class="c1"># Test error handling</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_invalid_controller_type</span><span class="p">():</span> <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s2">&quot;Unknown controller type&quot;</span><span class="p">):</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;invalid_controller&#39;</span><span class="p">)</span>
<span class="err">```</span> <span class="c1">### Integration Testing ```python</span>
<span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false # Test PSO integration</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_pso_integration</span><span class="p">():</span> <span class="n">factory</span> <span class="o">=</span> <span class="n">create_pso_controller_factory</span><span class="p">(</span><span class="n">SMCType</span><span class="o">.</span><span class="n">CLASSICAL</span><span class="p">)</span> <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">factory</span><span class="p">,</span> <span class="s1">&#39;n_gains&#39;</span><span class="p">)</span> <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">factory</span><span class="p">,</span> <span class="s1">&#39;controller_type&#39;</span><span class="p">)</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">factory</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span> <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="s1">&#39;validate_gains&#39;</span><span class="p">)</span> <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="s1">&#39;compute_control&#39;</span><span class="p">)</span> <span class="c1"># Test configuration integration</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_config_integration</span><span class="p">():</span> <span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span> <span class="c1"># Verify configuration applied correctly</span>
<span class="err">```</span> <span class="c1">### Performance Testing ```python</span>
<span class="c1"># Benchmark factory performance</span>

<span class="k">def</span><span class="w"> </span><span class="nf">benchmark_factory_performance</span><span class="p">():</span> <span class="kn">import</span><span class="w"> </span><span class="nn">time</span> <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">)</span> <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="n">avg_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span> <span class="k">assert</span> <span class="n">avg_time</span> <span class="o">&lt;</span> <span class="mf">0.005</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Factory too slow: </span><span class="si">{</span><span class="n">avg_time</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">s&quot;</span>
<span class="err">```</span> <span class="c1">### Scientific Validation ```python</span>
<span class="c1"># example-metadata:</span>
<span class="c1"># runnable: false # Validate control theory properties</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_controller_stability</span><span class="p">():</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="n">gains</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span> <span class="c1"># Test Lyapunov stability state = np.array([0.1, 0.05, 0.0, 0.0, 0.0, 0.0]) control_output = controller.compute_control(state, 0.0, {}) # Verify control output bounds assert abs(control_output.u) &lt;= controller.max_force # Validate PSO optimization compatibility</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_pso_optimization_compatibility</span><span class="p">():</span> <span class="n">factory</span> <span class="o">=</span> <span class="n">create_pso_controller_factory</span><span class="p">(</span><span class="n">SMCType</span><span class="o">.</span><span class="n">CLASSICAL</span><span class="p">)</span> <span class="c1"># Test gain bounds lower_bounds, upper_bounds = get_gain_bounds_for_pso(SMCType.CLASSICAL) assert len(lower_bounds) == factory.n_gains assert all(l &lt; u for l, u in zip(lower_bounds, upper_bounds)) # Test gain validation wrapper = factory([10, 8, 15, 12, 50, 5]) test_gains = np.array([[10, 8, 15, 12, 50, 5], [0, 0, 0, 0, 0, 0]]) validity = wrapper.validate_gains(test_gains) assert validity[0] == True # Valid gains assert validity[1] == False # Invalid gains (zeros)</span>
</pre></div>
</div>
<hr class="docutils" />
<p>This documentation provides complete coverage of the factory integration system, addressing all aspects of implementation, usage, and troubleshooting. The system successfully resolves GitHub issue #6 by providing robust, thread-safe controller instantiation with deep PSO optimization integration.</p>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Research Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Oct 10, 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=4ebf8126"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=08e7b316"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script src="_static/back-to-top.js?v=840797bb"></script>
    <script src="_static/lazy-load.js?v=dc25293c"></script>
    <script src="_static/dark-mode.js?v=bf328970"></script>
    </body>
</html>