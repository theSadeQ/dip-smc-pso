<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Factory Integration Troubleshooting Guide - DIP_SMC_PSO Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5349f25f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=f5a89ef9" />
    
    


<style>
  body {
    --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">DIP_SMC_PSO Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">DIP_SMC_PSO Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">ğŸ“š Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">Optimal Sliding Mode Control for a Double-Inverted Pendulum via PSO</a></li>
<li class="toctree-l1"><a class="reference internal" href="theory_overview.html">1. Theoretical Background Ã¢â‚¬â€ Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">3. System Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="plant_model.html">1.x Plant Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="hil_quickstart.html">Hardware-in-the-Loop (HIL) Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="streamlit_dashboard_guide.html">Streamlit Dashboard User Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ğŸ® Control Systems &amp; Optimization</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="controllers/index.html">Controllers Module Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Controllers Module Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="controllers/classical_smc_technical_guide.html">Classical Sliding Mode Control Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="controllers/adaptive_smc_technical_guide.html">Adaptive Sliding Mode Control Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="controllers/sta_smc_technical_guide.html">Super-Twisting Sliding Mode Control Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="controllers/hybrid_smc_technical_guide.html">Hybrid Adaptive Super-Twisting SMC Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="controllers/mpc_technical_guide.html">Model Predictive Control Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="controllers/swing_up_smc_technical_guide.html">Swing-Up SMC Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="controllers/factory_system_guide.html">SMC Controller Factory System Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="controllers/control_primitives_reference.html">Control Primitives Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="mathematical_foundations/smc_complete_theory.html">Complete Sliding Mode Control Mathematical Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="mathematical_foundations/controller_comparison_theory.html">SMC Controller Comparison Theory</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="reference/controllers/index.html">Controllers Module</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Controllers Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/adaptive_smc.html">controllers.adaptive_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/classic_smc.html">controllers.classic_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory.html">controllers.factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/mpc_controller.html">controllers.mpc_controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/sta_smc.html">controllers.sta_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/swing_up_smc.html">controllers.swing_up_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/__init__.html">controllers.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/base_controller_interface.html">controllers.base.controller_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/base_control_primitives.html">controllers.base.control_primitives</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/base___init__.html">controllers.base.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory_deprecation.html">controllers.factory.deprecation</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory_fallback_configs.html">controllers.factory.fallback_configs</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory_legacy_factory.html">controllers.factory.legacy_factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory_optimization.html">controllers.factory.optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory_pso_integration.html">controllers.factory.pso_integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory_smc_factory.html">controllers.factory.smc_factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory_thread_safety.html">controllers.factory.thread_safety</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory___init__.html">controllers.factory.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/mpc_mpc_controller.html">controllers.mpc.mpc_controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/mpc___init__.html">controllers.mpc.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_adaptive_smc.html">controllers.smc.adaptive_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_classic_smc.html">controllers.smc.classic_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_hybrid_adaptive_sta_smc.html">controllers.smc.hybrid_adaptive_sta_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_sta_smc.html">controllers.smc.sta_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc___init__.html">controllers.smc.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/specialized_swing_up_smc.html">controllers.specialized.swing_up_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/specialized___init__.html">controllers.specialized.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory_core_protocols.html">controllers.factory.core.protocols</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory_core_registry.html">controllers.factory.core.registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory_core_threading.html">controllers.factory.core.threading</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory_core_validation.html">controllers.factory.core.validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/factory_core___init__.html">controllers.factory.core.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms___init__.html">controllers.smc.algorithms.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_core_equivalent_control.html">controllers.smc.core.equivalent_control</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_core_gain_validation.html">controllers.smc.core.gain_validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_core_sliding_surface.html">controllers.smc.core.sliding_surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_core_switching_functions.html">controllers.smc.core.switching_functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_core___init__.html">controllers.smc.core.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_adaptive_adaptation_law.html">controllers.smc.algorithms.adaptive.adaptation_law</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_adaptive_config.html">controllers.smc.algorithms.adaptive.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_adaptive_controller.html">controllers.smc.algorithms.adaptive.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_adaptive_parameter_estimation.html">controllers.smc.algorithms.adaptive.parameter_estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_adaptive___init__.html">controllers.smc.algorithms.adaptive.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_classical_boundary_layer.html">controllers.smc.algorithms.classical.boundary_layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_classical_config.html">controllers.smc.algorithms.classical.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_classical_controller.html">controllers.smc.algorithms.classical.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_classical___init__.html">controllers.smc.algorithms.classical.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_hybrid_config.html">controllers.smc.algorithms.hybrid.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_hybrid_controller.html">controllers.smc.algorithms.hybrid.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_hybrid_switching_logic.html">controllers.smc.algorithms.hybrid.switching_logic</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_hybrid___init__.html">controllers.smc.algorithms.hybrid.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_super_twisting_config.html">controllers.smc.algorithms.super_twisting.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_super_twisting_controller.html">controllers.smc.algorithms.super_twisting.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_super_twisting_twisting_algorithm.html">controllers.smc.algorithms.super_twisting.twisting_algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference/controllers/smc_algorithms_super_twisting___init__.html">controllers.smc.algorithms.super_twisting.<strong>init</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mathematical_foundations/index.html">Mathematical Foundations</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Mathematical Foundations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mathematical_foundations/smc_complete_theory.html">Complete Sliding Mode Control Mathematical Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="mathematical_foundations/controller_comparison_theory.html">SMC Controller Comparison Theory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plant/models_guide.html">Plant Models Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization_simulation/guide.html">Optimization &amp; Simulation Guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="reference/controllers/index.html">Controllers Module</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Controllers Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/adaptive_smc.html">controllers.adaptive_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/classic_smc.html">controllers.classic_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory.html">controllers.factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/mpc_controller.html">controllers.mpc_controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/sta_smc.html">controllers.sta_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/swing_up_smc.html">controllers.swing_up_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/__init__.html">controllers.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/base_controller_interface.html">controllers.base.controller_interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/base_control_primitives.html">controllers.base.control_primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/base___init__.html">controllers.base.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory_deprecation.html">controllers.factory.deprecation</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory_fallback_configs.html">controllers.factory.fallback_configs</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory_legacy_factory.html">controllers.factory.legacy_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory_optimization.html">controllers.factory.optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory_pso_integration.html">controllers.factory.pso_integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory_smc_factory.html">controllers.factory.smc_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory_thread_safety.html">controllers.factory.thread_safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory___init__.html">controllers.factory.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/mpc_mpc_controller.html">controllers.mpc.mpc_controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/mpc___init__.html">controllers.mpc.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_adaptive_smc.html">controllers.smc.adaptive_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_classic_smc.html">controllers.smc.classic_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_hybrid_adaptive_sta_smc.html">controllers.smc.hybrid_adaptive_sta_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_sta_smc.html">controllers.smc.sta_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc___init__.html">controllers.smc.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/specialized_swing_up_smc.html">controllers.specialized.swing_up_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/specialized___init__.html">controllers.specialized.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory_core_protocols.html">controllers.factory.core.protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory_core_registry.html">controllers.factory.core.registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory_core_threading.html">controllers.factory.core.threading</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory_core_validation.html">controllers.factory.core.validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/factory_core___init__.html">controllers.factory.core.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms___init__.html">controllers.smc.algorithms.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_core_equivalent_control.html">controllers.smc.core.equivalent_control</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_core_gain_validation.html">controllers.smc.core.gain_validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_core_sliding_surface.html">controllers.smc.core.sliding_surface</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_core_switching_functions.html">controllers.smc.core.switching_functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_core___init__.html">controllers.smc.core.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_adaptive_adaptation_law.html">controllers.smc.algorithms.adaptive.adaptation_law</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_adaptive_config.html">controllers.smc.algorithms.adaptive.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_adaptive_controller.html">controllers.smc.algorithms.adaptive.controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_adaptive_parameter_estimation.html">controllers.smc.algorithms.adaptive.parameter_estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_adaptive___init__.html">controllers.smc.algorithms.adaptive.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_classical_boundary_layer.html">controllers.smc.algorithms.classical.boundary_layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_classical_config.html">controllers.smc.algorithms.classical.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_classical_controller.html">controllers.smc.algorithms.classical.controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_classical___init__.html">controllers.smc.algorithms.classical.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_hybrid_config.html">controllers.smc.algorithms.hybrid.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_hybrid_controller.html">controllers.smc.algorithms.hybrid.controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_hybrid_switching_logic.html">controllers.smc.algorithms.hybrid.switching_logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_hybrid___init__.html">controllers.smc.algorithms.hybrid.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_super_twisting_config.html">controllers.smc.algorithms.super_twisting.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_super_twisting_controller.html">controllers.smc.algorithms.super_twisting.controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_super_twisting_twisting_algorithm.html">controllers.smc.algorithms.super_twisting.twisting_algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/controllers/smc_algorithms_super_twisting___init__.html">controllers.smc.algorithms.super_twisting.<strong>init</strong></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="reference/optimizer/index.html">Optimizer Module</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Optimizer Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="reference/optimizer/pso_optimizer.html">optimizer.pso_optimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference/optimizer/__init__.html">optimizer.<strong>init</strong></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="analysis_plan.html">5. Analysis &amp; Verification Plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks_methodology.html">Benchmarks &amp; Methodology</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ğŸ§ª Development &amp; Testing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TESTING.html">Testing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_protocols.html">5.x Test Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="use_cases.html">4. Use Cases &amp; Operating Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="context.html">2. Application Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="fault_detection_guide.html">Fault Detection &amp; Isolation (FDI) Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ğŸ“Š Research &amp; Theory</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="presentation/index.html">Research Presentation Materials</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Research Presentation Materials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="presentation/introduction.html">Abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/introduction.html#introduction-and-motivation">Introduction and Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/introduction.html#the-double-inverted-pendulum-as-a-canonical-control-problem">The Double Inverted Pendulum as a Canonical Control Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/introduction.html#the-primary-control-objectives-and-challenges">The Primary Control Objectives and Challenges</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/introduction.html#sliding-mode-control-as-a-robust-solution">Sliding Mode Control as a Robust Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/introduction.html#the-gain-tuning-dilemma-and-the-need-for-optimization">The Gain Tuning Dilemma and the Need for Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/introduction.html#particle-swarm-optimization-for-automated-design">Particle Swarm Optimization for Automated Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/introduction.html#synthesis-and-motivation">Synthesis and Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/introduction.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/problem-statement.html">Problem Statement for Doubleâ€‘InvertedÂ Pendulum (DIP) Control with SMC and PSO</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/previous-works.html">Previous Work Before the Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/system-modeling.html"><strong>A Comprehensive Technical Report on the Modeling and Configuration of a Cartâ€‘Based Double Inverted Pendulum System</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/smc-theory.html">Sliding Mode Control for a Doubleâ€‘Inverted Pendulum: Bridging Theory and Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/chattering-mitigation.html">Abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/chattering-mitigation.html#introduction">1Â Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/chattering-mitigation.html#system-modelling-and-problem-formulation">2Â SystemÂ Modelling and ProblemÂ Formulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/chattering-mitigation.html#simulation-methodology">3Â Simulation Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/chattering-mitigation.html#classic-sliding-mode-control">4Â Classic SlidingÂ Mode Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/chattering-mitigation.html#chattering-mitigation-strategy-i-boundary-layer-method">5Â ChatteringÂ Mitigation StrategyÂ I:Â BoundaryÂ LayerÂ Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/chattering-mitigation.html#chattering-mitigation-strategy-ii-supertwisting-algorithm">6Â ChatteringÂ Mitigation StrategyÂ II:Â Superâ€‘Twisting Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/chattering-mitigation.html#chattering-mitigation-strategy-iii-adaptive-sliding-mode-control">7Â ChatteringÂ Mitigation StrategyÂ III:Â AdaptiveÂ SlidingÂ ModeÂ Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/chattering-mitigation.html#chattering-mitigation-strategy-iv-hybrid-adaptivesta">8Â ChatteringÂ Mitigation StrategyÂ IV:Â HybridÂ Adaptiveâ€“STA</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/chattering-mitigation.html#synthesis-and-comparative-analysis">9Â SynthesisÂ and Comparative Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/chattering-mitigation.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/pso-optimization.html"><strong>Comprehensive Simulation Analysis and Enhancements for the Double Inverted Pendulum Control System</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/simulation-setup.html">Particle Swarm Optimization for Slidingâ€‘Mode Controller Tuning of a Double Inverted Pendulum</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/results-discussion.html">8 â€“ Results and Discussion</a></li>
<li class="toctree-l2"><a class="reference internal" href="presentation/results-discussion.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="presentation/introduction.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/introduction.html#introduction-and-motivation">Introduction and Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/introduction.html#the-double-inverted-pendulum-as-a-canonical-control-problem">The Double Inverted Pendulum as a Canonical Control Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/introduction.html#the-primary-control-objectives-and-challenges">The Primary Control Objectives and Challenges</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/introduction.html#sliding-mode-control-as-a-robust-solution">Sliding Mode Control as a Robust Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/introduction.html#the-gain-tuning-dilemma-and-the-need-for-optimization">The Gain Tuning Dilemma and the Need for Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/introduction.html#particle-swarm-optimization-for-automated-design">Particle Swarm Optimization for Automated Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/introduction.html#synthesis-and-motivation">Synthesis and Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/introduction.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/problem-statement.html">Problem Statement for Doubleâ€‘InvertedÂ Pendulum (DIP) Control with SMC and PSO</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/previous-works.html">Previous Work Before the Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/system-modeling.html"><strong>A Comprehensive Technical Report on the Modeling and Configuration of a Cartâ€‘Based Double Inverted Pendulum System</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/smc-theory.html">Sliding Mode Control for a Doubleâ€‘Inverted Pendulum: Bridging Theory and Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/chattering-mitigation.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/chattering-mitigation.html#introduction">1Â Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/chattering-mitigation.html#system-modelling-and-problem-formulation">2Â SystemÂ Modelling and ProblemÂ Formulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/chattering-mitigation.html#simulation-methodology">3Â Simulation Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/chattering-mitigation.html#classic-sliding-mode-control">4Â Classic SlidingÂ Mode Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/chattering-mitigation.html#chattering-mitigation-strategy-i-boundary-layer-method">5Â ChatteringÂ Mitigation StrategyÂ I:Â BoundaryÂ LayerÂ Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/chattering-mitigation.html#chattering-mitigation-strategy-ii-supertwisting-algorithm">6Â ChatteringÂ Mitigation StrategyÂ II:Â Superâ€‘Twisting Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/chattering-mitigation.html#chattering-mitigation-strategy-iii-adaptive-sliding-mode-control">7Â ChatteringÂ Mitigation StrategyÂ III:Â AdaptiveÂ SlidingÂ ModeÂ Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/chattering-mitigation.html#chattering-mitigation-strategy-iv-hybrid-adaptivesta">8Â ChatteringÂ Mitigation StrategyÂ IV:Â HybridÂ Adaptiveâ€“STA</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/chattering-mitigation.html#synthesis-and-comparative-analysis">9Â SynthesisÂ and Comparative Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/chattering-mitigation.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/pso-optimization.html"><strong>Comprehensive Simulation Analysis and Enhancements for the Double Inverted Pendulum Control System</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/simulation-setup.html">Particle Swarm Optimization for Slidingâ€‘Mode Controller Tuning of a Double Inverted Pendulum</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/results-discussion.html">8 â€“ Results and Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="presentation/results-discussion.html#references">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ğŸ“– API Reference &amp; Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">API Reference Documentation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="examples/index.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography &amp; Academic References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ğŸ”§ Project Management</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing â€“ ResearchPlanSpec Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="RELEASE_CHECKLIST.html">Release Checklist</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="symbols.html">Symbols &amp; Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="results_readme.html">Results &amp; Plots</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/theSadeQ/DIP_SMC_PSO/blob/main/docs/factory_integration_troubleshooting_guide.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/theSadeQ/DIP_SMC_PSO/edit/main/docs/factory_integration_troubleshooting_guide.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <p>#==========================================================================================\<br />
#================ docs/factory_integration_troubleshooting_guide.md ==================\<br />
#==========================================================================================\</p>
<section class="tex2jax_ignore mathjax_ignore" id="factory-integration-troubleshooting-guide">
<h1>Factory Integration Troubleshooting Guide<a class="headerlink" href="#factory-integration-troubleshooting-guide" title="Link to this heading">Â¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">Â¶</a></h2>
<p>This comprehensive troubleshooting guide addresses common issues encountered when using the Enterprise Controller Factory system in the DIP SMC-PSO project. The guide provides systematic diagnostic procedures, root cause analysis, and proven solutions for factory integration problems.</p>
</section>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">Â¶</a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#quick-diagnosis">Quick Diagnosis</a></p></li>
<li><p><a class="reference internal" href="#controller-creation-issues">Controller Creation Issues</a></p></li>
<li><p><a class="reference internal" href="#pso-integration-problems">PSO Integration Problems</a></p></li>
<li><p><a class="reference internal" href="#configuration-issues">Configuration Issues</a></p></li>
<li><p><a class="reference internal" href="#performance-problems">Performance Problems</a></p></li>
<li><p><a class="reference internal" href="#import-and-dependency-issues">Import and Dependency Issues</a></p></li>
<li><p><a class="reference internal" href="#thread-safety-issues">Thread Safety Issues</a></p></li>
<li><p><a class="reference internal" href="#validation-failures"><span class="xref myst">Validation Failures</span></a></p></li>
<li><p><a class="reference internal" href="#debugging-tools-and-techniques">Debugging Tools and Techniques</a></p></li>
<li><p><a class="reference internal" href="#prevention-strategies">Prevention Strategies</a></p></li>
</ol>
</section>
<hr class="docutils" />
<section id="quick-diagnosis">
<h2>Quick Diagnosis<a class="headerlink" href="#quick-diagnosis" title="Link to this heading">Â¶</a></h2>
<section id="diagnostic-checklist">
<h3>Diagnostic Checklist<a class="headerlink" href="#diagnostic-checklist" title="Link to this heading">Â¶</a></h3>
<p>When encountering factory issues, run this quick diagnostic sequence:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;Factory integration quick diagnostic tool.&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">list_available_controllers</span><span class="p">,</span>
    <span class="n">list_all_controllers</span><span class="p">,</span>
    <span class="n">create_controller</span><span class="p">,</span>
    <span class="n">get_default_gains</span>
<span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">quick_diagnosis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run quick diagnostic checks for factory integration.&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Factory Integration Diagnostic ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># 1. Check available controllers</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Checking available controllers...&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">available</span> <span class="o">=</span> <span class="n">list_available_controllers</span><span class="p">()</span>
        <span class="n">all_controllers</span> <span class="o">=</span> <span class="n">list_all_controllers</span><span class="p">()</span>
        <span class="n">unavailable</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">all_controllers</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">available</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   âœ… Available: </span><span class="si">{</span><span class="n">available</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">unavailable</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   âš ï¸  Unavailable: </span><span class="si">{</span><span class="n">unavailable</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   âŒ Controller listing failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># 2. Test basic controller creation</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Testing basic controller creation...&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">controller_type</span> <span class="ow">in</span> <span class="n">available</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   âœ… </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">: Created successfully&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   âŒ </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># 3. Test gain access</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. Testing default gains access...&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">controller_type</span> <span class="ow">in</span> <span class="n">available</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">gains</span> <span class="o">=</span> <span class="n">get_default_gains</span><span class="p">(</span><span class="n">controller_type</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   âœ… </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span><span class="si">}</span><span class="s2"> gains&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   âŒ </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># 4. Test PSO integration</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4. Testing PSO integration...&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_pso_controller_factory</span><span class="p">,</span> <span class="n">SMCType</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">create_pso_controller_factory</span><span class="p">(</span><span class="n">SMCType</span><span class="o">.</span><span class="n">CLASSICAL</span><span class="p">)</span>
        <span class="n">test_gains</span> <span class="o">=</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
        <span class="n">controller</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="n">test_gains</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   âœ… PSO factory: Working&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   âŒ PSO factory: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># 5. Test configuration integration</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5. Testing configuration integration...&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">src.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_config</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span>
        <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   âœ… Configuration: Working&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   âŒ Configuration: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Diagnostic Complete ===&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">quick_diagnosis</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="common-issue-indicators">
<h3>Common Issue Indicators<a class="headerlink" href="#common-issue-indicators" title="Link to this heading">Â¶</a></h3>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Symptom</p></th>
<th class="head"><p>Likely Cause</p></th>
<th class="head"><p>Quick Fix</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ValueError:</span> <span class="pre">Unknown</span> <span class="pre">controller</span> <span class="pre">type</span></code></p></td>
<td><p>Typo in controller name</p></td>
<td><p>Check <code class="docutils literal notranslate"><span class="pre">list_available_controllers()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ImportError:</span> <span class="pre">MPC</span> <span class="pre">controller</span> <span class="pre">missing</span></code></p></td>
<td><p>Optional dependencies not installed</p></td>
<td><p>Install dependencies or use different controller</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ValueError:</span> <span class="pre">requires</span> <span class="pre">N</span> <span class="pre">gains,</span> <span class="pre">got</span> <span class="pre">M</span></code></p></td>
<td><p>Wrong number of gains</p></td>
<td><p>Check <code class="docutils literal notranslate"><span class="pre">get_default_gains(controller_type)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">RuntimeError:</span> <span class="pre">Lock</span> <span class="pre">timeout</span></code></p></td>
<td><p>Thread contention</p></td>
<td><p>Reduce concurrent factory calls</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ConfigValueError:</span> <span class="pre">parameter</span> <span class="pre">invalid</span></code></p></td>
<td><p>Invalid configuration values</p></td>
<td><p>Validate configuration parameters</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<hr class="docutils" />
<section id="controller-creation-issues">
<h2>Controller Creation Issues<a class="headerlink" href="#controller-creation-issues" title="Link to this heading">Â¶</a></h2>
<section id="issue-1-unknown-controller-type">
<h3>Issue 1: Unknown Controller Type<a class="headerlink" href="#issue-1-unknown-controller-type" title="Link to this heading">Â¶</a></h3>
<section id="symptoms">
<h4>Symptoms<a class="headerlink" href="#symptoms" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ne">ValueError</span><span class="p">:</span> <span class="n">Unknown</span> <span class="n">controller</span> <span class="nb">type</span> <span class="s1">&#39;classical&#39;</span><span class="o">.</span> <span class="n">Available</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;sta_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;adaptive_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;hybrid_adaptive_sta_smc&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="root-causes">
<h4>Root Causes<a class="headerlink" href="#root-causes" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Incorrect controller name</strong>: Using abbreviated or incorrect names</p></li>
<li><p><strong>Typos</strong>: Misspelling in controller type string</p></li>
<li><p><strong>Case sensitivity</strong>: Using wrong case for controller names</p></li>
<li><p><strong>Outdated code</strong>: Using deprecated controller names</p></li>
</ol>
</section>
<section id="solutions">
<h4>Solutions<a class="headerlink" href="#solutions" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Check Available Controllers</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">list_available_controllers</span>

<span class="c1"># Check what&#39;s actually available</span>
<span class="n">available</span> <span class="o">=</span> <span class="n">list_available_controllers</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available controllers: </span><span class="si">{</span><span class="n">available</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Use correct names</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">)</span>  <span class="c1"># âœ… Correct</span>
<span class="c1"># controller = create_controller(&#39;classical&#39;)    # âŒ Incorrect</span>
</pre></div>
</div>
<p><strong>Solution 2: Use Controller Aliases</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># These aliases are supported for backward compatibility</span>
<span class="n">valid_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;classical_smc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;classic_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;smc_classical&#39;</span><span class="p">,</span> <span class="s1">&#39;smc_v1&#39;</span><span class="p">],</span>
    <span class="s1">&#39;sta_smc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sta_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;super_twisting&#39;</span><span class="p">,</span> <span class="s1">&#39;sta&#39;</span><span class="p">],</span>
    <span class="s1">&#39;adaptive_smc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;adaptive_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;adaptive&#39;</span><span class="p">],</span>
    <span class="s1">&#39;hybrid_adaptive_sta_smc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;hybrid_adaptive_sta_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;hybrid&#39;</span><span class="p">,</span> <span class="s1">&#39;hybrid_sta&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Use any valid name</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classic_smc&#39;</span><span class="p">)</span>      <span class="c1"># âœ… Alias works</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;super_twisting&#39;</span><span class="p">)</span>   <span class="c1"># âœ… Alias works</span>
</pre></div>
</div>
<p><strong>Solution 3: Defensive Programming</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">safe_create_controller</span><span class="p">(</span><span class="n">preferred_types</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create controller with fallback options.&quot;&quot;&quot;</span>
    <span class="n">available</span> <span class="o">=</span> <span class="n">list_available_controllers</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">controller_type</span> <span class="ow">in</span> <span class="n">preferred_types</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">controller_type</span> <span class="ow">in</span> <span class="n">available</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to create </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">continue</span>

    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;None of </span><span class="si">{</span><span class="n">preferred_types</span><span class="si">}</span><span class="s2"> could be created. Available: </span><span class="si">{</span><span class="n">available</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Usage with fallbacks</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">safe_create_controller</span><span class="p">([</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;adaptive_smc&#39;</span><span class="p">])</span>
</pre></div>
</div>
</section>
</section>
<section id="issue-2-controller-class-not-available">
<h3>Issue 2: Controller Class Not Available<a class="headerlink" href="#issue-2-controller-class-not-available" title="Link to this heading">Â¶</a></h3>
<section id="id1">
<h4>Symptoms<a class="headerlink" href="#id1" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ne">ImportError</span><span class="p">:</span> <span class="n">Controller</span> <span class="k">class</span><span class="w"> </span><span class="nc">for</span> <span class="n">mpc_controller</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">available</span>
<span class="ne">ImportError</span><span class="p">:</span> <span class="n">MPC</span> <span class="n">controller</span> <span class="n">missing</span> <span class="n">optional</span> <span class="n">dependency</span>
</pre></div>
</div>
</section>
<section id="id2">
<h4>Root Causes<a class="headerlink" href="#id2" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Missing optional dependencies</strong>: MPC controller requires additional packages</p></li>
<li><p><strong>Import failures</strong>: Module import errors</p></li>
<li><p><strong>Installation issues</strong>: Incomplete package installation</p></li>
</ol>
</section>
<section id="id3">
<h4>Solutions<a class="headerlink" href="#id3" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Check Dependencies</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_controller_dependencies</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check which controllers are available and why others aren&#39;t.&quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">CONTROLLER_REGISTRY</span>

    <span class="k">for</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">CONTROLLER_REGISTRY</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">: Class not available&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">controller_type</span> <span class="o">==</span> <span class="s1">&#39;mpc_controller&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Reason: Optional MPC dependencies not installed&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Solution: pip install control-systems-toolkit&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ… </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">: Available&quot;</span><span class="p">)</span>

<span class="n">check_controller_dependencies</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Solution 2: Install Missing Dependencies</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># For MPC controller</span>
pip<span class="w"> </span>install<span class="w"> </span>control-systems-toolkit
pip<span class="w"> </span>install<span class="w"> </span>cvxopt<span class="w">  </span><span class="c1"># If using optimization-based MPC</span>

<span class="c1"># Verify installation</span>
python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;from src.controllers.mpc.controller import MPCController; print(&#39;MPC available&#39;)&quot;</span>
</pre></div>
</div>
<p><strong>Solution 3: Dynamic Controller Availability</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_controller_with_fallback</span><span class="p">(</span><span class="n">preferred_type</span><span class="p">,</span> <span class="n">fallback_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create controller with automatic fallback.&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">preferred_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: </span><span class="si">{</span><span class="n">preferred_type</span><span class="si">}</span><span class="s2"> not available, using </span><span class="si">{</span><span class="n">fallback_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">fallback_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="c1"># Example: Try MPC, fallback to classical SMC</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller_with_fallback</span><span class="p">(</span>
    <span class="s1">&#39;mpc_controller&#39;</span><span class="p">,</span>
    <span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span>
    <span class="n">gains</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="issue-3-configuration-creation-failures">
<h3>Issue 3: Configuration Creation Failures<a class="headerlink" href="#issue-3-configuration-creation-failures" title="Link to this heading">Â¶</a></h3>
<section id="id4">
<h4>Symptoms<a class="headerlink" href="#id4" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ne">Warning</span><span class="p">:</span> <span class="n">Could</span> <span class="ow">not</span> <span class="n">create</span> <span class="n">full</span> <span class="n">config</span><span class="p">,</span> <span class="n">using</span> <span class="n">minimal</span> <span class="n">config</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="fm">__init__</span><span class="p">()</span> <span class="n">got</span> <span class="n">an</span> <span class="n">unexpected</span> <span class="n">keyword</span> <span class="n">argument</span> <span class="s1">&#39;invalid_param&#39;</span>
</pre></div>
</div>
</section>
<section id="id5">
<h4>Root Causes<a class="headerlink" href="#id5" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Invalid parameters</strong>: Passing unsupported parameters to configuration classes</p></li>
<li><p><strong>Type mismatches</strong>: Wrong parameter types</p></li>
<li><p><strong>Missing required parameters</strong>: Not providing all required configuration values</p></li>
</ol>
</section>
<section id="id6">
<h4>Solutions<a class="headerlink" href="#id6" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Parameter Validation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">validate_controller_parameters</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate parameters before controller creation.&quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">CONTROLLER_REGISTRY</span>

    <span class="n">controller_info</span> <span class="o">=</span> <span class="n">CONTROLLER_REGISTRY</span><span class="p">[</span><span class="n">controller_type</span><span class="p">]</span>
    <span class="n">required_params</span> <span class="o">=</span> <span class="n">controller_info</span><span class="p">[</span><span class="s1">&#39;required_params&#39;</span><span class="p">]</span>

    <span class="c1"># Check required parameters</span>
    <span class="n">missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">required_params</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required parameters: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># Controller-specific validation</span>
    <span class="k">if</span> <span class="n">controller_type</span> <span class="o">==</span> <span class="s1">&#39;classical_smc&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;gains&#39;</span> <span class="ow">in</span> <span class="n">params</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Classical SMC requires exactly 6 gains&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="s1">&#39;boundary_layer&#39;</span> <span class="ow">in</span> <span class="n">params</span> <span class="ow">and</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;boundary_layer&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Boundary layer must be positive&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">elif</span> <span class="n">controller_type</span> <span class="o">==</span> <span class="s1">&#39;mpc_controller&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;horizon&#39;</span> <span class="ow">in</span> <span class="n">params</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;horizon&#39;</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;horizon&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MPC horizon must be positive integer&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>

<span class="c1"># Usage</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;gains&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;max_force&#39;</span><span class="p">:</span> <span class="mf">150.0</span><span class="p">,</span> <span class="s1">&#39;boundary_layer&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">}</span>
<span class="k">if</span> <span class="n">validate_controller_parameters</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
    <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Solution 2: Graceful Parameter Handling</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_controller_robust</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create controller with robust parameter handling.&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Try with provided parameters</span>
        <span class="k">return</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;unexpected keyword argument&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
            <span class="c1"># Extract parameter name from error</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&#39;(\w+)&#39;&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">invalid_param</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing invalid parameter: </span><span class="si">{</span><span class="n">invalid_param</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="c1"># Remove invalid parameter and retry</span>
                <span class="n">filtered_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">invalid_param</span><span class="p">}</span>
                <span class="k">return</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">filtered_kwargs</span><span class="p">)</span>

        <span class="k">raise</span>  <span class="c1"># Re-raise if we can&#39;t handle it</span>

<span class="c1"># Usage</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller_robust</span><span class="p">(</span>
    <span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span>
    <span class="n">gains</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="n">invalid_param</span><span class="o">=</span><span class="s1">&#39;will_be_removed&#39;</span>  <span class="c1"># This will be filtered out</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="pso-integration-problems">
<h2>PSO Integration Problems<a class="headerlink" href="#pso-integration-problems" title="Link to this heading">Â¶</a></h2>
<section id="issue-1-pso-factory-creation-failures">
<h3>Issue 1: PSO Factory Creation Failures<a class="headerlink" href="#issue-1-pso-factory-creation-failures" title="Link to this heading">Â¶</a></h3>
<section id="id7">
<h4>Symptoms<a class="headerlink" href="#id7" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ne">AttributeError</span><span class="p">:</span> <span class="s1">&#39;function&#39;</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">&#39;n_gains&#39;</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="n">create_pso_controller_factory</span><span class="p">()</span> <span class="n">missing</span> <span class="n">required</span> <span class="n">argument</span>
</pre></div>
</div>
</section>
<section id="id8">
<h4>Root Causes<a class="headerlink" href="#id8" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Missing PSO attributes</strong>: Factory function doesnâ€™t have required PSO metadata</p></li>
<li><p><strong>Incorrect factory usage</strong>: Not using PSO-specific factory functions</p></li>
<li><p><strong>Parameter mismatches</strong>: Wrong parameters for PSO integration</p></li>
</ol>
</section>
<section id="id9">
<h4>Solutions<a class="headerlink" href="#id9" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Verify PSO Factory Attributes</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_pso_controller_factory</span><span class="p">,</span> <span class="n">SMCType</span>

<span class="k">def</span><span class="w"> </span><span class="nf">verify_pso_factory</span><span class="p">(</span><span class="n">smc_type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Verify PSO factory has required attributes.&quot;&quot;&quot;</span>

    <span class="n">factory</span> <span class="o">=</span> <span class="n">create_pso_controller_factory</span><span class="p">(</span><span class="n">smc_type</span><span class="p">)</span>

    <span class="n">required_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;n_gains&#39;</span><span class="p">,</span> <span class="s1">&#39;controller_type&#39;</span><span class="p">,</span> <span class="s1">&#39;max_force&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">required_attributes</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">factory</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ Missing attribute: </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">factory</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ… </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">True</span>

<span class="c1"># Test factory</span>
<span class="k">if</span> <span class="n">verify_pso_factory</span><span class="p">(</span><span class="n">SMCType</span><span class="o">.</span><span class="n">CLASSICAL</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PSO factory is properly configured&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Solution 2: Debug Factory Creation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">debug_pso_factory_creation</span><span class="p">(</span><span class="n">smc_type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Debug PSO factory creation step by step.&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating PSO factory for </span><span class="si">{</span><span class="n">smc_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Step 1: Check controller availability</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">list_available_controllers</span>
        <span class="n">available</span> <span class="o">=</span> <span class="n">list_available_controllers</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">smc_type</span><span class="o">.</span><span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">available</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ Controller </span><span class="si">{</span><span class="n">smc_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> not available&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Step 2: Create factory</span>
        <span class="n">factory</span> <span class="o">=</span> <span class="n">create_pso_controller_factory</span><span class="p">(</span><span class="n">smc_type</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ… Factory created successfully&quot;</span><span class="p">)</span>

        <span class="c1"># Step 3: Test factory attributes</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   n_gains: </span><span class="si">{</span><span class="n">factory</span><span class="o">.</span><span class="n">n_gains</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   controller_type: </span><span class="si">{</span><span class="n">factory</span><span class="o">.</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   max_force: </span><span class="si">{</span><span class="n">factory</span><span class="o">.</span><span class="n">max_force</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Step 4: Test factory function</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_default_gains</span>
        <span class="n">test_gains</span> <span class="o">=</span> <span class="n">get_default_gains</span><span class="p">(</span><span class="n">smc_type</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">controller</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="n">test_gains</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ… Factory function works&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">factory</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ Factory creation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>
        <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="c1"># Debug factory creation</span>
<span class="n">factory</span> <span class="o">=</span> <span class="n">debug_pso_factory_creation</span><span class="p">(</span><span class="n">SMCType</span><span class="o">.</span><span class="n">CLASSICAL</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="issue-2-gain-validation-failures">
<h3>Issue 2: Gain Validation Failures<a class="headerlink" href="#issue-2-gain-validation-failures" title="Link to this heading">Â¶</a></h3>
<section id="id10">
<h4>Symptoms<a class="headerlink" href="#id10" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">All</span> <span class="n">PSO</span> <span class="n">particles</span> <span class="n">marked</span> <span class="k">as</span> <span class="n">invalid</span>
<span class="n">validate_smc_gains</span> <span class="n">returns</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">valid</span><span class="o">-</span><span class="n">looking</span> <span class="n">gains</span>
</pre></div>
</div>
</section>
<section id="id11">
<h4>Root Causes<a class="headerlink" href="#id11" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Incorrect gain bounds</strong>: Using bounds that donâ€™t match controller requirements</p></li>
<li><p><strong>Type issues</strong>: Passing wrong data types to validation</p></li>
<li><p><strong>Numerical precision</strong>: Floating-point precision causing validation failures</p></li>
</ol>
</section>
<section id="id12">
<h4>Solutions<a class="headerlink" href="#id12" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Debug Gain Validation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">validate_smc_gains</span><span class="p">,</span> <span class="n">get_gain_bounds_for_pso</span><span class="p">,</span> <span class="n">SMCType</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">debug_gain_validation</span><span class="p">(</span><span class="n">smc_type</span><span class="p">,</span> <span class="n">gains</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Debug gain validation step by step.&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validating gains for </span><span class="si">{</span><span class="n">smc_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">gains</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Step 1: Check gain count</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_expected_gain_count</span>
    <span class="n">expected_count</span> <span class="o">=</span> <span class="n">get_expected_gain_count</span><span class="p">(</span><span class="n">smc_type</span><span class="p">)</span>
    <span class="n">actual_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gain count: expected </span><span class="si">{</span><span class="n">expected_count</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">actual_count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">actual_count</span> <span class="o">!=</span> <span class="n">expected_count</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ Wrong gain count&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># Step 2: Check gain types</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">gain</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gains</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gain</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ Gain </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> has wrong type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">gain</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">gain</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ Gain </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> is not finite: </span><span class="si">{</span><span class="n">gain</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">gain</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ Gain </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> is not positive: </span><span class="si">{</span><span class="n">gain</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ… All validation checks passed&quot;</span><span class="p">)</span>

    <span class="c1"># Step 3: Check against bounds</span>
    <span class="n">lower_bounds</span><span class="p">,</span> <span class="n">upper_bounds</span> <span class="o">=</span> <span class="n">get_gain_bounds_for_pso</span><span class="p">(</span><span class="n">smc_type</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">gain</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="n">lower_bounds</span><span class="p">,</span> <span class="n">upper_bounds</span><span class="p">)):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lower</span> <span class="o">&lt;=</span> <span class="n">gain</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âš ï¸  Gain </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> outside recommended bounds: </span><span class="si">{</span><span class="n">gain</span><span class="si">}</span><span class="s2"> not in [</span><span class="si">{</span><span class="n">lower</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">upper</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">True</span>

<span class="c1"># Test validation</span>
<span class="n">test_gains</span> <span class="o">=</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
<span class="n">debug_gain_validation</span><span class="p">(</span><span class="n">SMCType</span><span class="o">.</span><span class="n">CLASSICAL</span><span class="p">,</span> <span class="n">test_gains</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Solution 2: Fix Common Validation Issues</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fix_common_gain_issues</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="n">smc_type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fix common gain validation issues.&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

    <span class="c1"># Convert to list if numpy array</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">gains</span> <span class="o">=</span> <span class="n">gains</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1"># Ensure all gains are float</span>
    <span class="n">gains</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gains</span><span class="p">]</span>

    <span class="c1"># Clamp to valid range</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">gain</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">gains</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">gain</span><span class="p">):</span>
            <span class="n">gains</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Default for invalid values</span>
        <span class="k">elif</span> <span class="n">gain</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">gains</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Minimum positive value</span>
        <span class="k">elif</span> <span class="n">gain</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="n">gains</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.0</span>  <span class="c1"># Maximum reasonable value</span>

    <span class="c1"># Ensure correct count</span>
    <span class="n">expected_count</span> <span class="o">=</span> <span class="n">get_expected_gain_count</span><span class="p">(</span><span class="n">smc_type</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">expected_count</span><span class="p">:</span>
        <span class="c1"># Pad with defaults</span>
        <span class="n">default_gains</span> <span class="o">=</span> <span class="n">get_default_gains</span><span class="p">(</span><span class="n">smc_type</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">gains</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">default_gains</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">gains</span><span class="p">):])</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">expected_count</span><span class="p">:</span>
        <span class="c1"># Truncate</span>
        <span class="n">gains</span> <span class="o">=</span> <span class="n">gains</span><span class="p">[:</span><span class="n">expected_count</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">gains</span>

<span class="c1"># Usage in PSO fitness function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">robust_fitness_function</span><span class="p">(</span><span class="n">gains</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PSO fitness function with gain fixing.&quot;&quot;&quot;</span>

    <span class="c1"># Fix common issues</span>
    <span class="n">fixed_gains</span> <span class="o">=</span> <span class="n">fix_common_gain_issues</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="n">SMCType</span><span class="o">.</span><span class="n">CLASSICAL</span><span class="p">)</span>

    <span class="c1"># Validate</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">validate_smc_gains</span><span class="p">(</span><span class="n">SMCType</span><span class="o">.</span><span class="n">CLASSICAL</span><span class="p">,</span> <span class="n">fixed_gains</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

    <span class="c1"># Create controller</span>
    <span class="n">factory</span> <span class="o">=</span> <span class="n">create_pso_controller_factory</span><span class="p">(</span><span class="n">SMCType</span><span class="o">.</span><span class="n">CLASSICAL</span><span class="p">)</span>
    <span class="n">controller</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="n">fixed_gains</span><span class="p">)</span>

    <span class="c1"># Evaluate performance</span>
    <span class="k">return</span> <span class="n">evaluate_controller_performance</span><span class="p">(</span><span class="n">controller</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="issue-3-pso-performance-problems">
<h3>Issue 3: PSO Performance Problems<a class="headerlink" href="#issue-3-pso-performance-problems" title="Link to this heading">Â¶</a></h3>
<section id="id13">
<h4>Symptoms<a class="headerlink" href="#id13" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">PSO</span> <span class="n">optimization</span> <span class="n">extremely</span> <span class="n">slow</span>
<span class="n">High</span> <span class="n">memory</span> <span class="n">usage</span> <span class="n">during</span> <span class="n">PSO</span>
<span class="n">PSO</span> <span class="n">doesn</span><span class="s1">&#39;t converge</span>
</pre></div>
</div>
</section>
<section id="id14">
<h4>Root Causes<a class="headerlink" href="#id14" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Factory recreation overhead</strong>: Creating factory in fitness function</p></li>
<li><p><strong>Memory leaks</strong>: Not properly cleaning up controllers</p></li>
<li><p><strong>Inefficient evaluation</strong>: Complex performance evaluation</p></li>
<li><p><strong>Poor PSO parameters</strong>: Suboptimal PSO configuration</p></li>
</ol>
</section>
<section id="id15">
<h4>Solutions<a class="headerlink" href="#id15" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Optimize PSO Performance</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">OptimizedPSOWorkflow</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optimized PSO workflow for maximum performance.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">smc_type</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smc_type</span> <span class="o">=</span> <span class="n">smc_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>

        <span class="c1"># Create factory once (expensive operation)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory</span> <span class="o">=</span> <span class="n">create_pso_controller_factory</span><span class="p">(</span><span class="n">smc_type</span><span class="p">,</span> <span class="n">plant_config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

        <span class="c1"># Pre-compute test scenarios</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_scenarios</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_test_scenarios</span><span class="p">()</span>

        <span class="c1"># Performance monitoring</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation_times</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate_test_scenarios</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pre-generate test scenarios for consistent evaluation.&quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

        <span class="n">scenarios</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Standard test points</span>
        <span class="n">test_states</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>  <span class="c1"># Small angle</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>   <span class="c1"># Medium angle</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>   <span class="c1"># Cart displacement</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">test_states</span><span class="p">:</span>
            <span class="n">scenarios</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;initial_state&#39;</span><span class="p">:</span> <span class="n">state</span><span class="p">,</span>
                <span class="s1">&#39;simulation_time&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;target_state&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
            <span class="p">})</span>

        <span class="k">return</span> <span class="n">scenarios</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fast_fitness_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gains</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Optimized fitness function for PSO.&quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Quick validation</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">validate_smc_gains</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smc_type</span><span class="p">,</span> <span class="n">gains</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

            <span class="c1"># Create controller (fast operation with pre-created factory)</span>
            <span class="n">controller</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span>

            <span class="c1"># Fast performance evaluation</span>
            <span class="n">total_cost</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_scenarios</span><span class="p">:</span>
                <span class="c1"># Simplified simulation</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">scenario</span><span class="p">[</span><span class="s1">&#39;initial_state&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">cost</span> <span class="o">=</span> <span class="mf">0.0</span>

                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>  <span class="c1"># Short simulation steps</span>
                    <span class="n">control_output</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">compute_control</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="n">control_value</span> <span class="o">=</span> <span class="n">control_output</span><span class="o">.</span><span class="n">u</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">control_output</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">control_output</span>

                    <span class="c1"># Simple cost computation</span>
                    <span class="n">state_cost</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">state</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Position and angle errors</span>
                    <span class="n">control_cost</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">control_value</span><span class="o">**</span><span class="mi">2</span>
                    <span class="n">cost</span> <span class="o">+=</span> <span class="n">state_cost</span> <span class="o">+</span> <span class="n">control_cost</span>

                    <span class="c1"># Simple state update (for speed)</span>
                    <span class="n">state</span> <span class="o">+=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># Simplified dynamics</span>

                <span class="n">total_cost</span> <span class="o">+=</span> <span class="n">cost</span>

            <span class="c1"># Performance monitoring</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evaluation_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evaluation_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elapsed</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation_count</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">avg_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluation_times</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:])</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Evaluation </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">evaluation_count</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">avg_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s avg&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">total_cost</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_optimization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run optimized PSO.&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">src.optimization.algorithms.pso_optimizer</span><span class="w"> </span><span class="kn">import</span> <span class="n">PSOTuner</span>

        <span class="c1"># Optimized PSO parameters</span>
        <span class="n">pso_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;n_particles&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>      <span class="c1"># Smaller swarm for speed</span>
            <span class="s1">&#39;max_iter&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>         <span class="c1"># Fewer iterations</span>
            <span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
            <span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;c2&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;early_stopping&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;patience&#39;</span><span class="p">:</span> <span class="mi">10</span>
        <span class="p">}</span>

        <span class="n">tuner</span> <span class="o">=</span> <span class="n">PSOTuner</span><span class="p">(</span>
            <span class="n">controller_factory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fast_fitness_function</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span>
            <span class="o">**</span><span class="n">pso_config</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">tuner</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span>

<span class="c1"># Usage</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">OptimizedPSOWorkflow</span><span class="p">(</span><span class="n">SMCType</span><span class="o">.</span><span class="n">CLASSICAL</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="n">best_gains</span><span class="p">,</span> <span class="n">best_fitness</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">run_optimization</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="configuration-issues">
<h2>Configuration Issues<a class="headerlink" href="#configuration-issues" title="Link to this heading">Â¶</a></h2>
<section id="issue-1-configuration-parameter-conflicts">
<h3>Issue 1: Configuration Parameter Conflicts<a class="headerlink" href="#issue-1-configuration-parameter-conflicts" title="Link to this heading">Â¶</a></h3>
<section id="id16">
<h4>Symptoms<a class="headerlink" href="#id16" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ne">Warning</span><span class="p">:</span> <span class="n">Could</span> <span class="ow">not</span> <span class="n">extract</span> <span class="n">controller</span> <span class="n">parameters</span>
<span class="n">Configuration</span> <span class="n">parameter</span> <span class="s1">&#39;gains&#39;</span> <span class="n">overridden</span> <span class="n">by</span> <span class="n">explicit</span> <span class="n">parameter</span>
<span class="n">Inconsistent</span> <span class="n">parameter</span> <span class="n">values</span> <span class="n">between</span> <span class="n">config</span> <span class="n">sources</span>
</pre></div>
</div>
</section>
<section id="id17">
<h4>Root Causes<a class="headerlink" href="#id17" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Multiple configuration sources</strong>: Conflicting values from different sources</p></li>
<li><p><strong>Parameter priority confusion</strong>: Not understanding resolution order</p></li>
<li><p><strong>Deprecated parameters</strong>: Using old parameter names</p></li>
</ol>
</section>
<section id="id18">
<h4>Solutions<a class="headerlink" href="#id18" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Configuration Priority Debugging</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">debug_configuration_priority</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Debug configuration parameter resolution.&quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Configuration priority debug for </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameters provided:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  gains: </span><span class="si">{</span><span class="n">gains</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  config: </span><span class="si">{</span><span class="n">config</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  kwargs: </span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># Priority 1: Explicit gains</span>
    <span class="k">if</span> <span class="n">gains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ… Priority 1 - Explicit gains: </span><span class="si">{</span><span class="n">gains</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">final_gains</span> <span class="o">=</span> <span class="n">gains</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Priority 2: Configuration object</span>
        <span class="n">config_gains</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Try different config structures</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s1">&#39;controllers&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">controller_type</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">controllers</span><span class="p">:</span>
                    <span class="n">controller_config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">controllers</span><span class="p">[</span><span class="n">controller_type</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller_config</span><span class="p">,</span> <span class="s1">&#39;gains&#39;</span><span class="p">):</span>
                        <span class="n">config_gains</span> <span class="o">=</span> <span class="n">controller_config</span><span class="o">.</span><span class="n">gains</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ… Priority 2 - Config gains: </span><span class="si">{</span><span class="n">config_gains</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ Config extraction failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">config_gains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">final_gains</span> <span class="o">=</span> <span class="n">config_gains</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Priority 3: Registry defaults</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_default_gains</span>
            <span class="n">default_gains</span> <span class="o">=</span> <span class="n">get_default_gains</span><span class="p">(</span><span class="n">controller_type</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ… Priority 3 - Default gains: </span><span class="si">{</span><span class="n">default_gains</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">final_gains</span> <span class="o">=</span> <span class="n">default_gains</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Final gains: </span><span class="si">{</span><span class="n">final_gains</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_gains</span>

<span class="c1"># Test configuration priority</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_config</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span>

<span class="n">gains</span> <span class="o">=</span> <span class="n">debug_configuration_priority</span><span class="p">(</span>
    <span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span>
    <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
    <span class="n">gains</span><span class="o">=</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>  <span class="c1"># Should override config</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Solution 2: Configuration Validation and Cleanup</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">validate_and_clean_config</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate and clean configuration object.&quot;&quot;&quot;</span>

    <span class="n">cleaned_config</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Extract controller-specific configuration</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s1">&#39;controllers&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">controller_type</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">controllers</span><span class="p">:</span>
            <span class="n">controller_config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">controllers</span><span class="p">[</span><span class="n">controller_type</span><span class="p">]</span>

            <span class="c1"># Handle different config types</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller_config</span><span class="p">,</span> <span class="s1">&#39;model_dump&#39;</span><span class="p">):</span>
                <span class="c1"># Pydantic model</span>
                <span class="n">cleaned_config</span> <span class="o">=</span> <span class="n">controller_config</span><span class="o">.</span><span class="n">model_dump</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">controller_config</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="c1"># Dictionary</span>
                <span class="n">cleaned_config</span> <span class="o">=</span> <span class="n">controller_config</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Object with attributes</span>
                <span class="n">cleaned_config</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">attr</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">controller_config</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">controller_config</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">controller_config</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
                <span class="p">}</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Config extraction failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Validate parameters</span>
    <span class="k">if</span> <span class="s1">&#39;gains&#39;</span> <span class="ow">in</span> <span class="n">cleaned_config</span><span class="p">:</span>
        <span class="n">gains</span> <span class="o">=</span> <span class="n">cleaned_config</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Invalid gains format&quot;</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">cleaned_config</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="s1">&#39;max_force&#39;</span> <span class="ow">in</span> <span class="n">cleaned_config</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cleaned_config</span><span class="p">[</span><span class="s1">&#39;max_force&#39;</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">or</span> <span class="n">cleaned_config</span><span class="p">[</span><span class="s1">&#39;max_force&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Invalid max_force value&quot;</span><span class="p">)</span>
            <span class="n">cleaned_config</span><span class="p">[</span><span class="s1">&#39;max_force&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">150.0</span>  <span class="c1"># Default</span>

    <span class="c1"># Handle deprecated parameters</span>
    <span class="n">deprecated_mappings</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;use_equivalent&#39;</span><span class="p">:</span> <span class="s1">&#39;enable_equivalent_control&#39;</span><span class="p">,</span>
        <span class="s1">&#39;k_gain&#39;</span><span class="p">:</span> <span class="s1">&#39;switching_gain&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lambda_gains&#39;</span><span class="p">:</span> <span class="s1">&#39;surface_gains&#39;</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">old_param</span><span class="p">,</span> <span class="n">new_param</span> <span class="ow">in</span> <span class="n">deprecated_mappings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">old_param</span> <span class="ow">in</span> <span class="n">cleaned_config</span><span class="p">:</span>
            <span class="n">cleaned_config</span><span class="p">[</span><span class="n">new_param</span><span class="p">]</span> <span class="o">=</span> <span class="n">cleaned_config</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">old_param</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deprecated parameter &#39;</span><span class="si">{</span><span class="n">old_param</span><span class="si">}</span><span class="s2">&#39; migrated to &#39;</span><span class="si">{</span><span class="n">new_param</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">warnings</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Configuration warnings:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">warning</span> <span class="ow">in</span> <span class="n">warnings</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âš ï¸  </span><span class="si">{</span><span class="n">warning</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cleaned_config</span>

<span class="c1"># Usage</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span>
<span class="n">cleaned</span> <span class="o">=</span> <span class="n">validate_and_clean_config</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">cleaned</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="issue-2-yaml-configuration-errors">
<h3>Issue 2: YAML Configuration Errors<a class="headerlink" href="#issue-2-yaml-configuration-errors" title="Link to this heading">Â¶</a></h3>
<section id="id19">
<h4>Symptoms<a class="headerlink" href="#id19" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">yaml</span><span class="o">.</span><span class="n">scanner</span><span class="o">.</span><span class="n">ScannerError</span><span class="p">:</span> <span class="n">mapping</span> <span class="n">values</span> <span class="n">are</span> <span class="ow">not</span> <span class="n">allowed</span> <span class="n">here</span>
<span class="ne">KeyError</span><span class="p">:</span> <span class="s1">&#39;controllers&#39;</span> <span class="ow">not</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">configuration</span>
<span class="n">Pydantic</span> <span class="n">validation</span> <span class="n">error</span> <span class="k">for</span> <span class="n">configuration</span>
</pre></div>
</div>
</section>
<section id="id20">
<h4>Root Causes<a class="headerlink" href="#id20" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>YAML syntax errors</strong>: Invalid YAML formatting</p></li>
<li><p><strong>Missing configuration sections</strong>: Required sections not present</p></li>
<li><p><strong>Type mismatches</strong>: Wrong data types in configuration</p></li>
</ol>
</section>
<section id="id21">
<h4>Solutions<a class="headerlink" href="#id21" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Configuration Validation Tool</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">validate_yaml_configuration</span><span class="p">(</span><span class="n">config_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate YAML configuration file.&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validating configuration: </span><span class="si">{</span><span class="n">config_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Check file exists</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ Configuration file not found: </span><span class="si">{</span><span class="n">config_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># Check YAML syntax</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">config_data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ… YAML syntax valid&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">yaml</span><span class="o">.</span><span class="n">YAMLError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ YAML syntax error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># Check required sections</span>
    <span class="n">required_sections</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;controllers&#39;</span><span class="p">,</span> <span class="s1">&#39;physics&#39;</span><span class="p">,</span> <span class="s1">&#39;simulation&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">required_sections</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">section</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">config_data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âš ï¸  Missing section: </span><span class="si">{</span><span class="n">section</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ… Section found: </span><span class="si">{</span><span class="n">section</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Check controller configurations</span>
    <span class="k">if</span> <span class="s1">&#39;controllers&#39;</span> <span class="ow">in</span> <span class="n">config_data</span><span class="p">:</span>
        <span class="n">controllers</span> <span class="o">=</span> <span class="n">config_data</span><span class="p">[</span><span class="s1">&#39;controllers&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">controller_config</span> <span class="ow">in</span> <span class="n">controllers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Validating </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>

            <span class="c1"># Check gains</span>
            <span class="k">if</span> <span class="s1">&#39;gains&#39;</span> <span class="ow">in</span> <span class="n">controller_config</span><span class="p">:</span>
                <span class="n">gains</span> <span class="o">=</span> <span class="n">controller_config</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âŒ gains must be a list, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âŒ gains list is empty&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âœ… gains: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span><span class="si">}</span><span class="s2"> values&quot;</span><span class="p">)</span>

            <span class="c1"># Check numeric parameters</span>
            <span class="n">numeric_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;max_force&#39;</span><span class="p">,</span> <span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="s1">&#39;boundary_layer&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">numeric_params</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">controller_config</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">controller_config</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âŒ </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> must be numeric, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âŒ </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2"> must be positive, got </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âœ… </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">True</span>

<span class="c1"># Validate configuration</span>
<span class="n">validate_yaml_configuration</span><span class="p">(</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Solution 2: Configuration Fix Tool</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fix_configuration_file</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="n">backup</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fix common configuration file issues.&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

    <span class="n">config_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">backup</span><span class="p">:</span>
        <span class="n">backup_file</span> <span class="o">=</span> <span class="n">config_file</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.yaml.backup&#39;</span><span class="p">)</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="n">backup_file</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created backup: </span><span class="si">{</span><span class="n">backup_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Load current configuration</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">config_data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">fixes_applied</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Fix 1: Ensure required sections exist</span>
    <span class="n">required_sections</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;controllers&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;physics&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;m1&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;m2&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;l1&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
            <span class="s1">&#39;b1&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;I1&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;I2&#39;</span><span class="p">:</span> <span class="mf">0.1</span>
        <span class="p">},</span>
        <span class="s1">&#39;simulation&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span>
            <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="mf">0.001</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">section</span><span class="p">,</span> <span class="n">defaults</span> <span class="ow">in</span> <span class="n">required_sections</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">section</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">config_data</span><span class="p">:</span>
            <span class="n">config_data</span><span class="p">[</span><span class="n">section</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaults</span>
            <span class="n">fixes_applied</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added missing section: </span><span class="si">{</span><span class="n">section</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Fix 2: Ensure controller defaults</span>
    <span class="n">controller_defaults</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;classical_smc&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;gains&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
            <span class="s1">&#39;max_force&#39;</span><span class="p">:</span> <span class="mf">150.0</span><span class="p">,</span>
            <span class="s1">&#39;boundary_layer&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>
            <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="mf">0.001</span>
        <span class="p">},</span>
        <span class="s1">&#39;adaptive_smc&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;gains&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">25.0</span><span class="p">,</span> <span class="mf">18.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span>
            <span class="s1">&#39;max_force&#39;</span><span class="p">:</span> <span class="mf">150.0</span><span class="p">,</span>
            <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="mf">0.001</span>
        <span class="p">},</span>
        <span class="s1">&#39;sta_smc&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;gains&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">25.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">],</span>
            <span class="s1">&#39;max_force&#39;</span><span class="p">:</span> <span class="mf">150.0</span><span class="p">,</span>
            <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="mf">0.001</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">defaults</span> <span class="ow">in</span> <span class="n">controller_defaults</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">controller_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">config_data</span><span class="p">[</span><span class="s1">&#39;controllers&#39;</span><span class="p">]:</span>
            <span class="n">config_data</span><span class="p">[</span><span class="s1">&#39;controllers&#39;</span><span class="p">][</span><span class="n">controller_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaults</span>
            <span class="n">fixes_applied</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added controller defaults: </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Fix missing parameters</span>
            <span class="n">controller_config</span> <span class="o">=</span> <span class="n">config_data</span><span class="p">[</span><span class="s1">&#39;controllers&#39;</span><span class="p">][</span><span class="n">controller_type</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">default_value</span> <span class="ow">in</span> <span class="n">defaults</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">controller_config</span><span class="p">:</span>
                    <span class="n">controller_config</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_value</span>
                    <span class="n">fixes_applied</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added missing parameter </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Fix 3: Validate and fix data types</span>
    <span class="k">for</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">controller_config</span> <span class="ow">in</span> <span class="n">config_data</span><span class="p">[</span><span class="s1">&#39;controllers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="s1">&#39;gains&#39;</span> <span class="ow">in</span> <span class="n">controller_config</span><span class="p">:</span>
            <span class="n">gains</span> <span class="o">=</span> <span class="n">controller_config</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="c1"># Try to convert to list</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">controller_config</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span>
                    <span class="n">fixes_applied</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Converted </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">.gains to list&quot;</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">controller_config</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">controller_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gains&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">])</span>
                    <span class="n">fixes_applied</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reset invalid </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">.gains&quot;</span><span class="p">)</span>

    <span class="c1"># Write fixed configuration</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">config_data</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fixes_applied</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fixes applied:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">fix</span> <span class="ow">in</span> <span class="n">fixes_applied</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âœ… </span><span class="si">{</span><span class="n">fix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No fixes needed&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">fixes_applied</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="c1"># Fix configuration file</span>
<span class="n">fix_configuration_file</span><span class="p">(</span><span class="s2">&quot;config.yaml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="performance-problems">
<h2>Performance Problems<a class="headerlink" href="#performance-problems" title="Link to this heading">Â¶</a></h2>
<section id="issue-1-slow-controller-creation">
<h3>Issue 1: Slow Controller Creation<a class="headerlink" href="#issue-1-slow-controller-creation" title="Link to this heading">Â¶</a></h3>
<section id="id22">
<h4>Symptoms<a class="headerlink" href="#id22" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Controller</span> <span class="n">creation</span> <span class="n">takes</span> <span class="o">&gt;</span><span class="mi">1</span> <span class="n">second</span>
<span class="n">High</span> <span class="n">CPU</span> <span class="n">usage</span> <span class="n">during</span> <span class="n">factory</span> <span class="n">operations</span>
<span class="n">Memory</span> <span class="n">usage</span> <span class="n">grows</span> <span class="k">with</span> <span class="n">each</span> <span class="n">controller</span> <span class="n">creation</span>
</pre></div>
</div>
</section>
<section id="id23">
<h4>Root Causes<a class="headerlink" href="#id23" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Configuration overhead</strong>: Complex configuration processing</p></li>
<li><p><strong>Import delays</strong>: Slow module imports</p></li>
<li><p><strong>Memory allocation</strong>: Large object creation</p></li>
<li><p><strong>Thread contention</strong>: Multiple threads creating controllers</p></li>
</ol>
</section>
<section id="id24">
<h4>Solutions<a class="headerlink" href="#id24" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Performance Profiling</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">profile_controller_creation</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Profile controller creation performance.&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

    <span class="n">process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span>

    <span class="c1"># Warmup</span>
    <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">)</span>

    <span class="c1"># Measure performance</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">memory_usage</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">):</span>
        <span class="c1"># Measure memory before</span>
        <span class="n">mem_before</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>  <span class="c1"># MB</span>

        <span class="c1"># Time controller creation</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">)</span>
        <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="c1"># Measure memory after</span>
        <span class="n">mem_after</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>  <span class="c1"># MB</span>

        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>
        <span class="n">memory_usage</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mem_after</span> <span class="o">-</span> <span class="n">mem_before</span><span class="p">)</span>

        <span class="c1"># Cleanup</span>
        <span class="k">del</span> <span class="n">controller</span>

    <span class="c1"># Analysis</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Performance Profile for </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Iterations: </span><span class="si">{</span><span class="n">n_iterations</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Average time: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">times</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Std deviation: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">times</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Min time: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">times</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Max time: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">times</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Average memory per creation: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">memory_usage</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">MB&quot;</span><span class="p">)</span>

    <span class="c1"># Performance thresholds</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âš ï¸  Controller creation is slow (&gt;0.1s)&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">memory_usage</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âš ï¸  High memory usage per controller (&gt;10MB)&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;mean_time&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">times</span><span class="p">),</span>
        <span class="s1">&#39;std_time&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">times</span><span class="p">),</span>
        <span class="s1">&#39;mean_memory&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">memory_usage</span><span class="p">)</span>
    <span class="p">}</span>

<span class="c1"># Profile different controllers</span>
<span class="k">for</span> <span class="n">controller_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;adaptive_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;sta_smc&#39;</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">profile_controller_creation</span><span class="p">(</span><span class="n">controller_type</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Profiling failed for </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Solution 2: Performance Optimization</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">OptimizedControllerFactory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optimized controller factory with caching and pooling.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_controller_pool</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pool_size</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_cached_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">config_key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get cached configuration to avoid repeated processing.&quot;&quot;&quot;</span>

        <span class="n">cache_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">config_key</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_cache</span><span class="p">:</span>
            <span class="c1"># Create and cache configuration</span>
            <span class="k">if</span> <span class="n">config_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Use defaults</span>
                <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_default_gains</span>
                <span class="n">gains</span> <span class="o">=</span> <span class="n">get_default_gains</span><span class="p">(</span><span class="n">controller_type</span><span class="p">)</span>
                <span class="n">config_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_minimal_config</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">gains</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Process provided configuration</span>
                <span class="n">config_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_config</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">config_key</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_config_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">config_obj</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_minimal_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">gains</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create minimal configuration object.&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">CONTROLLER_REGISTRY</span>

        <span class="n">controller_info</span> <span class="o">=</span> <span class="n">CONTROLLER_REGISTRY</span><span class="p">[</span><span class="n">controller_type</span><span class="p">]</span>
        <span class="n">config_class</span> <span class="o">=</span> <span class="n">controller_info</span><span class="p">[</span><span class="s1">&#39;config_class&#39;</span><span class="p">]</span>

        <span class="c1"># Minimal required parameters</span>
        <span class="k">if</span> <span class="n">controller_type</span> <span class="o">==</span> <span class="s1">&#39;classical_smc&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">config_class</span><span class="p">(</span>
                <span class="n">gains</span><span class="o">=</span><span class="n">gains</span><span class="p">,</span>
                <span class="n">max_force</span><span class="o">=</span><span class="mf">150.0</span><span class="p">,</span>
                <span class="n">boundary_layer</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
                <span class="n">dt</span><span class="o">=</span><span class="mf">0.001</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">controller_type</span> <span class="o">==</span> <span class="s1">&#39;adaptive_smc&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">config_class</span><span class="p">(</span>
                <span class="n">gains</span><span class="o">=</span><span class="n">gains</span><span class="p">,</span>
                <span class="n">max_force</span><span class="o">=</span><span class="mf">150.0</span><span class="p">,</span>
                <span class="n">dt</span><span class="o">=</span><span class="mf">0.001</span>
            <span class="p">)</span>
        <span class="c1"># ... other controller types</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_optimized_controller</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">gains</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create controller with optimization.&quot;&quot;&quot;</span>

        <span class="c1"># Use pooling for identical configurations</span>
        <span class="n">pool_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span> <span class="k">if</span> <span class="n">gains</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pool_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_controller_pool</span><span class="p">:</span>
            <span class="c1"># Reuse existing controller</span>
            <span class="n">controller</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_controller_pool</span><span class="p">[</span><span class="n">pool_key</span><span class="p">]</span>
            <span class="n">controller</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>  <span class="c1"># Reset state</span>
            <span class="k">return</span> <span class="n">controller</span>

        <span class="c1"># Create new controller</span>
        <span class="k">if</span> <span class="n">gains</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">gains</span><span class="o">=</span><span class="n">gains</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>

        <span class="c1"># Add to pool if space available</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_controller_pool</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pool_size</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_controller_pool</span><span class="p">[</span><span class="n">pool_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">controller</span>

        <span class="k">return</span> <span class="n">controller</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear all caches to free memory.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_config_cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_controller_pool</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

<span class="c1"># Usage</span>
<span class="n">factory</span> <span class="o">=</span> <span class="n">OptimizedControllerFactory</span><span class="p">()</span>

<span class="c1"># Create controllers efficiently</span>
<span class="n">controllers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">gains</span> <span class="o">=</span> <span class="p">[</span><span class="mf">20.0</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
    <span class="n">controller</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">create_optimized_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="n">gains</span><span class="o">=</span><span class="n">gains</span><span class="p">)</span>
    <span class="n">controllers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">controller</span><span class="p">)</span>

<span class="c1"># Cleanup</span>
<span class="n">factory</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="issue-2-memory-leaks">
<h3>Issue 2: Memory Leaks<a class="headerlink" href="#issue-2-memory-leaks" title="Link to this heading">Â¶</a></h3>
<section id="id25">
<h4>Symptoms<a class="headerlink" href="#id25" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Memory</span> <span class="n">usage</span> <span class="n">continuously</span> <span class="n">grows</span>
<span class="s2">&quot;Out of memory&quot;</span> <span class="n">errors</span> <span class="n">during</span> <span class="n">long</span> <span class="n">PSO</span> <span class="n">runs</span>
<span class="n">Python</span> <span class="n">process</span> <span class="ow">not</span> <span class="n">releasing</span> <span class="n">memory</span>
</pre></div>
</div>
</section>
<section id="id26">
<h4>Root Causes<a class="headerlink" href="#id26" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Controller references</strong>: Not properly releasing controller objects</p></li>
<li><p><strong>Configuration caching</strong>: Unlimited cache growth</p></li>
<li><p><strong>Circular references</strong>: Python garbage collection issues</p></li>
</ol>
</section>
<section id="id27">
<h4>Solutions<a class="headerlink" href="#id27" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Memory Monitoring</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MemoryMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monitor memory usage during controller operations.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseline_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peak_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_memory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_memory_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current memory usage in MB.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">memory_info</span><span class="p">()</span><span class="o">.</span><span class="n">rss</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">record_measurement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operation_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Record memory measurement.&quot;&quot;&quot;</span>
        <span class="n">current_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peak_memory</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_memory</span><span class="p">,</span> <span class="n">current_memory</span><span class="p">)</span>

        <span class="n">measurement</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;operation&#39;</span><span class="p">:</span> <span class="n">operation_name</span><span class="p">,</span>
            <span class="s1">&#39;memory_mb&#39;</span><span class="p">:</span> <span class="n">current_memory</span><span class="p">,</span>
            <span class="s1">&#39;delta_mb&#39;</span><span class="p">:</span> <span class="n">current_memory</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_memory</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">measurement</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">measurement</span><span class="p">[</span><span class="s1">&#39;delta_mb&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>  <span class="c1"># Alert if &gt;100MB growth</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âš ï¸  Memory alert: </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">current_memory</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">MB (+</span><span class="si">{</span><span class="n">measurement</span><span class="p">[</span><span class="s1">&#39;delta_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">MB)&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print memory usage summary.&quot;&quot;&quot;</span>
        <span class="n">current_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_memory_usage</span><span class="p">()</span>
        <span class="n">total_growth</span> <span class="o">=</span> <span class="n">current_memory</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_memory</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory Usage Summary:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Baseline: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_memory</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">MB&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Current: </span><span class="si">{</span><span class="n">current_memory</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">MB&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Peak: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">peak_memory</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">MB&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Total growth: </span><span class="si">{</span><span class="n">total_growth</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">MB&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">total_growth</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âš ï¸  Significant memory growth detected&quot;</span><span class="p">)</span>

<span class="c1"># Usage with memory monitoring</span>
<span class="n">monitor</span> <span class="o">=</span> <span class="n">MemoryMonitor</span><span class="p">()</span>

<span class="c1"># Monitor PSO operation</span>
<span class="n">factory</span> <span class="o">=</span> <span class="n">create_pso_controller_factory</span><span class="p">(</span><span class="n">SMCType</span><span class="o">.</span><span class="n">CLASSICAL</span><span class="p">)</span>
<span class="n">monitor</span><span class="o">.</span><span class="n">record_measurement</span><span class="p">(</span><span class="s2">&quot;Factory creation&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">gains</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">controller</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">monitor</span><span class="o">.</span><span class="n">record_measurement</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Explicit cleanup</span>
    <span class="k">del</span> <span class="n">controller</span>

<span class="n">monitor</span><span class="o">.</span><span class="n">record_measurement</span><span class="p">(</span><span class="s2">&quot;PSO complete&quot;</span><span class="p">)</span>
<span class="n">monitor</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Solution 2: Explicit Memory Management</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">weakref</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ManagedControllerFactory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Controller factory with explicit memory management.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weak_references</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_creation_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cleanup_threshold</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_managed_controller</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create controller with memory management.&quot;&quot;&quot;</span>

        <span class="c1"># Create controller</span>
        <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Add weak reference for tracking</span>
        <span class="n">weak_ref</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_controller_deleted</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weak_references</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">weak_ref</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_creation_count</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Periodic cleanup</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_creation_count</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cleanup_threshold</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_perform_cleanup</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">controller</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_on_controller_deleted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weak_ref</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Callback when controller is garbage collected.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weak_references</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">weak_ref</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_perform_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform explicit cleanup.&quot;&quot;&quot;</span>

        <span class="c1"># Remove dead weak references</span>
        <span class="n">dead_refs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weak_references</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ref</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">dead_refs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_weak_references</span> <span class="o">-=</span> <span class="n">dead_refs</span>

        <span class="c1"># Force garbage collection</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cleanup: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_weak_references</span><span class="p">)</span><span class="si">}</span><span class="s2"> controllers active, &quot;</span>
              <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_creation_count</span><span class="si">}</span><span class="s2"> total created&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_active_controller_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get number of active controllers.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">([</span><span class="n">ref</span> <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weak_references</span> <span class="k">if</span> <span class="n">ref</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">force_cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Force immediate cleanup.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_perform_cleanup</span><span class="p">()</span>

<span class="c1"># Usage with managed factory</span>
<span class="n">managed_factory</span> <span class="o">=</span> <span class="n">ManagedControllerFactory</span><span class="p">()</span>

<span class="c1"># PSO with memory management</span>
<span class="k">def</span><span class="w"> </span><span class="nf">managed_pso_fitness</span><span class="p">(</span><span class="n">gains</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PSO fitness function with memory management.&quot;&quot;&quot;</span>

    <span class="n">controller</span> <span class="o">=</span> <span class="n">managed_factory</span><span class="o">.</span><span class="n">create_managed_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="n">gains</span><span class="o">=</span><span class="n">gains</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Evaluate controller</span>
        <span class="n">performance</span> <span class="o">=</span> <span class="n">evaluate_controller_performance</span><span class="p">(</span><span class="n">controller</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">performance</span><span class="p">[</span><span class="s1">&#39;total_cost&#39;</span><span class="p">]</span>

    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Explicit cleanup</span>
        <span class="k">del</span> <span class="n">controller</span>

        <span class="c1"># Periodic forced cleanup</span>
        <span class="k">if</span> <span class="n">managed_factory</span><span class="o">.</span><span class="n">_creation_count</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">managed_factory</span><span class="o">.</span><span class="n">force_cleanup</span><span class="p">()</span>

<span class="c1"># Run PSO with memory management</span>
<span class="c1"># ... PSO optimization code</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="import-and-dependency-issues">
<h2>Import and Dependency Issues<a class="headerlink" href="#import-and-dependency-issues" title="Link to this heading">Â¶</a></h2>
<section id="issue-1-missing-module-imports">
<h3>Issue 1: Missing Module Imports<a class="headerlink" href="#issue-1-missing-module-imports" title="Link to this heading">Â¶</a></h3>
<section id="id28">
<h4>Symptoms<a class="headerlink" href="#id28" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ne">ImportError</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="s1">&#39;src.controllers.factory&#39;</span>
<span class="ne">ModuleNotFoundError</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="s1">&#39;control&#39;</span>
<span class="ne">ImportError</span><span class="p">:</span> <span class="n">cannot</span> <span class="kn">import</span><span class="w"> </span><span class="nn">name</span> <span class="s1">&#39;MPCController&#39;</span>
</pre></div>
</div>
</section>
<section id="id29">
<h4>Root Causes<a class="headerlink" href="#id29" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Python path issues</strong>: <code class="docutils literal notranslate"><span class="pre">src</span></code> directory not in Python path</p></li>
<li><p><strong>Missing dependencies</strong>: Required packages not installed</p></li>
<li><p><strong>Circular imports</strong>: Import dependency cycles</p></li>
<li><p><strong>Optional dependencies</strong>: Missing optional packages</p></li>
</ol>
</section>
<section id="id30">
<h4>Solutions<a class="headerlink" href="#id30" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Python Path Management</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fix_python_path</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fix Python path for project imports.&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

    <span class="c1"># Get project root directory</span>
    <span class="n">current_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span>
    <span class="n">project_root</span> <span class="o">=</span> <span class="n">current_dir</span>

    <span class="c1"># Find project root by looking for key files</span>
    <span class="k">while</span> <span class="n">project_root</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="n">project_root</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">project_root</span> <span class="o">/</span> <span class="s1">&#39;src&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="n">project_root</span> <span class="o">/</span> <span class="s1">&#39;config.yaml&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">break</span>
        <span class="n">project_root</span> <span class="o">=</span> <span class="n">project_root</span><span class="o">.</span><span class="n">parent</span>

    <span class="c1"># Add to Python path</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">project_root</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">project_root</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added to Python path: </span><span class="si">{</span><span class="n">project_root</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Verify imports work</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_controller</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ… Factory imports working&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ Import still failing: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="c1"># Fix path before imports</span>
<span class="n">fix_python_path</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Solution 2: Dependency Checker</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">check_dependencies</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check all project dependencies.&quot;&quot;&quot;</span>

    <span class="n">required_packages</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;numpy&#39;</span><span class="p">:</span> <span class="s1">&#39;pip install numpy&#39;</span><span class="p">,</span>
        <span class="s1">&#39;scipy&#39;</span><span class="p">:</span> <span class="s1">&#39;pip install scipy&#39;</span><span class="p">,</span>
        <span class="s1">&#39;matplotlib&#39;</span><span class="p">:</span> <span class="s1">&#39;pip install matplotlib&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pydantic&#39;</span><span class="p">:</span> <span class="s1">&#39;pip install pydantic&#39;</span><span class="p">,</span>
        <span class="s1">&#39;yaml&#39;</span><span class="p">:</span> <span class="s1">&#39;pip install pyyaml&#39;</span><span class="p">,</span>
        <span class="s1">&#39;numba&#39;</span><span class="p">:</span> <span class="s1">&#39;pip install numba&#39;</span>
    <span class="p">}</span>

    <span class="n">optional_packages</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;control&#39;</span><span class="p">:</span> <span class="s1">&#39;pip install control-systems-toolkit (for MPC)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;cvxopt&#39;</span><span class="p">:</span> <span class="s1">&#39;pip install cvxopt (for optimization-based MPC)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;streamlit&#39;</span><span class="p">:</span> <span class="s1">&#39;pip install streamlit (for web interface)&#39;</span>
    <span class="p">}</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Checking required dependencies:&quot;</span><span class="p">)</span>
    <span class="n">missing_required</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">package</span><span class="p">,</span> <span class="n">install_cmd</span> <span class="ow">in</span> <span class="n">required_packages</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">__import__</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âœ… </span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âŒ </span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">install_cmd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">missing_required</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">package</span><span class="p">,</span> <span class="n">install_cmd</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Checking optional dependencies:&quot;</span><span class="p">)</span>
    <span class="n">missing_optional</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">package</span><span class="p">,</span> <span class="n">install_cmd</span> <span class="ow">in</span> <span class="n">optional_packages</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">__import__</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âœ… </span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  âš ï¸  </span><span class="si">{</span><span class="n">package</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">install_cmd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">missing_optional</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">package</span><span class="p">,</span> <span class="n">install_cmd</span><span class="p">))</span>

    <span class="c1"># Installation script</span>
    <span class="k">if</span> <span class="n">missing_required</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">To install missing required packages:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">package</span><span class="p">,</span> <span class="n">install_cmd</span> <span class="ow">in</span> <span class="n">missing_required</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">install_cmd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">missing_optional</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">To install missing optional packages:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">package</span><span class="p">,</span> <span class="n">install_cmd</span> <span class="ow">in</span> <span class="n">missing_optional</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">install_cmd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">missing_required</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>

<span class="c1"># Check dependencies</span>
<span class="n">check_dependencies</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Solution 3: Import Debugging</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">debug_import_issues</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Debug specific import issues.&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Python version: </span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Python path: </span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>  <span class="c1"># Show first 3 entries</span>

    <span class="c1"># Test specific imports</span>
    <span class="n">import_tests</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="s1">&#39;Basic src module&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;src.controllers&#39;</span><span class="p">,</span> <span class="s1">&#39;Controllers module&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;src.controllers.factory&#39;</span><span class="p">,</span> <span class="s1">&#39;Factory module&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;src.config&#39;</span><span class="p">,</span> <span class="s1">&#39;Config module&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;src.optimization.algorithms.pso_optimizer&#39;</span><span class="p">,</span> <span class="s1">&#39;PSO optimizer&#39;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">for</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">description</span> <span class="ow">in</span> <span class="n">import_tests</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">module</span> <span class="o">=</span> <span class="nb">__import__</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">fromlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âœ… </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">module</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Try to give specific help</span>
            <span class="k">if</span> <span class="s1">&#39;src&#39;</span> <span class="ow">in</span> <span class="n">module_name</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Try: sys.path.insert(0, &#39;/path/to/project/root&#39;)&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s1">&#39;mpc&#39;</span> <span class="ow">in</span> <span class="n">module_name</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Try: pip install control-systems-toolkit&quot;</span><span class="p">)</span>

<span class="n">debug_import_issues</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="thread-safety-issues">
<h2>Thread Safety Issues<a class="headerlink" href="#thread-safety-issues" title="Link to this heading">Â¶</a></h2>
<section id="issue-1-factory-lock-timeouts">
<h3>Issue 1: Factory Lock Timeouts<a class="headerlink" href="#issue-1-factory-lock-timeouts" title="Link to this heading">Â¶</a></h3>
<section id="id31">
<h4>Symptoms<a class="headerlink" href="#id31" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ne">RuntimeError</span><span class="p">:</span> <span class="n">Lock</span> <span class="n">timeout</span> <span class="n">exceeded</span> <span class="p">(</span><span class="mf">10.0</span><span class="n">s</span><span class="p">)</span>
<span class="n">Deadlock</span> <span class="n">detected</span> <span class="ow">in</span> <span class="n">factory</span> <span class="n">operations</span>
<span class="n">Concurrent</span> <span class="n">controller</span> <span class="n">creation</span> <span class="n">hanging</span>
</pre></div>
</div>
</section>
<section id="id32">
<h4>Root Causes<a class="headerlink" href="#id32" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Excessive concurrency</strong>: Too many threads creating controllers</p></li>
<li><p><strong>Long-running operations</strong>: Slow operations holding locks</p></li>
<li><p><strong>Nested locking</strong>: Deadlock from recursive calls</p></li>
<li><p><strong>Resource contention</strong>: Limited system resources</p></li>
</ol>
</section>
<section id="id33">
<h4>Solutions<a class="headerlink" href="#id33" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Reduce Factory Contention</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">concurrent.futures</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadPoolExecutor</span><span class="p">,</span> <span class="n">as_completed</span>

<span class="k">def</span><span class="w"> </span><span class="nf">parallel_controller_creation_safe</span><span class="p">(</span><span class="n">controller_configs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Safe parallel controller creation with reduced contention.&quot;&quot;&quot;</span>

    <span class="c1"># Strategy 1: Batch creation to reduce lock contention</span>
    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Limit concurrent factory calls</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_controller_batch</span><span class="p">(</span><span class="n">config_batch</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a batch of controllers.&quot;&quot;&quot;</span>
        <span class="n">batch_results</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">config_batch</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
                <span class="n">batch_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="n">controller</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">batch_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">batch_results</span>

    <span class="c1"># Split configs into batches</span>
    <span class="n">batches</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">controller_configs</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">batch_size</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">controller_configs</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># Process batches sequentially to avoid lock contention</span>
    <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">batches</span><span class="p">:</span>
        <span class="n">batch_results</span> <span class="o">=</span> <span class="n">create_controller_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">batch_results</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># Usage</span>
<span class="n">configs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;controller_type&#39;</span><span class="p">:</span> <span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;gains&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;controller_type&#39;</span><span class="p">:</span> <span class="s1">&#39;adaptive_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;gains&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="c1"># ... more configs</span>
<span class="p">]</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">parallel_controller_creation_safe</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Solution 2: Lock-Free Factory Operations</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">LockFreeControllerCache</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lock-free controller cache using pre-created controllers.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_controller_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">RLock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">initialize_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">preload_configs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pre-create controllers to avoid runtime factory calls.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initializing controller cache...&quot;</span><span class="p">)</span>

        <span class="c1"># Create controllers sequentially during initialization</span>
        <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">preload_configs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
                <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_cache_key</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_controller_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">controller</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cached: </span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;controller_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to cache </span><span class="si">{</span><span class="n">config</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_initialized</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cache initialized with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_controller_cache</span><span class="p">)</span><span class="si">}</span><span class="s2"> controllers&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_make_cache_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create cache key from configuration.&quot;&quot;&quot;</span>
        <span class="n">key_parts</span> <span class="o">=</span> <span class="p">[</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;controller_type&#39;</span><span class="p">]]</span>

        <span class="k">if</span> <span class="s1">&#39;gains&#39;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
            <span class="n">key_parts</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">g</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]])</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">key_parts</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_controller</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get controller from cache (thread-safe read).&quot;&quot;&quot;</span>

        <span class="n">cache_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_cache_key</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_controller_cache</span><span class="p">:</span>
            <span class="c1"># Clone controller to avoid shared state issues</span>
            <span class="n">cached_controller</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_controller_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clone_controller</span><span class="p">(</span><span class="n">cached_controller</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Fallback to factory (with lock)</span>
            <span class="k">return</span> <span class="n">create_controller</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_clone_controller</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cached_controller</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new controller with same configuration.&quot;&quot;&quot;</span>
        <span class="c1"># Reset cached controller state</span>
        <span class="n">cached_controller</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">cached_controller</span>

<span class="c1"># Initialize cache at startup</span>
<span class="n">cache</span> <span class="o">=</span> <span class="n">LockFreeControllerCache</span><span class="p">()</span>

<span class="c1"># Pre-define common configurations</span>
<span class="n">common_configs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;controller_type&#39;</span><span class="p">:</span> <span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;gains&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;controller_type&#39;</span><span class="p">:</span> <span class="s1">&#39;adaptive_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;gains&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;controller_type&#39;</span><span class="p">:</span> <span class="s1">&#39;sta_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;gains&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">]},</span>
<span class="p">]</span>

<span class="n">cache</span><span class="o">.</span><span class="n">initialize_cache</span><span class="p">(</span><span class="n">common_configs</span><span class="p">)</span>

<span class="c1"># Use cache in PSO (thread-safe)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">thread_safe_fitness_function</span><span class="p">(</span><span class="n">gains</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PSO fitness function using cached controllers.&quot;&quot;&quot;</span>

    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;controller_type&#39;</span><span class="p">:</span> <span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="s1">&#39;gains&#39;</span><span class="p">:</span> <span class="n">gains</span><span class="p">}</span>
    <span class="n">controller</span> <span class="o">=</span> <span class="n">cache</span><span class="o">.</span><span class="n">get_controller</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">evaluate_controller_performance</span><span class="p">(</span><span class="n">controller</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="issue-2-shared-state-problems">
<h3>Issue 2: Shared State Problems<a class="headerlink" href="#issue-2-shared-state-problems" title="Link to this heading">Â¶</a></h3>
<section id="id34">
<h4>Symptoms<a class="headerlink" href="#id34" title="Link to this heading">Â¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Controllers</span> <span class="n">interfering</span> <span class="k">with</span> <span class="n">each</span> <span class="n">other</span>
<span class="n">Unexpected</span> <span class="n">state</span> <span class="n">changes</span> <span class="n">between</span> <span class="n">calls</span>
<span class="n">Race</span> <span class="n">conditions</span> <span class="ow">in</span> <span class="n">control</span> <span class="n">computation</span>
</pre></div>
</div>
</section>
<section id="id35">
<h4>Root Causes<a class="headerlink" href="#id35" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p><strong>Shared mutable state</strong>: Controllers sharing mutable objects</p></li>
<li><p><strong>Singleton patterns</strong>: Global state being modified</p></li>
<li><p><strong>Static variables</strong>: Class-level shared state</p></li>
</ol>
</section>
<section id="id36">
<h4>Solutions<a class="headerlink" href="#id36" title="Link to this heading">Â¶</a></h4>
<p><strong>Solution 1: Controller State Isolation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">IsolatedControllerWrapper</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper to ensure controller state isolation.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_controller</span> <span class="o">=</span> <span class="n">controller</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_state_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">RLock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initial_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_capture_state</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_capture_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Capture controller&#39;s initial state.&quot;&quot;&quot;</span>
        <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Capture gains</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="p">,</span> <span class="s1">&#39;gains&#39;</span><span class="p">):</span>
            <span class="n">state</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="o">.</span><span class="n">gains</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Capture configuration</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="p">,</span> <span class="s1">&#39;config&#39;</span><span class="p">):</span>
            <span class="n">state</span><span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="o">.</span><span class="n">config</span>

        <span class="c1"># Controller-specific state</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="p">,</span> <span class="s1">&#39;_adaptive_gains&#39;</span><span class="p">):</span>
            <span class="n">state</span><span class="p">[</span><span class="s1">&#39;adaptive_gains&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="o">.</span><span class="n">_adaptive_gains</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset controller to initial state.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_lock</span><span class="p">:</span>
            <span class="c1"># Reset gains</span>
            <span class="k">if</span> <span class="s1">&#39;gains&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_state</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="o">.</span><span class="n">gains</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_state</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="c1"># Reset adaptive state</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="p">,</span> <span class="s1">&#39;_adaptive_gains&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;adaptive_gains&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_state</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="o">.</span><span class="n">_adaptive_gains</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_state</span><span class="p">[</span><span class="s1">&#39;adaptive_gains&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="c1"># Call controller&#39;s reset method</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="p">,</span> <span class="s1">&#39;reset&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compute_control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">last_control</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Thread-safe control computation.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_lock</span><span class="p">:</span>
            <span class="c1"># Ensure clean state</span>
            <span class="k">if</span> <span class="n">history</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">history</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1"># Compute control</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="o">.</span><span class="n">compute_control</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">last_control</span><span class="p">,</span> <span class="n">history</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delegate other attributes to wrapped controller.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_controller</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<span class="c1"># Usage with thread safety</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_isolated_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create controller with state isolation.&quot;&quot;&quot;</span>

    <span class="n">base_controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">IsolatedControllerWrapper</span><span class="p">(</span><span class="n">base_controller</span><span class="p">)</span>

<span class="c1"># PSO with isolated controllers</span>
<span class="k">def</span><span class="w"> </span><span class="nf">isolated_fitness_function</span><span class="p">(</span><span class="n">gains</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;PSO fitness function with isolated controllers.&quot;&quot;&quot;</span>

    <span class="n">controller</span> <span class="o">=</span> <span class="n">create_isolated_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span> <span class="n">gains</span><span class="o">=</span><span class="n">gains</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">performance</span> <span class="o">=</span> <span class="n">evaluate_controller_performance</span><span class="p">(</span><span class="n">controller</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">performance</span><span class="p">[</span><span class="s1">&#39;total_cost&#39;</span><span class="p">]</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="c1"># Ensure clean state for next use</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="debugging-tools-and-techniques">
<h2>Debugging Tools and Techniques<a class="headerlink" href="#debugging-tools-and-techniques" title="Link to this heading">Â¶</a></h2>
<section id="comprehensive-debugging-suite">
<h3>Comprehensive Debugging Suite<a class="headerlink" href="#comprehensive-debugging-suite" title="Link to this heading">Â¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;Comprehensive factory debugging suite.&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">traceback</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FactoryDebugger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Comprehensive debugging tools for factory integration.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_file</span><span class="o">=</span><span class="s1">&#39;factory_debug.log&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_file</span> <span class="o">=</span> <span class="n">log_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_logging</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_setup_logging</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup detailed logging.&quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
            <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span>
            <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(name)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_file</span><span class="p">),</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;FactoryDebugger&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">debug_controller_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Debug controller creation step by step.&quot;&quot;&quot;</span>

        <span class="n">debug_info</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span>
            <span class="s1">&#39;controller_type&#39;</span><span class="p">:</span> <span class="n">controller_type</span><span class="p">,</span>
            <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="p">,</span>
            <span class="s1">&#39;steps&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;errors&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Step 1: Check controller availability</span>
            <span class="n">step1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_debug_step_availability</span><span class="p">(</span><span class="n">controller_type</span><span class="p">)</span>
            <span class="n">debug_info</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step1</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">step1</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">debug_info</span>

            <span class="c1"># Step 2: Parameter resolution</span>
            <span class="n">step2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_debug_step_parameters</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
            <span class="n">debug_info</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step2</span><span class="p">)</span>

            <span class="c1"># Step 3: Configuration creation</span>
            <span class="n">step3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_debug_step_configuration</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">step2</span><span class="p">[</span><span class="s1">&#39;resolved_params&#39;</span><span class="p">])</span>
            <span class="n">debug_info</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step3</span><span class="p">)</span>

            <span class="c1"># Step 4: Controller instantiation</span>
            <span class="n">step4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_debug_step_instantiation</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">step3</span><span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">])</span>
            <span class="n">debug_info</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step4</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">step4</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]:</span>
                <span class="n">debug_info</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">debug_info</span><span class="p">[</span><span class="s1">&#39;controller&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">step4</span><span class="p">[</span><span class="s1">&#39;controller&#39;</span><span class="p">]</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">debug_info</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="s1">&#39;traceback&#39;</span><span class="p">:</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
            <span class="p">})</span>

        <span class="c1"># Store debug data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">debug_info</span>

        <span class="k">return</span> <span class="n">debug_info</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_debug_step_availability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Debug controller availability.&quot;&quot;&quot;</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;availability_check&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">list_available_controllers</span><span class="p">,</span> <span class="n">CONTROLLER_REGISTRY</span>

            <span class="n">available</span> <span class="o">=</span> <span class="n">list_available_controllers</span><span class="p">()</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;available_controllers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">available</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;controller_in_registry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">controller_type</span> <span class="ow">in</span> <span class="n">CONTROLLER_REGISTRY</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;controller_available&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">controller_type</span> <span class="ow">in</span> <span class="n">available</span>

            <span class="k">if</span> <span class="n">controller_type</span> <span class="ow">in</span> <span class="n">available</span><span class="p">:</span>
                <span class="n">controller_info</span> <span class="o">=</span> <span class="n">CONTROLLER_REGISTRY</span><span class="p">[</span><span class="n">controller_type</span><span class="p">]</span>
                <span class="n">step</span><span class="p">[</span><span class="s1">&#39;controller_info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;class_available&#39;</span><span class="p">:</span> <span class="n">controller_info</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">controller_info</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;gain_count&#39;</span><span class="p">:</span> <span class="n">controller_info</span><span class="p">[</span><span class="s1">&#39;gain_count&#39;</span><span class="p">]</span>
                <span class="p">}</span>
                <span class="n">step</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">step</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Controller </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2"> not available&quot;</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">step</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_debug_step_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Debug parameter resolution.&quot;&quot;&quot;</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;parameter_resolution&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Analyze provided parameters</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;provided_params&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;gains_provided&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;gains&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;config_provided&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;config&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span>

            <span class="c1"># Check gains if provided</span>
            <span class="k">if</span> <span class="s1">&#39;gains&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">gains</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span>
                <span class="n">step</span><span class="p">[</span><span class="s1">&#39;gains_analysis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                    <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;N/A&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;all_numeric&#39;</span><span class="p">:</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gains</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span>
                <span class="p">}</span>

            <span class="c1"># Resolve final parameters</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_default_gains</span>

            <span class="k">if</span> <span class="s1">&#39;gains&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">default_gains</span> <span class="o">=</span> <span class="n">get_default_gains</span><span class="p">(</span><span class="n">controller_type</span><span class="p">)</span>
                <span class="n">step</span><span class="p">[</span><span class="s1">&#39;using_default_gains&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">step</span><span class="p">[</span><span class="s1">&#39;default_gains&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_gains</span>
                <span class="n">resolved_gains</span> <span class="o">=</span> <span class="n">default_gains</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">resolved_gains</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span>

            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;resolved_params&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;resolved_params&#39;</span><span class="p">][</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resolved_gains</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">step</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_debug_step_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Debug configuration creation.&quot;&quot;&quot;</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;configuration_creation&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">CONTROLLER_REGISTRY</span>

            <span class="n">controller_info</span> <span class="o">=</span> <span class="n">CONTROLLER_REGISTRY</span><span class="p">[</span><span class="n">controller_type</span><span class="p">]</span>
            <span class="n">config_class</span> <span class="o">=</span> <span class="n">controller_info</span><span class="p">[</span><span class="s1">&#39;config_class&#39;</span><span class="p">]</span>

            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;config_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config_class</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;required_params&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">controller_info</span><span class="p">[</span><span class="s1">&#39;required_params&#39;</span><span class="p">]</span>

            <span class="c1"># Try to create configuration</span>
            <span class="k">if</span> <span class="n">controller_type</span> <span class="o">==</span> <span class="s1">&#39;classical_smc&#39;</span><span class="p">:</span>
                <span class="n">config</span> <span class="o">=</span> <span class="n">config_class</span><span class="p">(</span>
                    <span class="n">gains</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">],</span>
                    <span class="n">max_force</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_force&#39;</span><span class="p">,</span> <span class="mf">150.0</span><span class="p">),</span>
                    <span class="n">boundary_layer</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;boundary_layer&#39;</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span>
                    <span class="n">dt</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">controller_type</span> <span class="o">==</span> <span class="s1">&#39;adaptive_smc&#39;</span><span class="p">:</span>
                <span class="n">config</span> <span class="o">=</span> <span class="n">config_class</span><span class="p">(</span>
                    <span class="n">gains</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">],</span>
                    <span class="n">max_force</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_force&#39;</span><span class="p">,</span> <span class="mf">150.0</span><span class="p">),</span>
                    <span class="n">dt</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="c1"># ... other controller types</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Generic creation</span>
                <span class="n">config</span> <span class="o">=</span> <span class="n">config_class</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;traceback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">step</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_debug_step_instantiation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Debug controller instantiation.&quot;&quot;&quot;</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;controller_instantiation&#39;</span><span class="p">,</span> <span class="s1">&#39;success&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">CONTROLLER_REGISTRY</span>

            <span class="n">controller_info</span> <span class="o">=</span> <span class="n">CONTROLLER_REGISTRY</span><span class="p">[</span><span class="n">controller_type</span><span class="p">]</span>
            <span class="n">controller_class</span> <span class="o">=</span> <span class="n">controller_info</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>

            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;controller_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">controller_class</span><span class="o">.</span><span class="vm">__name__</span>

            <span class="c1"># Create controller</span>
            <span class="n">controller</span> <span class="o">=</span> <span class="n">controller_class</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

            <span class="c1"># Verify controller interface</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;has_compute_control&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="s1">&#39;compute_control&#39;</span><span class="p">)</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;has_reset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="s1">&#39;reset&#39;</span><span class="p">)</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;has_gains&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="s1">&#39;gains&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="s1">&#39;gains&#39;</span><span class="p">):</span>
                <span class="n">step</span><span class="p">[</span><span class="s1">&#39;controller_gains&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">gains</span>

            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;controller&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">controller</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">step</span><span class="p">[</span><span class="s1">&#39;traceback&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">step</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_debug_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;debug_report.json&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate comprehensive debug report.&quot;&quot;&quot;</span>

        <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span>
            <span class="s1">&#39;total_debug_sessions&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">debug_data</span><span class="p">),</span>
            <span class="s1">&#39;sessions&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug_data</span>
        <span class="p">}</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Debug report saved to: </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">report</span>

<span class="c1"># Usage</span>
<span class="n">debugger</span> <span class="o">=</span> <span class="n">FactoryDebugger</span><span class="p">()</span>

<span class="c1"># Debug controller creation</span>
<span class="n">debug_info</span> <span class="o">=</span> <span class="n">debugger</span><span class="o">.</span><span class="n">debug_controller_creation</span><span class="p">(</span>
    <span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span>
    <span class="n">gains</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">)</span>

<span class="k">if</span> <span class="n">debug_info</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ… Controller creation successful&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âŒ Controller creation failed&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">debug_info</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">error</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Generate report</span>
<span class="n">debugger</span><span class="o">.</span><span class="n">generate_debug_report</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="prevention-strategies">
<h2>Prevention Strategies<a class="headerlink" href="#prevention-strategies" title="Link to this heading">Â¶</a></h2>
<section id="best-practices-for-robust-factory-integration">
<h3>Best Practices for Robust Factory Integration<a class="headerlink" href="#best-practices-for-robust-factory-integration" title="Link to this heading">Â¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;Best practices for robust factory integration.&quot;&quot;&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RobustFactoryIntegration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Demonstrates best practices for factory integration.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">factory_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validation_cache</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_controller_robust</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create controller with comprehensive robustness patterns.&quot;&quot;&quot;</span>

        <span class="c1"># 1. Input validation</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_inputs</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid inputs&quot;</span><span class="p">)</span>

        <span class="c1"># 2. Pre-creation checks</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pre_creation_checks</span><span class="p">(</span><span class="n">controller_type</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Controller </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2"> not available&quot;</span><span class="p">)</span>

        <span class="c1"># 3. Safe creation with fallbacks</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_with_fallbacks</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log_creation_failure</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate inputs before creation.&quot;&quot;&quot;</span>

        <span class="c1"># Check controller type</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">controller_type</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Check gains if provided</span>
        <span class="k">if</span> <span class="s1">&#39;gains&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">gains</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gains</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">g</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gains</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_pre_creation_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform pre-creation availability checks.&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">list_available_controllers</span>
            <span class="n">available</span> <span class="o">=</span> <span class="n">list_available_controllers</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">controller_type</span> <span class="ow">in</span> <span class="n">available</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_with_fallbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create controller with fallback strategies.&quot;&quot;&quot;</span>

        <span class="n">strategies</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_strategy_direct_creation</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_strategy_minimal_config</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_strategy_default_parameters</span>
        <span class="p">]</span>

        <span class="n">last_exception</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="n">strategies</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">strategy</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">last_exception</span> <span class="o">=</span> <span class="n">e</span>
                <span class="k">continue</span>

        <span class="c1"># All strategies failed</span>
        <span class="k">raise</span> <span class="n">last_exception</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_strategy_direct_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Strategy 1: Direct creation with provided parameters.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_controller</span>
        <span class="k">return</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_strategy_minimal_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Strategy 2: Minimal configuration creation.&quot;&quot;&quot;</span>

        <span class="c1"># Use only essential parameters</span>
        <span class="n">essential_params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="s1">&#39;gains&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">essential_params</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gains&#39;</span><span class="p">]</span>

        <span class="c1"># Add required defaults</span>
        <span class="k">if</span> <span class="n">controller_type</span> <span class="o">==</span> <span class="s1">&#39;classical_smc&#39;</span><span class="p">:</span>
            <span class="n">essential_params</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s1">&#39;max_force&#39;</span><span class="p">:</span> <span class="mf">150.0</span><span class="p">,</span>
                <span class="s1">&#39;boundary_layer&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span>
                <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="mf">0.001</span>
            <span class="p">})</span>
        <span class="k">elif</span> <span class="n">controller_type</span> <span class="o">==</span> <span class="s1">&#39;adaptive_smc&#39;</span><span class="p">:</span>
            <span class="n">essential_params</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                <span class="s1">&#39;max_force&#39;</span><span class="p">:</span> <span class="mf">150.0</span><span class="p">,</span>
                <span class="s1">&#39;dt&#39;</span><span class="p">:</span> <span class="mf">0.001</span>
            <span class="p">})</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_controller</span>
        <span class="k">return</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="o">**</span><span class="n">essential_params</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_strategy_default_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Strategy 3: Use all default parameters.&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_controller</span>
        <span class="k">return</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_log_creation_failure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log creation failure for debugging.&quot;&quot;&quot;</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Controller creation failed:&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Type: </span><span class="si">{</span><span class="n">controller_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Parameters: </span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Exception: </span><span class="si">{</span><span class="n">exception</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Validation patterns</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FactoryValidationPatterns</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Common validation patterns for factory integration.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_controller_type</span><span class="p">(</span><span class="n">controller_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate controller type string.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Controller type must be string&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">controller_type</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Controller type cannot be empty&quot;</span><span class="p">)</span>

        <span class="c1"># Normalize</span>
        <span class="k">return</span> <span class="n">controller_type</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_gains</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="n">expected_count</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate gain array.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">gains</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># Allow None for default gains</span>

        <span class="c1"># Convert numpy arrays</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="s1">&#39;tolist&#39;</span><span class="p">):</span>
            <span class="n">gains</span> <span class="o">=</span> <span class="n">gains</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gains</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Gains must be list or tuple&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Gains cannot be empty&quot;</span><span class="p">)</span>

        <span class="c1"># Check types</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gains</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;All gains must be numeric&quot;</span><span class="p">)</span>

        <span class="c1"># Check finite values</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gains</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All gains must be finite&quot;</span><span class="p">)</span>

        <span class="c1"># Check positivity</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">g</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gains</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All gains must be positive&quot;</span><span class="p">)</span>

        <span class="c1"># Check count if specified</span>
        <span class="k">if</span> <span class="n">expected_count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span> <span class="o">!=</span> <span class="n">expected_count</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="n">expected_count</span><span class="si">}</span><span class="s2"> gains, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">gains</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_configuration</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">controller_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate configuration object.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># Allow None for default config</span>

        <span class="c1"># Check for required attributes based on controller type</span>
        <span class="k">if</span> <span class="n">controller_type</span> <span class="o">==</span> <span class="s1">&#39;classical_smc&#39;</span><span class="p">:</span>
            <span class="n">required_attrs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;max_force&#39;</span><span class="p">,</span> <span class="s1">&#39;boundary_layer&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">required_attrs</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid </span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>

<span class="c1"># Testing patterns</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FactoryTestingPatterns</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Testing patterns for factory integration.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_all_controllers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test all available controllers.&quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">list_available_controllers</span>

        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">available</span> <span class="o">=</span> <span class="n">list_available_controllers</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">controller_type</span> <span class="ow">in</span> <span class="n">available</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Test with defaults</span>
                <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">)</span>
                <span class="n">results</span><span class="p">[</span><span class="n">controller_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;success&#39;</span><span class="p">}</span>

                <span class="c1"># Test with custom gains</span>
                <span class="kn">from</span><span class="w"> </span><span class="nn">src.controllers.factory</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_default_gains</span>
                <span class="n">custom_gains</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span> <span class="o">*</span> <span class="mf">1.1</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">get_default_gains</span><span class="p">(</span><span class="n">controller_type</span><span class="p">)]</span>
                <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="n">controller_type</span><span class="p">,</span> <span class="n">gains</span><span class="o">=</span><span class="n">custom_gains</span><span class="p">)</span>
                <span class="n">results</span><span class="p">[</span><span class="n">controller_type</span><span class="p">][</span><span class="s1">&#39;custom_gains&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;success&#39;</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="n">controller_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stress_test_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stress test factory with many creations.&quot;&quot;&quot;</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">controller</span> <span class="o">=</span> <span class="n">create_controller</span><span class="p">(</span><span class="s1">&#39;classical_smc&#39;</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">controller</span>  <span class="c1"># Explicit cleanup</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>

        <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;total_time&#39;</span><span class="p">:</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">,</span>
            <span class="s1">&#39;avg_time_per_creation&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_iterations</span><span class="p">,</span>
            <span class="s1">&#39;errors&#39;</span><span class="p">:</span> <span class="n">errors</span><span class="p">,</span>
            <span class="s1">&#39;success_rate&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">n_iterations</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">))</span> <span class="o">/</span> <span class="n">n_iterations</span>
        <span class="p">}</span>

<span class="c1"># Usage examples</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Robust factory integration</span>
    <span class="n">robust_factory</span> <span class="o">=</span> <span class="n">RobustFactoryIntegration</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">controller</span> <span class="o">=</span> <span class="n">robust_factory</span><span class="o">.</span><span class="n">create_controller_robust</span><span class="p">(</span>
            <span class="s1">&#39;classical_smc&#39;</span><span class="p">,</span>
            <span class="n">gains</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ… Robust controller creation successful&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ Robust controller creation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Validation patterns</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">FactoryValidationPatterns</span><span class="o">.</span><span class="n">validate_gains</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">expected_count</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;âœ… Gain validation passed&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;âŒ Gain validation failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Testing patterns</span>
    <span class="n">tester</span> <span class="o">=</span> <span class="n">FactoryTestingPatterns</span><span class="p">()</span>
    <span class="n">test_results</span> <span class="o">=</span> <span class="n">tester</span><span class="o">.</span><span class="n">test_all_controllers</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Controller test results: </span><span class="si">{</span><span class="n">test_results</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<hr class="docutils" />
<p>This comprehensive troubleshooting guide provides systematic approaches to diagnosing and resolving factory integration issues. Each section includes detailed diagnostic procedures, root cause analysis, and proven solutions with practical code examples. The guide emphasizes prevention through robust programming practices and comprehensive testing strategies.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Research Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Oct 04, 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Factory Integration Troubleshooting Guide</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li><a class="reference internal" href="#quick-diagnosis">Quick Diagnosis</a><ul>
<li><a class="reference internal" href="#diagnostic-checklist">Diagnostic Checklist</a></li>
<li><a class="reference internal" href="#common-issue-indicators">Common Issue Indicators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#controller-creation-issues">Controller Creation Issues</a><ul>
<li><a class="reference internal" href="#issue-1-unknown-controller-type">Issue 1: Unknown Controller Type</a><ul>
<li><a class="reference internal" href="#symptoms">Symptoms</a></li>
<li><a class="reference internal" href="#root-causes">Root Causes</a></li>
<li><a class="reference internal" href="#solutions">Solutions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#issue-2-controller-class-not-available">Issue 2: Controller Class Not Available</a><ul>
<li><a class="reference internal" href="#id1">Symptoms</a></li>
<li><a class="reference internal" href="#id2">Root Causes</a></li>
<li><a class="reference internal" href="#id3">Solutions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#issue-3-configuration-creation-failures">Issue 3: Configuration Creation Failures</a><ul>
<li><a class="reference internal" href="#id4">Symptoms</a></li>
<li><a class="reference internal" href="#id5">Root Causes</a></li>
<li><a class="reference internal" href="#id6">Solutions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#pso-integration-problems">PSO Integration Problems</a><ul>
<li><a class="reference internal" href="#issue-1-pso-factory-creation-failures">Issue 1: PSO Factory Creation Failures</a><ul>
<li><a class="reference internal" href="#id7">Symptoms</a></li>
<li><a class="reference internal" href="#id8">Root Causes</a></li>
<li><a class="reference internal" href="#id9">Solutions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#issue-2-gain-validation-failures">Issue 2: Gain Validation Failures</a><ul>
<li><a class="reference internal" href="#id10">Symptoms</a></li>
<li><a class="reference internal" href="#id11">Root Causes</a></li>
<li><a class="reference internal" href="#id12">Solutions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#issue-3-pso-performance-problems">Issue 3: PSO Performance Problems</a><ul>
<li><a class="reference internal" href="#id13">Symptoms</a></li>
<li><a class="reference internal" href="#id14">Root Causes</a></li>
<li><a class="reference internal" href="#id15">Solutions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#configuration-issues">Configuration Issues</a><ul>
<li><a class="reference internal" href="#issue-1-configuration-parameter-conflicts">Issue 1: Configuration Parameter Conflicts</a><ul>
<li><a class="reference internal" href="#id16">Symptoms</a></li>
<li><a class="reference internal" href="#id17">Root Causes</a></li>
<li><a class="reference internal" href="#id18">Solutions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#issue-2-yaml-configuration-errors">Issue 2: YAML Configuration Errors</a><ul>
<li><a class="reference internal" href="#id19">Symptoms</a></li>
<li><a class="reference internal" href="#id20">Root Causes</a></li>
<li><a class="reference internal" href="#id21">Solutions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#performance-problems">Performance Problems</a><ul>
<li><a class="reference internal" href="#issue-1-slow-controller-creation">Issue 1: Slow Controller Creation</a><ul>
<li><a class="reference internal" href="#id22">Symptoms</a></li>
<li><a class="reference internal" href="#id23">Root Causes</a></li>
<li><a class="reference internal" href="#id24">Solutions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#issue-2-memory-leaks">Issue 2: Memory Leaks</a><ul>
<li><a class="reference internal" href="#id25">Symptoms</a></li>
<li><a class="reference internal" href="#id26">Root Causes</a></li>
<li><a class="reference internal" href="#id27">Solutions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#import-and-dependency-issues">Import and Dependency Issues</a><ul>
<li><a class="reference internal" href="#issue-1-missing-module-imports">Issue 1: Missing Module Imports</a><ul>
<li><a class="reference internal" href="#id28">Symptoms</a></li>
<li><a class="reference internal" href="#id29">Root Causes</a></li>
<li><a class="reference internal" href="#id30">Solutions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#thread-safety-issues">Thread Safety Issues</a><ul>
<li><a class="reference internal" href="#issue-1-factory-lock-timeouts">Issue 1: Factory Lock Timeouts</a><ul>
<li><a class="reference internal" href="#id31">Symptoms</a></li>
<li><a class="reference internal" href="#id32">Root Causes</a></li>
<li><a class="reference internal" href="#id33">Solutions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#issue-2-shared-state-problems">Issue 2: Shared State Problems</a><ul>
<li><a class="reference internal" href="#id34">Symptoms</a></li>
<li><a class="reference internal" href="#id35">Root Causes</a></li>
<li><a class="reference internal" href="#id36">Solutions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#debugging-tools-and-techniques">Debugging Tools and Techniques</a><ul>
<li><a class="reference internal" href="#comprehensive-debugging-suite">Comprehensive Debugging Suite</a></li>
</ul>
</li>
<li><a class="reference internal" href="#prevention-strategies">Prevention Strategies</a><ul>
<li><a class="reference internal" href="#best-practices-for-robust-factory-integration">Best Practices for Robust Factory Integration</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=4ebf8126"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=08e7b316"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script src="_static/back-to-top.js?v=840797bb"></script>
    <script src="_static/lazy-load.js?v=dc25293c"></script>
    <script src="_static/dark-mode.js?v=bf328970"></script>
    </body>
</html>