<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
.chartjs-container {
    margin: 1.5em auto;
    padding: 1em;
    background: #f8f9fa;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.chart-note {
    text-align: center;
    color: #6c757d;
    font-size: 0.9em;
    margin-top: 0.5em;
}
</style>
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>simulation.engines.adaptive_integrator - DIP_SMC_PSO Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5349f25f" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=f5a89ef9" />
    
    


<style>
  body {
    --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">DIP_SMC_PSO Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">DIP_SMC_PSO Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">📚 Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">Optimal Sliding Mode Control for a Double-Inverted Pendulum via PSO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory_overview.html">1. Theoretical Background â€” Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture.html">3. System Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plant_model.html">1.x Plant Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hil_quickstart.html">Hardware-in-the-Loop (HIL) Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../streamlit_dashboard_guide.html">Streamlit Dashboard User Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">🎮 Control Systems &amp; Optimization</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../controllers/index.html">Controllers Module Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Controllers Module Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../controllers/classical_smc_technical_guide.html">Classical Sliding Mode Control Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../controllers/adaptive_smc_technical_guide.html">Adaptive Sliding Mode Control Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../controllers/sta_smc_technical_guide.html">Super-Twisting Sliding Mode Control Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../controllers/hybrid_smc_technical_guide.html">Hybrid Adaptive Super-Twisting SMC Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../controllers/mpc_technical_guide.html">Model Predictive Control Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../controllers/swing_up_smc_technical_guide.html">Swing-Up SMC Technical Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../controllers/swing_up_smc_technical_guide.html#example-metadata">example-metadata:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../controllers/swing_up_smc_technical_guide.html#runnable-false">runnable: false</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../controllers/factory_system_guide.html">SMC Controller Factory System Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../controllers/control_primitives_reference.html">Control Primitives Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mathematical_foundations/smc_complete_theory.html">Complete Sliding Mode Control Mathematical Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mathematical_foundations/controller_comparison_theory.html">SMC Controller Comparison Theory</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../controllers/index.html">Controllers Module</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Controllers Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../controllers/adaptive_smc.html">controllers.adaptive_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/classic_smc.html">controllers.classic_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory.html">controllers.factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/mpc_controller.html">controllers.mpc_controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/sta_smc.html">controllers.sta_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/swing_up_smc.html">controllers.swing_up_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/__init__.html">controllers.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/base_controller_interface.html">controllers.base.controller_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/base_control_primitives.html">controllers.base.control_primitives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/base___init__.html">controllers.base.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory_deprecation.html">controllers.factory.deprecation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory_fallback_configs.html">controllers.factory.fallback_configs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory_legacy_factory.html">controllers.factory.legacy_factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory_optimization.html">controllers.factory.optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory_pso_integration.html">controllers.factory.pso_integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory_smc_factory.html">controllers.factory.smc_factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory_thread_safety.html">controllers.factory.thread_safety</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory___init__.html">controllers.factory.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/mpc_mpc_controller.html">controllers.mpc.mpc_controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/mpc___init__.html">controllers.mpc.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_adaptive_smc.html">controllers.smc.adaptive_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_classic_smc.html">controllers.smc.classic_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_hybrid_adaptive_sta_smc.html">controllers.smc.hybrid_adaptive_sta_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_sta_smc.html">controllers.smc.sta_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc___init__.html">controllers.smc.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/specialized_swing_up_smc.html">controllers.specialized.swing_up_smc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/specialized___init__.html">controllers.specialized.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory_core_protocols.html">controllers.factory.core.protocols</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory_core_registry.html">controllers.factory.core.registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory_core_threading.html">controllers.factory.core.threading</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory_core_validation.html">controllers.factory.core.validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/factory_core___init__.html">controllers.factory.core.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms___init__.html">controllers.smc.algorithms.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_core_equivalent_control.html">controllers.smc.core.equivalent_control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_core_gain_validation.html">controllers.smc.core.gain_validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_core_sliding_surface.html">controllers.smc.core.sliding_surface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_core_switching_functions.html">controllers.smc.core.switching_functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_core___init__.html">controllers.smc.core.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_adaptive_adaptation_law.html">controllers.smc.algorithms.adaptive.adaptation_law</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_adaptive_config.html">controllers.smc.algorithms.adaptive.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_adaptive_controller.html">controllers.smc.algorithms.adaptive.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_adaptive_parameter_estimation.html">controllers.smc.algorithms.adaptive.parameter_estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_adaptive___init__.html">controllers.smc.algorithms.adaptive.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_classical_boundary_layer.html">controllers.smc.algorithms.classical.boundary_layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_classical_config.html">controllers.smc.algorithms.classical.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_classical_controller.html">controllers.smc.algorithms.classical.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_classical___init__.html">controllers.smc.algorithms.classical.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_hybrid_config.html">controllers.smc.algorithms.hybrid.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_hybrid_controller.html">controllers.smc.algorithms.hybrid.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_hybrid_switching_logic.html">controllers.smc.algorithms.hybrid.switching_logic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_hybrid___init__.html">controllers.smc.algorithms.hybrid.<strong>init</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_super_twisting_config.html">controllers.smc.algorithms.super_twisting.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_super_twisting_controller.html">controllers.smc.algorithms.super_twisting.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_super_twisting_twisting_algorithm.html">controllers.smc.algorithms.super_twisting.twisting_algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../controllers/smc_algorithms_super_twisting___init__.html">controllers.smc.algorithms.super_twisting.<strong>init</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../mathematical_foundations/index.html">Mathematical Foundations</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Mathematical Foundations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../mathematical_foundations/smc_complete_theory.html">Complete Sliding Mode Control Mathematical Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mathematical_foundations/controller_comparison_theory.html">SMC Controller Comparison Theory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../plant/models_guide.html">Plant Models Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../optimization_simulation/guide.html">Optimization &amp; Simulation Guide</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../controllers/index.html">Controllers Module</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Controllers Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../controllers/adaptive_smc.html">controllers.adaptive_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/classic_smc.html">controllers.classic_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory.html">controllers.factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/mpc_controller.html">controllers.mpc_controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/sta_smc.html">controllers.sta_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/swing_up_smc.html">controllers.swing_up_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/__init__.html">controllers.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/base_controller_interface.html">controllers.base.controller_interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/base_control_primitives.html">controllers.base.control_primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/base___init__.html">controllers.base.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_deprecation.html">controllers.factory.deprecation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_fallback_configs.html">controllers.factory.fallback_configs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_legacy_factory.html">controllers.factory.legacy_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_optimization.html">controllers.factory.optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_pso_integration.html">controllers.factory.pso_integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_smc_factory.html">controllers.factory.smc_factory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_thread_safety.html">controllers.factory.thread_safety</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory___init__.html">controllers.factory.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/mpc_mpc_controller.html">controllers.mpc.mpc_controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/mpc___init__.html">controllers.mpc.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_adaptive_smc.html">controllers.smc.adaptive_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_classic_smc.html">controllers.smc.classic_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_hybrid_adaptive_sta_smc.html">controllers.smc.hybrid_adaptive_sta_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_sta_smc.html">controllers.smc.sta_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc___init__.html">controllers.smc.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/specialized_swing_up_smc.html">controllers.specialized.swing_up_smc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/specialized___init__.html">controllers.specialized.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_core_protocols.html">controllers.factory.core.protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_core_registry.html">controllers.factory.core.registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_core_threading.html">controllers.factory.core.threading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_core_validation.html">controllers.factory.core.validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/factory_core___init__.html">controllers.factory.core.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms___init__.html">controllers.smc.algorithms.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_core_equivalent_control.html">controllers.smc.core.equivalent_control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_core_gain_validation.html">controllers.smc.core.gain_validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_core_sliding_surface.html">controllers.smc.core.sliding_surface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_core_switching_functions.html">controllers.smc.core.switching_functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_core___init__.html">controllers.smc.core.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_adaptive_adaptation_law.html">controllers.smc.algorithms.adaptive.adaptation_law</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_adaptive_config.html">controllers.smc.algorithms.adaptive.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_adaptive_controller.html">controllers.smc.algorithms.adaptive.controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_adaptive_parameter_estimation.html">controllers.smc.algorithms.adaptive.parameter_estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_adaptive___init__.html">controllers.smc.algorithms.adaptive.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_classical_boundary_layer.html">controllers.smc.algorithms.classical.boundary_layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_classical_config.html">controllers.smc.algorithms.classical.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_classical_controller.html">controllers.smc.algorithms.classical.controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_classical___init__.html">controllers.smc.algorithms.classical.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_hybrid_config.html">controllers.smc.algorithms.hybrid.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_hybrid_controller.html">controllers.smc.algorithms.hybrid.controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_hybrid_switching_logic.html">controllers.smc.algorithms.hybrid.switching_logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_hybrid___init__.html">controllers.smc.algorithms.hybrid.<strong>init</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_super_twisting_config.html">controllers.smc.algorithms.super_twisting.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_super_twisting_controller.html">controllers.smc.algorithms.super_twisting.controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_super_twisting_twisting_algorithm.html">controllers.smc.algorithms.super_twisting.twisting_algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/smc_algorithms_super_twisting___init__.html">controllers.smc.algorithms.super_twisting.<strong>init</strong></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../optimizer/index.html">Optimizer Module</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Optimizer Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../optimizer/pso_optimizer.html">optimizer.pso_optimizer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimizer/__init__.html">optimizer.<strong>init</strong></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../analysis_plan.html">5. Analysis &amp; Verification Plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../benchmarks_methodology.html">Benchmarks &amp; Methodology</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">🧪 Development &amp; Testing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../TESTING.html">Testing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../test_protocols.html">5.x Test Protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use_cases.html">4. Use Cases &amp; Operating Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../context.html">2. Application Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fault_detection_guide.html">Fault Detection &amp; Isolation (FDI) Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">📊 Research &amp; Theory</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../presentation/index.html">Research Presentation Materials</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Research Presentation Materials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/introduction.html">Abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/introduction.html#introduction-and-motivation">Introduction and Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/introduction.html#the-double-inverted-pendulum-as-a-canonical-control-problem">The Double Inverted Pendulum as a Canonical Control Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/introduction.html#the-primary-control-objectives-and-challenges">The Primary Control Objectives and Challenges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/introduction.html#sliding-mode-control-as-a-robust-solution">Sliding Mode Control as a Robust Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/introduction.html#the-gain-tuning-dilemma-and-the-need-for-optimization">The Gain Tuning Dilemma and the Need for Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/introduction.html#particle-swarm-optimization-for-automated-design">Particle Swarm Optimization for Automated Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/introduction.html#synthesis-and-motivation">Synthesis and Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/introduction.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/problem-statement.html">Problem Statement for Double‑Inverted Pendulum (DIP) Control with SMC and PSO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/previous-works.html">Previous Work Before the Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/system-modeling.html"><strong>A Comprehensive Technical Report on the Modeling and Configuration of a Cart‑Based Double Inverted Pendulum System</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/smc-theory.html">Sliding Mode Control for a Double‑Inverted Pendulum: Bridging Theory and Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/chattering-mitigation.html">Abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/chattering-mitigation.html#introduction">1 Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/chattering-mitigation.html#system-modelling-and-problem-formulation">2 System Modelling and Problem Formulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/chattering-mitigation.html#simulation-methodology">3 Simulation Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/chattering-mitigation.html#classic-sliding-mode-control">4 Classic Sliding Mode Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/chattering-mitigation.html#chattering-mitigation-strategy-i-boundary-layer-method">5 Chattering Mitigation Strategy I: Boundary Layer Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/chattering-mitigation.html#chattering-mitigation-strategy-ii-supertwisting-algorithm">6 Chattering Mitigation Strategy II: Super‑Twisting Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/chattering-mitigation.html#chattering-mitigation-strategy-iii-adaptive-sliding-mode-control">7 Chattering Mitigation Strategy III: Adaptive Sliding Mode Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/chattering-mitigation.html#chattering-mitigation-strategy-iv-hybrid-adaptivesta">8 Chattering Mitigation Strategy IV: Hybrid Adaptive–STA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/chattering-mitigation.html#synthesis-and-comparative-analysis">9 Synthesis and Comparative Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/chattering-mitigation.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/pso-optimization.html"><strong>Comprehensive Simulation Analysis and Enhancements for the Double Inverted Pendulum Control System</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/simulation-setup.html">Particle Swarm Optimization for Sliding‑Mode Controller Tuning of a Double Inverted Pendulum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/results-discussion.html">8 – Results and Discussion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../presentation/results-discussion.html#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/introduction.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/introduction.html#introduction-and-motivation">Introduction and Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/introduction.html#the-double-inverted-pendulum-as-a-canonical-control-problem">The Double Inverted Pendulum as a Canonical Control Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/introduction.html#the-primary-control-objectives-and-challenges">The Primary Control Objectives and Challenges</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/introduction.html#sliding-mode-control-as-a-robust-solution">Sliding Mode Control as a Robust Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/introduction.html#the-gain-tuning-dilemma-and-the-need-for-optimization">The Gain Tuning Dilemma and the Need for Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/introduction.html#particle-swarm-optimization-for-automated-design">Particle Swarm Optimization for Automated Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/introduction.html#synthesis-and-motivation">Synthesis and Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/introduction.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/problem-statement.html">Problem Statement for Double‑Inverted Pendulum (DIP) Control with SMC and PSO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/previous-works.html">Previous Work Before the Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/system-modeling.html"><strong>A Comprehensive Technical Report on the Modeling and Configuration of a Cart‑Based Double Inverted Pendulum System</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/smc-theory.html">Sliding Mode Control for a Double‑Inverted Pendulum: Bridging Theory and Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/chattering-mitigation.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/chattering-mitigation.html#introduction">1 Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/chattering-mitigation.html#system-modelling-and-problem-formulation">2 System Modelling and Problem Formulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/chattering-mitigation.html#simulation-methodology">3 Simulation Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/chattering-mitigation.html#classic-sliding-mode-control">4 Classic Sliding Mode Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/chattering-mitigation.html#chattering-mitigation-strategy-i-boundary-layer-method">5 Chattering Mitigation Strategy I: Boundary Layer Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/chattering-mitigation.html#chattering-mitigation-strategy-ii-supertwisting-algorithm">6 Chattering Mitigation Strategy II: Super‑Twisting Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/chattering-mitigation.html#chattering-mitigation-strategy-iii-adaptive-sliding-mode-control">7 Chattering Mitigation Strategy III: Adaptive Sliding Mode Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/chattering-mitigation.html#chattering-mitigation-strategy-iv-hybrid-adaptivesta">8 Chattering Mitigation Strategy IV: Hybrid Adaptive–STA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/chattering-mitigation.html#synthesis-and-comparative-analysis">9 Synthesis and Comparative Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/chattering-mitigation.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/pso-optimization.html"><strong>Comprehensive Simulation Analysis and Enhancements for the Double Inverted Pendulum Control System</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/simulation-setup.html">Particle Swarm Optimization for Sliding‑Mode Controller Tuning of a Double Inverted Pendulum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/results-discussion.html">8 – Results and Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../presentation/results-discussion.html#references">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">📖 API Reference &amp; Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference Documentation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples/index.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">Bibliography &amp; Academic References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">🔧 Project Management</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html">Contributing – ResearchPlanSpec Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../RELEASE_CHECKLIST.html">Release Checklist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../symbols.html">Symbols &amp; Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../results_readme.html">Results &amp; Plots</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">📚 Citations &amp; Attribution</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CITATIONS.html">Citations &amp; Academic Attribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CITATIONS_ACADEMIC.html">Academic Theory Citations &amp; References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DEPENDENCIES.html">Software Dependencies &amp; Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../PATTERNS.html">Software Design Patterns &amp; Architecture Attribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../LICENSES.html">License Compliance &amp; Attribution</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/theSadeQ/DIP_SMC_PSO/blob/main/docs/reference/simulation/engines_adaptive_integrator.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/theSadeQ/DIP_SMC_PSO/edit/main/docs/reference/simulation/engines_adaptive_integrator.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="simulation-engines-adaptive-integrator">
<h1>simulation.engines.adaptive_integrator<a class="headerlink" href="#simulation-engines-adaptive-integrator" title="Link to this heading">¶</a></h1>
<p><strong>Source:</strong> <code class="docutils literal notranslate"><span class="pre">src\simulation\engines\adaptive_integrator.py</span></code></p>
<section id="module-overview">
<h2>Module Overview<a class="headerlink" href="#module-overview" title="Link to this heading">¶</a></h2>
<p>Adaptive Runge–Kutta integrators for state‑space models.</p>
<p>This module implements a Dormand–Prince 4(5) embedded Runge–Kutta step
with error estimation and adaptive step size control.  Embedded
Runge–Kutta pairs compute two solutions of different orders from the
same function evaluations; the difference between the 4th‑ and 5th‑order
approximations provides an estimate of the local truncation error.  By
comparing this error against user‑supplied absolute and relative
tolerances the integrator can accept or reject a proposed step and
adjust the step size accordingly【313837333132264†L58-L82】.  Adaptive
integrators avoid manual tuning of Courant–Friedrichs–Lewy (CFL)
parameters and automatically reduce the step size when the system
exhibits rapid dynamics or near‑singular mass matrices.</p>
<p>The implementation here focuses on a single step of the Dormand–Prince
method.  A higher‑level loop must call :func:<code class="docutils literal notranslate"><span class="pre">rk45_step</span></code> repeatedly
while updating the integration time and state.  If a step is rejected
the returned state will be <code class="docutils literal notranslate"><span class="pre">None</span></code> and the caller should retry the
integration with the suggested smaller <code class="docutils literal notranslate"><span class="pre">dt</span></code>.  When a step is
accepted the integrator proposes a new step size that can be used for
the next call.</p>
<p>The algorithm is described in many numerical analysis textbooks; see
Section III of Shampine and Reichelt for details【313837333132264†L58-L82】.</p>
</section>
<section id="complete-source-code">
<h2>Complete Source Code<a class="headerlink" href="#complete-source-code" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1">#======================================================================================\\\</span>
<span class="linenos">  2</span><span class="c1">#=================== src/simulation/engines/adaptive_integrator.py ====================\\\</span>
<span class="linenos">  3</span><span class="c1">#======================================================================================\\\</span>
<span class="linenos">  4</span>
<span class="linenos">  5</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">  6</span><span class="sd">Adaptive Runge–Kutta integrators for state‑space models.</span>
<span class="linenos">  7</span>
<span class="linenos">  8</span><span class="sd">This module implements a Dormand–Prince 4(5) embedded Runge–Kutta step</span>
<span class="linenos">  9</span><span class="sd">with error estimation and adaptive step size control.  Embedded</span>
<span class="linenos"> 10</span><span class="sd">Runge–Kutta pairs compute two solutions of different orders from the</span>
<span class="linenos"> 11</span><span class="sd">same function evaluations; the difference between the 4th‑ and 5th‑order</span>
<span class="linenos"> 12</span><span class="sd">approximations provides an estimate of the local truncation error.  By</span>
<span class="linenos"> 13</span><span class="sd">comparing this error against user‑supplied absolute and relative</span>
<span class="linenos"> 14</span><span class="sd">tolerances the integrator can accept or reject a proposed step and</span>
<span class="linenos"> 15</span><span class="sd">adjust the step size accordingly【313837333132264†L58-L82】.  Adaptive</span>
<span class="linenos"> 16</span><span class="sd">integrators avoid manual tuning of Courant–Friedrichs–Lewy (CFL)</span>
<span class="linenos"> 17</span><span class="sd">parameters and automatically reduce the step size when the system</span>
<span class="linenos"> 18</span><span class="sd">exhibits rapid dynamics or near‑singular mass matrices.</span>
<span class="linenos"> 19</span>
<span class="linenos"> 20</span><span class="sd">The implementation here focuses on a single step of the Dormand–Prince</span>
<span class="linenos"> 21</span><span class="sd">method.  A higher‑level loop must call :func:`rk45_step` repeatedly</span>
<span class="linenos"> 22</span><span class="sd">while updating the integration time and state.  If a step is rejected</span>
<span class="linenos"> 23</span><span class="sd">the returned state will be ``None`` and the caller should retry the</span>
<span class="linenos"> 24</span><span class="sd">integration with the suggested smaller ``dt``.  When a step is</span>
<span class="linenos"> 25</span><span class="sd">accepted the integrator proposes a new step size that can be used for</span>
<span class="linenos"> 26</span><span class="sd">the next call.</span>
<span class="linenos"> 27</span>
<span class="linenos"> 28</span><span class="sd">The algorithm is described in many numerical analysis textbooks; see</span>
<span class="linenos"> 29</span><span class="sd">Section III of Shampine and Reichelt for details【313837333132264†L58-L82】.</span>
<span class="linenos"> 30</span>
<span class="linenos"> 31</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 32</span><span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>
<span class="linenos"> 33</span>
<span class="linenos"> 34</span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Optional</span>
<span class="linenos"> 35</span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span><span class="k">def</span><span class="w"> </span><span class="nf">rk45_step</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
<span class="linenos"> 38</span>              <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="linenos"> 39</span>              <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="linenos"> 40</span>              <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="linenos"> 41</span>              <span class="n">abs_tol</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="linenos"> 42</span>              <span class="n">rel_tol</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="nb">float</span><span class="p">]:</span>
<span class="linenos"> 43</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a single Dormand–Prince 4(5) integration step.</span>
<span class="linenos"> 44</span>
<span class="linenos"> 45</span><span class="sd">    Parameters</span>
<span class="linenos"> 46</span><span class="sd">    ----------</span>
<span class="linenos"> 47</span><span class="sd">    f : Callable[[float, np.ndarray], np.ndarray]</span>
<span class="linenos"> 48</span><span class="sd">        Function computing the time derivative of the state ``y`` at time</span>
<span class="linenos"> 49</span><span class="sd">        ``t``.  The derivative must be a one‑dimensional NumPy array.</span>
<span class="linenos"> 50</span><span class="sd">    t : float</span>
<span class="linenos"> 51</span><span class="sd">        Current integration time.</span>
<span class="linenos"> 52</span><span class="sd">    y : np.ndarray</span>
<span class="linenos"> 53</span><span class="sd">        Current state vector.</span>
<span class="linenos"> 54</span><span class="sd">    dt : float</span>
<span class="linenos"> 55</span><span class="sd">        Proposed step size.</span>
<span class="linenos"> 56</span><span class="sd">    abs_tol : float</span>
<span class="linenos"> 57</span><span class="sd">        Absolute tolerance for local error control.</span>
<span class="linenos"> 58</span><span class="sd">    rel_tol : float</span>
<span class="linenos"> 59</span><span class="sd">        Relative tolerance for local error control.</span>
<span class="linenos"> 60</span>
<span class="linenos"> 61</span><span class="sd">    Returns</span>
<span class="linenos"> 62</span><span class="sd">    -------</span>
<span class="linenos"> 63</span><span class="sd">    Tuple[Optional[np.ndarray], float]</span>
<span class="linenos"> 64</span><span class="sd">        A tuple ``(y_new, dt_new)``.  If the step is accepted then</span>
<span class="linenos"> 65</span><span class="sd">        ``y_new`` contains the 5th‑order solution at ``t + dt`` and</span>
<span class="linenos"> 66</span><span class="sd">        ``dt_new`` is a suggested step size for the next step.  If the</span>
<span class="linenos"> 67</span><span class="sd">        step is rejected then ``y_new`` is ``None`` and ``dt_new`` is a</span>
<span class="linenos"> 68</span><span class="sd">        smaller step size to retry.</span>
<span class="linenos"> 69</span>
<span class="linenos"> 70</span><span class="sd">    Notes</span>
<span class="linenos"> 71</span><span class="sd">    -----</span>
<span class="linenos"> 72</span><span class="sd">    This implementation uses the Dormand–Prince coefficients for the</span>
<span class="linenos"> 73</span><span class="sd">    classic `RK45` method.  The constants are hard‑coded for clarity</span>
<span class="linenos"> 74</span><span class="sd">    rather than generated programmatically.  See the cited reference</span>
<span class="linenos"> 75</span><span class="sd">    for the Butcher tableau【313837333132264†L58-L82】.</span>
<span class="linenos"> 76</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 77</span>    <span class="c1"># Dormand–Prince coefficients (c, a&#39;s, b4, b5)</span>
<span class="linenos"> 78</span>    <span class="n">c2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span>
<span class="linenos"> 79</span>    <span class="n">c3</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">10</span>
<span class="linenos"> 80</span>    <span class="n">c4</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="mi">5</span>
<span class="linenos"> 81</span>    <span class="n">c5</span> <span class="o">=</span> <span class="mi">8</span><span class="o">/</span><span class="mi">9</span>
<span class="linenos"> 82</span>    <span class="n">c6</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 83</span>    <span class="n">c7</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 84</span>
<span class="linenos"> 85</span>    <span class="n">a21</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span>
<span class="linenos"> 86</span>    <span class="n">a31</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">40</span>
<span class="linenos"> 87</span>    <span class="n">a32</span> <span class="o">=</span> <span class="mi">9</span><span class="o">/</span><span class="mi">40</span>
<span class="linenos"> 88</span>    <span class="n">a41</span> <span class="o">=</span> <span class="mi">44</span><span class="o">/</span><span class="mi">45</span>
<span class="linenos"> 89</span>    <span class="n">a42</span> <span class="o">=</span> <span class="o">-</span><span class="mi">56</span><span class="o">/</span><span class="mi">15</span>
<span class="linenos"> 90</span>    <span class="n">a43</span> <span class="o">=</span> <span class="mi">32</span><span class="o">/</span><span class="mi">9</span>
<span class="linenos"> 91</span>    <span class="n">a51</span> <span class="o">=</span> <span class="mi">19372</span><span class="o">/</span><span class="mi">6561</span>
<span class="linenos"> 92</span>    <span class="n">a52</span> <span class="o">=</span> <span class="o">-</span><span class="mi">25360</span><span class="o">/</span><span class="mi">2187</span>
<span class="linenos"> 93</span>    <span class="n">a53</span> <span class="o">=</span> <span class="mi">64448</span><span class="o">/</span><span class="mi">6561</span>
<span class="linenos"> 94</span>    <span class="n">a54</span> <span class="o">=</span> <span class="o">-</span><span class="mi">212</span><span class="o">/</span><span class="mi">729</span>
<span class="linenos"> 95</span>    <span class="n">a61</span> <span class="o">=</span> <span class="mi">9017</span><span class="o">/</span><span class="mi">3168</span>
<span class="linenos"> 96</span>    <span class="n">a62</span> <span class="o">=</span> <span class="o">-</span><span class="mi">355</span><span class="o">/</span><span class="mi">33</span>
<span class="linenos"> 97</span>    <span class="n">a63</span> <span class="o">=</span> <span class="mi">46732</span><span class="o">/</span><span class="mi">5247</span>
<span class="linenos"> 98</span>    <span class="n">a64</span> <span class="o">=</span> <span class="mi">49</span><span class="o">/</span><span class="mi">176</span>
<span class="linenos"> 99</span>    <span class="n">a65</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5103</span><span class="o">/</span><span class="mi">18656</span>
<span class="linenos">100</span>    <span class="n">a71</span> <span class="o">=</span> <span class="mi">35</span><span class="o">/</span><span class="mi">384</span>
<span class="linenos">101</span>    <span class="n">a72</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">102</span>    <span class="n">a73</span> <span class="o">=</span> <span class="mi">500</span><span class="o">/</span><span class="mi">1113</span>
<span class="linenos">103</span>    <span class="n">a74</span> <span class="o">=</span> <span class="mi">125</span><span class="o">/</span><span class="mi">192</span>
<span class="linenos">104</span>    <span class="n">a75</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2187</span><span class="o">/</span><span class="mi">6784</span>
<span class="linenos">105</span>    <span class="n">a76</span> <span class="o">=</span> <span class="mi">11</span><span class="o">/</span><span class="mi">84</span>
<span class="linenos">106</span>
<span class="linenos">107</span>    <span class="n">b4_1</span> <span class="o">=</span> <span class="mi">5179</span><span class="o">/</span><span class="mi">57600</span>
<span class="linenos">108</span>    <span class="n">b4_3</span> <span class="o">=</span> <span class="mi">7571</span><span class="o">/</span><span class="mi">16695</span>
<span class="linenos">109</span>    <span class="n">b4_4</span> <span class="o">=</span> <span class="mi">393</span><span class="o">/</span><span class="mi">640</span>
<span class="linenos">110</span>    <span class="n">b4_5</span> <span class="o">=</span> <span class="o">-</span><span class="mi">92097</span><span class="o">/</span><span class="mi">339200</span>
<span class="linenos">111</span>    <span class="n">b4_6</span> <span class="o">=</span> <span class="mi">187</span><span class="o">/</span><span class="mi">2100</span>
<span class="linenos">112</span>    <span class="n">b4_7</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">40</span>
<span class="linenos">113</span>    <span class="n">b5_1</span> <span class="o">=</span> <span class="mi">35</span><span class="o">/</span><span class="mi">384</span>
<span class="linenos">114</span>    <span class="n">b5_3</span> <span class="o">=</span> <span class="mi">500</span><span class="o">/</span><span class="mi">1113</span>
<span class="linenos">115</span>    <span class="n">b5_4</span> <span class="o">=</span> <span class="mi">125</span><span class="o">/</span><span class="mi">192</span>
<span class="linenos">116</span>    <span class="n">b5_5</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2187</span><span class="o">/</span><span class="mi">6784</span>
<span class="linenos">117</span>    <span class="n">b5_6</span> <span class="o">=</span> <span class="mi">11</span><span class="o">/</span><span class="mi">84</span>
<span class="linenos">118</span>    <span class="n">b5_7</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">119</span>
<span class="linenos">120</span>    <span class="c1"># Evaluate the stages</span>
<span class="linenos">121</span>    <span class="n">k1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="linenos">122</span>    <span class="n">k2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">a21</span><span class="o">*</span><span class="n">k1</span><span class="p">))</span>
<span class="linenos">123</span>    <span class="n">k3</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">a31</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">a32</span><span class="o">*</span><span class="n">k2</span><span class="p">))</span>
<span class="linenos">124</span>    <span class="n">k4</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c4</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">a41</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">a42</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="n">a43</span><span class="o">*</span><span class="n">k3</span><span class="p">))</span>
<span class="linenos">125</span>    <span class="n">k5</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">a51</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">a52</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="n">a53</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">a54</span><span class="o">*</span><span class="n">k4</span><span class="p">))</span>
<span class="linenos">126</span>    <span class="n">k6</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">a61</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">a62</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="n">a63</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">a64</span><span class="o">*</span><span class="n">k4</span> <span class="o">+</span> <span class="n">a65</span><span class="o">*</span><span class="n">k5</span><span class="p">))</span>
<span class="linenos">127</span>    <span class="n">k7</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">a71</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">a72</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="n">a73</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">a74</span><span class="o">*</span><span class="n">k4</span> <span class="o">+</span> <span class="n">a75</span><span class="o">*</span><span class="n">k5</span> <span class="o">+</span> <span class="n">a76</span><span class="o">*</span><span class="n">k6</span><span class="p">))</span>
<span class="linenos">128</span>
<span class="linenos">129</span>    <span class="c1"># 4th‑order and 5th‑order solutions</span>
<span class="linenos">130</span>    <span class="n">y4</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">b4_1</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">b4_3</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">b4_4</span><span class="o">*</span><span class="n">k4</span> <span class="o">+</span> <span class="n">b4_5</span><span class="o">*</span><span class="n">k5</span> <span class="o">+</span> <span class="n">b4_6</span><span class="o">*</span><span class="n">k6</span> <span class="o">+</span> <span class="n">b4_7</span><span class="o">*</span><span class="n">k7</span><span class="p">)</span>
<span class="linenos">131</span>    <span class="n">y5</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">b5_1</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">b5_3</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">b5_4</span><span class="o">*</span><span class="n">k4</span> <span class="o">+</span> <span class="n">b5_5</span><span class="o">*</span><span class="n">k5</span> <span class="o">+</span> <span class="n">b5_6</span><span class="o">*</span><span class="n">k6</span> <span class="o">+</span> <span class="n">b5_7</span><span class="o">*</span><span class="n">k7</span><span class="p">)</span>
<span class="linenos">132</span>
<span class="linenos">133</span>    <span class="c1"># Estimate the local error</span>
<span class="linenos">134</span>    <span class="n">err</span> <span class="o">=</span> <span class="n">y5</span> <span class="o">-</span> <span class="n">y4</span>
<span class="linenos">135</span>    <span class="c1"># Compute norm relative to tolerances</span>
<span class="linenos">136</span>    <span class="n">scale</span> <span class="o">=</span> <span class="n">abs_tol</span> <span class="o">+</span> <span class="n">rel_tol</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y5</span><span class="p">))</span>
<span class="linenos">137</span>    <span class="n">error_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">err</span> <span class="o">/</span> <span class="n">scale</span><span class="p">)</span>
<span class="linenos">138</span>
<span class="linenos">139</span>    <span class="c1"># Determine whether to accept the step.  A typical tolerance for the</span>
<span class="linenos">140</span>    <span class="c1"># error norm is 1.  See the cited source for rationale【313837333132264†L58-L82】.</span>
<span class="linenos">141</span>    <span class="k">if</span> <span class="n">error_norm</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">:</span>
<span class="linenos">142</span>        <span class="c1"># Accept the step; propose new step size for next call</span>
<span class="linenos">143</span>        <span class="c1"># Safety factors: shrink if error close to 1.0, grow if much smaller</span>
<span class="linenos">144</span>        <span class="c1"># Use exponent 1/5 because the method is 5th order</span>
<span class="linenos">145</span>        <span class="n">dt_new</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">error_norm</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">)))</span>
<span class="linenos">146</span>        <span class="k">return</span> <span class="n">y5</span><span class="p">,</span> <span class="n">dt_new</span>
<span class="linenos">147</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">148</span>        <span class="c1"># Reject the step; suggest smaller dt and return None</span>
<span class="linenos">149</span>        <span class="n">dt_new</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">error_norm</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">))</span>
<span class="linenos">150</span>        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dt_new</span>
<span class="linenos">151</span>
<span class="linenos">152</span><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;rk45_step&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<section id="rk45-step-f-t-y-dt-abs-tol-rel-tol">
<h3><code class="docutils literal notranslate"><span class="pre">rk45_step(f,</span> <span class="pre">t,</span> <span class="pre">y,</span> <span class="pre">dt,</span> <span class="pre">abs_tol,</span> <span class="pre">rel_tol)</span></code><a class="headerlink" href="#rk45-step-f-t-y-dt-abs-tol-rel-tol" title="Link to this heading">¶</a></h3>
<p>Perform a single Dormand–Prince 4(5) integration step.</p>
</section>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h2>
<p>f : Callable[[float, np.ndarray], np.ndarray]
Function computing the time derivative of the state <code class="docutils literal notranslate"><span class="pre">y</span></code> at time
<code class="docutils literal notranslate"><span class="pre">t</span></code>.  The derivative must be a one‑dimensional NumPy array.
t : float
Current integration time.
y : np.ndarray
Current state vector.
dt : float
Proposed step size.
abs_tol : float
Absolute tolerance for local error control.
rel_tol : float
Relative tolerance for local error control.</p>
</section>
<section id="returns">
<h2>Returns<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h2>
<p>Tuple[Optional[np.ndarray], float]
A tuple <code class="docutils literal notranslate"><span class="pre">(y_new,</span> <span class="pre">dt_new)</span></code>.  If the step is accepted then
<code class="docutils literal notranslate"><span class="pre">y_new</span></code> contains the 5th‑order solution at <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">+</span> <span class="pre">dt</span></code> and
<code class="docutils literal notranslate"><span class="pre">dt_new</span></code> is a suggested step size for the next step.  If the
step is rejected then <code class="docutils literal notranslate"><span class="pre">y_new</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code> and <code class="docutils literal notranslate"><span class="pre">dt_new</span></code> is a
smaller step size to retry.</p>
</section>
<section id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Link to this heading">¶</a></h2>
<p>This implementation uses the Dormand–Prince coefficients for the
classic <code class="docutils literal notranslate"><span class="pre">RK45</span></code> method.  The constants are hard‑coded for clarity
rather than generated programmatically.  See the cited reference
for the Butcher tableau【313837333132264†L58-L82】.</p>
<section id="source-code">
<h3>Source Code<a class="headerlink" href="#source-code" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="k">def</span><span class="w"> </span><span class="nf">rk45_step</span><span class="p">(</span><span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
<span class="linenos">  2</span>              <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="linenos">  3</span>              <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<span class="linenos">  4</span>              <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="linenos">  5</span>              <span class="n">abs_tol</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="linenos">  6</span>              <span class="n">rel_tol</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="nb">float</span><span class="p">]:</span>
<span class="linenos">  7</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a single Dormand–Prince 4(5) integration step.</span>
<span class="linenos">  8</span>
<span class="linenos">  9</span><span class="sd">    Parameters</span>
<span class="linenos"> 10</span><span class="sd">    ----------</span>
<span class="linenos"> 11</span><span class="sd">    f : Callable[[float, np.ndarray], np.ndarray]</span>
<span class="linenos"> 12</span><span class="sd">        Function computing the time derivative of the state ``y`` at time</span>
<span class="linenos"> 13</span><span class="sd">        ``t``.  The derivative must be a one‑dimensional NumPy array.</span>
<span class="linenos"> 14</span><span class="sd">    t : float</span>
<span class="linenos"> 15</span><span class="sd">        Current integration time.</span>
<span class="linenos"> 16</span><span class="sd">    y : np.ndarray</span>
<span class="linenos"> 17</span><span class="sd">        Current state vector.</span>
<span class="linenos"> 18</span><span class="sd">    dt : float</span>
<span class="linenos"> 19</span><span class="sd">        Proposed step size.</span>
<span class="linenos"> 20</span><span class="sd">    abs_tol : float</span>
<span class="linenos"> 21</span><span class="sd">        Absolute tolerance for local error control.</span>
<span class="linenos"> 22</span><span class="sd">    rel_tol : float</span>
<span class="linenos"> 23</span><span class="sd">        Relative tolerance for local error control.</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span><span class="sd">    Returns</span>
<span class="linenos"> 26</span><span class="sd">    -------</span>
<span class="linenos"> 27</span><span class="sd">    Tuple[Optional[np.ndarray], float]</span>
<span class="linenos"> 28</span><span class="sd">        A tuple ``(y_new, dt_new)``.  If the step is accepted then</span>
<span class="linenos"> 29</span><span class="sd">        ``y_new`` contains the 5th‑order solution at ``t + dt`` and</span>
<span class="linenos"> 30</span><span class="sd">        ``dt_new`` is a suggested step size for the next step.  If the</span>
<span class="linenos"> 31</span><span class="sd">        step is rejected then ``y_new`` is ``None`` and ``dt_new`` is a</span>
<span class="linenos"> 32</span><span class="sd">        smaller step size to retry.</span>
<span class="linenos"> 33</span>
<span class="linenos"> 34</span><span class="sd">    Notes</span>
<span class="linenos"> 35</span><span class="sd">    -----</span>
<span class="linenos"> 36</span><span class="sd">    This implementation uses the Dormand–Prince coefficients for the</span>
<span class="linenos"> 37</span><span class="sd">    classic `RK45` method.  The constants are hard‑coded for clarity</span>
<span class="linenos"> 38</span><span class="sd">    rather than generated programmatically.  See the cited reference</span>
<span class="linenos"> 39</span><span class="sd">    for the Butcher tableau【313837333132264†L58-L82】.</span>
<span class="linenos"> 40</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 41</span>    <span class="c1"># Dormand–Prince coefficients (c, a&#39;s, b4, b5)</span>
<span class="linenos"> 42</span>    <span class="n">c2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span>
<span class="linenos"> 43</span>    <span class="n">c3</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">10</span>
<span class="linenos"> 44</span>    <span class="n">c4</span> <span class="o">=</span> <span class="mi">4</span><span class="o">/</span><span class="mi">5</span>
<span class="linenos"> 45</span>    <span class="n">c5</span> <span class="o">=</span> <span class="mi">8</span><span class="o">/</span><span class="mi">9</span>
<span class="linenos"> 46</span>    <span class="n">c6</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 47</span>    <span class="n">c7</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="linenos"> 48</span>
<span class="linenos"> 49</span>    <span class="n">a21</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span>
<span class="linenos"> 50</span>    <span class="n">a31</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mi">40</span>
<span class="linenos"> 51</span>    <span class="n">a32</span> <span class="o">=</span> <span class="mi">9</span><span class="o">/</span><span class="mi">40</span>
<span class="linenos"> 52</span>    <span class="n">a41</span> <span class="o">=</span> <span class="mi">44</span><span class="o">/</span><span class="mi">45</span>
<span class="linenos"> 53</span>    <span class="n">a42</span> <span class="o">=</span> <span class="o">-</span><span class="mi">56</span><span class="o">/</span><span class="mi">15</span>
<span class="linenos"> 54</span>    <span class="n">a43</span> <span class="o">=</span> <span class="mi">32</span><span class="o">/</span><span class="mi">9</span>
<span class="linenos"> 55</span>    <span class="n">a51</span> <span class="o">=</span> <span class="mi">19372</span><span class="o">/</span><span class="mi">6561</span>
<span class="linenos"> 56</span>    <span class="n">a52</span> <span class="o">=</span> <span class="o">-</span><span class="mi">25360</span><span class="o">/</span><span class="mi">2187</span>
<span class="linenos"> 57</span>    <span class="n">a53</span> <span class="o">=</span> <span class="mi">64448</span><span class="o">/</span><span class="mi">6561</span>
<span class="linenos"> 58</span>    <span class="n">a54</span> <span class="o">=</span> <span class="o">-</span><span class="mi">212</span><span class="o">/</span><span class="mi">729</span>
<span class="linenos"> 59</span>    <span class="n">a61</span> <span class="o">=</span> <span class="mi">9017</span><span class="o">/</span><span class="mi">3168</span>
<span class="linenos"> 60</span>    <span class="n">a62</span> <span class="o">=</span> <span class="o">-</span><span class="mi">355</span><span class="o">/</span><span class="mi">33</span>
<span class="linenos"> 61</span>    <span class="n">a63</span> <span class="o">=</span> <span class="mi">46732</span><span class="o">/</span><span class="mi">5247</span>
<span class="linenos"> 62</span>    <span class="n">a64</span> <span class="o">=</span> <span class="mi">49</span><span class="o">/</span><span class="mi">176</span>
<span class="linenos"> 63</span>    <span class="n">a65</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5103</span><span class="o">/</span><span class="mi">18656</span>
<span class="linenos"> 64</span>    <span class="n">a71</span> <span class="o">=</span> <span class="mi">35</span><span class="o">/</span><span class="mi">384</span>
<span class="linenos"> 65</span>    <span class="n">a72</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 66</span>    <span class="n">a73</span> <span class="o">=</span> <span class="mi">500</span><span class="o">/</span><span class="mi">1113</span>
<span class="linenos"> 67</span>    <span class="n">a74</span> <span class="o">=</span> <span class="mi">125</span><span class="o">/</span><span class="mi">192</span>
<span class="linenos"> 68</span>    <span class="n">a75</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2187</span><span class="o">/</span><span class="mi">6784</span>
<span class="linenos"> 69</span>    <span class="n">a76</span> <span class="o">=</span> <span class="mi">11</span><span class="o">/</span><span class="mi">84</span>
<span class="linenos"> 70</span>
<span class="linenos"> 71</span>    <span class="n">b4_1</span> <span class="o">=</span> <span class="mi">5179</span><span class="o">/</span><span class="mi">57600</span>
<span class="linenos"> 72</span>    <span class="n">b4_3</span> <span class="o">=</span> <span class="mi">7571</span><span class="o">/</span><span class="mi">16695</span>
<span class="linenos"> 73</span>    <span class="n">b4_4</span> <span class="o">=</span> <span class="mi">393</span><span class="o">/</span><span class="mi">640</span>
<span class="linenos"> 74</span>    <span class="n">b4_5</span> <span class="o">=</span> <span class="o">-</span><span class="mi">92097</span><span class="o">/</span><span class="mi">339200</span>
<span class="linenos"> 75</span>    <span class="n">b4_6</span> <span class="o">=</span> <span class="mi">187</span><span class="o">/</span><span class="mi">2100</span>
<span class="linenos"> 76</span>    <span class="n">b4_7</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">40</span>
<span class="linenos"> 77</span>    <span class="n">b5_1</span> <span class="o">=</span> <span class="mi">35</span><span class="o">/</span><span class="mi">384</span>
<span class="linenos"> 78</span>    <span class="n">b5_3</span> <span class="o">=</span> <span class="mi">500</span><span class="o">/</span><span class="mi">1113</span>
<span class="linenos"> 79</span>    <span class="n">b5_4</span> <span class="o">=</span> <span class="mi">125</span><span class="o">/</span><span class="mi">192</span>
<span class="linenos"> 80</span>    <span class="n">b5_5</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2187</span><span class="o">/</span><span class="mi">6784</span>
<span class="linenos"> 81</span>    <span class="n">b5_6</span> <span class="o">=</span> <span class="mi">11</span><span class="o">/</span><span class="mi">84</span>
<span class="linenos"> 82</span>    <span class="n">b5_7</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos"> 83</span>
<span class="linenos"> 84</span>    <span class="c1"># Evaluate the stages</span>
<span class="linenos"> 85</span>    <span class="n">k1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="linenos"> 86</span>    <span class="n">k2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">a21</span><span class="o">*</span><span class="n">k1</span><span class="p">))</span>
<span class="linenos"> 87</span>    <span class="n">k3</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">a31</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">a32</span><span class="o">*</span><span class="n">k2</span><span class="p">))</span>
<span class="linenos"> 88</span>    <span class="n">k4</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c4</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">a41</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">a42</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="n">a43</span><span class="o">*</span><span class="n">k3</span><span class="p">))</span>
<span class="linenos"> 89</span>    <span class="n">k5</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c5</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">a51</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">a52</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="n">a53</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">a54</span><span class="o">*</span><span class="n">k4</span><span class="p">))</span>
<span class="linenos"> 90</span>    <span class="n">k6</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">a61</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">a62</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="n">a63</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">a64</span><span class="o">*</span><span class="n">k4</span> <span class="o">+</span> <span class="n">a65</span><span class="o">*</span><span class="n">k5</span><span class="p">))</span>
<span class="linenos"> 91</span>    <span class="n">k7</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">dt</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">a71</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">a72</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="n">a73</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">a74</span><span class="o">*</span><span class="n">k4</span> <span class="o">+</span> <span class="n">a75</span><span class="o">*</span><span class="n">k5</span> <span class="o">+</span> <span class="n">a76</span><span class="o">*</span><span class="n">k6</span><span class="p">))</span>
<span class="linenos"> 92</span>
<span class="linenos"> 93</span>    <span class="c1"># 4th‑order and 5th‑order solutions</span>
<span class="linenos"> 94</span>    <span class="n">y4</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">b4_1</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">b4_3</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">b4_4</span><span class="o">*</span><span class="n">k4</span> <span class="o">+</span> <span class="n">b4_5</span><span class="o">*</span><span class="n">k5</span> <span class="o">+</span> <span class="n">b4_6</span><span class="o">*</span><span class="n">k6</span> <span class="o">+</span> <span class="n">b4_7</span><span class="o">*</span><span class="n">k7</span><span class="p">)</span>
<span class="linenos"> 95</span>    <span class="n">y5</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">b5_1</span><span class="o">*</span><span class="n">k1</span> <span class="o">+</span> <span class="n">b5_3</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">b5_4</span><span class="o">*</span><span class="n">k4</span> <span class="o">+</span> <span class="n">b5_5</span><span class="o">*</span><span class="n">k5</span> <span class="o">+</span> <span class="n">b5_6</span><span class="o">*</span><span class="n">k6</span> <span class="o">+</span> <span class="n">b5_7</span><span class="o">*</span><span class="n">k7</span><span class="p">)</span>
<span class="linenos"> 96</span>
<span class="linenos"> 97</span>    <span class="c1"># Estimate the local error</span>
<span class="linenos"> 98</span>    <span class="n">err</span> <span class="o">=</span> <span class="n">y5</span> <span class="o">-</span> <span class="n">y4</span>
<span class="linenos"> 99</span>    <span class="c1"># Compute norm relative to tolerances</span>
<span class="linenos">100</span>    <span class="n">scale</span> <span class="o">=</span> <span class="n">abs_tol</span> <span class="o">+</span> <span class="n">rel_tol</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y5</span><span class="p">))</span>
<span class="linenos">101</span>    <span class="n">error_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">err</span> <span class="o">/</span> <span class="n">scale</span><span class="p">)</span>
<span class="linenos">102</span>
<span class="linenos">103</span>    <span class="c1"># Determine whether to accept the step.  A typical tolerance for the</span>
<span class="linenos">104</span>    <span class="c1"># error norm is 1.  See the cited source for rationale【313837333132264†L58-L82】.</span>
<span class="linenos">105</span>    <span class="k">if</span> <span class="n">error_norm</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">:</span>
<span class="linenos">106</span>        <span class="c1"># Accept the step; propose new step size for next call</span>
<span class="linenos">107</span>        <span class="c1"># Safety factors: shrink if error close to 1.0, grow if much smaller</span>
<span class="linenos">108</span>        <span class="c1"># Use exponent 1/5 because the method is 5th order</span>
<span class="linenos">109</span>        <span class="n">dt_new</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">error_norm</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">)))</span>
<span class="linenos">110</span>        <span class="k">return</span> <span class="n">y5</span><span class="p">,</span> <span class="n">dt_new</span>
<span class="linenos">111</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">112</span>        <span class="c1"># Reject the step; suggest smaller dt and return None</span>
<span class="linenos">113</span>        <span class="n">dt_new</span> <span class="o">=</span> <span class="n">dt</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">error_norm</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">))</span>
<span class="linenos">114</span>        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dt_new</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading">¶</a></h2>
<p>This module imports:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">__future__</span> <span class="pre">import</span> <span class="pre">annotations</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">typing</span> <span class="pre">import</span> <span class="pre">Callable,</span> <span class="pre">Tuple,</span> <span class="pre">Optional</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code></p></li>
</ul>
</section>
<section id="advanced-mathematical-theory">
<h2>Advanced Mathematical Theory<a class="headerlink" href="#advanced-mathematical-theory" title="Link to this heading">¶</a></h2>
<section id="adaptive-step-size-control">
<h3>Adaptive Step Size Control<a class="headerlink" href="#adaptive-step-size-control" title="Link to this heading">¶</a></h3>
<p><strong>Error estimation (embedded RK pairs):</strong></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\epsilon_n = \|\vec{x}_{n+1}^{\text{high}} - \vec{x}_{n+1}^{\text{low}}\|\]</div>
</div>
<p><strong>Step size adaptation:</strong></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[h_{\text{new}} = h \cdot \min\left(f_{\max}, \max\left(f_{\min}, f \cdot \left(\frac{\text{tol}}{\epsilon}\right)^{1/p}\right)\right)\]</div>
</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> is the lower order of the embedded pair</p></li>
<li><p><span class="math notranslate nohighlight">\(f, f_{\min}, f_{\max}\)</span> are safety factors</p></li>
</ul>
</section>
<section id="runge-kutta-fehlberg-rk45">
<h3>Runge-Kutta-Fehlberg (RK45)<a class="headerlink" href="#runge-kutta-fehlberg-rk45" title="Link to this heading">¶</a></h3>
<p><strong>Fourth-order solution:</strong></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\vec{x}_{n+1}^{(4)} = \vec{x}_n + h\sum_{i=1}^{6} b_i \vec{k}_i\]</div>
</div>
<p><strong>Fifth-order solution:</strong></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\vec{x}_{n+1}^{(5)} = \vec{x}_n + h\sum_{i=1}^{6} b_i^* \vec{k}_i\]</div>
</div>
<p><strong>Butcher tableau coefficients:</strong></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\vec{k}_i = \vec{f}\left(t_n + c_i h, \vec{x}_n + h\sum_{j=1}^{i-1} a_{ij}\vec{k}_j\right)\]</div>
</div>
</section>
<section id="dormand-prince-method">
<h3>Dormand-Prince Method<a class="headerlink" href="#dormand-prince-method" title="Link to this heading">¶</a></h3>
<p><strong>Fifth-order accurate with fourth-order error estimate:</strong></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\text{Solution:} \quad &amp;\vec{x}_{n+1} = \vec{x}_n + h\sum_{i=1}^{7} b_i \vec{k}_i \quad O(h^6) \\
\text{Error Est:} \quad &amp;\epsilon_n = h\sum_{i=1}^{7} (b_i - b_i^*) \vec{k}_i \quad O(h^5)
\end{align}\end{split}\]</div>
</div>
</section>
<section id="step-acceptance-criteria">
<h3>Step Acceptance Criteria<a class="headerlink" href="#step-acceptance-criteria" title="Link to this heading">¶</a></h3>
<p><strong>Accept step if:</strong></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\epsilon_n \leq \text{tol} \cdot \max(\|\vec{x}_n\|, \|\vec{x}_{n+1}\|)\]</div>
</div>
<p><strong>Reject and retry with:</strong></p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[h_{\text{retry}} = h \cdot \max\left(0.1, 0.9\left(\frac{\text{tol}}{\epsilon_n}\right)^{1/p}\right)\]</div>
</div>
</section>
</section>
<section id="architecture-diagram">
<h2>Architecture Diagram<a class="headerlink" href="#architecture-diagram" title="Link to this heading">¶</a></h2>
<div class="mermaid">
            graph TD
    A[x_n, t_n, h] --&gt; B[Embedded RK Step]

    B --&gt; C[High-Order Solution]
    B --&gt; D[Low-Order Solution]

    C --&gt; E[x_n+1^high_]
    D --&gt; F[x_n+1^low_]

    E --&gt; G[Error Estimate]
    F --&gt; G

    G --&gt; H[ε = ||x^high - x^low||]
    H --&gt; I{ε ≤ tol?}

    I --&gt;|Yes| J[Accept Step]
    I --&gt;|No| K[Reject Step]

    J --&gt; L[Update h_new]
    L --&gt; M[h_new = h·_tol/ε_^1/p]

    K --&gt; N[Reduce h]
    N --&gt; O[h_new = 0.5·h]
    O --&gt; B

    M --&gt; P[x_n+1, t_n+1_]
    P --&gt; Q{t &lt; T?}
    Q --&gt;|Yes| A
    Q --&gt;|No| R[Final Solution]

    style J fill:#9f9
    style K fill:#f99
    style P fill:#9cf
        </div></section>
<section id="usage-examples">
<h2>Usage Examples<a class="headerlink" href="#usage-examples" title="Link to this heading">¶</a></h2>
<section id="example-1-basic-simulation">
<h3>Example 1: Basic Simulation<a class="headerlink" href="#example-1-basic-simulation" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimulationEngine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.engines</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimulationRunner</span>

<span class="c1"># Initialize simulation engine</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">SimulationRunner</span><span class="p">(</span>
    <span class="n">controller</span><span class="o">=</span><span class="n">controller</span><span class="p">,</span>
    <span class="n">dynamics</span><span class="o">=</span><span class="n">dynamics</span><span class="p">,</span>
    <span class="n">integrator</span><span class="o">=</span><span class="s1">&#39;rk4&#39;</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span>
<span class="p">)</span>

<span class="c1"># Run simulation</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span>
    <span class="n">x0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
    <span class="n">duration</span><span class="o">=</span><span class="mf">5.0</span>
<span class="p">)</span>

<span class="c1"># Extract trajectories</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">time</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">states</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">controls</span>
</pre></div>
</div>
</section>
<section id="example-2-adaptive-integration">
<h3>Example 2: Adaptive Integration<a class="headerlink" href="#example-2-adaptive-integration" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.integrators.adaptive</span><span class="w"> </span><span class="kn">import</span> <span class="n">AdaptiveRK45Integrator</span>

<span class="c1"># Create adaptive integrator</span>
<span class="n">integrator</span> <span class="o">=</span> <span class="n">AdaptiveRK45Integrator</span><span class="p">(</span>
    <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
    <span class="n">atol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span>
    <span class="n">max_step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">min_step</span><span class="o">=</span><span class="mf">1e-6</span>
<span class="p">)</span>

<span class="c1"># Simulate with automatic step size control</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span>
    <span class="n">x0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
    <span class="n">duration</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">integrator</span>
<span class="p">)</span>

<span class="c1"># Check step size history</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Steps taken: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">time</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average dt: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">time</span><span class="p">))</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="example-3-batch-simulation-numba">
<h3>Example 3: Batch Simulation (Numba)<a class="headerlink" href="#example-3-batch-simulation-numba" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.engines</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_batch_simulation</span>

<span class="c1"># Define batch of initial conditions</span>
<span class="n">x0_batch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1"># 100 initial states</span>

<span class="c1"># Vectorized batch simulation</span>
<span class="n">results_batch</span> <span class="o">=</span> <span class="n">run_batch_simulation</span><span class="p">(</span>
    <span class="n">controller</span><span class="o">=</span><span class="n">controller</span><span class="p">,</span>
    <span class="n">dynamics</span><span class="o">=</span><span class="n">dynamics</span><span class="p">,</span>
    <span class="n">x0_batch</span><span class="o">=</span><span class="n">x0_batch</span><span class="p">,</span>
    <span class="n">duration</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
    <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span>
<span class="p">)</span>

<span class="c1"># Compute batch statistics</span>
<span class="n">mean_trajectory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">results_batch</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">std_trajectory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">results_batch</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="example-4-safety-guards">
<h3>Example 4: Safety Guards<a class="headerlink" href="#example-4-safety-guards" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.context</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimulationContext</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.safety</span><span class="w"> </span><span class="kn">import</span> <span class="n">SafetyGuards</span>

<span class="c1"># Configure safety constraints</span>
<span class="n">safety</span> <span class="o">=</span> <span class="n">SafetyGuards</span><span class="p">(</span>
    <span class="n">state_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">control_bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">deadline_ms</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
    <span class="n">max_condition_number</span><span class="o">=</span><span class="mf">1e6</span>
<span class="p">)</span>

<span class="c1"># Simulation with safety monitoring</span>
<span class="k">with</span> <span class="n">SimulationContext</span><span class="p">(</span><span class="n">controller</span><span class="p">,</span> <span class="n">dynamics</span><span class="p">,</span> <span class="n">safety</span><span class="p">)</span> <span class="k">as</span> <span class="n">ctx</span><span class="p">:</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>

    <span class="c1"># Check safety violations</span>
    <span class="n">violations</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">get_safety_violations</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">violations</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">violations</span><span class="p">)</span><span class="si">}</span><span class="s2"> safety events detected&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="example-5-performance-profiling">
<h3>Example 5: Performance Profiling<a class="headerlink" href="#example-5-performance-profiling" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">src.simulation.engines</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimulationRunner</span>

<span class="c1"># Profile different integrators</span>
<span class="n">integrators</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;euler&#39;</span><span class="p">,</span> <span class="s1">&#39;rk4&#39;</span><span class="p">,</span> <span class="s1">&#39;rk45&#39;</span><span class="p">]</span>
<span class="n">times</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">integrators</span><span class="p">:</span>
    <span class="n">runner</span> <span class="o">=</span> <span class="n">SimulationRunner</span><span class="p">(</span>
        <span class="n">controller</span><span class="o">=</span><span class="n">controller</span><span class="p">,</span>
        <span class="n">dynamics</span><span class="o">=</span><span class="n">dynamics</span><span class="p">,</span>
        <span class="n">integrator</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span>
    <span class="p">)</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
    <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>

    <span class="n">times</span><span class="p">[</span><span class="n">method</span><span class="p">]</span> <span class="o">=</span> <span class="n">elapsed</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">elapsed</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">time</span><span class="p">)</span><span class="si">}</span><span class="s2"> steps)&quot;</span><span class="p">)</span>

<span class="c1"># Compare speedup</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">RK4 vs Euler speedup: </span><span class="si">{</span><span class="n">times</span><span class="p">[</span><span class="s1">&#39;euler&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">times</span><span class="p">[</span><span class="s1">&#39;rk4&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Research Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Oct 08, 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">simulation.engines.adaptive_integrator</a><ul>
<li><a class="reference internal" href="#module-overview">Module Overview</a></li>
<li><a class="reference internal" href="#complete-source-code">Complete Source Code</a></li>
<li><a class="reference internal" href="#functions">Functions</a><ul>
<li><a class="reference internal" href="#rk45-step-f-t-y-dt-abs-tol-rel-tol"><code class="docutils literal notranslate"><span class="pre">rk45_step(f,</span> <span class="pre">t,</span> <span class="pre">y,</span> <span class="pre">dt,</span> <span class="pre">abs_tol,</span> <span class="pre">rel_tol)</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters">Parameters</a></li>
<li><a class="reference internal" href="#returns">Returns</a></li>
<li><a class="reference internal" href="#notes">Notes</a><ul>
<li><a class="reference internal" href="#source-code">Source Code</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#advanced-mathematical-theory">Advanced Mathematical Theory</a><ul>
<li><a class="reference internal" href="#adaptive-step-size-control">Adaptive Step Size Control</a></li>
<li><a class="reference internal" href="#runge-kutta-fehlberg-rk45">Runge-Kutta-Fehlberg (RK45)</a></li>
<li><a class="reference internal" href="#dormand-prince-method">Dormand-Prince Method</a></li>
<li><a class="reference internal" href="#step-acceptance-criteria">Step Acceptance Criteria</a></li>
</ul>
</li>
<li><a class="reference internal" href="#architecture-diagram">Architecture Diagram</a></li>
<li><a class="reference internal" href="#usage-examples">Usage Examples</a><ul>
<li><a class="reference internal" href="#example-1-basic-simulation">Example 1: Basic Simulation</a></li>
<li><a class="reference internal" href="#example-2-adaptive-integration">Example 2: Adaptive Integration</a></li>
<li><a class="reference internal" href="#example-3-batch-simulation-numba">Example 3: Batch Simulation (Numba)</a></li>
<li><a class="reference internal" href="#example-4-safety-guards">Example 4: Safety Guards</a></li>
<li><a class="reference internal" href="#example-5-performance-profiling">Example 5: Performance Profiling</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=4ebf8126"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=08e7b316"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"tex": {"tags": "all", "tagSide": "right", "macros": {"vec": ["\\boldsymbol{#1}", 1], "mat": ["\\boldsymbol{#1}", 1], "norm": ["\\left\\|#1\\right\\|", 1], "R": "\\mathbb{R}", "C": "\\mathbb{C}", "N": "\\mathbb{N}", "Z": "\\mathbb{Z}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://unpkg.com/mermaid@10.2.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true,theme:'neutral'});</script>
    <script src="../../_static/back-to-top.js?v=840797bb"></script>
    <script src="../../_static/lazy-load.js?v=dc25293c"></script>
    <script src="../../_static/dark-mode.js?v=bf328970"></script>
    </body>
</html>