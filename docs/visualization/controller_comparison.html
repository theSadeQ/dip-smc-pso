<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controller Comparison Tool - DIP SMC PSO</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .control-panel {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .control-panel h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #f5f5f5;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .checkbox-item:hover {
            background: #e8e8e8;
        }

        .checkbox-item input {
            margin-right: 10px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-item label {
            cursor: pointer;
            font-weight: 500;
        }

        .metric-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .metric-btn {
            padding: 10px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .metric-btn:hover {
            background: #667eea;
            color: white;
        }

        .metric-btn.active {
            background: #667eea;
            color: white;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .chart-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .chart-card h3 {
            color: #667eea;
            font-size: 1.3em;
            margin-bottom: 15px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 15px;
        }

        .summary-table {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: #f5f5f5;
        }

        .best-value {
            background: #c3f0c3;
            font-weight: bold;
        }

        footer {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-top: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .back-link {
            display: inline-block;
            margin-top: 10px;
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
        }

        .back-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéØ Interactive Controller Comparison Tool</h1>
            <p class="subtitle">Compare SMC controller variants across multiple performance metrics with interactive filtering</p>
        </header>

        <div class="control-panel">
            <h2>üîß Controller Selection</h2>
            <div class="checkbox-group">
                <div class="checkbox-item">
                    <input type="checkbox" id="ctrl-classical" value="classical" checked>
                    <label for="ctrl-classical">Classical SMC</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ctrl-sta" value="sta" checked>
                    <label for="ctrl-sta">Super-Twisting STA-SMC</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ctrl-adaptive" value="adaptive" checked>
                    <label for="ctrl-adaptive">Adaptive SMC</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ctrl-hybrid" value="hybrid" checked>
                    <label for="ctrl-hybrid">Hybrid Adaptive-STA SMC</label>
                </div>
            </div>

            <h2 style="margin-top: 20px;">üìä Metric Selection</h2>
            <div class="metric-selector">
                <button class="metric-btn active" data-metric="settling-time">Settling Time</button>
                <button class="metric-btn active" data-metric="computational">Computational Efficiency</button>
                <button class="metric-btn active" data-metric="stability">Stability Scores</button>
                <button class="metric-btn" data-metric="overshoot">Overshoot Analysis</button>
            </div>
        </div>

        <div class="comparison-grid" id="chartGrid">
            <!-- Charts will be dynamically inserted here -->
        </div>

        <div class="summary-table">
            <h2 style="color: #667eea; margin-bottom: 10px;">üìã Performance Summary Table</h2>
            <table id="summaryTable">
                <thead>
                    <tr>
                        <th>Controller</th>
                        <th>Settling Time (s)</th>
                        <th>Computation (ms)</th>
                        <th>Overshoot (%)</th>
                        <th>Stability Score</th>
                        <th>Overall Rank</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Data will be populated by JavaScript -->
                </tbody>
            </table>
        </div>

        <footer>
            <p><strong>DIP-SMC-PSO Controller Comparison Tool</strong></p>
            <p style="margin-top: 10px; color: #666;">
                Select controllers and metrics above to customize your comparison view
            </p>
            <a href="interactive_dashboard.html" class="back-link">‚Üê Back to Dashboard</a>
        </footer>
    </div>

    <script>
        // Sample data structure (would be loaded from JSON in production)
        const performanceData = {
            'classical': {
                name: 'Classical SMC',
                settlingTime: 1.85,
                computation: 0.022,
                overshoot: 8.2,
                stability: 100,
                color: 'rgba(75, 192, 192, 0.8)'
            },
            'sta': {
                name: 'STA-SMC',
                settlingTime: 2.12,
                computation: 0.031,
                overshoot: 7.8,
                stability: 95,
                color: 'rgba(255, 99, 132, 0.8)'
            },
            'adaptive': {
                name: 'Adaptive SMC',
                settlingTime: 2.45,
                computation: 0.041,
                overshoot: 12.5,
                stability: 90,
                color: 'rgba(54, 162, 235, 0.8)'
            },
            'hybrid': {
                name: 'Hybrid Adaptive-STA',
                settlingTime: 2.08,
                computation: 0.038,
                overshoot: 9.1,
                stability: 98,
                color: 'rgba(255, 206, 86, 0.8)'
            }
        };

        let charts = {};
        let selectedControllers = ['classical', 'sta', 'adaptive', 'hybrid'];
        let selectedMetrics = ['settling-time', 'computational', 'stability'];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            updateCharts();
            updateTable();
        });

        function setupEventListeners() {
            // Controller checkboxes
            document.querySelectorAll('.checkbox-item input').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    updateSelectedControllers();
                    updateCharts();
                    updateTable();
                });
            });

            // Metric buttons
            document.querySelectorAll('.metric-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.classList.toggle('active');
                    updateSelectedMetrics();
                    updateCharts();
                });
            });
        }

        function updateSelectedControllers() {
            selectedControllers = Array.from(document.querySelectorAll('.checkbox-item input:checked'))
                .map(cb => cb.value);
        }

        function updateSelectedMetrics() {
            selectedMetrics = Array.from(document.querySelectorAll('.metric-btn.active'))
                .map(btn => btn.dataset.metric);
        }

        function updateCharts() {
            const grid = document.getElementById('chartGrid');
            grid.innerHTML = '';

            // Destroy existing charts
            Object.values(charts).forEach(chart => chart.destroy());
            charts = {};

            // Create charts based on selected metrics
            selectedMetrics.forEach(metric => {
                const card = createChartCard(metric);
                grid.appendChild(card);
            });
        }

        function createChartCard(metric) {
            const card = document.createElement('div');
            card.className = 'chart-card';

            const title = {
                'settling-time': 'üìä Settling Time Comparison',
                'computational': '‚ö° Computational Efficiency',
                'stability': 'üéØ Stability Scores',
                'overshoot': 'üìâ Overshoot Analysis'
            }[metric];

            const canvasId = `chart-${metric}`;
            card.innerHTML = `
                <h3>${title}</h3>
                <div class="chart-container">
                    <canvas id="${canvasId}"></canvas>
                </div>
            `;

            setTimeout(() => {
                const ctx = document.getElementById(canvasId);
                if (ctx) {
                    charts[metric] = createChart(ctx, metric);
                }
            }, 100);

            return card;
        }

        function createChart(ctx, metric) {
            const data = getChartData(metric);
            const config = getChartConfig(metric, data);
            return new Chart(ctx, config);
        }

        function getChartData(metric) {
            const labels = selectedControllers.map(key => performanceData[key].name);
            const values = selectedControllers.map(key => {
                switch(metric) {
                    case 'settling-time': return performanceData[key].settlingTime;
                    case 'computational': return performanceData[key].computation;
                    case 'stability': return performanceData[key].stability;
                    case 'overshoot': return performanceData[key].overshoot;
                }
            });
            const colors = selectedControllers.map(key => performanceData[key].color);

            return { labels, values, colors };
        }

        function getChartConfig(metric, data) {
            const baseConfig = {
                type: metric === 'stability' ? 'radar' : 'bar',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: getMetricLabel(metric),
                        data: data.values,
                        backgroundColor: data.colors,
                        borderColor: data.colors.map(c => c.replace('0.8', '1')),
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    }
                }
            };

            if (metric === 'stability') {
                baseConfig.options.scales = {
                    r: {
                        beginAtZero: true,
                        max: 100,
                        ticks: { stepSize: 20 }
                    }
                };
            } else {
                baseConfig.options.scales = {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: getYAxisLabel(metric) }
                    }
                };
            }

            return baseConfig;
        }

        function getMetricLabel(metric) {
            return {
                'settling-time': 'Settling Time',
                'computational': 'Computation Time',
                'stability': 'Stability Score',
                'overshoot': 'Overshoot'
            }[metric];
        }

        function getYAxisLabel(metric) {
            return {
                'settling-time': 'Time (seconds)',
                'computational': 'Time (milliseconds)',
                'overshoot': 'Overshoot (%)'
            }[metric];
        }

        function updateTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            selectedControllers.forEach(key => {
                const data = performanceData[key];
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${data.name}</strong></td>
                    <td>${data.settlingTime.toFixed(2)}</td>
                    <td>${data.computation.toFixed(3)}</td>
                    <td>${data.overshoot.toFixed(1)}</td>
                    <td>${data.stability}</td>
                    <td>${calculateRank(key)}</td>
                `;
                tbody.appendChild(row);
            });

            highlightBestValues();
        }

        function calculateRank(key) {
            const scores = selectedControllers.map(k => {
                const d = performanceData[k];
                // Lower is better for settling time, computation, overshoot
                // Higher is better for stability
                return (1 / d.settlingTime) + (1 / d.computation) + (1 / d.overshoot) + d.stability;
            });

            const sortedKeys = selectedControllers
                .map((k, i) => [k, scores[i]])
                .sort((a, b) => b[1] - a[1])
                .map(x => x[0]);

            return sortedKeys.indexOf(key) + 1;
        }

        function highlightBestValues() {
            const table = document.getElementById('summaryTable');
            const rows = Array.from(table.querySelectorAll('tbody tr'));

            // Find best values for each column
            for (let col = 1; col <= 4; col++) {
                let bestValue = col === 4 ? -Infinity : Infinity; // Stability: higher is better
                let bestCell = null;

                rows.forEach(row => {
                    const cell = row.cells[col];
                    const value = parseFloat(cell.textContent);
                    if (col === 4 ? value > bestValue : value < bestValue) {
                        bestValue = value;
                        bestCell = cell;
                    }
                });

                if (bestCell) {
                    bestCell.classList.add('best-value');
                }
            }
        }
    </script>
</body>
</html>
