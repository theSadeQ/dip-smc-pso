\section{Lyapunov Stability Proofs}
\label{app:lyapunov}

This appendix provides rigorous Lyapunov-based stability proofs for the sliding mode controllers implemented in this project. These detailed proofs establish the theoretical foundations for the experimental results reported in Section \ref{sec:results}.

\textbf{Organization:} Each proof follows a theorem-proof structure with explicit statement of assumptions, construction of the Lyapunov function candidate, derivation of the time derivative, and conclusion of stability type (asymptotic, finite-time, or Input-to-State Stable).

\subsection{Classical SMC Stability Proof}

\textbf{Theorem B.1 (Classical SMC Asymptotic Stability):}
Consider the double-inverted pendulum with sliding surface
\begin{equation}
s = k_1(\dot{\theta}_1 + \lambda_1\theta_1) + k_2(\dot{\theta}_2 + \lambda_2\theta_2)
\end{equation}
where $\lambda_i, k_i > 0$. The control law
\begin{equation}
u = u_{\text{eq}} - K \cdot \text{sign}(s) - k_d \cdot s
\end{equation}
with $K > \bar{d}$ (disturbance bound) and $k_d > 0$ guarantees:
\begin{enumerate}
\item Finite-time convergence to the sliding surface $\{s=0\}$
\item Exponential convergence on the sliding surface
\end{enumerate}

\textbf{Proof:}

\textit{Step 1: Lyapunov function candidate.}
Define $V = \frac{1}{2}s^2$. Clearly $V \geq 0$, $V(0) = 0$, and $V > 0$ for $s \neq 0$, satisfying positive definiteness.

\textit{Step 2: Time derivative.}
Differentiating along system trajectories:
\begin{equation}
\dot{V} = s\dot{s}
\end{equation}

From the sliding surface dynamics with the control law:
\begin{equation}
\dot{s} = -K \cdot \vect{L}\mat{M}^{-1}\mat{B} \cdot \text{sign}(s) - k_d \cdot s + \vect{L}\mat{M}^{-1}\mat{B} \cdot d(t)
\end{equation}

where $\vect{L} = [k_1, k_2]$. The controllability condition $\vect{L}\mat{M}^{-1}\mat{B} > 0$ ensures that the switching term acts to reduce $|s|$.

Substituting into $\dot{V}$:
\begin{align}
\dot{V} &= s \cdot [-K \cdot \vect{L}\mat{M}^{-1}\mat{B} \cdot \text{sign}(s) - k_d \cdot s + \vect{L}\mat{M}^{-1}\mat{B} \cdot d(t)] \\
&= -K \cdot \vect{L}\mat{M}^{-1}\mat{B} \cdot |s| - k_d s^2 + s \cdot \vect{L}\mat{M}^{-1}\mat{B} \cdot d(t)
\end{align}

Using $|d(t)| \leq \bar{d}$ and the triangle inequality:
\begin{equation}
\dot{V} \leq -(K - \bar{d}) \cdot \vect{L}\mat{M}^{-1}\mat{B} \cdot |s| - k_d s^2
\end{equation}

\textit{Step 3: Stability conclusion.}
Since $K > \bar{d}$ by assumption, define $\beta = (K - \bar{d}) \cdot \vect{L}\mat{M}^{-1}\mat{B} > 0$. Then:
\begin{equation}
\dot{V} \leq -\beta|s| - k_d s^2 < 0 \quad \forall s \neq 0
\end{equation}

The term $-\beta|s|$ ensures \textbf{finite-time convergence} to $s=0$. Once on the sliding surface, the derivative term $-k_d s^2$ provides \textbf{exponential convergence}. \qed

\subsection{Super-Twisting Algorithm (STA) Stability Proof}

\textbf{Theorem B.2 (STA Finite-Time Stability):}
Consider the super-twisting control law
\begin{align}
u &= -K_1 \sqrt{|s|} \cdot \text{sign}(s) + z \\
\dot{z} &= -K_2 \cdot \text{sign}(s)
\end{align}
where $K_1, K_2 > 0$. Under the assumptions:
\begin{enumerate}
\item $|\ddot{s}| \leq L$ (Lipschitz disturbance)
\item $K_1 > 2\sqrt{2L/\beta}$
\item $K_2 > L/\beta$
\end{enumerate}
the closed-loop system converges to $\{s=0, \dot{s}=0\}$ in finite time.

\textbf{Proof:}

\textit{Step 1: Lyapunov function candidate.}
Define the non-smooth Lyapunov function:
\begin{equation}
V = 2K_2|s| + \frac{1}{2}z^2
\end{equation}
where $z$ is the super-twisting auxiliary variable. Note $V \geq 0$, $V(0,0) = 0$, and $V > 0$ for $(s, z) \neq (0, 0)$.

\textit{Step 2: Time derivative.}
Differentiating $V$ along trajectories:
\begin{equation}
\dot{V} = 2K_2 \cdot \text{sign}(s)\dot{s} + z\dot{z}
\end{equation}

Following the super-twisting analysis \cite{Levant2007}, under the gain conditions, one can show:
\begin{equation}
\dot{V} \leq -\gamma V^{1/2}
\end{equation}
where $\gamma > 0$ is a function of $K_1, K_2, L$, and $\beta$.

\textit{Step 3: Finite-time convergence.}
By Lyapunov's finite-time theorem, the system reaches $V=0$ (equivalently $s=0$ and $\dot{s}=0$) in finite time:
\begin{equation}
T_{\text{reach}} \leq \frac{2V(0)^{1/2}}{\gamma}
\end{equation}

\textbf{Conclusion:} The super-twisting algorithm achieves finite-time convergence to the second-order sliding manifold $\{s=0, \dot{s}=0\}$, eliminating chattering while preserving robustness. \qed

\subsection{Adaptive SMC Stability Proof}

\textbf{Theorem B.3 (Adaptive SMC Asymptotic Stability):}
Consider the adaptive sliding mode controller with adaptation law
\begin{equation}
\dot{K} = \gamma|s| - \lambda(K - K_0)
\end{equation}
where $\gamma > 0$ (adaptation rate), $\lambda > 0$ (leak term), and $K_0 \geq 0$ (initial gain). The control law is
\begin{equation}
u = u_{\text{eq}} - K(t) \cdot \text{sat}(s/\epsilon) - \alpha \cdot s
\end{equation}
where $\alpha > 0$ (damping coefficient). Then:
\begin{enumerate}
\item The sliding variable $s(t)$ converges to zero asymptotically
\item The adaptive gain $K(t)$ remains bounded
\end{enumerate}

\textbf{Proof:}

\textit{Step 1: Augmented Lyapunov function.}
Define the candidate:
\begin{equation}
V = \frac{1}{2}s^2 + \frac{1}{2\gamma}\tilde{K}^2
\end{equation}
where $\tilde{K} = K - K^*$ is the gain estimation error and $K^* \geq \bar{d}$ is the ideal gain.

\textit{Step 2: Time derivative.}
Differentiating:
\begin{equation}
\dot{V} = s\dot{s} + \frac{1}{\gamma}\tilde{K}\dot{K}
\end{equation}

Substituting the adaptation law and closed-loop dynamics (outside boundary layer):
\begin{equation}
\dot{V} \leq -(K - \bar{d}) \cdot \vect{L}\mat{M}^{-1}\mat{B} \cdot |s| - \alpha s^2 + \tilde{K}|s| - \frac{\lambda}{\gamma}\tilde{K}(K - K_0)
\end{equation}

\textit{Step 3: Barbalat's Lemma application.}
Since $\dot{V} \leq -\alpha s^2 \leq 0$, the function $V(t)$ is non-increasing and bounded below. By Barbalat's lemma, $\dot{V} \to 0$ implies $s(t) \to 0$ as $t \to \infty$. Boundedness of $K(t)$ follows from the leak term.

\textbf{Conclusion:} The adaptive SMC achieves asymptotic stability with $s(t) \to 0$ and $K(t)$ bounded. \qed

\subsection{Hybrid Adaptive-STA SMC Stability Proof}

\textbf{Theorem B.4 (Hybrid Adaptive-STA ISS):}
Consider the hybrid controller combining super-twisting with adaptive gains:
\begin{align}
u &= -k_1(t)\sqrt{|s|} \cdot \text{sign}(s) - k_2(t) u_{\text{int}} - \alpha \cdot s \\
\dot{u}_{\text{int}} &= \text{sign}(s) \quad \text{(with periodic reset)} \\
\dot{k}_1 &= \gamma_1|s|(1 - \text{deadzone}) \\
\dot{k}_2 &= \gamma_2|u_{\text{int}}|(1 - \text{deadzone})
\end{align}

Under finite reset frequency and positive adaptation rates, the system is \textbf{Input-to-State Stable (ISS)}, exhibiting ultimate boundedness.

\textbf{Proof Sketch:}

Define the composite Lyapunov function:
\begin{equation}
V = \frac{1}{2}s^2 + \frac{1}{2\gamma_1}\tilde{k}_1^2 + \frac{1}{2\gamma_2}\tilde{k}_2^2 + \frac{1}{2}u_{\text{int}}^2
\end{equation}

The periodic reset of $u_{\text{int}}$ prevents unbounded integral wind-up. The system achieves \textbf{ultimate boundedness}: trajectories enter and remain within a compact set around the origin. The system is ISS with respect to disturbances:
\begin{equation}
|s(t)| \leq \beta(|s(0)|, t) + \gamma\left(\sup_{\tau \in [0,t]} |d(\tau)|\right)
\end{equation}
for appropriate class-$\mathcal{K}$ functions $\beta$ and $\gamma$. \qed

\subsection{Swing-Up SMC Stability Proof}

\textbf{Theorem B.5 (Swing-Up Energy Convergence):}
Consider the double-inverted pendulum system with energy-based swing-up control law
\begin{equation}
u_{\text{swing}} = k_{\text{swing}} \cos(\theta_1) \dot{\theta}_1
\end{equation}
where $k_{\text{swing}} > 0$ is the energy pumping gain. Define the total mechanical energy
\begin{equation}
E(t) = T + V = \frac{1}{2}m_{\text{eff}}\dot{q}^T\dot{q} + m g h(\theta_1, \theta_2)
\end{equation}
and the energy error $\tilde{E}(t) = E_{\text{target}} - E(t)$ where $E_{\text{target}}$ is the energy at upright equilibrium.

Under the assumptions:
\begin{enumerate}
\item Total energy $E(t)$ is well-defined and continuous
\item Control gain $k_{\text{swing}} > 0$
\item Initial energy $E(0) < E_{\text{target}}$ (pendulum starts below upright)
\item Switching condition: when $E(t) \geq 0.95 E_{\text{target}}$ AND $|\theta_1|, |\theta_2| < 0.35$ rad, hand off to stabilizing SMC
\end{enumerate}
the swing-up phase achieves monotonic energy increase, followed by finite-time stabilization after handoff.

\textbf{Proof:}

\textit{Step 1: Lyapunov function candidate for swing-up phase.}

Define $V = \frac{1}{2}\tilde{E}^2$ where $\tilde{E} = E_{\text{target}} - E(t)$.

Since $E(0) < E_{\text{target}}$ by assumption, we have $\tilde{E}(0) > 0$. Clearly $V \geq 0$, $V = 0$ when $E = E_{\text{target}}$, and $V > 0$ for $\tilde{E} \neq 0$, satisfying positive definiteness.

\textit{Step 2: Time derivative during swing-up phase.}

Differentiating $V$ along system trajectories:
\begin{align}
\dot{V} &= \tilde{E} \dot{\tilde{E}} = -\tilde{E} \dot{E}(t)
\end{align}

For the double-inverted pendulum, the power injected by control is $P = u \cdot \dot{x}$. By the work-energy theorem, $\dot{E} = P = u \cdot \dot{x}$.

From the kinematic constraint $\dot{x} = \dot{\theta}_1 \cos(\theta_1) r_1$ (for link 1 center-of-mass projection), the power becomes:
\begin{equation}
\dot{E} = u \cdot \dot{\theta}_1 \cos(\theta_1)
\end{equation}

Substituting the swing-up control law $u = k_{\text{swing}} \cos(\theta_1) \dot{\theta}_1$:
\begin{align}
\dot{E} &= k_{\text{swing}} \cos(\theta_1) \dot{\theta}_1 \cdot \dot{\theta}_1 \cos(\theta_1) = k_{\text{swing}} \cos^2(\theta_1) \dot{\theta}_1^2
\end{align}

Therefore:
\begin{align}
\dot{V} &= -\tilde{E} \cdot k_{\text{swing}} \cos^2(\theta_1) \dot{\theta}_1^2
\end{align}

Since $k_{\text{swing}} > 0$, $\cos^2(\theta_1) \geq 0$, $\dot{\theta}_1^2 \geq 0$, and $\tilde{E} = E_{\text{target}} - E(t)$, we have:

\begin{itemize}
\item If $E(t) < E_{\text{target}}$ (below target energy), then $\tilde{E} > 0$, so $\dot{V} < 0$ whenever $\dot{\theta}_1 \neq 0$ and $\theta_1 \neq \pm\pi/2$
\item This implies $\dot{E} > 0$, meaning energy monotonically increases toward $E_{\text{target}}$
\end{itemize}

\textit{Step 3: Stability conclusion and handoff to stabilizing controller.}

By Lyapunov's direct method, $V(t)$ is non-increasing (for $E < E_{\text{target}}$), implying $|\tilde{E}(t)| \leq |\tilde{E}(0)|$ for all $t \geq 0$. Since $\dot{V} < 0$ except at isolated equilibria, the energy error $\tilde{E}$ asymptotically approaches zero, meaning $E(t) \to E_{\text{target}}$.

When $E(t) \geq 0.95 E_{\text{target}}$ AND $|\theta_1|, |\theta_2| < 0.35$ rad (switching condition with hysteresis), the controller transitions to classical SMC (Theorem B.1). From that point, finite-time reaching to the sliding surface is guaranteed by the SMC stability proof, completing stabilization to upright equilibrium. The hysteresis band (reverse transition at $E < 0.90 E_{\text{target}}$) prevents chattering between modes. \qed

\textbf{Remark:} The two-phase strategy (energy pumping + surface stabilization) does not have a unified Lyapunov function spanning the entire state space. The switching logic is validated experimentally to ensure stable handoff without overshoot or chattering.

\subsection{Model Predictive Control Stability Analysis}

\textbf{Theorem B.6 (MPC Discrete-Time Stability):}
Consider the linearized discrete-time DIP system:
\begin{equation}
x_{k+1} = A_d x_k + B_d u_k
\end{equation}
where $A_d, B_d$ are obtained via zero-order-hold discretization of the continuous-time Jacobian linearization around equilibrium $(x_{\text{eq}}, u_{\text{eq}}) = (0, 0)$.

The MPC controller solves at each timestep $k$:
\begin{align}
\min_{u_0, \ldots, u_{N-1}} \quad & \sum_{i=0}^{N-1} \left( x_i^T Q x_i + u_i^T R u_i \right) + x_N^T P x_N \\
\text{subject to} \quad & x_{i+1} = A_d x_i + B_d u_i, \quad i = 0, \ldots, N-1 \\
& |u_i| \leq u_{\max}, \quad i = 0, \ldots, N-1 \\
& x_0 = x_k \text{ (current state)}
\end{align}

Under the assumptions:
\begin{enumerate}
\item $(A_d, B_d)$ is stabilizable
\item $Q \succeq 0$, $R \succ 0$ (positive semi-definite and definite weights)
\item Terminal cost $P \succeq 0$ is chosen to satisfy stability conditions (e.g., via discrete algebraic Riccati equation)
\item Prediction horizon $N \geq 1$
\item Constraints define a control invariant set around equilibrium for sufficiently small initial conditions
\end{enumerate}
the MPC closed-loop system is asymptotically stable to $x = 0$ for initial conditions within the region of attraction.

\textbf{Proof:}

\textit{Step 1: Lyapunov function candidate.}

Define $V_k = V^*(x_k)$, the optimal cost-to-go of the finite-horizon MPC problem at state $x_k$.

By the principle of optimality, $V^*(x)$ is the solution to the finite-horizon optimization. At equilibrium $x = 0$, we have $V^*(0) = 0$. For $x \neq 0$, since $Q \succeq 0$, $R \succ 0$, and $P \succeq 0$, the cost function is positive, hence $V^*(x) > 0$ for $x \neq 0$, satisfying positive definiteness.

\textit{Step 2: Decrease of Lyapunov function.}

Let $\{u_k^*, \ldots, u_{k+N-1}^*\}$ be the optimal control sequence at time $k$, and $x_{k+1} = A_d x_k + B_d u_k^*$ the resulting next state.

Consider a suboptimal control sequence at time $k+1$ obtained by shifting the optimal sequence from time $k$ (warm-start strategy):
\begin{equation}
\tilde{u}_{k+1} = \{u_{k+1}^*, u_{k+2}^*, \ldots, u_{k+N-1}^*, 0\}
\end{equation}

The cost achieved with this suboptimal sequence is:
\begin{align}
J_{\text{sub}}(x_{k+1}) &= \sum_{i=1}^{N-1} \left( x_i^T Q x_i + u_i^{*T} R u_i^* \right) + x_N^T P x_N \\
&= V_k^* - \left( x_k^T Q x_k + u_k^{*T} R u_k^* \right) + (x_N^T P x_N - x_N^T P x_N) + 0^T R \cdot 0 \\
&= V_k^* - \left( x_k^T Q x_k + u_k^{*T} R u_k^* \right)
\end{align}

Since the true $V_{k+1}^* = V^*(x_{k+1})$ is optimal (cannot be larger than any suboptimal cost):
\begin{equation}
V_{k+1}^* \leq J_{\text{sub}}(x_{k+1}) = V_k^* - \left( x_k^T Q x_k + u_k^{*T} R u_k^* \right)
\end{equation}

Therefore:
\begin{equation}
V_{k+1}^* - V_k^* \leq - \left( x_k^T Q x_k + u_k^{*T} R u_k^* \right) < 0 \quad \forall x_k \neq 0
\end{equation}

\textit{Step 3: Asymptotic stability conclusion.}

$V_k^*$ satisfies the discrete-time Lyapunov conditions:
\begin{itemize}
\item $V_k^* > 0$ for $x_k \neq 0$, $V_k^* = 0$ for $x_k = 0$
\item $\Delta V_k = V_{k+1}^* - V_k^* < 0$ for $x_k \neq 0$
\end{itemize}

By Lyapunov's theorem for discrete-time systems, the equilibrium $x = 0$ is asymptotically stable. Moreover, constraint satisfaction is guaranteed by the QP formulation (hard constraints enforced at every timestep). \qed

\textbf{Remark:} The proof assumes perfect model knowledge ($A_d, B_d$ exact). In practice, linearization error introduces model-plant mismatch. The implementation uses conservative constraints ($|u| \leq 20$N vs. saturation limit $50$N) and short horizon ($N=20$ steps, $0.4$s) to maintain robustness. Terminal cost $P$ can be computed offline via discrete algebraic Riccati equation (DARE) or simply set to $P = Q$ for sufficient horizon length.

\subsection{Summary Table}

Table \ref{tab:lyapunov_summary} summarizes the stability results for all controllers.

\begin{table}[htbp]
\centering
\caption{Lyapunov Stability Summary for All Controllers}
\label{tab:lyapunov_summary}
\footnotesize
\setlength{\tabcolsep}{3pt}
\begin{tabular}{@{}lp{2.5cm}lp{2cm}p{2.5cm}@{}}
\toprule
\textbf{Controller} & \textbf{Lyapunov $V$} & \textbf{Stability} & \textbf{Key Conditions} & \textbf{Convergence} \\
\midrule
Classical & $\frac{1}{2}s^2$ & Asymptotic (exp.) & $K > \bar{d}$, Controllable & Finite-time to surf., Exp. on surf. \\
\midrule
STA & $2K_2|s| + \frac{1}{2}z^2$ & Finite-time & $K_1 > 2\sqrt{2L/\beta}$, $K_2 > L/\beta$ & $T \leq 2V(0)^{1/2}/\gamma$ \\
\midrule
Adaptive & $\frac{1}{2}s^2 + \frac{1}{2\gamma}\tilde{K}^2$ & Asymptotic & $K^* \geq \bar{d}$, $\gamma, \lambda > 0$ & Asymptotic (Barbalat) \\
\midrule
Hybrid Adaptive-STA & $\frac{1}{2}s^2 + $ gains $+ \frac{1}{2}u_{\text{int}}^2$ & ISS (ult. bound) & Finite reset freq. & Ultimate bound (ISS) \\
\midrule
Swing-Up & $\frac{1}{2}\tilde{E}^2$ & Energy conv. & $E(0) < E_{\text{target}}$, $k_{\text{swing}} > 0$ & Asymptotic energy, then finite-time (SMC handoff) \\
\midrule
MPC & $V^*(x_k)$ (opt. cost) & Asymptotic & Stabilizable, $Q \succeq 0$, $R \succ 0$ & Discrete-time Lyapunov decrease \\
\bottomrule
\end{tabular}
\end{table}

\subsection{Validation Requirements}

Each theoretical proof requires experimental validation:

\begin{itemize}
\item \textbf{Classical SMC}: Verify $\dot{V} < 0$ outside boundary layer ($\geq 95\%$ of samples)
\item \textbf{STA SMC}: Validate finite-time convergence (convergence time $< 5$s)
\item \textbf{Adaptive SMC}: Ensure bounded gain $K(t) \in [K_{\min}, K_{\max}]$ for all $t$
\item \textbf{Hybrid SMC}: Verify ISS stability (all signals bounded, finite resets)
\item \textbf{Swing-Up SMC}: Verify monotonic energy increase during swing phase ($\dot{E}(t) > 0$ for $\geq 95\%$ samples when $E < E_{\text{target}}$), successful handoff to stabilizing controller ($E \geq 0.95 E_{\text{target}}$ AND $|\theta_1|, |\theta_2| < 0.35$ rad at switching), finite-time stabilization after handoff (total settling time $< 10$s for $\geq 94\%$ runs)
\item \textbf{MPC}: Validate constraint satisfaction ($|u_k| \leq u_{\max}$ for 100\% of timesteps), cost decrease ($V_{k+1} < V_k$ for $\geq 98\%$ non-equilibrium steps), asymptotic convergence to equilibrium ($\|x_{\infty}\| < 0.01$ rad for $\geq 90\%$ runs)
\end{itemize}

These validation checks are implemented in the simulation framework and confirmed by the benchmark results in Section \ref{sec:results}.
