IET CONTROL, ROBOTICS AND SENSORS SERIES 111
The Inverted Pendulum in Control Theory and Robotics

Other volumes in this series:
Volume 8 A History of Control Engineering, 1800­1930 S. Bennett Volume 18 Applied Control Theory, 2nd Edition J.R. Leigh Volume 20 Design of Modern Control Systems D.J. Bell, P.A. Cook and N. Munro (Editors) Volume 28 Robots and Automated Manufacture J. Billingsley (Editor) Volume 33 Temperature Measurement and Control J.R. Leigh Volume 34 Singular Perturbation Methodology in Control Systems D.S. Naidu Volume 35 Implementation of Self-tuning Controllers K. Warwick (Editor) Volume 37 Industrial Digital Control Systems, 2nd Edition K. Warwick and D. Rees (Editors) Volume 39 Continuous Time Controller Design R. Balasubramanian Volume 40 Deterministic Control of Uncertain Systems A.S.I. Zinober (Editor) Volume 41 Computer Control of Real-Time Processes S. Bennett and G.S. Virk (Editors) Volume 42 Digital Signal Processing: Principles, devices and applications N.B. Jones and J.D.McK. Watson
(Editors) Volume 44 Knowledge-based Systems for Industrial Control J. McGhee, M.J. Grimble and A. Mowforth (Editors) Volume 47 A History of Control Engineering, 1930­1956 S. Bennett Volume 49 Polynomial Methods in Optimal Control and Filtering K.J. Hunt (Editor) Volume 50 Programming Industrial Control Systems Using IEC 1131-3 R.W. Lewis Volume 51 Advanced Robotics and Intelligent Machines J.O. Gray and D.G. Caldwell (Editors) Volume 52 Adaptive Prediction and Predictive Control P.P. Kanjilal Volume 53 Neural Network Applications in Control G.W. Irwin, K. Warwick and K.J. Hunt (Editors) Volume 54 Control Engineering Solutions: A practical approach P. Albertos, R. Strietzel and N. Mort (Editors) Volume 55 Genetic Algorithms in Engineering Systems A.M.S. Zalzala and P.J. Fleming (Editors) Volume 56 Symbolic Methods in Control System Analysis and Design N. Munro (Editor) Volume 57 Flight Control Systems R.W. Pratt (Editor) Volume 58 Power-plant Control and Instrumentation: The control of boilers and HRSG systems D. Lindsley Volume 59 Modelling Control Systems Using IEC 61499 R. Lewis Volume 60 People in Control: Human factors in control room design J. Noyes and M. Bransby (Editors) Volume 61 Nonlinear Predictive Control: Theory and practice B. Kouvaritakis and M. Cannon (Editors) Volume 62 Active Sound and Vibration Control M.O. Tokhi and S.M. Veres Volume 63 Stepping Motors, 4th Edition P.P. Acarnley Volume 64 Control Theory, 2nd Edition J.R. Leigh Volume 65 Modelling and Parameter Estimation of Dynamic Systems J.R. Raol, G. Girija and J. Singh Volume 66 Variable Structure Systems: From principles to implementation A. Sabanovic, L. Fridman and
S. Spurgeon (Editors) Volume 67 Motion Vision: Design of compact motion sensing solution for autonomous systems J. Kolodko
and L. Vlacic Volume 68 Flexible Robot Manipulators: Modelling, simulation and control M.O. Tokhi and A.K.M. Azad
(Editors) Volume 69 Advances in Unmanned Marine Vehicles G. Roberts and R. Sutton (Editors) Volume 70 Intelligent Control Systems Using Computational Intelligence Techniques A. Ruano (Editor) Volume 71 Advances in Cognitive Systems S. Nefti and J. Gray (Editors) Volume 72 Control Theory: A guided tour, 3rd Edition J.R. Leigh Volume 73 Adaptive Sampling with Mobile WSN K. Sreenath, M.F. Mysorewala, D.O. Popa and F.L. Lewis Volume 74 Eigenstructure Control Algorithms: Applications to aircraft/rotorcraft handling qualities design
S. Srinathkumar Volume 75 Advanced Control for Constrained Processes and Systems F. Garelli, R.J. Mantz and H. De Battista Volume 76 Developments in Control Theory towards Glocal Control L. Qiu, J. Chen, T. Iwasaki and H. Fujioka
(Editors) Volume 77 Further Advances in Unmanned Marine Vehicles G.N. Roberts and R. Sutton (Editors) Volume 78 Frequency-Domain Control Design for High-Performance Systems J. O'Brien Volume 80 Control-oriented Modelling and Identification: Theory and practice M. Lovera (Editor) Volume 81 Optimal Adaptive Control and Differential Games by Reinforcement Learning Principles
D. Vrabie, K. Vamvoudakis and F. Lewis Volume 83 Robust and Adaptive Model Predictive Control of Nonlinear Systems M. Guay, V. Adetola and
D. DeHaan Volume 84 Nonlinear and Adaptive Control Systems Z. Ding Volume 86 Modeling and Control of Flexible Robot Manipulators, 2nd edition M.O. Tokhi and A.K.M. Azad Volume 88 Distributed Control and Filtering for Industrial Systems M. Mahmoud Volume 89 Control-based Operating System Design A. Leva et al. Volume 90 Application of Dimensional Analysis in Systems Modelling and Control Design P. Balaguer Volume 91 An Introduction to Fractional Control D. Valério and J. Costa Volume 92 Handbook of Vehicle Suspension Control Systems H. Liu, H. Gao and P. Li Volume 93 Design and Development of Multi-Lane Smart Electromechanical Actuators F.Y. Annaz Volume 94 Analysis and Design of Reset Control Systems Y. Guo, L. Xie and Y. Wang Volume 95 Modelling Control Systems Using IEC 61499, 2nd Edition R. Lewis and A. Zoitl Volume 96 Cyber-Physical System Design with Sensor Networking Technologies S. Zeadally and N. Jabeur
(Editors) Volume 99 Practical Robotics and Mechatronics: Marine, space and medical applications I. Yamamoto Volume 100 Organic Sensors: Materials and applications E Garcia-Breijo and P Cosseddu (Editors) Volume 102 Recent Trends in Sliding Mode Control L. Fridman JP. Barbot and F. Plestan (Editors) Volume 104 Control of Mechatronic Systems L. Guvenc, B.A Guvenc, B. Demirel, M.T Emirler Volume 105 Mechatronic Hands: Prosthetic and robotic design P.H. Chappell Volume 107 Solved Problems in Dynamical Systems and Control D. Valério, J.T. Machado, A.M. Lopes and A.M.
Galhano

The Inverted Pendulum in Control Theory and Robotics
From theory to new innovations
Edited by Olfa Boubaker and Rafael Iriarte
The Institution of Engineering and Technology

Published by The Institution of Engineering and Technology, London, United Kingdom The Institution of Engineering and Technology is registered as a Charity in England & Wales (no. 211014) and Scotland (no. SC038698). © The Institution of Engineering and Technology 2018 First published 2017
This publication is copyright under the Berne Convention and the Universal Copyright Convention. All rights reserved. Apart from any fair dealing for the purposes of research or private study, or criticism or review, as permitted under the Copyright, Designs and Patents Act 1988, this publication may be reproduced, stored or transmitted, in any form or by any means, only with the prior permission in writing of the publishers, or in the case of reprographic reproduction in accordance with the terms of licences issued by the Copyright Licensing Agency. Enquiries concerning reproduction outside those terms should be sent to the publisher at the undermentioned address: The Institution of Engineering and Technology Michael Faraday House Six Hills Way, Stevenage Herts, SG1 2AY, United Kingdom www.theiet.org While the authors and publisher believe that the information and guidance given in this work are correct, all parties must rely upon their own skill and judgement when making use of them. Neither the authors nor publisher assumes any liability to anyone for any loss or damage caused by any error or omission in the work, whether such an error or omission is the result of negligence or any other cause. Any and all such liability is disclaimed. The moral rights of the author to be identified as author of this work have been asserted by them in accordance with the Copyright, Designs and Patents Act 1988.
British Library Cataloguing in Publication Data A catalogue record for this product is available from the British Library
ISBN 978-1-78561-320-3 (hardback) ISBN 978-1-78561-321-0 (PDF)
Typeset in India by MPS Limited Printed in the UK by CPI Group (UK) Ltd, Croydon

Contents

Foreword

xiii

1 The inverted pendulum: history and survey of open and current

problems in control theory and robotics

1

Olfa Boubaker

Abstract

1

1.1 Introduction

1

1.2 Inverted-pendulum benchmarks: an overview

5

1.2.1 Notation

11

1.3 Experimental laboratories

12

1.3.1 Commercial devices

12

1.3.2 Universities platforms

13

1.3.3 Virtual models

13

1.4 Advances in control theory

14

1.4.1 Why the inverted pendulum is the most popular

benchmark?

14

1.4.2 Emerging control problems

14

1.4.3 Challenging control problems

16

1.5 Major accomplishments in robotics

18

1.5.1 Modeling and controlling under-actuated mechanical

systems

18

1.5.2 Self-balanced mobile-wheeled robots

19

1.5.3 Modeling and controlling walking pattern generation

19

1.6 Conclusion

20

References

20

PART I Robust state estimation and control: application

to pendulum-cart systems

41

2 State estimation and parameter identification via sliding-mode

techniques: pendulum­cart system

43

Diego Gutiérrez and Héctor Ríos

2.1 Introduction

43

2.2 Problem statement

45

2.3 Preliminaries

47

vi The inverted pendulum in control theory and robotics

2.4 High-order sliding-mode observers

48

2.4.1 Super-twisting observer

49

2.4.2 Fixed-time observer

51

2.4.3 Experimental results

54

2.5 Parameter identification algorithms

58

2.5.1 Homogeneous algorithm

59

2.5.2 Finite-time algorithm

61

2.5.3 Experimental results

63

2.6 Conclusions

66

References

66

3 Higher order sliding-mode stabilization of inverted cart­pendulum

71

Jesus Mendoza-Avila and Ismael Castillo

Abstract

71

3.1 Introduction

71

3.2 Singular LQ sliding variable design

72

3.2.1 MATLAB function: SSLQ

75

3.3 Continuous higher order sliding-mode controllers

75

3.3.1 Integral sliding-mode control

76

3.3.2 Continuous integral sliding-mode control

76

3.3.3 Arbitrary order controllers design

77

3.4 Cart­pendulum system

78

3.4.1 Mathematical model

79

3.4.2 Linear model

81

3.5 Continuous higher order sliding-mode controllers: cart­pendulum

system realization

83

3.5.1 Relative degree one SMC

86

3.5.2 Relative degree two SMC

86

3.5.3 Relative degree three SMC

87

3.5.4 Relative degree four SMC

87

3.6 Results

88

3.6.1 Accuracy analysis

88

3.7 Conclusions

90

References

90

4 Stabilization and tracking control of the inverted pendulum

on a cart via a modified PSO fractional order PID controller

93

Haifa Mehdi and Olfa Boubaker

Abstract

93

4.1 Introduction

93

4.2 The cart-inverted pendulum system

95

4.2.1 System presentation

95

4.2.2 Dynamic modeling

97

Contents vii

4.3 Control system

99

4.3.1 Super-twisting observer

99

4.3.2 Fractional controller

100

4.3.3 Tuning parameters of fractional-order controller

102

4.4 Simulation results

104

4.4.1 Simulation results and performance analysis: case study 1 106

4.4.2 Simulation results and performance analysis: case study 2 109

4.5 Conclusion

111

References

112

PART II Controllers for underactuated mechanical systems

117

5 Model-free control of the inertia wheel inverted pendulum

with real-time experiments

119

Ahmed Chemori

5.1 Introduction

119

5.2 Description of the system: inertia wheel inverted pendulum

120

5.2.1 Description of the mechanical part of the system

120

5.2.2 Description of the electronic part of the system

121

5.2.3 Description of the control PC and software

122

5.3 A proposed control solution for underactuated systems

122

5.3.1 Brief background on model-free control

122

5.3.2 Proposed control solution

123

5.4 Application: the inertia wheel inverted pendulum system

128

5.4.1 Dynamic modeling of the system

128

5.5 Numerical simulations

129

5.6 Real-time experiments

131

5.6.1 Scenario 1: Control in nominal case

132

5.6.2 Scenario 2: External disturbance rejection

132

5.7 Conclusion

134

References

134

6 Output feedback second-order sliding-mode tracking control

for perturbed inertia wheel pendulum

137

Luis T. Aguilar and Rafael Iriarte

6.1 Introduction

137

6.2 Dynamic model and problem statement

138

6.2.1 Generating desired trajectories centered at the upright

equilibrium point

139

6.3 Observer design

141

6.4 Control synthesis

142

6.5 Numerical results

145

6.6 Conclusions

146

Appendix A

147

viii The inverted pendulum in control theory and robotics

Acknowledgments

149

References

149

7 Switched integral sliding mode control for robust generation

of self-oscillation in pendulum systems

151

Juan Eduardo Velázquez-Velázquez, Rosalba Galván-Guerra,

and Rafael Iriarte

Abstract

151

7.1 Introduction

151

7.2 Preliminaries and problem formulation

153

7.2.1 Uncertain system

153

7.2.2 Generation of self-oscillations: two-relay controller

153

7.2.3 Motivational example

155

7.2.4 Problem statement

157

7.3 Switched integral sliding modes

158

7.3.1 Sliding variable design

158

7.3.2 Controller design

159

7.4 Simulation example

161

7.5 Conclusion

162

Acknowledgment

162

References

162

8 Finite-time stabilization of underactuated mechanical systems in

the presence of uncertainties: application to the cart­pole system

165

Jawhar Ghommam, Ahmed Chemori, and Faiçal Mnif

8.1 Introduction

165

8.2 Dynamic modeling of underactuated mechanical systems:

Lagrangian formalism

167

8.3 Control problem formulation

173

8.4 Preliminaries

174

8.4.1 Notions of finite stability

174

8.5 Proposed control design

174

8.6 Numerical simulations: the case of the cart­pole system

182

8.7 Conclusion

187

References

187

PART III Nonlinear controllers for mobile

inverted pendulum systems

191

9 Advances in robust control of mobile wheeled inverted pendulum

193

Jian Huang and Toshio Fukuda

Abstract

193

9.1 Introduction

193

Contents ix

9.2 Modeling of mobile wheeled inverted pendulum

195

9.2.1 Derivation of dynamic model

195

9.2.2 Analysis of equilibriums

197

9.3 Sliding mode controller design for mobile wheeled inverted

pendulum

198

9.3.1 Type-I sliding mode controller for MWIP

198

9.3.2 Type-II sliding mode controller for MWIP

202

9.4 Dynamic surface controller with nonlinear disturbance observer

for MWIP

205

9.4.1 Nonlinear disturbance observer design for MWIP

205

9.4.2 Controller design

207

9.5 Simulation study

217

9.5.1 Simulation of SMC for MWIP

217

9.5.2 Simulation of DSCNDO for MWIP

219

9.6 Conclusion

221

Acknowledgment

221

References

221

10 Case studies on non-linear control theory of the

inverted pendulum

225

Xu Xu, Hongwei Zhang, and Giuseppe Carbone

Abstract

225

10.1 Introduction

225

10.2 Modelling of the cart­pendulum systems

227

10.3 Control analysis

232

10.3.1 Linear control analysis

232

10.3.2 Non-linear control analysis

233

10.4 Simulations for single and double pendulum control

237

10.5 Case study 1 ­ LEGO EV3-based inverted pendulum

239

10.5.1 Introduction

239

10.5.2 LEGO Mindstorms EV3

240

10.5.3 Construction of LEGO inverted pendulum

243

10.5.4 Controller design and Simulink model

245

10.5.5 Experimental results

246

10.6 Case study 2 ­ a parallel manipulator as the cart

246

10.7 Conclusions

253

Appendix A Solving and implementing control solutions

using MATLAB®

254

Appendix A.1 Non-linear control of a single pendulum and

cart system

254

Acknowledgement

259

References

259

x The inverted pendulum in control theory and robotics

11 Bipedal-double-pendulum walking robot control using recurrent

hybrid neural network

263

S¸ahin Yildirim

Abstract

263

11.1 Introduction

263

11.2 Bipedal-like double-pendulum robot

264

11.2.1 Walking

266

11.2.2 Impact

266

11.3 Proposed neural network

267

11.4 Control system

269

11.4.1 Neural network controller

270

11.5 Results

271

11.6 Conclusion

276

Appendix A

277

References

279

PART IV Robust controllers-based observers via Takagi­Sugeno

or linear approaches

281

12 A survey on the polytopic Takagi­Sugeno approach: application

to the inverted pendulum

283

Souad Bezzaoucha, Holger Voos, and Mohamed Darouach

Abstract

283

12.1 Introduction

283

12.2 Systematic transformation of a nonlinear system

into a polytopic T­S form

285

12.3 Stability analysis of polytopic T­S systems

290

12.4 Observer design for polytopic T­S models

291

12.4.1 Measurable premise variables

292

12.4.2 Unmeasurable premise variables

293

12.5 Polytopic T­S models stabilization

294

12.5.1 State feedback stabilization

295

12.5.2 Observer-based state feedback stabilization

296

12.5.3 Static output feedback stabilization

303

12.6 Conclusion

305

References

305

13 Robust fault-tolerant control of nonlinear inverted pendulum and

cart system with simultaneous actuator and sensor faults sliding-

mode observer

309

Slim Dhahri, Ali Ben Brahim, Fayçal Ben Hmida, and Anis Sellami

13.1 Introduction

309

13.2 Problem formulation

311

13.2.1 Motivation

311

Contents xi

13.2.2 Inverted-pendulum modeling

311

13.3 Fault reconstruction by sliding-mode observation

315

13.3.1 System description

315

13.3.2 Existence conditions

318

13.3.3 T­S model in canonical form

319

13.3.4 Sliding motion stability

323

13.3.5 Sliding motion reachability

326

13.3.6 Simultaneous actuator and sensor faults estimation

328

13.4 Fault-tolerant controller design for T­S fuzzy systems

329

13.5 Simulation results

336

13.5.1 TS-SMO design

337

13.5.2 Simultaneous faults estimation design

338

13.5.3 TS-DOFC design

338

13.6 Conclusion

340

References

341

14 LMI-based control design for balancing and attitude stabilization

of inverted pendulums

347

Magdi S. Mahmoud

Abstract

347

14.1 Introduction

347

14.2 Dynamic modeling

350

14.3 Pendulums on cart

351

14.3.1 Single pendulum on cart

351

14.3.2 Double pendulums on cart

352

14.3.3 State-space representation

353

14.4 Inverted pendulum on pivot

353

14.4.1 DIP on pivot

353

14.4.2 TIP on pivot

354

14.5 Rotational double inverted pendulum

356

14.6 Inverted pendulum-type assistant robot

358

14.7 LMI-based control-design methods

360

14.7.1 LQR: proportional gain

361

14.7.2 LQRI: proportional-integral gain

362

14.7.3 LQR+: proportional gain with disturbance rejection

363

14.7.4 LQRI+: proportional-integral gain with disturbance

rejection

364

14.7.5 Model-predictive control

365

14.8 Multiobjective state feedback

367

14.8.1 H2 performance

368

14.8.2 H performance

368

14.8.3 Mixed H2/H performance

368

14.9 Simulation results

369

14.9.1 SIP­DIP open-loop response

369

14.9.2 SIP LQR response

370

xii The inverted pendulum in control theory and robotics

14.9.3 DIP on cart

371

14.9.4 Triple IP

374

14.9.5 RDIP simulation

375

14.9.6 I-PENTAR simulation

375

14.10 Conclusions

380

Acknowledgment

380

References

380

Index

385

Foreword
For at least 50 years, the inverted pendulum has been the most popular benchmark, among others, for teaching and research in control theory. Achieving its stability problem has become then a common engineering challenge. The fundamental focus of this book is then to enhance the wealth of this robotic system and provide an overall picture of historical, current trends and challenging problems in control theory and possible applications in mobile robotics, based on its simple structure and its rich nonlinear model.
The book is a timely and comprehensive reference guide for graduate students, researchers, engineers and practitioners in the areas of control theory and robotics. Readers will find it to be a clear and understandable textbook for control system courses at colleges and universities. It is written for senior electrical, mechanical, aerospace or mechatronics students.
Written by eminent scientists in the field of control theory and robotics from 12 countries (China, France, Italy, Japan, Luxembourg, Mexico, Oman, Saudi Arabia, Tunisia, Turkey, United Kingdom and USA), this book covers the latest advanced control approaches based on the stabilization principle as well as the trajectory generation methods of the inverted pendulum. Approaches include sliding-mode control, PID control and intelligent control techniques, among others. Observer design problems are also considered. The efficiency of the controllers-based observers approaches are proved for overcoming the complications introduced by the presence of uncertain dynamics, external disturbance, faults, non-holonomic kinematic constraints as well as under-actuated configurations.
Not only does this book provide the readers with control fundamentals and algorithms but it also discusses key applications using different experimental platforms including the cart-inverted pendulum, the inertia-wheel pendulum, the mobile-wheeled inverted pendulum, etc.
In total, 14 chapters written by active researchers in the field are compiled in this book to provide an overall picture of the most challenging problems to be solved in control theory from design to experiments. The book begins with a survey chapter where the available varieties of the inverted pendulum system are depicted, highlighting the richness of the dynamics of such system and then providing an overall picture of different control design approaches and trendy robotic problems related to its simple structure. The book covers then the topic in four parts: Part I, organized in four chapters, presents applications of robust state estimation and control with applications to pendulum-cart systems; Part II, structured in four chapters, depicted different

xiv The inverted pendulum in control theory and robotics
control approaches designed for under-actuated mechanical systems with applications to the inertia-wheel pendulum; Part III is organized in three chapters where nonlinear controllers are designed for mobile inverted pendulum systems; finally, Part IV, structured in three chapters, proposes robust controllers-based observers via Takagi­Sugeno or linear approaches.
The following researchers are particularly acknowledged for their considerable efforts:
 We are grateful to Professor Leonid Fridman from Facultad de Ingeniería, UNAM, Mexico, for the fruitful collaboration. It would not have been possible to compile the book without his precious help, particularly the contributions proposed in Chapters 2, 3, 6 and 7 and experimental results presented in Chapters 2 and 3.
 We thank the Emeritus Professors Toshio Fukuda from Nagoya University, Japan, Mohamed Darouach from Research Centre for Automatic Control of Nancy, France, and MagdiSadek Mahmoud from King Fahd University of Petroleum and Minerals, Saudi Arabia, for their valuable supports and contributions at Chapters 9, 12 and 14.
 We are grateful to Professor Guillermo Fernandez-Anaya from Universidad Iberoamericana, Mexico, and the Emeritus Professor José Ragot from Centre de Recherche en Automatique de Nancy, France, for their helpful and professional efforts to provide precious comments and reviews.
 The authors of Chapter 2, Diego Gutierrez and Héctor Ríos, the authors of Chapter 3, Jesús Mendoza and Ismael Castillo, and the author of Chapter 5, Ahmed Chemori, are particularly thanked for all the efforts provided to present experimental data.
 All our thanks go to the Professor Giuseppe Carbone from University of Cassino and South Latium, Italy, for his valuable support and for choosing our book to present the new prototype of the balancing inverted pendulum of LARM laboratory of University of Cassino at Chapter 10.
Finally, the editors would like to express their gratefulness to all authors of the book for their valuable contributions and all reviewers for their helpful and professional efforts to provide precious comments and feedback.
Olfa Boubaker and Rafael Iriarte

Chapter 1
The inverted pendulum: history and survey of open and current problems in control theory and robotics
Olfa Boubaker1
Abstract
The inverted pendulum is a classical problem in dynamics and control theory widely used as a fundamental system for testing emerging control algorithms. In spite of its very simple structure appropriate for developing real-time implementation, the inverted-pendulum model is considered the richest one among common robotic benchmarks. Not only it can describe many engineering problems but also it can explain several biological examples. Various mathematical models and experimental designs for the inverted pendulum exist offering an attractive tool for education and research. The objective of this survey is to present an overview of the available varieties of such system, highlighting the richness of its dynamics and then providing an overall picture of different control design approaches and trendy robotic problems related to its simple structure. In total, 300 references in the open literature, dating back to Galileo's first experiments written in 1602, are compiled to provide an overall picture of historical, current and challenging developments based on the stabilization principle of the inverted pendulum.
1.1 Introduction
A pendulum, pendere in Latin, is a string, cord or massless rod of length l that allows a suspended mass m, also called Bob, to swing back and forth, as shown by Figure 1.1, in a stable manner with limited amplitude. Simple pendulum system, like crane payload and grandfather pendulum clock, see Figure 1.2, have its center of mass down unlike inverted-pendulum system which is an inherently unstable system, has its center of mass higher than its pivot as shown by Figure 1.3 and must be actively balanced in order to remain upright. A torque T must be applied at its pivot point in order to oscillate the pivot point vertically and creating a remaining torque on the pendulum.
1National Institute of Applied Sciences and Technology (INSAT), Tunisia

2 The inverted pendulum in control theory and robotics
Frictionless pivot

Passive joint

Active joint

Center of mass

Massless rod



Bobs trajectory
Massive bob m
Equilibrium position
Figure 1.1 The pendulum system

Figure 1.2 Simple pendulum systems
Since Galileo's first experiments written in his first letter in 1602 [1], the pendulum system was introduced in all almost physical courses to illustrate basic concepts of periodic motion and conservation of energy. The valuable hypothesis of Galileo of the isochronisms assuming that the period of the pendulum is approximately independent of the amplitude of the swing was the most fundamental one. Galileo has also found that the period is independent of the suspended mass, and proportional to the square root of the length of the pendulum.

The inverted pendulum 3
m g

T
Figure 1.3 Inverted-pendulum system
F
Figure 1.4 The stick-balancing problem
The pendulum has played a significant role not only in the development of science and education but also in culture and politics [2,3]. Besides, its initial utilization as a clock by Christian Huygens in 1656 as a first measure of time, the simple pendulum was studied by the leading scientists of the seventeenth century, like Newton and Hooke for establishing a lot of physical laws. In that framework, we can cite the conservation laws, the collision laws, the value of the acceleration due to gravity g, the finding of the variation in g from equatorial to polar regions and consequently discovering the oblate shape of the earth and mainly the decisive evidence for Newton's synthesis of terrestrial and celestial mechanics [3].
A simple demonstration of stabilizing the center of mass of an inverted pendulum higher than its pivot is balancing an upturned broomstick on the end of one's finger by applying a horizontal force F as shown by Figure 1.4. This concept can be also displayed by a simple device that allows observing the movement of a liquid placed in a basin at the top of the structure.

4 The inverted pendulum in control theory and robotics
For the inverted pendulum, it has been necessary to wait until the beginning of the twentieth century to have the first findings around its dynamical system. As claimed in [4], the first results were initiated by Stephenson, who demonstrated in 1908 that the inverted pendulum could be stabilized by applying rapid, vertical, harmonic oscillations to its base [5], and who established in 1909, the stability conditions for the double and the triple inverted pendulums [6]. In 1932, Lowenstern developed the general equations of motion for the inverted pendulums [7]. It is just in the 1960s that the dynamics of inverted pendulums were well understood. In their paper History of Inverted Pendulum [8], the authors present several of the early treatments from the literature between 1960 and 1970 and state that Roberge demonstrated a first solution to the single inverted-pendulum system at M.I.T. in his aptly named bachelor's thesis, The Mechanical Seal [9], supervised by Leonard Gould. They also claim that Donald, Higdon and Cannon described, in 1963, systems with multiple independent inverted pendula at Stanford University [10] and that Schaefer and Cannon discussed, in 1966, jointed and flexible inverted-pendulum systems [11]. Several interesting papers are then followed [12­14]. It is just with the takeoff of the control theory and robotics at the end of the 1960s that the inverted pendulum becomes the most popular system, among others, for teaching and researches. Solutions of high interest are then proposed to solve various control problems. At the first stage, the stabilization problem around the upright position [15­19] and the swing-up problem [20­23] are solved independently. At the last stage, complete solution is then proposed [24­29]. Some solutions are then following to solve the tracking problem [30,31] and the observer-based controller problem with separation principle [32,33]. The parameter identification problem is also considered in some papers [34­36]. Few papers dealt then with the delay-control problem [37,38], the bifurcation analysis [39­41] and possible chaos dynamics of the inverted pendulum [42,43].
It is important to note that the simple structure of the inverted-pendulum model allowing carrying out experimental validations is one of the key motivations of using this benchmark in education and in research. Furthermore, as shown by Figure 1.5, many engineering systems are based on the stabilization principle of the inverted pendulum. For the liftoff of rockets and flight of missiles, for example, the first achievement is done by Norris at California Institute of Technology, in 1956, in his Engineer's thesis [44]. Standing and walking of bipeds using the stabilization principle of the inverted pendulum was initiated by the pioneers Hemami, Vukobratovic, Raibert and Kajita in their works presented in [45­50], whereas self-balancing problem of wheeled inverted pendulums was started in [51­53].
Since more than seven decades, the inverted pendulum is considered the most popular benchmark in control theory and robotics. For example, Scopus bibliographic database shows more than 6,000 of references written around the dynamical model of this important system. The analysis of the inverted-pendulum system and the design of different control laws have proposed by several textbooks [54­66], monographs [67] and survey papers [68­72].
The objective of this first chapter is to present the history and survey of open and current problems in control theory and robotics written around the invertedpendulum system. The chapter is organized as follows: in Section 1.2, an overview

The inverted pendulum 5
Figure 1.5 Engineering systems based on the stabilization principle of the inverted pendulum
of inverted-pendulum benchmarks will be presented. Experimental platforms will be then extended in Section 1.3. In Section 1.4, advances and challenging achievements in control theory will be deeply expanded. Finally, an overview of major accomplishments in the robotics field based in the stabilization principle of the inverted pendulum will be advanced in Section 1.5.
1.2 Inverted-pendulum benchmarks: an overview
Several benchmark systems of high interest exist in the literature of control theory and are frequently used as experimental models to validate the efficiency of control algorithms. In the field of robotics, some examples of high interest exist. Their related mathematical models are generally derived using two traditional formulations: the Lagrange­Euler formulation and the recursive Newton­Euler formulation [73­80]. The Lagrange­Euler approach uses the Lagrangian function which is the difference between the kinetic energy and the potential energy of the robotic system which is composed on different compounds, while Newton­Euler approach describes the combined translational and rotational dynamics of the different rigid bodies with respect to the each link's center of mass. In the literature, the Lagrange­Euler formulation is generally preferred since the controllers are conducted to obtain the time evolution of the generalized coordinates of the robotic system. Using Lagrange approach or Newton­Euler approach, the analytic developments must lead to a dynamical robotic system.
The reader can refer to Chapters 2, 10 and 14 of this book to find mathematical developments based on Lagrange­Euler method expanded for establishing examples of pendulum dynamical models.

6 The inverted pendulum in control theory and robotics
T1

T2

y

(a)

x

Ball position Ball

Beam rotation

(b)

Beam

F

(c)

x

Figure 1.6 (a) VTO Aircraft benchmark, (b) ball and beam benchmark, (c) TORA benchmark, and (d) the bicycle benchmark

In the field of robotics, the most popular benchmarks are the vertical take-off and landing (VTOL) aircraft [81], the translational oscillator with a rotational actuator (TORA) [82], the ball and beam system [83] and the bicycle [84], respectively, shown by Figure 1.6. However, in spite of its simple structure, the inverted pendulum is

Rear frame including rider body

The inverted pendulum 7
Front frame (fork and handlebar)

Rear wheel

Front wheel

x

(d)

Steer axis

Figure 1.6 (Continued)

Table 1.1 Common varieties of the inverted-pendulum benchmark

Benchmark

Inverted pendulum on a pivot
Inverted pendulum on a cart
Wheeled inverted pendulum

Pendupot Acrobot Inertia wheel pendulum Spherical pendulum Inverted pendulum on a cart Double-inverted pendulum Twin-inverted pendulum Triple pendulum Quadruple pendulum Furuta or rotational pendulum

Synoptic diagram
Figure 1.7
Figure 1.8 Figure 1.9 Figure 1.10 Figure 1.11 Figure 1.12 Figure 1.13 Figure 1.14 Figure 1.15 Figure 1.16

Mathematical model
[62,65,85,86] [62,65,85,87,88] [62,65,67,85] [89,90] [62,65,85] [19,91] [92] [91,93] [91,94] [62,65,85,91,95,96] [97,98]

considered, among the last examples, the most fundamental one. Various models for the inverted pendulum exist in the literature. They can be classified as follows:
 Inverted pendulums on a pivot: n rigid bodies (serial or parallel) are joined together and fixed on a pivot where the system inputs are the m voltages of the motors at each joint and the outputs are the n pendulum angles. In most cases, under-actuated inverted pendulums are considered such as n > m.

Y 2

c2
q
2
m2, J2

1 mq1, J1 c1
1

(a)

X

Y 2

c2
q
2
m2, J2 1

m1, J1 q

c1

1

X (b)

Figure 1.7 (a) The pendubot and (b) the acrobot

q
2
M, J

 g

m, J1

q
1

c

Figure 1.8 The inertia wheel pendulum

The inverted pendulum 9

z0

m, J

g r

yz-

q

plane

2

z
q
1
y

x

xzplane

Figure 1.9 The spherical pendulum

y

x

F

m, J



q

c

M

Figure 1.10 The cart-inverted pendulum

2

c2

m2, J2

q
2

y x

g

m1, J1

1

q

1

c1

F M, J

Figure 1.11 The double-inverted pendulum on a cart

10 The inverted pendulum in control theory and robotics

y x

m2, J2 2
q 2 c2

m1, J1

q
1

1

c1

g

F M, J

Figure 1.12 The twin-inverted pendulum on a cart

3 c3
q3 q
3
m3, J3

2

T3

c2

q

2
m2, J2

T2

y x

1

m1, J1

c1 q
1
T1

M, J

Figure 1.13 Triple-inverted pendulum
 Inverted pendulums on a cart: a multilink system of n rigid bodies is attached to an inherently stable moving base (the cart). Hence, an under-actuated mechanical system is obtained such as the system input is the force acting upon the cart and where the (n + 1) outputs are the cart position at the n pendulum angles.

4 c4
q
4
m4, J4

3

T4

c3

q3

m3, J3

The inverted pendulum 11

2 T3
c2

q

2

m2, J2

T2

y x

1

q m1, J1 1

c1

T1

M

Figure 1.14 Quadruple-inverted pendulum

 Wheeled inverted pendulum: a single-link rigid body is self-balanced by an unstable moving base mounted on one or two wheels. The inputs and the outputs vary depending from one design to another but an under-actuated mechanical system is always considered. The system can act on 2D or on 3D space.
For better understanding, the common varieties of the inverted-pendulum benchmark are summarized in Table 1.1 where a synoptic diagram and the related references to related mathematical models are given for each variety.
1.2.1 Notation
For Figures 1.7­1.16, M and J design the mass and the moment of inertia of the stable or unstable base, respectively. mi, li, lci, Ji design, for i = 1, ..., n, the mass, the length, the center of mass and the moment of inertia of the pendulum i, respectively. When only one pendulum is considered, the index i is omitted. The acceleration due to gravity is designed by g.
It is obvious that the most familiar models in the literature are the inverted pendulum on a cart for which Chapters 2­4 of this book are devoted and the inertial wheel

12 The inverted pendulum in control theory and robotics
z0



q

1

T2

x0

q
2

r0

y0

Figure 1.15 The Furuta pendulum (rotational pendulum)

q3

z

y



m1, J1

q4

q1

q2

M, J

x

x

Figure 1.16 The wheeled inverted pendulum

pendulum for which Chapters 5­7 are dedicated. New structures for the inverted pendulums are also recently proposed like the fly inverted pendulum [99], the inverted bicycle [100] and the spherical inverted pendulum on a five-bar mechanism [101].
1.3 Experimental laboratories
The simple structure of the inverted-pendulum model allowing carrying out experimental validations in education and in research was one of the key motivations of using this benchmark. Numerous real and virtual platforms exist.
1.3.1 Commercial devices
Several companies around the world are dedicated to manufacture professional products. In this framework, we can cite the LEGO products [102­106], the Quanser

The inverted pendulum 13
products [107] fully compatible with MATLAB®/SimulinkTM and LabVIEWTM software including translational and rotary motion control inverted-pendulum systems [101­110], the Googol Technology products [111] including transitional, circular and self-balancing wheeled inverted-pendulum platforms [112­114] and supporting MATLAB environment, the INTECO inverted pendulum on a cart [115], the Instruments Digital dual-inverted pendulum/crane system fully compatible with MATLAB software [116], the Model 505 of inverted pendulum of Educational Control Products [117] and the Rex Controls Furuta pendulum [118].
The reader can find more details about the mechanical system and the physical parameters of the inverted pendulum on a cart of INTECO available at National Autonomous University of Mexico at Chapters 2 and 3 of this book and about the inverted pendulum of Googol Technology in Chapter 4.
1.3.2 Universities platforms
A number of universities and research laboratories around the world have designed and built their own real inverted platforms to validate the efficiency of several emerging control techniques and verify their implementation. In this framework, we can cite the inertia flywheel pendulum mechatronic kit of Huafan University (Taiwan) [99], the balancing inverted pendulum on a parallel manipulator of LARM laboratory of University of Cassino (Italy) [119], the Furuta pendulum of Massachusetts Institute of Technology (USA) [120], the flying inverted pendulum of the Institute for Dynamic Systems and Control (Switzerland) [121], the inverted pendulum of Department of Aeronautical and Mechanical Engineering of Western Michigan University (USA) [122], the single/double inverted pendulum of the University of Adelaide, School of Mechanical Engineering (Australia) [123], the rotary inverted pendulum of the Rensselaer Polytechnic Institute of Troy (USA) [124] and so on.
Furthermore, full details about the inertia wheel pendulum of the LIRMM Laboratory of Informatics, Robotics and Microelectronics (France) can be found in Chapter 5, whereas the balancing inverted pendulum of LARM laboratory of University of Cassino (Italy) is fully described in Chapter 10.
1.3.3 Virtual models
To avoid unreliable and expensive real platforms, real experiments are often substituted by virtual reality enabled by tools. One may find good examples of virtual control laboratories of pendulum-car benchmark using for example SimMechanics in MATLAB/Simulink environment [125] or solid works using MATLAB­Simulink, ControlDesk, and a DS1104 board from dSPACE software [126]. Open source inverted-pendulum virtual models are also available [127] making this an ideal student project for an undergraduate controls curriculum.
Nowadays, many students communicate with the educational material through internet-based technologies. Time savings, sharing resources of expensive equipment and individual access to experimentation are the main factors that motivate remote laboratories over the world. Remote pioneered projects based on the inverted pendulum can be found in [128,129].

14 The inverted pendulum in control theory and robotics
1.4 Advances in control theory
1.4.1 Why the inverted pendulum is the most popular benchmark?
Although the structure of the pendulum systems already presented seems to be quite simple, many standard techniques in control theory are ineffective when tested on this benchmark. The inverted-pendulum system is a typical nonlinear dynamic system including a stable equilibrium point when the pendulum is in a pending position and an unstable equilibrium point when the pendulum is in an upright position [63]. When the system is moved up from the pending position to the upright position, the model is nonlinear with the pendulum angle. The control problem of the system is much more difficult than it appears to be for many reasons, e.g., geometric properties of the system are lost when the pendulum moves through horizontal positions [130]. Indeed, the output-zeroing manifold does not contain any equilibrium points, the relative degree of the system is not constant and the controllability distribution of the system does not have a constant rank. The system is therefore not linearizable [131]. The control problem to be solved is generally composed of two main specific tasks: the first one is the swing-up control problem and the second one is the stabilization problem around the unstable equilibrium point [132]. Finding a continuous feedback that can render the vertical upward position of the pendulum globally asymptotically stable has been considered a major problem for a long time.
1.4.2 Emerging control problems
The inverted pendulum was also used to illustrate major emerging problems in control theory which are mainly:
 Swing-up: The control objective is to upswinging the pendulum from its stable position to its unstable position. It was first proposed by Furuta in 1976 [134]. Many papers are proposed in this framework but one of the most interesting was written by Astrom and Furuta in which properties of the simple strategies for swinging up based on energy control are presented, and the idea to give the nonlinear system the energy of the upright position is clearly explained [23].
 Stabilization problem around the upright position: This problem is a very popular example in control education, generally introduced to undergraduatelevel students from a linearization of the nonlinear model using a first-order Taylor approach at the unstable equilibrium point. As a result, a linear system is obtained, and a feedback gain is computed using a linear control strategy such as LQR or pole placement [19,54­57,67,68]. The importance of such an approach in education is that many typical problems in control theory can be highlighted such as undesirable dynamics exhibited by unstable and nonminimum phase systems and difficulties of controlling single input/multioutput systems. In research, the stabilization problem is generally solved using a nonlinear controller [62,63]. One of the important objectives is to stabilize the system around its unstable equilibrium point and having at the same time a larger basin of attraction for initial conditions. But the most important problem is to guarantee the global stabilization

Table 1.2 Main control problems

The inverted pendulum 15

System

Swing-up Stabilization Tracking problem problem problem

Observer-based control problem

Pendubot

[135,136] [137,138]

Acrobot

[87,141,142] [137,143]

Inertia wheel pendulum [144,148] [145,149]

Inverted pendulum

[155­158] [159­172]

on a cart

Twin-inverted pendulum ­

[179]

Double-inverted

[180]

[181­187]

pendulum

Triple-inverted pendulum [190]

[191­195]

Furuta pendulum

[199]

[200­203]

Spherical pendulum [210]

[211]

[139]

[140]

[144,145,148,149] [146,147,150,151]

[146­147,150­152] [153,154]

[173­175]

[176­178]

­ [188]

­ [189]

­ [204­207] [212,213]

[196­198] [208,209] ­

of the system dynamics. One possibility to achieve global stabilization of the pendulum is by means of hybrid controllers [59,60]. Typically, two different control laws are employed, one takes care of the local stabilization of the pendulum in the upright position and the other swings the pendulum up. Another way is to stabilize the system by means of continuous feedback. In this way, for almost all initial conditions, the upright position is attractive (though not stable).  The tracking problem: The objective is to effectively follow a desired reference input for outputs, the position and velocity variables in our case. The importance for such unstable system is taking into account the stochastic disturbances is evident.  Observer-based control problem: It is well known that output feedback control or observer design is a very important problem in control systems, since in many practical nonlinear control systems, state variables are often unavailable. Observer-based controllers have attracted some interest in nonlinear systems. For inverted-pendulum systems, such problem is widely studied when velocity variables are often considered unavailable states. The main further is the development of the separation property; that is, the controller and the observer can be independently designed.
Table 1.2 gives an overview of different solutions proposed in the literature for solving main control problems presented below. On the other hand, inverted-pendulum benchmarks are used to illustrate almost all emerging ideas in control theory techniques. Table 1.3 depicted few high cited scientific articles for each control approach.
It is also important to note that one of the complex problems to achieve for inverted pendulum was the global asymptotic stabilization of the origin by a single and smooth continuous feedback performing both the upswing and the stabilization control. A complete solution to this problem can be found in [168,171].
On other side, accurate mathematical models of physical systems are essential for understanding the behavior of actual systems under different operating conditions

16 The inverted pendulum in control theory and robotics
Table 1.3 Nonlinear control techniques illustrated by the inverted-pendulum benchmark

Control technique
Bang­bang control Fuzzy logic control Neural network control PID control Optimal control Energy-based control Adaptive control Sliding mode control
Predictive control Feedback linearization Passivity-based control Back-stepping control Hybrid control Feedforward control

Mathematical model
Furuta pendulum Inverted pendulum on a cart
Triple-inverted pendulum Acrobot Wheeled inverted pendulum
Furuta pendulum Twin-inverted pendulum Inertia wheel pendulum
Cart inverted pendulum
Double-inverted pendulum on a cart

Reference
[20] [214] [215] [216] [217] [142] [218] [219] [220] [223] [145,149]
[221] [222] [224]

and for designing control systems. In mechanical systems, especially the inverted pendulum, difficulty of the exact determination of system parameters adversely affects the accuracy of the models that's why an experimental validation procedure of the control laws is often accompanied by a system parametric identification/estimation. A literature search showed that very few papers are devoted for such framework [34­36,225­228].
1.4.3 Challenging control problems
In this section, challenging and still open control problems will be presented. They include but are not limited to the following fields:
 Robustness-based sliding mode techniques: Besides stability, robustness is another important requirement to be considered in the study of uncertain nonlinear inverted-pendulum systems. Since uncertainty is source of instability, especially for tracking problems, common solutions are no more effective. Control design methods are then referred to confront system uncertainties and/or stochastic perturbations. Several promising directions can be chosen in such situations. In our sense, sliding mode observers-based controllers, very appropriate for robotic tracking problems with unavailable velocities measurements, will continue to have an enlarging impact in the following years in such framework. Sliding mode observers were initially proposed in [229] for systems with a relative degree equal to one and Lipschitz uncertainties. Then, they are extended for many other specific situations with high interest in [230­235]. In this book, solutions for solving problems related to robustness-based sliding mode techniques are proposed in Chapters 2­4, 6, 7, 9 and 13.

The inverted pendulum 17
 Robustness-based T­S fuzzy models: T­S fuzzy model-based observers/ controllers are widely popular models providing simple and effective solutions to the control of plants that are complex, uncertain and ill-defined such as invertedpendulum systems. Several research works using the inverted-pendulum systems are still recently organized in such directions [236­241]. In this book, solutions to the robustness-based T­S fuzzy models are found in Chapters 12 and 13.
 Robust fault-tolerant control: Nowadays, fault diagnosis and fault-tolerant control are considered major problems in the modern control theory [242]. Fault can occur in any part of the system and do degrade the feedback system performances, which leads to instability and even can result into dangerous situations. The inverted pendulum as inherent unstable nonlinear system with possible parameter uncertainties and possible faults in sensors and actuators may be considered a typical example to validate new approaches for robust fault-tolerant control [243­245]. In this book, robust fault-tolerant control problem is solved in Chapter 13.
 Fractional-order control: Fractional calculus is an old theory for solving differential equations. However, for only a few years, emerging and effective methods in differentiation and integration of noninteger-order equations make fractionalorder systems and also fractional-order controllers more and more attractive for control engineering applications. Fractional-order controllers are generally applied to enhance the system control performance. Some initiatives have been launched in this direction deriving some fractional-order inverted-pendulum models and/or using fractional-order-controller-based inverted-pendulum systems [246­249]. A solution to fractional-order proportional­integral­derivative (PID) controller is proposed in Chapter 4.
 Event-triggered control: In recent time, event-triggered control has received much attention since it has been demonstrated to reduce the amount of computations while still maintain a desired closed-loop behavior. It also allows the reduction of communications in control systems in which the information is transmitted through a shared network. Besides, the event-based control strategies have proved to be a good alternative to deal with delays and packet losses in communication networks. In addition, the event-based strategy offers several advantages such as protecting the actuators from frequent wear and tear and also reducing the waste of electric energy due to the switching voltage. In such framework, several recent papers have used the inverted pendulum as a typical example to prove such a challenging controller [250­253].
 Time-delayed control: It is well known that some important classes of systems, like oscillators and double integrators cannot be stabilized by a static output feedback, may be stabilized by inserting an artificial time delay in the feedback. Furthermore, static output-feedback controllers have advantages over observerbased controllers, since the design of observer-based controller is a complicated procedure mainly when uncertainties are considered. Several research papers had attempted to solve such a problem using time-delayed feedback [254]. Furthermore, in the presence of time delays, the well-known control techniques stabilizing the inverted-pendulum benchmarks may result in inadequate behavior and may

18 The inverted pendulum in control theory and robotics
even cause instability. The existence of time delay creates infinite dimensional dynamics and complicates the theoretical analysis. The dynamics of the inverted pendulum with delayed feedback control is handled recently by some researches [255­258].  Bifurcation and chaos analysis: Specific bifurcation conditions and chaotic generators have been verified for the inverted-pendulum systems using several phenomena. Such phenomena include impacts generally designed by piecewise linear functions in the related mathematical models [259­261] or delays in control laws [262­266].  Generation and stabilization of self-oscillations: Friction is a very complex phenomenon that occurs in pendulum systems. When friction effects are not modeled, feedback controllers may fail in real-time experiments. In most research works, the pendulum system was studied assuming that the only kind of friction is viscous friction, whereas a more accurate model of the friction should also include static and Coulomb (sliding) friction. Indeed, it was proven in [267] that it is always possible to obtain stable oscillations for the inverted-pendulum models associated to a limit cycle when such phenomena occur. Such dynamics may also bear through a supercritical Poincaré­Andronov­Hopf bifurcation induced by time delays in control variables [264]. Orbital stabilization of pendulum systems can also induce a periodic reference orbit in finite time [268­271]. Generation and stabilization of self-oscillations in presence of external perturbations and uncertainties are proposed in Chapters 6 and 7, respectively.
1.5 Major accomplishments in robotics
In robotics, inverted-pendulum systems are mainly used in three directions: (1) testing emerging control laws of the complex class of under-actuated mechanical systems, (2) designing and controlling wheeled self-balancing robots and (3) modeling and controlling walking pattern generation for bipedal and humanoid robots.
1.5.1 Modeling and controlling under-actuated mechanical systems
All inverted-pendulum models presented in this survey paper belong to the class of underactuated mechanical systems. A mechanical system is said to be under-actuated when it have fewer independent inputs than generalized coordinates to be controlled and have then unactuated degrees of freedom [85,261,264]. Because the number of inputs is less than the number of degrees of freedom, the controllability of the mechanical under-actuated system is not always satisfied, geometric properties of the system are lost and the system is therefore not linearizable. For such systems, the unactuated generalized coordinates may be controlled by the actuated coordinates through the dynamic coupling. This coupling is often inherently nonlinear, resulting in generally nonintegrable dynamic constraints and therefore second-order nonholonomic [272­275]. The study of such dynamical systems is much more difficult than it appears, and pendulum models are widely used to test different emerging control

The inverted pendulum 19
approaches proposed to control this class of systems so important in many applications [276­281]. In this book, Chapters 5­9 are devoted to solve control problems for such class of systems.
1.5.2 Self-balanced mobile-wheeled robots
Mobile robots are more and more omnipresent today. They are used in a diversity of applications including transport and entertainment. Especially, wheeled robots have a simpler mechanical structure than legged robots and are known to be energy efficient. Wheeled inverted pendulum devices are self-balancing robots that are statically unstable variety. They have generally two coaxial wheels mounted on either side of an intermediate body, with a center of mass above the wheel axes. Their particular configuration makes them highly maneuverable to hang around and quite suitable for indoor environments. Furthermore, they have the ability to maintain stability on inclines, by leaning into the slope and can accelerate quickly without tipping over. Nowadays, several well-known devices belong to the class of wheeled inverted pendulums. The most famous ones are the Segway [282,283], the JOE [284], the UW-car [285], the PMP [286], the B2 [287], the I-Pentar [288], a self-balancing humanoid robot, the Balbot [289] with a single-wheel moving robot in any direction and the ball-driven balancing robot [290], a mobile robot mounted on a moving ball. Examples of mobile platforms are found in Chapters 9, 10 and 14. Such devices must actively stabilize themselves to prevent overbalancing. Although they are more difficult to control than statically stable wheeled robots, they are still much easier to control than legged robots. Control law design for tracking trajectories in presence of any disturbances and uncertainties remain until now a challenging problem for such devices [291].
1.5.3 Modeling and controlling walking pattern generation
Unlike wheeled robots, legged robots are able to step over obstacles. However, they are more complex to model and stabilize during a walking cycle due to the greater number of degrees of freedom and the impact contact force with the ground, see bipedal robot model given in Chapter 11.
Based on the inverted-pendulum principle stabilization analogy with the human gait pattern, a number of inverted-pendulum models are used as walking pattern generation for humanoid robots. The most well-known models are the 3D linear inverted-pendulum models (LIPM) [292], the Kajita cart-table model [293], the variable impedance LIPM [294], the spring-loaded inverted pendulum [295] and the angular momentum pendulum model [296]. The most well-known humanoid robots using LIPM principles are the famous Japanese Honda female Android HRP-4C [297] and WABIAN-2R Humanoid robot [298,299]. Such models are also extensively used, in medicine, to find solutions for walking pattern generation impairments of elderly and stroked patients [300].

20 The inverted pendulum in control theory and robotics
1.6 Conclusion
Control methods and technologies arising from the model of the inverted pendulums attribute to the applications to both biological and mechanical control problems such stabilizing walking pattern generation and self-balancing wheeled transporters. By means of the rich properties of the inverted pendulum, this system will continue to play an important role in detecting abilities of innovative control methods dealing with nonlinearities, delays, bifurcations, chaos, minimum phase dynamics, oscillations and limit cycles, uncertainties and so on.
References
[1] Galilei G. (Favaro A., ed.) The works of Galileo Galilei (National Edition). Florence: Barbera; 1890­1909 (reprinted 1929­1939 and 1964­1966).
[2] Matthews M.R. Time for science education: How teaching the history and philosophy of pendulum motion can contribute to science literacy. New York: Kluwer Academic Publishers; 2000.
[3] Matthews M.R., Stinner A., Gauld C.F. (eds.) The pendulum: Scientific, historical, philosophical and educational perspectives. Netherlands: Springer; 2005.
[4] Castro A. Modeling and dynamic analysis of a two-wheeled inverted pendulum. Master Science thesis, Georgia Institute of Technology Publication, Atlanta, USA; 2012.
[5] Stephenson A. `A new type of dynamic stability'. Memories and Proceeding of the Manchester Literary and Philosophical Society. 1908; 52: 1­10. Manchester.
[6] Stephenson A. `On induced stability'. Philosophical Magazine. 1909; 17(1): 765­768.
[7] Lowenstern E.R. `Stabilizing effect of imposed oscillations on a dynamical system'. Philosophical Magazine. 1932; 13: 458­486.
[8] Lundberg K.H., Barton T.W. `History of inverted pendulum systems'. IFAC Proceedings Volumes. 2010; 42(24): 131­135.
[9] Roberge J.K. The mechanical seal. Bachelor's thesis, Massachusetts Institute of Technology, Cambridge; 1960.
[10] Donald T.H., Robert H.C. `On the control of unstable multiple-output mechanical systems'. ASME Publication 63-WA-148; American Society of Mechanical Engineers, New York, 1963.
[11] Schaefer J.F., Cannon R.H. (eds.) `On the control of unstable mechanical systems'. Proceedings of the third Automatic and Remote Control; London, June 1966. pp. 12­24.
[12] Phelps F.M., Hunter Jr J.H. `An analytical solution of the inverted pendulum'. American Journal of Physics. 1965; 33(4): 285­295.

The inverted pendulum 21
[13] Bagdanoff J.L., Citron S.J. `Experiments with an inverted pendulum subject to random parametric excitation'. The Journal of the Acoustical Society of America. 1965; 38: 447­452.
[14] Blitzer L. `Inverted pendulum'. American Journal of Physics. 1965; 33(12): 1076­1078.
[15] Young L.R. `Bang-bang aspects of manual control in high-order systems'. IEEE Transactions on Automatic Control. 1965; 10(3): 336­341.
[16] Furuta K., Okutani T., Sone H. `Computer control of a double inverted pendulum'. Computer and Electrical Engineering. 1978; 5: 67­84.
[17] Furuta K., Ochiai T., Ono N. `Attitude control of a triple inverted pendulum'. International Journal of Control. 1984; 39(6): 1351­1365.
[18] Gurumoorthy R., Sanders S.R. (eds.) `Controlling non-minimum phase nonlinear systems--The inverted pendulum on a cart example'. American Control Conference; San Francisco, California, June 1993. pp. 680­685.
[19] Bogdanov A. `Optimal control of a double inverted pendulum on a cart'. Tech. Rep. CSE-04-006; Oregon Health and Science University, OGI School of Science and Engineering, Beaverton, OR, 2004.
[20] Furuta K., Yamakita M., Kobayashi S. (eds.) `Swing up control of inverted pendulum'. International Conference Industrial Electronics, control and Instrumentation (IECON `91); Kobe, Japan, October 1991. pp. 2193­2198.
[21] Spong M.W. `The swing up control problem for the acrobot'. IEEE Control Systems Magazine. 1995; 15(1): 49­55.
[22] Yoshida K. (ed.) `Swing-up control of an inverted pendulum by energy-based methods'. Proceedings of the American Control Conference; San Diego, CA, June 1999. pp. 4045­4047.
[23] Astrom K.J., Furuta K. `Swinging up a pendulum by energy control'. Automatica. 2000; 36(2): 287­295.
[24] Mori S., Nishihara H., Furuta K. `Control of unstable mechanical system control of pendulum'. International Journal of Control. 1976; 23(5): 673­692.
[25] Wei Q., Dayawansa W.P., Levine W.S. `Nonlinear controller for an inverted pendulum having restricted travel'. Automatica. 1995; 31(6): 841­850.
[26] Spong M.W., Corke P., Lozano R. `Nonlinear control of the reaction wheel pendulum'. Automatica. 2001; 37(11): 1845­1851.
[27] Aracil J., Gordillo F. (eds.) `The inverted pendulum: A benchmark in nonlinear control'. Proceedings of the Sixth Biannual World Automation CongressIntelligent Automation and Control Trends, Principles, and Applications; Seville, June 2004. pp. 468­482.
[28] Muskinja N., Tovornik B. `Swinging up and stabilization of a real inverted pendulum'. IEEE Transactions on Industrial Electronics. 2006; 53(2): 631­639.
[29] Srinivasan B., Huguenin P., Bonvin D. `Global stabilization of an inverted pendulum-Control strategy and experimental verification'. Automatica. 2009; 45(1): 265­269.

22 The inverted pendulum in control theory and robotics
[30] Berkemeier M.D., Fearing R.S. `Tracking fast inverted trajectories of the underactuated Acrobot'. IEEE Transactions on Robotics and Automation. 1999; 15(4): 740­750.
[31] Wai R.J., Chang L.J. `Adaptive stabilizing and tracking control for a nonlinear inverted-pendulum system via sliding-mode technique'. IEEE Transactions on Industrial Electronics. 2006; 53(2): 674­692.
[32] Ma X.J., Sun Z.Q., HeY.Y. `Analysis and design of fuzzy controller and fuzzy observer'. IEEE Transactions on Fuzzy Systems. 1998; 6(1): 41­51.
[33] Tong S., Li H.X., Wang W. `Observer-based adaptive fuzzy control for SISO nonlinear systems'. Fuzzy Sets and Systems. 2004; 148(3): 355­376.
[34] Kobayashi M., Shinohara S., Tamura K. `Swing-up and stabilizing control of an inverted pendulum with adaptive identifier'. Transactions of the Japan Society of Mechanical Engineers Series C. 1992; 58(556): 3606­3613.
[35] Brock S. `Identification of the parameters in inverted pendulum model'. 7th International Workshop on Advanced Motion Control (AMC). 2002: 316­321.
[36] White W.N., Fales R.C. (eds.) `Control of a double inverted pendulum with hydraulic actuation: A case study'. Proceedings of the American Control Conference; San Diego, CA, June 1999. pp. 495­499.
[37] Atay F.M. `Balancing the inverted pendulum using position feedback'. Applied Mathematics Letters. 1999; 12(5): 51­56.
[38] Landry M., Campbell S.A., Morris K., Aguilar C.O. `Dynamics of an inverted pendulum with delayed feedback control'. SIAM Journal on Applied Dynamical Systems. 2005; 4(2): 333­351.
[39] McLaughlin J.B. `Period-doubling bifurcations and chaotic motion for a parametrically forced pendulum'. Journal of Statistical Physics. 1980; 24(2): 375­388.
[40] Sieber J., Krauskopf B. `Bifurcation analysis of an inverted pendulum with delayed feedback control near a triple-zero eigenvalue singularity'. Nonlinearity. 2004; 17(1): 85­103.
[41] Sieber J., Krauskopf B. `Complex balancing motions of an inverted pendulum subject to delayed feedback control'. Physica D: Nonlinear Phenomena. 2004; 197(3­4): 332­345.
[42] Levien R.B., Tan S.M. `Double pendulum: An experiment in chaos'. American Journal of Physics. 1993; 61: 1038­1044.
[43] Kim S.Y., Hu B. `Bifurcations and transitions to chaos in an inverted pendulum'. Physical Review E--Statistical Physics, Plasmas, Fluids, and Related Interdisciplinary Topics. 1998; 58(3 Suppl. A): 3028­3035.
[44] Norris J.C. An analysis of a compound pendulum rocket suspension. Thesis of California Institute of Technology, California; 1951.
[45] Hemami H., Weimer F.C., Koozekanani S.H. `Some aspects of the inverted pendulum problem for modeling of locomotion systems'. IEEE Transactions on Automatic Control. 1973; 18(6): 658­661.
[46] Hemami H., Golliday Jr C.L. `The inverted pendulum and biped stability'. Mathematical Biosciences. 1977; 34(1­2): 95­110.

The inverted pendulum 23
[47] Vukobratovic M., Stepaneko Y. `On the stability of anthropomorphic systems'. Mathematical Biosciences. 1972; 14(1): l­38.
[48] Raibert M.H. Legged robots that balance. Cambridge, Mass: MIT Press; 1986.
[49] Shuuji K., Kazuo T. (eds.) `Study of dynamic biped locomotion on rugged terrain-derivation and application of the linear inverted pendulum mode.' IEEE International Conference on Robotics and Automation; Sacramento, CA, USA, April 1991. pp. 1405­1411.
[50] Shuuji K., Kazuo T. (eds.) `Kazuo Experimental study of biped dynamic walking in the linear inverted pendulum mode'. IEEE International Conference on Robotics and Automation; Nagoya, Aichi, Japan, May 1995. pp. 2885­2891.
[51] Yamafuji K., Kawamura T. `Postural control of a monoaxial bicycle'. Journal of the Robotics Society of Japan. 1989; 7(4): 74­79 (in Japanese).
[52] Matsumoto O., Kajita S., Tani K. (eds.) `Attitude estimation of the wheeled inverted pendulum using adaptive observer'. Ninth Academic Conference of the Robotics Society of Japan; 1991. pp. 909­910 (in Japanese).
[53] Koyanagi E., Iida S., Kimoto K., Yuta S. (eds.) `A wheeled inverse pendulum type self-contained mobile robot and its two-dimensional trajectory control'. Proceedings of the Second International Symposium on Measurement and Control in Robotics; Tsukuba Science City, Japan, November 1992. Society of Instrument and Control Engineers of Japan; 1992. pp. 891­98.
[54] Cannon R.H. Dynamics of physical systems. New York: McGraw-Hill; 1967. pp. 703­710.
[55] Dorf R.C. Modern control systems. Reading: Addison-Wesley; 1967. pp. 276­279.
[56] Ogata K. Modern control engineering. Englewood Cliffs: Prentice-Hall; 1970. pp. 277­279.
[57] Kwakernaak H., Sivan R. Linear optimal control systems. New York: Wiley; 1972.
[58] Siebert W.McC. Circuits, signals, and systems. Cambridge: MIT Press; 1986. pp. 177­182.
[59] Morse A.S. (ed.) Control using logic-based switching. London: Springer; 1997.
[60] Yamamoto Y., Hara S. Learning, control & hybrid systems. Berlin: Springer; 1999.
[61] Siebert W.McC. Circuits, signals, and systems. Cambridge: MIT Press; 1998. [62] Fantoni I., Lozano R. `Non linear control for underactuated mechanical sys-
tems'. Communications and Control Engineering Series; Springer-Verlag, London, 2000. [63] Khalil H.K. Nonlinear systems. New Jersey: Prentice-Hall; 2002. [64] Li Z., Yang C., Fan L. Advanced control of wheeled inverted pendulum systems. London, UK: Springer; 2013. [65] Xin X., LiuY. Control design and analysis for underactuated robotic systems. London: Springer Science & Business Media; 2014.

24 The inverted pendulum in control theory and robotics
[66] Aguilar L.T., Boiko I., Fridman L., Iriarte R. Self-oscillations in dynamic systems: A new methodology via two-relay controllers. Switzerland: Springer; 2015.
[67] Block D., Astrom K., Spong M. The reaction wheel pendulum. Princeton, NJ: Morgan & Claypool Publication; 2007.
[68] Horacek P. `Laboratory experiments for control theory courses: A survey'. Annual Reviews in Control. 2000; 24: 151­162.
[69] Hahn H.H., Spong M.W. (eds.) `Remote laboratories for control education'. Proceedings of the IEEE Conference on Decision and Control; Sydney, NSW Australia, 12­15 December 2000. pp. 895­900.
[70] Acosta J.A. `Furuta's pendulum: A conservative nonlinear model for theory and practise'. Mathematical Problems in Engineering. 2010; 2010: 29 pp.
[71] Boubaker O. (eds.) `The inverted pendulum: A fundamental benchmark in control theory and robotics'. International Conference on Education and e-Learning Innovations (ICEELI); Sousse, Tunisia, July 2012. pp. 1­6.
[72] Boubaker O. `The inverted pendulum benchmark in nonlinear control theory: A survey'. International Journal of Advanced Robotic Systems. 2013; 10: 1­9.
[73] Craig J.J. Introduction to robotics. Addison Wesley: Pearson Education, Inc, Upper Saddle River; 1986.
[74] Spong M., Vidyasagar M. Robot dynamics and control. John Wiley and Sons, New Jersey; 1989.
[75] Shabana A.A. Computational dynamics (Second Edition). New York: Wiley; 2001.
[76] Sciavicco L., Siciliano B. Modelling and control of robot manipulators. Berlin: Springer-Verlag; 1996.
[77] Khalil W., Dombre E. Modeling, identification and control of robots. New York, NY: Taylor & Francis; 2002.
[78] Hahn H. Rigid body dynamics of mechanisms. Berlin: Springer; 2002. pp. 143. [79] Featherstone R. Rigid body dynamics algorithms. Berlin: Springer; 2008. [80] B. Siciliano, O. Khatib. Springer handbook of robotics. Berlin: Springer;
2008. [81] Martin P., Devasia S., Paden B. `A different look at output tracking: Control
of a VTOL aircraft'. Automatica. 1996; 32: 101­107. [82] Jankovic M., Fontaine D., Kokotovic P.V. `TORA example: Cascade and
passivity-based control designs'. IEEE Transactions on Control Systems Technology. 1996; 4: 292­297. [83] Andreev F., Auckly D., Gosavi S., Kapitanski L., Kelkar A., White W. `Matching, linear systems, and the ball and beam'. Automatica. 2002; 38: 2147­2152. [84] Aström K.J., Klein R.E., Lennartsson A. `Bicycle dynamics and control'. IEEE Control Systems Magazine. 2005; 25: 26­47. [85] Olfati-Saber R. Nonlinear control of underactuated mechanical systems with application to robotics and aerospace vehicles. Doctoral dissertation, Massachusetts Institute of Technology; 2000.

The inverted pendulum 25

[86] [87] [88] [89] [90] [91] [92] [93] [94] [95] [96] [97] [98] [99] [100] [101] [102]

Xin X., Tanaka S., She J., Yamasaki T. `New analytical results of energy-based swing-up control for the Pendubot'. International Journal of Non-Linear Mechanics. 2013; 52: 110­118. Spong M.W. `The swing up control problem for the acrobot'. IEEE Control Systems. 1995; 15(1): 49­55. Brown S.C., Passino K.M. `Intelligent control for an acrobot'. Journal of Intelligent and Robotic Systems: Theory and Applications. 1997; 18(3): 209­248. Liu G., Nesic D., Mareels I. `Modelling and stabilisation of a spherical inverted pendulum'. IFAC Proceedings Volumes. 2005; 38(1): 1130­1135. Liu G., Nesic D., Mareels I. `Modelling and stabilisation of a spherical inverted pendulum'. IFAC Proceedings Volumes. 2005; 38(1): 1130­1135. Jadlovsky S., Sarnovsky J. `Modelling of classical and rotary inverted pendulum systems­a generalized approach'. Journal of Electrical Engineering. 2013; 64(1): 12­19. Alamir M., Murilo, A. `Swing-up and stabilization of a twin-pendulum under state and control constraints by a fast NMPC scheme'. Automatica. 2008; 44(5): 1319­1324. Eltohamy K.G., Kuo C.Y. `Nonlinear optimal control of a triple link inverted pendulum with single control input'. International Journal of Control. 1998; 69(2): 239­256. Li H., Miao Z., Wang J. `Variable universe adaptive fuzzy control on the quadruple inverted pendulum'. Science in China, Series E: Technological Sciences. 2002; 45(2): 213­224. Yavin Y. `Control of a rotary inverted pendulum'. Applied Mathematics Letters. 1999; 12(2): 131­134. Gordillo F., Acosta J.A., Aracil J. `A new swing-up law for the Furuta pendulum'. International Journal of Control. 2003; 76(8): 836­844. Pathak K., Franch J., Agrawal S.K. `Velocity and position control of a wheeled inverted pendulum by partial feedback linearization'. IEEE Transactions on Robotics. 2005; 21(3): 505­513. Chan R.P.M., Stol K.A., Halkyard C.R. `Review of modelling and control of two-wheeled robots'. Annual Reviews in Control. 2013; 37(1): 89­103. Lin J., Chen S.Y., Gau W.H. `Design and implementation of a novel inertia flywheel pendulum mechatronic kit'. JVC/Journal of Vibration and Control. 2015; 21(16): 3417­3430. Feng Y., Du R., Xu Y. `Steering angle balance control method for rider-less bicycle based on ADAMS'. Smart Innovation, Systems and Technologies. 2017; 53: 15­31. Soto I., Campa R. `Modelling and control of a spherical inverted pendulum on a five-bar mechanism'. International Journal of Advanced Robotic Systems. 2015; 12(7): 95. Gawthrop P.J., McGookin E. (eds.) `Using LEGO in control education'. Seventh IFAC Symposium on Advances in Control Education; Madrid, Spain, June 2006. pp. 31­38.

26 The inverted pendulum in control theory and robotics

[103]
[104]
[105] [106]
[107] [108] [109]
[110] [111] [112] [113] [114] [115] [116] [117]

Le T., Oh P. (eds.) `NXT mobile inverted pendulum'. Proceedings of the ASME Design Engineering Technical Conference and Computers and Information in Engineering Conference; Brooklyn, New York, USA, August 2008. pp. 515­524. Bobtsov A.A., Pyrkin A.A., Kolyubin S.A. (eds.) `Adaptive stabilization of a reaction wheel pendulum on moving LEGO platform'. IEEE International Conference on Control Applications (CCA) & Intelligent Control (ISIC); St. Petersburg, Russia, July 2009. pp. 1218­1223. Kapitonov A.A., Bobtsov A.A., Kapitanyuk Y.A., et al. `Course of lab activities on control theory based on the LEGO NXT'. IFAC Proceedings Volumes. 2014; 47(3): 9063­9068. Canale M., Casale-Brunet S. `A multidisciplinary approach for model predictive control education: A LEGO Mindstorms NXT-based framework'. International Journal of Control, Automation and Systems. 2014; 12(5): 1030­1039. Quanser. http://www.quanser.com [Accessed March 2017]. Al-Hiddabi S.A. `Implementation of stable inversion control on a nonlinear non-minimum phase system: Cart-pendulum experiment'. Proceedings of the SICE Annual Conference; Okayama, Japan, August 2005. pp. 729­733. Al-Jodah A., Zargarzadeh H., Abbas M.K. (eds.) `Experimental verification and comparison of different stabilizing controllers for a rotary inverted pendulum'. IEEE International Conference on Control System, Computing and Engineering (ICCSCE 2013); Penang, Malaysia, November 2013. pp. 417­423. Siva-Kumar M., Dasu B., Ramesh G. `Design of LQR based stabilizer for rotary inverted pendulum system'. International Journal of Control Theory and Applications. 2016; 9(29): 21­29. Googol Technology Limits. http://www.googoltech.com/web/eng/ product_list_inner.jsp?module=Educational%20Products&content=Content [Accessed March 2017]. Fu C., Liu Y., Tan W., Zhang J. (eds.) ` Synthesis with regional pole assignment for a double inverted pendulum'. Proceedings of the 29th Chinese Control Conference (CCC'10); Beijing, China, July 2010. pp. 1895­1900. Wu J., Zhang W., Wang S. `A two-wheeled self-balancing robot with the fuzzy PD control method'. Mathematical Problems in Engineering. 2012; 13pp. doi:10.1155/2012/469491. Googol Technology. Inverted pendulum experimental manual suitable for GLIP series (Second Edition). 2006. INTECO. User manual. http://ee.sharif.edu/linearcontrol/Files/Lab/Pend_ man.pdf [Accessed March 2017]. Feedback. Digital pendulum. http://www.feedback-instruments.com/ products/education/control_instrumentation/digital_pendulum [Accessed March 2017]. Educational Control Products. http://www.ecpsystems.com/docs/ECP_ InvPend_Model_505.pdf. [Accessed March 2017].

The inverted pendulum 27

[118] [119] [120] [121] [122] [123] [124] [125]
[126]
[127]
[128] [129] [130] [131] [132]

Rex Controls. https://www.rexcontrols.com/furuta-pendulum [Accessed March 2017]. Cafolla D., Carbone G., Ceccarelli M. `Balancing of a 3-DOFs parallel manipulator'. in Zhang D., Wei B. (eds.) Dynamic Balancing of Mechanisms and Synthesizing of Parallel Robots. Switzerland: Springer; 2015. pp. 173­191. Houck A.C., Katzschmann R.K., Ramos J.L.A.S. Furuta pendulum. Department of Mechanical Engineering, Massachusetts Institute of Technology; 2013. Hehn M., D'Andrea R. `A flying inverted pendulum'. IEEE International Conference on Robotics and Automation (ICRA); Shanghai, China, May 2011. pp. 763­770. Hovingh A., Roon M. Design and control of an inverted pendulum [online]. 2007. Available from http://homepages.wmich.edu/ kamman/IP_FINAL_PROJECT_REPORT.pdf. Driver J., Thorpe D. Design, build and control of a single/double rotational inverted pendulum. Australia: The University of Adelaide, School of Mechanical Engineering; 2004. Awtar S., King N., Allen T., et al. `Inverted pendulum systems: Rotary and arm-driven-a mechatronic system design case study'. Mechatronics. 2002; 12(2): 357­370. Sham J.S., Solihin M.I., Heltha F., Muzaiyanah H. `Modelling and simulation of an inverted pendulum system: Comparison between experiment and CAD physical model'. ARPN Journal of Engineering and Applied Sciences. 2015; 10(20): 9752­9757. Antonio-Cruz M., Silva-Ortigoza R., Sandoval-Gutiérrez J., et al. `Modeling, simulation, and construction of a Furuta pendulum test-bed'. International Conference on Electronics, Communications and Computers (CONIELECOMP); Cholula, Puebla Mexico, February 2015. pp. 72­79. Turner M., Cooley T.R. (eds.) `A low cost and flexible open source inverted pendulum for feedback control laboratory courses'. 122nd ASEE Annual Conference and Exposition: Making Value for Society; Seattle, Washington, June 2015. Hahn H.H., Spong M.W. (eds.) `Remote laboratories for control education'. Proceedings of the IEEE Conference on Decision and Control; Darling Harbour, Australia, December 2000. pp. 895­900. Ling K., Lai Y., Chew K. (eds.) `An online Internet laboratory for control experiments'. IFAC/IEEE Symposium on Advances in Control Education; Queensland, Australia, December 2000. pp. 173­176. Zhao J., Spong M.W. `Hybrid control for global stabilization of the cart-pendulum system'. Automatica. 2001; 37(12): 1941­1951. Chung C.C., Hauser J. `Nonlinear control of a swinging pendulum'. Automatica. 1995; 31(6): 851­862. Muskinja N., Tovornik B. `Swinging up and stabilization of a real inverted pendulum'. IEEE Transaction on Industrial Electronics. 2006; 53(2): 631­639.

28 The inverted pendulum in control theory and robotics

[133] [134] [135] [136] [137] [138] [139] [140] [141] [142] [143] [144] [145] [146] [147] [148] [149]

Kheir N.A., Astrom K.J., Auslander D., et al. `Control systems engineering education'. Automatica. 1996; 32(2): 147­166. Mori S., Nishihara H., Furuta K. `Control of unstable mechanical systems: Control of pendulum'. International Journal of Control. 1976; 23(5): 673­69. Qian D., Yi J., Zhao D. (eds.) `Hierarchical sliding mode control to swing up a pendubot'. Proceedings of the American Control Conference; New York, July 2007. pp. 5254­5259. Xin X., Tanaka S., She J., Yamasaki T. `New analytical results of energy-based swing-up control for the Pendubot'. International Journal of Non-Linear Mechanics. 2013; 52: 110­118. Lai X.Z., She J.H., Yang S.X., Wu M. `Comprehensive unified control strategy for underactuated two-link manipulators'. IEEE Transactions on Systems, Man, and Cybernetics, Part B (Cybernetics). 2009; 39(2): 389­398. Zhang M., Tarn T.J. `Hybrid control of the Pendubot'. IEEE/ASME Transactions on Mechatronics. 2002; 7(1): 79­86. Begovich O., Sanchez E.N., Maldonado M. `Takagi­Sugeno fuzzy scheme for real-time trajectory tracking of an underactuated robot'. IEEE Transactions on Control Systems Technology. 2002; 10(1): 14­20. Eom M., Chwa D. `Robust swing-up and balancing control using a nonlinear disturbance observer for the pendubot system with dynamic friction'. IEEE Transactions on Robotics. 2015; 31(2): 331­343. MahindrakarA.D., Banavar R.N. `A swing-up of the acrobot based on a simple pendulum strategy'. International Journal of Control. 2005; 78(6): 424­429. Xin X., Kaneda M. `Analysis of the energy-based swing-up control of the Acrobot'. International Journal of Robust and Nonlinear Control. 2007; 17(16): 1503­1524. Horibe T., Sakamoto N. (eds.) `Swing up and stabilization of the Acrobot via nonlinear optimal control based on stable manifold method'. IFAC Symposium on Nonlinear Control Systems; California, USA, August 2016. pp. 374­379. Berkemeier M.D., Fearing R.S. `Tracking fast inverted trajectories of the underactuated Acrobot'. IEEE Transactions on Robotics and Automation. 1999; 15(4): 740­750. Zhang A., She J., Lai X., Wu M. `Motion planning and tracking control for an acrobot based on a rewinding approach'. Automatica. 2013; 49(1): 278­284. Anderle M., Celikovsky S. (eds.) `High gain observer for embedded Acrobot'. IFAC Proceedings Volumes; Cape Town, South Africa, August 2014. pp. 2818­2823. Jeong S., Lee S., Hong Y.D., Chwa D. `Adaptive robust swing-up and balancing control of acrobot using a fuzzy disturbance observer'. Journal of Institute of Control, Robotics and Systems. 2016; 22(5): 346­352. Srinivas K.N., Behera L. `Swing-up control strategies for a reaction wheel pendulum'. International Journal of Systems Science. 2008; 39(12): 1165­1177. Spong M.W., Corke P., Lozano R. `Nonlinear control of the reaction wheel pendulum'. Automatica. 2001; 37(11): 1845­1851.

The inverted pendulum 29

[150]
[151] [152]
[153] [154] [155] [156] [157] [158] [159] [160] [161] [162] [163] [164]

Estrada A., Aguilar L.T., Iriarte R., Fridman L. `Two relay controller for real time trajectory generation and its application to inverted orbital stabilization of inertia wheel pendulum via quasi-continuous HOSM'. Asian Journal of Control. 2012; 14(1): 58­66. Iriarte R., Aguilar L.T., Fridman L. `Second order sliding mode tracking controller for inertia wheel pendulum'. Journal of the Franklin Institute. 2013; 350(1): 92­106. Moreno-Valenzuela J., Aguilar-Avelar C., Puga-Guzman S., Santibanez V. `Two adaptive control strategies for trajectory tracking of the inertia wheel pendulum: Neural networks vis à vis model regressor'. Intelligent Automation and Soft Computing. 2017; 23(1): 63­73. Mohammadzadeh A., Hashemzadeh F. `A new robust observer-based adaptive type-2 fuzzy control for a class of nonlinear systems'. Applied Soft Computing Journal. 2015; 37: 204­216. Khalid N., Memon A.Y. `Output feedback control of a class of under-actuated nonlinear systems using extended high gain observer'. Arabian Journal for Science and Engineering. 2016; 41(9): 3531­3542. Bradshaw A., Shao J. `Swing-up control of inverted pendulum systems'. Robotica. 1996; 14(4): 397­405. Mason P., Broucke M., Piccoli B. `Time optimal swing-up of the planar pendulum'. IEEE Transactions on Automatic Control. 2008; 53(8): 1876­1886. Yang J.H., Shim S.Y., Seo J.H., Lee Y.S. `Swing-up control for an inverted pendulum with restricted cart rail length'. International Journal of Control, Automation and Systems. 2009; 7(4): 674­680. Dindis¸ G., Karamancioglu A. `A self-learning robust swing-up algorithm'. Transactions of the Institute of Measurement and Control. 2016; 38(4): 395­401. Shiriaev A., Ludvigsen H., Egeland O., Pogromsky A. (eds.) `On global properties of passivity based control of the inverted pendulum'. IEEE Conference on Decision and Control; Arizona, USA, December 1999. pp. 2513­2518. Lozano R., Fantoni I., Block D.J. `Stabilization of the inverted pendulum around its homoclinic orbit'. Systems & Control Letters. 2000; 40(3): 197­204. Angeli D. `Almost global stabilization of the inverted pendulum via continuous state feedback'. Automatica. 2001; 37(7): 1103­1108. Shiriaev A.S., Egeland O., Ludvigsen H., Fradkov A.L. `VSS-version of energy-based control for swinging up a pendulum'. Systems & Control Letters. 2001; 44(1): 45­56. Chatterjee D., Patra A., Joglekar H.K. `Swing-up and stabilization of a cart­pendulum system under restricted cart track length'. Systems & Control Letters. 2002; 47(4): 355­364. Bugeja M. `Non-linear swing-up and stabilizing control of an inverted pendulum system'. The IEEE Region 8 EUROCON 2003. Computer as a Tool; Ljubljana, Slovenia, September 2003. pp. 437­441.

30 The inverted pendulum in control theory and robotics

[165] [166] [167]
[168] [169] [170] [171] [172] [173] [174]
[175]
[176] [177] [178]

Ibañez C.A., Frias O.G., Castañón M.S. `Lyapunov-based controller for the inverted pendulum cart system'. Nonlinear Dynamics. 2005; 40(4): 367­374. Muskinja N., Tovornik B. `Swinging up and stabilization of a real inverted pendulum'. IEEE Transaction on Industrial Electronics. 2006; 53(2): 631­639. Alamir M. `A low dimensional contractive NMPC scheme for nonlinear systems stabilization: Theoretical framework and numerical investigation on relatively fast systems'. Lecture Notes in Control and Information Sciences. 2007; 358(1): 523­535. Gordillo F., Aracil J. `A new controller for the inverted pendulum on a cart'. International Journal of Robust and Nonlinear Control. 2008; 18(17): 1607­1621. Siuka A., Schoberl M. `Applications of energy based control methods for the inverted pendulum on a cart'. Robotics and Autonomous Systems. 2009; 57: 1012­1017. Park M.S., Chwa, D. `Swing-up and stabilization control of invertedpendulum systems via coupled sliding-mode control method'. IEEE Transactions on Industrial Electronics. 2009; 56(9): 3541­3555. Srinivasan B., Huguenin P., Bonvin D. `Global stabilization of an inverted pendulum­Control strategy and experimental verification'. Automatica. 2009; 45(1): 265­269. Adhikary N., Mahanta C. `Integral backstepping sliding mode control for underactuated systems: Swing-up and stabilization of the Cart­Pendulum System'. ISA Transactions. 2013; 52(6): 870­880. Psillakis H.E., Alexandridis A.T. `Inverted pendulum angle tracking control subject to uncertainties and stochastic perturbations'. IFAC Proceedings Volumes. 2006; 39(15): 456­461. Yu H., Liu Y., Yang T. `Closed-loop tracking control of a pendulum-driven cart-pole underactuated system'. Proceedings of the Institution of Mechanical Engineers, Part I: Journal of Systems and Control Engineering. 2008; 222(2): 109­125. Llama M.A., De La Torre W., Jurado F., Garcia-Hernandez R. `Robust Takagi­Sugeno fuzzy dynamic regulator for trajectory tracking of a pendulum-cart system'. Mathematical Problems in Engineering [online]. 2015. Available from http://dx.doi.org/10.1155/2015/247682. Wu Q.H., Jiang L., Wen J.Y. `Decentralized adaptive control of interconnected non-linear systems using high gain observer'. International Journal of Control. 2004; 77(8): 703­712. Lee J., Mukherjee R., Khalil H.K. `Output feedback stabilization of inverted pendulum on a cart in the presence of uncertainties'. Automatica. 2015; 54: 146­157. Xie W.B., Wang Y.L., Zhang J., Huang L. `Membership function dependent observer-based controller design for A T-S fuzzy system'. Asian Journal of Control. 2017 (Article in Press).

The inverted pendulum 31

[179] [180] [181] [182]
[183] [184] [185] [186]
[187] [188]
[189] [190] [191] [192]

Alamir M., Murilo A. `Swing-up and stabilization of a twin-pendulum under state and control constraints by a fast NMPC scheme'. Automatica. 2008; 44(5): 1319­1324. Yamakita M., Nonaka K., Furuta K. (eds.) `Swing up control of a double pendulum'. American Control Conference; San Francisco, California, June 1993. pp. 2229­2232. Guckenheimer J. `A robust hybrid stabilization strategy for equilibria'. IEEE Transactions on Automatic Control. 1995; 40(2): 321­326. Yi J., Yubazaki N., Hirota K. `Stabilization control of series-type double inverted pendulum systems using the SIRMs dynamically connected fuzzy inference model'. Artificial Intelligence in Engineering. 2001; 15(3): 297­308. Henmi T., Deng M., Inoue A. (eds.) `Swing-up control of a serial double inverted pendulum'. Proceedings of the IEEE American Control Conference; Boston, MA, USA, June 2004. pp. 3992­3997. Inoue A., Deng M.C., Henmi T., Ueki N., Hirashima Y. `Swing-up controller design for cart-type double inverted pendulum'. Control Theory and Applications. 2004; 21(5): 709­716. Graichen K., Treuer M., Zeitz M. `Swing-up of the double pendulum on a cart by feedforward and feedback control with experimental validation'. Automatica. 2007; 43(1): 63­71. Tao C.W., Taur J., Chang J.H., Su S.F. `Adaptive fuzzy switched swing-up and sliding control for the double-pendulum-and-cart system'. IEEE Transactions on Systems, Man, and Cybernetics, Part B (Cybernetics). 2010; 40(1): 241­252. Formal'skii A.M. `Global stabilization of a double inverted pendulum with control at the hinge between the links'. Mechanics of Solids. 2008; 43(5): 687­697. Yang W., Wu J., Yang S., Tao Y. `Adaptive NN tracking control of double inverted pendulums with input saturation'. in Guo C., Hou ZG., Zeng Z. (eds.) Advances in Neural Networks. Lecture Notes in Computer Science. Berlin, Heidelberg: Springer; 2013 (vol. 7952). pp. 147­154. Hassanzadeh I., Nejadfard A., Zadi M. `A multivariable adaptive control approach for stabilization of a cart-type double inverted pendulum'. Mathematical Problems in Engineering. 2011 (2011): Article ID 970786, 14 pp. Zhang Y.L., Cheng H.F., Li H.X. `The swing-up and stabilization of the triple inverted pendulum'. Control Theory and Applications. 2011; 28(1): 37­45. Medrano-Cerda G.A. `Robust stabilization of a triple inverted pendulum-cart'. International Journal of Control. 1997; 68(4): 849­865. Sehgal S., Tiwari S. (eds.) `LQR control for stabilizing triple link inverted pendulum system'. Second International Conference on Power, Control and Embedded Systems (ICPCES 2012); Motilal Nehru National Institute of Technology Allahabad, India, December 2012. doi:10.1109/ICPCES.2012.6508052.

32 The inverted pendulum in control theory and robotics

[193] [194] [195]
[196] [197] [198]
[199] [200] [201] [202] [203]
[204]
[205] [206] [207]

Gluck T., Eder A., Kugi A. `Swing-up control of a triple pendulum on a cart with experimental validation'. Automatica. 2013; 49(3): 801­808. Zhang X.L., Fan H.M., Zang J.Y., Zhao L., Hao S. `Nonlinear control of triple inverted pendulum based on GA­PIDNN". Nonlinear Dynamics. 2014; 79(2): 1185­1194. Zhang X.L., Fan H.M., Zang J.Y., Zhao L., Hao S. `The stabilization and 3D visual simulation of the triple inverted pendulum based on CGA-PIDNN'. International Journal of Control, Automation and Systems. 2015; 13(4): 1010­1019. Tsachouridis V.A., Medrano-Cerda G.A. `Discrete-time H control of a triple inverted pendulum with single control input'. IEE Proceedings: Control Theory and Applications. 1999; 146(6): 567­576. Medrano-Cerda G.A. `Robust stabilization of a triple inverted pendulum-cart'. International Journal of Control. 1997; 68(4): 849­865. Molazadeh V.R., Banazadeh A., Shafieenejad I. (eds.) `Design of the LQR controller and observer with fuzzy logic GA and GA-PSO algorithm for triple an inverted pendulum and cart system'. International Conference on Advanced Mechatronic Systems (ICAMechS); Kumamoto, Japan, August 2014. pp. 295­300. Gordillo F., Acosta J.A., Aracil J. `A new swing-up law for the Furuta pendulum'. International Journal of Control. 2003; 76(8): 836­844. Ibanez C.A., Azuela J.H.S. `Stabilization of the Furuta pendulum based on a Lyapunov function'. Nonlinear Dynamics. 2007; 49(1): 1­8. Ibanez, C.A., Ramirez, H.S. `A linear differential flatness approach to controlling the Furuta pendulum'. IMA Journal of Mathematical Control and Information. 2007; 24(1): 31­45. Acosta J.A., Aracil J., Gordillo F. `Nonlinear control strategies for the Furuta pendulum'. Control and Intelligent Systems. 2001; 29(3): 101­107. Noguchi K., Izutsu M., Kamamichi N., Shiotsuki T., Ishikawa J., Furuta K. (eds.) `Swinging up and stabilization control of double Furuta pendulums by safe manual control'. IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS 2009); St. Louis, MO, USA, October 2009. pp. 4232­4237. Ramirez-Neria M., Sira-Ramirez H., Garrido-Moctezuma R., LuvianoJuarez A. `Linear active disturbance rejection control of underactuated systems: The case of the Furuta pendulum'. ISA Transactions. 2014; 53(4): 920­928. Aguilar-Avelar C., Moreno-Valenzuela J. `A composite controller for trajectory tracking applied to the Furuta pendulum'. ISA Transactions. 2015; 57: 286­294. Moreno-Valenzuela J., Aguilar-Avelar C., Puga-Guzman S.A., Santibanez V. `Adaptive neural network control for the trajectory tracking of the Furuta pendulum'. IEEE Transactions on Cybernetics. 2016; 46(12): 3439­3452. Aguilar-Avelar C., Moreno-Valenzuela J. `New feedback linearization-based control for arm trajectory tracking of the Furuta pendulum'. IEEE/ASME Transactions on Mechatronics. 2016; 21(2): 638­648.

The inverted pendulum 33

[208]
[209] [210] [211] [212] [213] [214] [215] [216] [217] [218] [219] [220] [221] [222] [223]

Lenain R., Robertsson A., Johansson R., Shiriaev A., Berducat M. (eds.) `A velocity observer based on friction adaptation'. IEEE International Conference on Robotics and Automation; Pasadena, California, May 2008. pp. 3365­3370. Stamnes O.N., Aamo O.M., Kaasa G.O. `A constructive speed observer design for general Euler­Lagrange systems'. Automatica. 2011; 47(10): 2233­2238. Shiriaev A.S., Ludvigsen H., Egeland O. `Swinging up the spherical pendulum via stabilization of its first integrals'. Automatica. 2004; 40(1): 73­85. Shiriaev A.S., Freidovich L.B., Gusev S.V. `Transverse linearization for controlled mechanical systems with several passive degrees of freedom'. IEEE Transactions on Automatic Control. 2010; 55(4): 893­906. Consolini L., Tosques M. `On the exact tracking of the spherical inverted pendulum via an homotopy method'. Systems and Control Letters. 2009; 58(1): 1­6. Ping Z. `Tracking problems of a spherical inverted pendulum via neural network enhanced design'. Neurocomputing. 2013; 106: 137­147. Ma X.J., Sun Z.Q., He Y.Y. `Analysis and design of fuzzy controller and fuzzy observer'. IEEE Transactions on Fuzzy Systems, 1998; 6(1): 41­51. Anderson C.W. `Learning to control an inverted pendulum using neural networks'. IEEE Control Systems Magazine. 1989; 9(3): 31­37. Chang, W.D., Hsieh, J.G., Hwang, R.C. `A self-tuning PID control for a class of nonlinear systems based on the Lyapunov approach'. Journal of Process Control. 2002; 12(2): 233­242. Eltohamy K.G., Kuo C.Y. `Nonlinear optimal control of a triple link inverted pendulum with single control input'. International Journal of Control. 1998; 69(2): 239­256. Yang C., Li Z., Li J. `Trajectory planning and optimized adaptive control for a class of wheeled inverted pendulum vehicle models'. IEEE Transactions on Cybernetics. 2013; 43(1): 24­36. Huang J., Guan Z.H., Matsuno T., Fukuda T., Sekiyama K. `Sliding-mode velocity control of mobile-wheeled inverted-pendulum systems'. IEEE Transactions on Robotics. 2010; 26(4): 750­758. Ferreira A., Bejarano F.J., Fridman L.M. `Robust control with exact uncertainties compensation: With or without chattering'. IEEE Transactions on Control Systems Technology. 2011; 19(5): 969­975. Ebrahim A., Murphy G.V. (eds.) `Adaptive backstepping controller design of an inverted pendulum'. Proceedings of the Annual Southeastern Symposium on System Theory; Tuskegee, AL, USA, March 2005. pp. 172­174. Zhao J., Spong M.W. `Hybrid control for global stabilization of the cart-pendulum system'. Automatica. 2001; 37(12): 1941­1951. Alamir M., Murilo A. `Swing-up and stabilization of a twin-pendulum under state and control constraints by a fast NMPC scheme'. Automatica. 2008; 44(5): 1319­1324.

34 The inverted pendulum in control theory and robotics

[224] [225] [226] [227] [228]
[229] [230] [231] [232] [233] [234]
[235]
[236]
[237]

Graichen K., Treuer M., Zeitz M. `Swing-up of the double pendulum on a cart by feedforward and feedback control with experimental validation'. Automatica. 2007; 43(1): 63­71. Garcia-Alarcon O., Puga-Guzman S., Moreno-Valenzuela J. `On parameter identification of the Furuta pendulum'. Procedia Engineering. 2012; 35: 77­84. Bicakci S., Akdas D., Deniz Karaoglan A. `Optimizing Karnopp friction model parameters of a pendulum using RSM'. European Journal of Control. 2014; 20(4): 180­187. Wang B., Hou Z.X., Gao X.Z., Shan S.Q. `The application of inertial measurement unit in inertia parameter identification'. Advanced Materials Research. 2011; 201­203: 974­981. Ronquillo-Lomeli G., Rios-Moreno, G.J., Gomez-Espinosa A., MoralesHernandez L.A., Trejo-Perea M. `Nonlinear identification of inverted pendulum system using Volterra polynomials'. Mechanics Based Design of Structures and Machines. 2016; 44(1­2): 5­15. Davila J., Fridman L., Levant A. `Second-order sliding-mode observer for mechanical systems'. IEEE Transactions on Automatic Control. 2005; 50(11): 1785­1789. Moreno J.A., Osorio M. (eds.) `A Lyapunov approach to second-order sliding mode controllers and observers'. Proceedings of the IEEE Conference on Decision and Control; Cancun, Mexico, December 2008. pp. 2856­2861. Moreno J.A., Osorio M. `Strict Lyapunov functions for the super-twisting algorithm'. IEEE Transactions on Automatic Control. 2012; 57(4): 1035­1040. Salgado I., Kamal S., Bandyopadhyay B., Chairez I., Fridman L. `Control of discrete time systems based on recurrent super-twisting-like algorithm'. ISA Transactions. 2016; 64: 47­55. Guzman E., Moreno J.A. `Super-twisting observer for second-order systems with time-varying coefficient'. IET Control Theory and Applications. 2015; 9(4): 553­562. Chalanga A., Kamal S., Fridman L.M., Bandyopadhyay B., Moreno J.A. `Implementation of super-twisting control: Super-twisting and higher order sliding-mode observer-based approaches'. IEEE Transactions on Industrial Electronics. 2016; 63(6): 3677­3685. Mobayen, S., Tchier, F., Ragoub, L. `Design of an adaptive tracker for n-link rigid robotic manipulators based on super-twisting global nonlinear sliding mode control'. International Journal of Systems Science. 2017; 48(9): 1990­2002 (Article in Press): 1­13. Mansouri B., Manamanni N., Guelton K., Kruszewski A., Guerra T.M. `Output feedback LMI tracking control conditions with H criterion for uncertain and disturbed T­S models'. Information Sciences. 2009; 179(4): 446­457. Muhammad M., Buyamin S., Ahmad M.N., Nawawi S.W. `Takagi­Sugeno fuzzy modeling of a two-wheeled inverted pendulum robot'. Journal of Intelligent and Fuzzy Systems. 2013; 25(3): 535­546.

The inverted pendulum 35

[238] [239] [240] [241]
[242] [243]
[244] [245] [246] [247] [248] [249]
[250] [251] [252]

Xu J.X., Guo Z.Q., Lee T.H. `Design and implementation of a Takagi­ Sugeno-type fuzzy logic controller on a two-wheeled mobile robot'. IEEE Transactions on Industrial Electronics. 2013; 60(12): 5717­5728. Chiu C.S. `A dynamic decoupling approach to robust T­S fuzzy model-based control'. IEEE Transactions on Fuzzy Systems. 2014; 22(5): 1088­1100. Tsai P.W., Chen C.W. `A novel criterion for nonlinear time-delay systems using LMI fuzzy Lyapunov method'. Applied Soft Computing Journal. 2014; 25: 461­472. Llama M.A., De La Torre W., Jurado F., Garcia-Hernandez R. `Robust Takagi­Sugeno fuzzy dynamic regulator for trajectory tracking of a pendulum-cart system'. Mathematical Problems in Engineering [online]. 2015. Available from http://dx.doi.org/10.1155/2015/247682. Blanke M., Kinnaert M., Lunze J., Staroswiecki M. Diagnosis and fault-tolerant control (Third Edition). Berlin Heidelberg: Springer; 2016. Schulte H., Poschke F. (eds.) `H criteria for robust actuator fault reconstruction for nonlinear systems in Takagi­Sugeno's form using sliding modes'. 23rd Mediterranean Conference on Control and Automation (MED 2015); Torremolinos, Spain, June 2015. pp. 224­230. Chen Z., Ding S.X., Luo H., Zhang K. `An alternative data-driven fault detection scheme for dynamic processes with deterministic disturbances'. Journal of the Franklin Institute. 2017; 354(1): 556­570. Faraji-Niri M., Jahed-Motlagh M.R., Barkhordari-Yazdi M. `Stabilization of active fault-tolerant control systems by uncertain non homogeneous Markovian jump models'. Complexity. 2016; 21: 318­329. Bettayeb M., Boussalem C., Mansouri R., Al-Saggaf U.M. `Stabilization of an inverted pendulum-cart system by fractional PI-state feedback'. ISA Transactions. 2014; 53(2): 508­516. Zhong G., Deng H., Li J. `Chattering-free variable structure controller design via fractional calculus approach and its application'. Nonlinear Dynamics. 2015; 81(1­2): 679­694. Bouafoura M.K., Braiek N.B. `A state feedback control design for generalized fractional systems through orthogonal functions: Application to a fractional inverted pendulum'. Asian Journal of Control. 2013; 15(3): 773­782. Mishra S.K., Chandra D. `Stabilization and tracking control of inverted pendulum using fractional order PID controllers'. Journal of Engineering (United States) [online]. 2014. Available from http://dx.doi.org/10.1155/2014/752918. Durand S., Castellanos J.F.G., Marchand N., Sanchez W.F.G. `Event-based control of the inverted pendulum: Swing up and stabilization'. Journal of Control Engineering and Applied Informatics. 2013; 15(3): 96­104. Aranda-Escolastico E., Guinaldo M., Gordillo F., Dormido S. `A novel approach to periodic event-triggered control: Design and application to the inverted pendulum'. ISA Transactions. 2016; 65: 327­338. Mahmoud M.S., Memon A.M. `A periodic triggering mechanisms for networked control systems'. Information Sciences. 2015; 296: 282­306.

36 The inverted pendulum in control theory and robotics

[253] [254] [255] [256] [257] [258] [259] [260] [261] [262] [263] [264] [265] [266] [267] [268]

Etienne L., Khaled Y., Gennaro S.D., Barbot J.P. `Asynchronous eventtriggered observation and control of linear systems via impulsive observers'. Journal of the Franklin Institute. 2017; 354(1): 372­391. Fridman E., Shaikhet L. `Delay-induced stability of vector second-order systems via simple Lyapunov functionals'. Automatica. 2016; 74: 288­296. Xu Q., Stepan G., Wang Z. `Balancing a wheeled inverted pendulum with a single accelerometer in the presence of time delay'. Journal of Vibration and Control. 2017; 23(4): 604­614. Ghommam J., Mnif F. `Predictor-based control for an inverted pendulum subject to networked time delay'. ISA Transactions. 2017; 67: 306­316. Li Z., Bai Y., Huang C., Yan H. `Further results on stabilization for interval time-delay systems via new integral inequality approach'. ISA Transactions. 2017; 68: 170­180. Zhou Y., Wang Z. `A robust optimal trajectory tracking control for systems with an input delay'. Journal of the Franklin Institute. 2016; 353(12): 2627­2649. Shaw S.W., Rand R.H. `The transition to chaos in a simple mechanical system'. International Journal of Non-Linear Mechanics. 1989; 24(1): 41­56. Shaw J., Shaw S.W. `Onset of chaos in a two-degree-of-freedom impacting system'. Journal of Applied Mechanics. 1989; 56(1): 168­174. Du Z., Li Y., Shen J., Zhang W. `Impact oscillators with homoclinic orbit tangent to the wall'. Physica D: Nonlinear Phenomena. 2013; 245(1): 19­33. Sieber J., Krauskopf B. `Bifurcation analysis of an inverted pendulum with delayed feedback control near a triple-zero eigenvalue singularity'. Nonlinearity. 2004; 17(1): 85­103. Landry M., Campbell S.A., Morris K., Aguilar C.O. `Dynamics of an inverted pendulum with delayed feedback control'. SIAM Journal on Applied Dynamical Systems. 2005; 4(2): 333­351. Yang R., Peng Y., Song Y. `Stability and Hopf bifurcation in an inverted pendulum with delayed feedback control'. Nonlinear Dynamics. 2013; 73(1­2): 737­749. Wang Z., Hu H. `Stability and bifurcation of delayed dynamic systems: From theory to application'. Advances in Mechanics. 2013; 43(1): 3­20. Boussaada I., Morerescu I.C., Niculescu S.I. `Inverted pendulum stabilization: Characterization of codimension-three triple zero bifurcation via multiple delayed proportional gains'. Systems and Control Letters. 2015; 82: 1­9. Campbell S.A., Crawford S., Morris K. `Friction and the inverted pendulum stabilization problem'. Journal of Dynamic Systems, Measurement and Control. 2008; 130(5): 7 pp. Santiesteban R., Floquet T., Orlov Y., Riachy S., Richard J.P. `Second-order sliding mode control of underactuated mechanical systems II: Orbital stabilization of an inverted pendulum with application to swing up/balancing control'. International Journal of Robust and Nonlinear Control. 2008; 18(4­5): 544­556.

The inverted pendulum 37

[269] [270] [271] [272]
[273] [274] [275] [276]
[277]
[278] [279] [280] [281]
[282]

Aguilar L., Boiko I., Fridman L., Freidovich L. `Generating oscillations in inertia wheel pendulum via two relay controller'. International Journal of Robust and Nonlinear Control. 2012; 22(3): 318­330. Aguilar L., Boiko I., Fridman L., Iriarte R. `Generating self-excited oscillations for underactuated mechanical systems via two relay controller'. International Journal of Control. 2009; 82(9): 1678­1691. Aguilar L., Boiko I., Fridman L., Iriarte R. `Generating self-excited oscillations via two-relay controller'. IEEE Transactions on Automatic Control. 2009; 54(2): 416­420. Oriolo G., Nakamura Y. (eds.) `Control of mechanical systems with secondorder nonholonomic constraints: Underactuated manipulators'. Proceedings of the IEEE Conference on Decision and Control; Brighton, UK, December 1991. pp. 2398­2403. Spong M. (ed.) `Energy based control of a class of underactuated mechanical system'. 13th IFAC World Congress; San Francisco, USA, June 1996. pp. 431­436. Spong M. `Underactuated mechanical systems'. in Siciliano B., Valavanis K.P. (eds.) Control Problems in Robotics and Automation. London: Springer-Verlag; 1998. pp.135­150. Reyhanoglu M., Van Der Schaft A., McClamroch N.H., Kolmanovsky I. `Dynamics and control of a class of underactuated mechanical systems'. IEEE Transactions on Automatic Control. 1999; 44(9): 1663­1671. Ortega R., Spong M.W., Gomez-Estern F., Blankenstein G. `Stabilization of a class of underactuated mechanical systems via interconnection and damping assignment'. IEEE Transactions on Automatic Control. 2002; 47(8): 1218­1233. Riachy S., Orlov Y., Floquet T., Santiesteban R., Richard J.P. `Second-order sliding mode control of underactuated mechanical systems I: Local stabilization with application to an inverted pendulum'. International Journal of Robust and Nonlinear Control. 2008; 18(4­5): 529­543. Liu Y., Yu H. `A survey of underactuated mechanical systems'. IET Control Theory & Applications. 2013; 7(7): 921­935. Andary S., Chemori A., Krut S. `Control of the underactuated inertia wheel inverted pendulum for stable limit cycle generation'. Advanced Robotics. 2009; 23(15): 1999­2014. Choukchou-Braham A., Cherki B., Djemai M., Busawon K. Analysis and control of underwatcuated mechanical systems. London, UK: Springer; 2014. He G., Chen R., Zhang Y. `Globally stabilizing a class of underactuated mechanical systems on the basis of finite-time stabilizing observer'. Journal of Intelligent and Robotic Systems: Theory and Applications. June 2017; 86(3­4): 353­366. Segway Human Transporter. 2004. Available from http://www.segway.com [Accessed 29 March 2017].

38 The inverted pendulum in control theory and robotics

[283] [284] [285] [286] [287] [288] [289] [290] [291] [292] [293] [294] [295]

Nguyen H.G., Morrell J., Mullens K., et al. (eds.) `Segway robotic mobility platform'. Proceedings of SPIE--The International Society for Optical Engineering; USA, February 2004. pp. 207­220. Grasser F., D'Arrigo A., Colombi S., Rufer A.C. `JOE: A mobile, inverted pendulum'. IEEE Transactions on Industrial Electronics. 2002; 49(1): 107­114. Huang J., Ding F., Fukuda T., Matsuno T. `Modeling and velocity control for a novel narrow vehicle based on mobile wheeled inverted pendulum'. IEEE Transactions on Control Systems Technology. 2013; 21(5): 1607­1617. Sasaki M., Yanagihara N., Matsumoto O., Komoriya K. (eds.) `Forward and backward motion control of personal riding-type wheeled mobile platform'. IEEE International Conference on Robotics and Automation; New Orleans, LA, USA, April 2004. pp. 3331­3336. Vermeiren L., Dequidt A., Guerra T.M., Rago-Tirmant H., Parent M. `Modeling, control and experimental verification on a two-wheeled vehicle with free inclination: An urban transportation system'. Control Engineering Practice. 2011; 19(7): 744­756. Jeong S., Takahashi T. `Wheeled inverted pendulum type assistant robot: Design concept and mobile control'. Intelligent Service Robotics. 2008; 1(4): 313­320. Lauwers T., Kantor G., Hollis R. (eds.) `A dynamically stable single-wheeled mobile robot with inverse mouse-ball drive'. IEEE International Conference on Robotics and Automation; Orlando, FL, USA, May 2006. pp. 2889­2895. Kumagai M., Ochiai T. (eds.) `Development of a robot balancing on a ball'. International Conference on Control, Automation and Systems (ICCAS 2008); Seoul, Korea, October. 2008. pp. 433­438. Villacres J., Viscaino M., Herrera M., Camacho O. `Real-time implementation of different controllers for a two-wheeled inverted pendulum'. International Journal of Circuits, Systems and Signal Processing. 2016; 10: 281­290. Kajita S., Kanehiro F., Kaneko K., Yokoi K., Hirukawa H. (eds.) `The 3D linear inverted pendulum model: A simple modeling for a biped walking pattern generator'. IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS); Maui, USA, October 2001. pp. 239­246. Kajita S., Kanehiro F., Kaneko K., et al. (eds.) `Biped walking pattern generation by using preview control of zero-moment point'. IEEE International Conference on Robotics and Automation (ICRA); Taipei, China, September 2003. pp. 1620­1626. Sugihara T., Nakamura Y. (eds.) `Variable impedance inverted pendulum model control for a seamless contact phase transition on humanoid robot'. IEEE International Conference on Humanoid Robots (Humanoids2003), Karlsruhe, Germany, September 2003. Ghigliazza R.M., Altendorfer R., Holmes P., Koditschek D. `A simply stabilized running model'. SIAM Journal on Applied Dynamical Systems. 2004; 2(2): 187­218.

The inverted pendulum 39

[296] [297]
[298] [299] [300]

Siravuru A., Viswanathan S.P., Sreenath K., Sanyal A.K. `The reaction mass biped: Geometric mechanics and control'. Journal of Intelligent and Robotic Systems: Theory and Applications. 2017. doi:10.1007/s10846-017-0508-7. Kajita S., Morisawa M., Miura K., et al. (eds.) `Biped walking stabilization based on linear inverted pendulum tracking.' Proceedings of the IEEE/RSJ 2010 International Conference on Intelligent Robots and Systems; Taipei, Taiwan, October 2010. pp. 4489­449. Shiguematsu Y.M., Kryczka P., Hashimoto K., Lim H.O., Takanishi A. `Heel-contact toe-off walking pattern generator based on the linear inverted pendulum'. International Journal of Humanoid Robotics. 2016; 13(1): 25 pp. Luo J.W., Fu Y.L., Wang S.G. `3D stable biped walking control and implementation on real robot'. Advanced Robotics. 2017; 1­16. Huang H.W., Ju M.S., Lin C.C.K. `Flexor and extensor muscle tone evaluated using the quantitative pendulum test in stroke and Parkinsonian patients'. Journal of Clinical Neuroscience. 2016; 27: 48­52.

Part I
Robust state estimation and control: application to pendulum-cart systems

Chapter 2
State estimation and parameter identification via sliding-mode techniques: pendulum­cart system
Diego Gutiérrez1 and Héctor Ríos2
In this chapter, the problems of state estimation and parameter identification for the pendulum­cart system are addressed. Different high-order sliding-modes techniques are applied for such a mechanical system. The mathematical model is studied and a couple of high-order sliding-modes observers are proposed to estimate the state, in spite of disturbances; exactly and in a finite or fixed time, respectively. Then, using the exact state estimation, two parameter identification algorithms based on sliding-modes techniques are introduced to identify the unknown parameters of the system, i.e. the friction coefficients. Some experiments and comparisons are presented to illustrate the effectiveness of the presented algorithms. Finally, some concluding remarks are given at the end of the chapter.
2.1 Introduction
The state-estimation problem is one of the most important problems in control theory. There exist many kinds of observers in the literature like adaptive observers, dissipative observers, high-gain observers, sampled-data observers, interval observers, etc. Some of these are the sliding-modes-based observers, which have been successfully developed in the last decades (see, e.g. [1­3]) presenting finite-time convergence and insensitivity, more than just robustness, to some classes of disturbances.
The first results used first-order sliding-modes (FOSM) output injections (see, e.g. [4,5]), and to guarantee asymptotic convergence of the estimation error, they assumed that the system was minimum phase and relative degree one with respect to the unknown input. Later on, an output linear injection term was added to the FOSM output injection improving the numerical issues (see, e.g. [6,7]), providing, based on the same assumptions, asymptotic convergence of the estimation error. Nevertheless,
1Departamento de Control y Robótica, División de Ingeniería Eléctrica, Facultad de Ingeniería, Universidad Nacional Autónoma de México, Mexico. 2CONACYT ­ TECNM/Instituto Tecnológico de La Laguna, División de Estudios de Posgrado e Investigación, México.

44 The inverted pendulum in control theory and robotics
these assumptions limited the applicability of the proposed observers since they are not satisfied even for mechanical systems.
Afterwards, high-order sliding-modes (HOSM) observers were introduced based on strong observability and detectability conditions [8]. Such observers relaxed the condition related to the relative degree and ensure exact and finite-time state estimation (see, e.g. [9­13]). Continuous finite-time observers have been proposed based on homogeneity in [14­17]; and based on the implicit Lyapunov function theorem, a constructive homogeneous observer is proposed in [18]. These continuous observers provide exact and finite-time state estimation in absence of unknown inputs and uncertainties. Recently, the concept of fixed-time convergence, or uniform convergence with respect to the initial conditions, has been introduced by [19]. This property implies the existence of a bound for the convergence time, and such a bound is independent of the initial estimation error. There exist a couple of works related to this property and given in the differentiation framework: the given by [20] for the design of a first-order uniform robust exact differentiator, and that one in [21] for arbitrary order.
Regarding the parameter identification problem, it has been extensively studied during the last decades. One of the more important reasons is the need for accurate and efficient control for systems. The challenge of providing better models of physical phenomena leads to that the parameter identification problem becomes fundamental in industrial applications. System identification techniques are also used in signal processing applications (such as communications [22], geophysical engineering [23] and mechanical engineering [24]), in non-technical fields such as biology [25], environmental sciences and econometrics to improve the knowledge on the identified object, prediction and control.
The identification theory basically deals with the problem of the efficient extraction of signal and system dynamics properties based on available data measurements. In the literature there exist many methods to identify parameters, and the most popular ones belong to the group of least squares (LS) methods; for instance, the non-recursive method of LS, recursive methods of LS, method of weighted LS, exponential forgetting with constant forgetting factor, exponential forgetting with variable forgetting factor, etc. There exist also many modifications of the LS methods; for example, the method of generalized LS, method of extended LS, method of bias correction, instrumental variables method; and some others like Bayes method, maximum likelihood methods, extended Kalman filter, modulating functions methods, subspaces methods, etc. (see, e.g. [26­29]).
In the context of finite-time convergence [30], a recursive finite-time convergent algorithm has been presented in [31]. Such an algorithm is a non-linear recursive version of the LS algorithm, where the non-linear injection terms, designed based on the generalized super-twisting algorithm (STA) [32], lead to finite-time convergence. In this line of research, in [33,34], the filtered equivalent output injection of the STA together with a standard LS recursive algorithm have been used for parameter identification of mechanical systems. A finite-time and non-recursive LS algorithm is presented by [35] to identify constant parameters. Such an algorithm is based on adaptive control and it requires to solve matrix-valued ordinary differential equations and to check the invertibility of a matrix (persistence of excitation condition) online.

State estimation and parameter identification via sliding-modes 45

The observation and identification problems have been also studied in different

types of pendulums. In the context of state estimation, in [36], Kalman filters are

introduced to estimate the state of the Virgo inverted pendulum. To estimate the state

of the Furuta pendulum and the wheeled inverted pendulum, some linear observers

have been presented by [37,38], respectively. Some extended high-gain observers have

been implemented in the inertia wheeled pendulum and in the inverted pendulum­

cart by [39,40], respectively. For a mobile wheeled inverted pendulum, in [41,42],

non-linear observers have been proposed to estimate the state or disturbances. On

the other hand, in order to identify the pendulum parameters, in [43], some Kalman

filters are used to identify the dynamic characteristic of the structures equipped with

a pendulum tuned mass damper. For the Furuta pendulum, in [44], a standard LS

algorithm is implemented. Based on a Volterra polynomials, in [45], a non-linear

identification is proposed for the inverted pendulum systems. For the single and

the double pendulum, some parameter identification algorithm based on harmonic

balance-based algorithm are proposed by [46,47], respectively.

In this chapter, the problems of state estimation and parameter identification for

the pendulum­cart system are addressed. A couple of HOSM observers are proposed

to estimate the state, in spite of disturbances; exactly and in a finite or fixed time,

respectively. Based on the exact state estimation, two parameter identification algo-

rithms based on sliding-modes techniques are introduced to identify the unknown

parameters of the system, i.e. the friction coefficients. The corresponding conver-

gence proofs are given based on Lyapunov function approach. Some experiments and

comparisons illustrate the effectiveness of the presented algorithms.

The outline of this work is as follows. The problem statement is given in

Section 2.2 and some preliminary results are presented in Section 2.3. The corre-

sponding analysis, design, and robustness properties of the observers are presented

in Section 2.4 and the identification algorithms with the corresponding conditions to

ensure the convergence of the parameters are given in Section 2.5, both of them present

experimental results. Finally, some concluding remarks are discussed in Section 2.6.

Notation: Let R denote the set of real numbers. Let q denote the Euclidean

norm of a vector q  Rn; 1, n a sequence integers 1, . . . , n; and I an identity matrix.

The induced norm for a matrix Q  Rm×n is given as Q := max(QT Q), where

max (respectively, min) is the maximum (respectively, the minimum) eigenvalue.

For a Lebesgue measurable function u : R0  Rm define the norm u (t0,t1) :=

ess supt(t0,t1) erty u  <

u(t) +

, is

then u denoted

 := u (0,+) as L. Define

and the set of the function

functions u with the prop·  := |·| sign(·), for any

  R0.

2.2 Problem statement
Consider the pendulum­cart system depicted in Figure 2.1. This figure describes a pendulum rotating in a vertical plane around an axis located on a cart. The cart can move along a horizontal rail, lying in the plane of rotation. The system state is a vector x = (x1, x2, x3, x4)T , where x1 is the cart position, x2 is the angle between

46 The inverted pendulum in control theory and robotics
J,mp X2
Mass center
l F
mc

X1 Rail center

Figure 2.1 Pendulum­cart system

the upward direction and the pendulum, measured counterclockwise (x2 = 0 for the upright position of the pendulum), x3 is the cart velocity, and x4 is the pendulum angular velocity. A control force F, parallel to the rail, is applied to the cart. It is produced by a DC flat motor controlled by a pulse-width-modulation (PWM) voltage signal u, and F = p1u. The system control u takes values in the interval [-0.5, 0.5]. The total mass of the pendulum and cart is denoted by m. The distance from the axis of rotation of the pendulum to the centre of mass of the system is l. The moment of inertia of the pendulum with respect to its axis on the cart is represented by J . The cart friction is compound of two forces: the static and the viscous friction proportional to the cart velocity, fcx3 and fssign(x3), respectively. There is also a friction torque in the angular motion of the pendulum, proportional to the angular velocity, fpx4 [48].
The system dynamics is described by the following equations:

x1 = x3,

(2.1)

x2 = x4,

(2.2)

x3 = f1(x, u) + 1(t, x, u),

(2.3)

x4 = f2(x, u) + 2(t, x, u), y = (y1, y2)T = (x1, x2)T ,

(2.4) (2.5)

where the measurable output is given by y  R2, the nominal part of the system dynamics is represented by the functions f1 : R4 × R  R and f2 : R4 × R  R, i.e.

f1(x, u) :=

aw1

(x, J

u) +

+ l cos (x2)w2 mi l sin2 (x2 )

(x)

,

f2(x, u) :=

l

cos

(x2)w1(x, u) + w2 J + milsin2(x2)

(x)

,

w1(x, u) := p1u - mix42 sin (x2) - fcx3 - fssign(x3),

w2(x) := mig sin (x2) - fpx4,

(2.6)
(2.7) (2.8) (2.9)

mi

:=

l(mc

+ mp),

a

:=

l2

+

mc

J ,
+ mp

(2.10)

State estimation and parameter identification via sliding-modes 47 Table 2.1 Parameters of the pendulum­cart system

Name
mc mp l fc fs fp p1 J

Description
Cart mass Pendulum mass Distance from the rotation axis to the mass center Dynamic friction coefficient Dry friction coefficient Rotational friction coefficient Control-force-to-PWM-signal ratio Moment of inertia of the pendulum

Units
0.5723 (kg) 0.12 (kg) 0.01955717 (m) 0.5 (N s/m) 1.1975875 (N) 0.6650 × 10-4 (N ms/rad) 9.4 (N) 0.0038583 (kgm2)

while the uncertainties and perturbations are concentrated in the terms 1 and 2. The
solutions of the system (2.1)­(2.4) are understood in the Filippov's sense [49]. It is assumed that the uncertainties 1(t, x, u) and 2(t, x, u) are Lebesgue-measurable and uniformly bounded in any region of the state space x  R4, i.e. 1(t, x, u)   1+ and 2(t, x, u)   2+, with known positive constants 1+ and 2+.
The aims of this chapter are to estimate the corresponding velocities, i.e. the states x3 and x4; and identify the friction parameters1, i.e. fc, fp, and fs; by means of only the measurable output y and the input u despite the bounded uncertainties 1 and 2.
The parameters of system (2.1)­(2.4) are given in Table 2.1.

2.3 Preliminaries

Let us consider a time-varying differential equation [50]:

dx(t) = f (t, x(t)), dt

t  t0, t0  R,

(2.11)

where x(t)  Rn is the state vector; f : R0 × Rn  Rn is a continuous function with respect to x and measurable with respect to t, and f (t, 0) = 0. It is assumed that

solution of the system (2.11) for an initial condition x0  Rn at time instant t0  R is denoted as x(t, t0, x0) and it is defined on some finite time interval [t0, t0 + T ) where 0  T <  [the notation x(t) will be used to reference x(t, t0, x0) if the origin of x0

and t0 is clear from the context]. Let be an open subset of Rn, such that 0  .

Definition 2.1. [19],[50],[51]. At the steady state x = 0 the system (2.11) is said to be:

 Uniformly stable (US) if for any  > 0 there is () such that for any x0  , if |x0|  () then |x(t, t0, x0)|   for all t  t0, for any t0  R.

1It is well known that most of the time the value of the friction coefficients is obtained by means of experimental evaluation and thus it is difficult to provide an estimation.

48 The inverted pendulum in control theory and robotics
 Uniformly asymptotically stable (UAS) if it is US and for any  > 0 and  > 0 there exists T (, )  0 such that for any x0  , if |x0|   then |x(t, t0, x0)|   for all t  t0 + T (, ), for any t0  R.
 Uniformly finite-time stable (UFTS) if it is US and finite-time converging from , i.e. for any x0  there exists 0  T x0 < + such that x(t, t0, x0) = 0 for all
t  t0 + T x0 , for any t0  R. The function T0(x0) = inf {T x0  0 : x(t, t0, x0) = 0, t  t0 + T x0 } is called the settling-time of the system (2.11).  Uniformly fixed-time stable (UFxTS) if it is UFTS and the settling-time function T0(x0) is bounded, i.e. Tmax > 0 : T0(x0)  Tmax, for all x0  and for any t0  R.
If = Rn, then x = 0 is said to be globally US (GUS), UAS (GUAS), UFTS (GUFTS), or UFxTS (GUFxTS), respectively.

2.4 High-order sliding-mode observers

In this section, a general HOSM observer is presented to estimate the corresponding velocities. Then, two particular cases are presented in order to provide finite and fixed-time convergence of the estimated state to the real one.
The general HOSM observer has the following form:

x^1 = x^3 + k11(ey1 ), x^2 = x^4 + k22(ey2 ), x^3 = fn1 (x^, y, u) + k33(ey1 ), x^4 = fn2 (x^, y, u) + k44(ey2 ),

(2.12) (2.13) (2.14) (2.15)

where ey1 := y1 - x^1 and ey2 := y2 - x^2 are the output errors, the known nominal functions fn1 : R4 × R4 × R  R and fn2 : R4 × R4 × R  R take the following
structure

fn1 (x^, y, u) :=

awn1

(x^, y, u) + J + mil

l cos (y2 sin2(y2)

)wn2

(y)

,

fn2 (x^, y, u) :=

l

cos

(y2)wn1 (x^, y, u) + J + milsin2(y2)

wn2

(y)

,

wn1 (x^, y, u) := p1u - mix^42 sin (y2),

wn2 (y) := mig sin (y2),

(2.16)
(2.17) (2.18) (2.19)

the non-linear output injections

1(ey1 ) := 11

ey1

1
2 + 12

ey1

1 + 13

ey1

3
2,

2(ey2 ) := 21

ey2

1
2 + 22

ey2

1 + 23

ey2

3
2,

(2.20) (2.21)

State estimation and parameter identification via sliding-modes 49

3(ey1 ) := 31 ey1 0 + 32 ey1 1 + 33 ey1 2 , 4(ey2 ) := 41 ey2 0 + 42 ey2 1 + 43 ey2 2 ,

(2.22) (2.23)

and some positive constants ki, ij  0 for i = 1, 4 and j = 1, 3. Note that the properties of the general HOSM observer may change according to the selection of the parameters ij, i.e.

 For i1 = i3 = 0, i = 1, 4, the observer (2.12)­(2.15) recovers a classic linear observer.
 For i2 = i3 = 0, i = 1, 4, the observer (2.12)­(2.15) recovers a well-known non-linear observer, i.e. the super-twisting observer [11].
 For i2 = 0, i = 1, 2, the observer (2.12)­(2.15) recovers another non-linear observer, i.e. the fixed-time observer [20].

Let us define the state estimation error e = (e1, e2, e3, e4)T  R4 where ei := xi - x^i for i = 1, 4. Thus, the error dynamics is given as follows:

e1 = e3 - k11(ey1 ),

(2.24)

e2 = e4 - k22(ey2 ),

(2.25)

e3 = F1(x, x^, y, u) + 1(t, x, u) - k33(ey1 ),

(2.26)

e4 = F2(x, x^, y, u) + 2(t, x, u) - k44(ey2 ).

(2.27)

where F1(x, x^, y, u) := f1(x, u) - fn1 (x^, y, u) and F2(x, x^, y, u) := f2(x, u) - fn2 (x^, y, u). Due to the boundedness assumption over the uncertain terms 1 and 2, and the stability properties of the pendulum­cart system2, it is possible to find an upper bound such
that

F1(x, x^, y, u) + 1(t, x, u)   f1+,

(2.28)

F2(x, x^, y, u) + 2(t, x, u)   f2+,

(2.29)

with known positive constants fi+ for i = 1, 2. In the following, the error dynamics is analysed for two different non-linear

observers, i.e. the super-twisting and the fixed-time observer, respectively.

2.4.1 Super-twisting observer

Consider the general HOSM observer (2.12)­(2.15) for the case in which i2 = i3 = 0, and i1 = 1 for i = 1, 4, i.e. the super-twisting observer [11]:

x^1 = x^3 + k1

ey1

1
2,

(2.30)

x^2 = x^4 + k2

ey2

1
2,

(2.31)

2Note that for any initial condition x0  R4 the trajectories of the pendulum­cart system (2.1)­(2.4) are US for any bounded 1 and 2.

50 The inverted pendulum in control theory and robotics

x^3 = fn1 (x^, y, u) + k3 ey1 0, x^4 = fn2 (x^, y, u) + k4 ey2 0.

(2.32) (2.33)

The following theorem describes the convergence properties of the super-twisting observer.

Theorem 2.1. [32] Let observer (2.30)­(2.33) be applied to pendulum­cart system (2.1)­(2.4). If the observer parameters are designed as follows:

k1

>

0,

k2

>

0,

k3

>

3f1+

+

2

f1+ k12

,

k4

>

3f2+

+

2

f2+ k22

,

(2.34)

then the error dynamics is UFTS.

Proof. The error dynamics between pendulum­cart system (2.1)­(2.4) and the supertwisting observer (2.30)­(2.33) is given as follows:

e1

= e3 - k1

e1

1
2,

e2

= e4 - k2

e2

1
2,

e3 = F1(x, x^, y, u) + 1(t, x, u) - k3 e1 0,

e4 = F2(x, x^, y, u) + 2(t, x, u) - k4 e2 0.

(2.35) (2.36) (2.37) (2.38)

Based on [32], it is possible to show that the function

V = V1 + V2 = 1T P11 + 2T P22,

with

1T =

e1

1
2 , e3

, 2T =

1
e2 2 , e4 ,

P1

=

1 2

4k3 + k12 -k1 -k1 2

,

P2

=

1 2

4k4 + k22 -k2 -k2 2

,

(2.39)
(2.40) (2.41)

is a Lyapunov function for the error dynamics (2.35)­(2.38), and its derivative along the trajectories of such an error dynamics is given by

V

=

1

-

|e1

|

1 2

1T Q11

-

1

|e2|

1 2

2T Q22

+

(F1

+

1)q1T 1

+

(F2

+

2)q2T 2,

(2.42)

where

Q1

=

k1 2

2k3 + k12 -k1 -k1 1

,

Q2

=

k3 2

2k4 + k22 -k2 -k2 1

,

q1T = [-k1, 2] , q2T = [-k2, 2] .

(2.43) (2.44)

State estimation and parameter identification via sliding-modes 51

Recalling that |F1 + 1|  f1+ and |F2 + 2|  f2+, it may be shown that V is upper bounded as follows

V



1

-

|e1

|

1 2

1T Q¯ 11

-

1

|e2

|

1 2

2T Q¯ 22,

(2.45)

where

Q¯ 1

=

k1 2

2k3 + k12 - 2f1+

-k1

-

2f1+ k1

-k1 - 1

2f1+ k1

,

Q¯ 2

=

k3 2

2k4 + k22 - 2f1+

-k2

-

2f2+ k2

-k2 - 1

2f2+ k2

.

(2.46) (2.47)

Then, V is negative definite if Q¯ 1 > 0 and Q¯ 2 > 0. Hence, it is easy to show that this is true if the inequalities (2.34) hold. On the other hand, it follows that

1

1

|e1

|

1 2



1



V1 min (P1 )

2

,

|e2

|

1 2



2



V2 min (P2 )

2
,

(2.48)

where min(Pi) is the minimum eigenvalue of the matrix Pi. Therefore, V may be upper bounded as follows

V

1
 -1V12

1
- 2V22



-

V

1 2

,

(2.49)

with

1

:=

1
m2 in

(P1

)min

(Q¯ 1

)

,

max (P1 )

2

:=

1
m2 in

(P2)min

(Q¯ 2

)

,

max (P2 )



:=

min(1, 2),

(2.50)

and max(Pi) the maximum eigenvalue of the matrix Pi. Thus, since the solution of

the

differential

equation

v



-

v

1 2

,

v(0)  0,

is

given

by

v(t)

=

(v

1 2

(0)

-

 2

t)2

for

all t  0, by the comparison principle [50] one obtains that V (t), and therefore the

error dynamics (2.35)­(2.38), converges to zero at most in a finite time given by

T

=

2V

1 2

(e(0))/

.

2.4.2 Fixed-time observer

Let us consider the general HOSM observer (2.12)­(2.15) with i1 = 1 for i = 1, 2; i1 = 0.5 for i = 3, 4; i2 = 0 for i = 1, 2; i2 = 2 for i = 3, 4; i3 =  for i = 1, 2; i3 = 1.52 for i = 3, 4; and  > 0; i.e. the fixed-time observer [20]:

x^1 = x^3 + k1

1

3

ey1 2 +  ey1 2 ,

(2.51)

x^2 = x^4 + k2

1

3

ey2 2 +  ey2 2 ,

(2.52)

52 The inverted pendulum in control theory and robotics

x^3 = fn1 (x^, y, u) + k3

1 2

ey1 0 + 2

ey1

1 + 32 2

ey1 2

,

(2.53)

x^4 = fn2 (x^, y, u) + k4

1 2

ey2 0 + 2

ey2

1 + 32 2

ey2 2

.

(2.54)

The following theorem describes the convergence properties of the fixed-time observer.

Theorem 2.2. [20] Let observer (2.51)­(2.54) be applied to pendulum­cart system (2.1)­(2.4). If the observer parameters are in the set:

0 < k1  2

f1+,

k3

>

k12 4

+

(2f1+)2 k12



k1 > 2

f1+, k3 > 2f1+

,

0 < k2  2

f2+,

k4

>

k22 4

+

(2f2+)2 k22



k2 > 2

f2+, k4 > 2f2+

,

(2.55) (2.56)

then the error dynamics is UFxTS.

Proof. The error dynamics between pendulum­cart system (2.1)­(2.4) and the fixedtime observer (2.51)­(2.54) is given as follows:

e1 = e3 - k1¯1(e1), e2 = e4 - k2¯2(e2), e3 = F1(x, x^, y, u) + 1(t, x, u) - k3¯3(e1), e4 = F2(x, x^, y, u) + 2(t, x, u) - k4¯4(e2).

(2.57) (2.58) (2.59) (2.60)

where

¯1(e1) :=

1

3

ey1 2 +  ey1 2 ,

¯2(e2) :=

1

3

ey2 2 +  ey2 2 ,

¯3(e1) :=

1 2

ey1 0 + 2

ey1

1 + 32 2

ey1

2,

¯4(e2) :=

1 2

ey2 0 + 2

ey2

1 + 32 2

ey2

2.

Based on [20], one can show that the function

V = V1 + V2 = 1T P11 + 2T P22,

with

1T = ¯1(e1), e3 , 2T = ¯2(e2), e4 ,

(2.61) (2.62) (2.63) (2.64)
(2.65)
(2.66)

State estimation and parameter identification via sliding-modes 53

and P1, P2 symmetric and positive definite matrices; is a Lyapunov function for the error dynamics (2.57)­(2.60). Some suitable matrices Pi = PiT > 0 are the solutions of the following linear matrix inequalities [20]

AT1 P1 + P1A1 + I + (2f1+)2CT C P1B

BT P1

-1

AT2 P2 + P2A2 + I + (2f2+)2CT C P2B

BT P2

-1

 0,  0,

(2.67) (2.68)

where

A1 :=

-k1 1 -k3 0

, A2 :=

-k2 1 -k4 0

, B := [0, 1]T , C := [1, 0],

(2.69)

with ki for i = 1, 4 defined by (2.55)­(2.56), and some  > 0. Thus, it is possible to show that

V

=

1
-11V12

-

12|e1|

1 2

V1

1
- 21V22

-

22|e2|

1 2

V2,

(2.70)

where



3

11

:=

1

,

2m2 ax(P1)

12

:=

, 2max (P1 )

21

:=



1

,

2m2 ax(P2)

22

:=

3 .
2max (P2 )

(2.71) (2.72)

Therefore, this implies that the trajectories of the error dynamics (2.57)­

(2.60)

converge

to

zero

at

most

in

a

finite

time

given

by

T1

=

2V

1 2

(e(0))/

,

with

 := min(11, 21). Hence, the uniform finite-time stability of the error dynamics is

concluded. To provide the fixed-time convergence, it is needed to prove the uniform

convergence with respect to the initial conditions.

Let us consider the following function

V¯1 =

 2

2k3|e1|3

-

e1

e3

4 3

+

 2

|e3

|2

(2.73)

V¯2 =

 2

2k4|e2|3

-

e2

e4

4 3

+

 2

|e4

|2

,

(2.74)

where  > 0 sufficiently large. Thus, taking V¯ = V¯1 + V¯2, its derivative along the

trajectories of the error dynamics is given by





V¯ = - 1  V¯1

7 2
+

V¯ 2

7 2
,

2 2c1

2c2

V¯1 > , V¯2 > ,

(2.75)

for a sufficient large , and some positive constants c1 and c2. Hence, any trajectory of the error dynamics (2.57)­(2.60) converges to the compact set  := {e  R4| V¯1  , V¯2  } containing the origin, robustly and uniformly with respect to the initial error e(0)  R4, and the convergence time is upper bounded by a time T2 independent
of the initial error. The estimation of such a time is given in [20].

54 The inverted pendulum in control theory and robotics
Figure 2.2 Real pendulum­cart system
Therefore, combining the two previous properties, i.e. finite-time and uniform convergence, one can conclude that the error dynamics (2.57)­(2.60) is UFxTS.
Remark 2.1. The detailed convergence proofs for the super-twisting and fixed-time observers can be seen in [32] and [20], respectively. In this chapter, the proofs provided for Theorems 2.1 and 2.2 represent just brief sketches. Moreover, the given results are particularly provided for the pendulum­cart system.
2.4.3 Experimental results
In order to illustrate the workability of the previous HOSM observers, some experiments have been done over the real pendulum­cart system by INTECO and depicted in Figure 2.2.
The control input u is designed in two steps: 1. Swing-Up. Based on an algorithm for generation of oscillations, the control
input u is able to take the pendulum from its stable equilibrium point, i.e. x = [0,  , 0, 0]T , to certain region close to its unstable equilibrium point, i.e. x = [0, 0, 0, 0]T . 2. Tracking Control. Once a region around the unstable equilibrium point has been reached, a PID controller is applied to track the reference r = 0.3 sin(0.05t) for the cart position and to maintain the pendulum in the upper position. The super-twisting and the fixed-time observers, described by (2.30)­(2.33) and (2.51)­(2.54), respectively, are implemented in MATLAB® Simulink®. The parameters for both observers were chosen according to the theorems described for each algorithm and tuned in the experiments to obtain the minimum possible errors; these parameters are given in Table 2.2. The experiments have been done on MATLAB Simulink platform over a RTDAC4/ PCIc data-acquisition board connected to the educational pendulum­cart system. All the experiments have been implemented with the Euler's integration method and with a sampling time equal to 1 × 10-2 s.

State estimation and parameter identification via sliding-modes 55 Table 2.2 Parameters of the observers

Parameter Super-twisting obs. Fixed-time obs.

k1

6.7

6.7

k2

6.7

6.7

k3

22

22

k4

22

22

ff21++

1

1

1

1



­

1.5

0.6

Real

0.4

Super-twisting observer

Fixed-time observer

0.2

0

x1 [m]

-0.2

-0.4 0.2 0
-0.6 -0.2

-0.4

-0.8

-0.60

0.5

1

-1

0

5

10

15

20

25

30

35

40

Time [s]

Figure 2.3 Cart position estimation

The results are presented in Figures 2.3­2.6. It is worth saying that the estimated positions, i.e. x^1 and x^2, are compared with the positions provided by a couple of position encoders given in the pendulum­cart system, while the estimated velocities, i.e. x^3 and x^4, are compared with the velocities given by a numerical differentiator included in the pendulum­cart toolbox. Then, it is easy to see that both observers

have similar performance and they provide very good estimation results.

In order to illustrate the performance of both observers the following index is

implemented:

I= 1

t

1/2

|e( )|2d ,

T t- T

(2.76)

where e is the state estimation vector and T is a time window width; in the experi-

ment, T was selected as 2. This performance index calculates the Root Mean Square

(RMS) value of the input e.

56 The inverted pendulum in control theory and robotics

5
4 4
2
30 012345
2

Real Super-twisting observer Fixed-time observer

x2 [rad]

1

0

-1

0

5

10

15

20

25

30

35

40

Time [s]

Figure 2.4 Pendulum position estimation

x3 [m/s]

2 1.5
1 0.5
0 -0.5
-1 -1.5
-2 0

Numerical differentiation Super-twisting observer Fixed-time observer

5

10

15

20

25

30

35

40

Time [s]

Figure 2.5 Cart velocity estimation

The behaviour of the performance index during the experiment is shown in Figure 2.7. One can see that the fixed-time observer presents a bigger overshoot than the super-twisting observer and this last one has a lower performance index after the transient.

x4 [rad/s]

State estimation and parameter identification via sliding-modes 57

10 8 6 4 2 0
-2 -4 -6 -8 -10
0

Numerical differentiator Super-twisting observer Fixed-time observer

5

10

15

20

25

30

35

40

Time [s]

Figure 2.6 Pendulum velocity estimation

6

Super-twisting observer

5

Fixed-time observer

4

3

2

1

00

5

10

15

20

25

30

35

40

Time [s]

Figure 2.7 Performance index of state estimation

I

The results show that both observers present good results in order to estimate the pendulum­cart states, but super-twisting observer presents a better performance with the chosen index and the tuning of the fixed-time observer parameters can be a little more difficult because it presents more than the super-twisting.

58 The inverted pendulum in control theory and robotics
2.5 Parameter identification algorithms
A common issue in the control design problem is the lack of knowledge in the parameters of the system, for instance, the friction coefficients in mechanical systems; and even a complete ignorance of them. In order to solve such a problem parameter identification algorithms are required.
Let us assume that 1 = 2 = 0, then the pendulum­cart dynamics can be rewritten in its regressor form as follows [29]:

x1 = x3, x2 = x4, x3 = fn1 (x, u) + 1(t) , x4 = fn2 (x, u) + 2(t) ,

(2.77) (2.78) (2.79) (2.80)

where

fn1 (x, u) :=

awn1

(x, J

u) +

+ mi

l cos(x2)wn2 lsin2(x2)

(x)

,

fn2 (x, u) :=

l

cos(y2)wn1 (x, u) J + milsin2

+ wn2 (x2)

(x)

,

wn1 (x, u) := p1u - mix42 sin(x2), wn2 (x) =: mig sin(x2),

1(t) :=

J

-1 + milsin2(x2) (ax3, asign(x3), lx4 cos(x2)),

2(t) :=

J

-1 + milsin2(x2) (l cos(x2)x3, l cos(x2)sign(x3), x4),

 T := ( fc, fs, fp),

(2.81) (2.82) (2.83)
(2.84) (2.85)

where   R3 represents the unknown parameter vector, and

T 1

:

R



R3,

T 2

:

R



R3 are the regressor vectors. From (2.77) to (2.80), it is easy to see that it is enough

to consider only dynamics (2.79) in order to identify the corresponding parameter

vector  .

Thus, it is assumed that 1 is bounded, i.e. 0 < 1 = 1 < , and that it is persistently exciting (PE), i.e. there exist constants 2 > 0 and 0 > 0 such that

t+0

T 1

(

)

1( )d  2I ,

t

t  0.

(2.86)

In the following, two different non-linear identification algorithms are presented in order to identify the parameter vector  , i.e. a homogeneous algorithm and a finite-time algorithm, respectively.

State estimation and parameter identification via sliding-modes 59

2.5.1 Homogeneous algorithm

The homogeneous parameter identification algorithm takes the following form [52]:

x¯3 = -k¯1 e¯3  + 1(t)^ + fn1 (x^, y, u),

^ = -k¯2 e¯3 2 -1

T 1

(t

),

(2.87) (2.88)

where k¯1 and k¯2 are positive gains, e¯3 := x¯3 - x^3 is a state estimation error where x^3 may be given by the super-twisting or the fixed-time observer; and the parameter   (0.5, 1). Note that for the case  = 1 the algorithm is reduced to the well-known
linear adaptive observer [53]. Define the identification error as ~ := ^ -  . Thus, based on homogeneity for
time varying-systems (for more details, see [52,54]), the following theorem describes
the convergence properties of the Homogeneous algorithm.

Theorem 2.3. [52] Let the Homogeneous algorithm (2.87)­(2.88) be applied to the dynamics (2.79), and the regressor vector 1 be PE. Then for any k¯1, k¯2 > 0 and   (0.5, 1) the identification error ~ is GUAS.

Proof. Define e~3 := x¯3 - x3. Then, the error dynamics is given by
e~3 = -k¯1 e¯3  + 1(t)~ + fn1 (x^, y, u) - fn1 (x, u) ~ = -k¯2 e¯3 2 -1 1T (t).

(2.89) (2.90)

Then, according to the state estimation properties of the super-twisting and the
fixed-time observers described in the previous sections, one can ensure that after a finite time x^3  x3, and thus, this implies that after a finite time e~3  e¯3 and also fn1 (x^, y, u)  fn1 (x, u). Therefore, the error dynamics can be rewritten as follows:

e~3 = -k¯1 e~3  + 1(t)~ ~ = -k¯2 e~3 2 -1 1T (t).

(2.91) (2.92)

One can show that the system (2.91)­(2.92) is r-homogeneous, in the sense given by [52], with degree d =  - 1 for the vector of weight (r1, r2, r3, r4) = (1,  ,  ,  ). Note that d < 0 for all   (0.5, 1). Then, based on homogeneity theory one a show that the system (2.91)­(2.92) is GUAS.
First, note that the system (2.91)­(2.92) can be rewritten as follows:

 (t) = A(t) (t) + f (t, e~3),

(2.93)

where  (t) = (e~3, ~T )T  R4, A(t) is a bounded and continuous matrix, for almost all t  0, that is given by

A(t) =

-k¯1

-k¯2

T 1

(t

)

1(t) , 0

(2.94)

60 The inverted pendulum in control theory and robotics

and the non-linear term f : R0 × R  R4 is given as follows:

f (t, e~3) =

-k¯1 e~3  - e~3 -k¯2 e~3 2 -1 - e~3 1T (t)

.

(2.95)

Define

W1(e~3, ~)

=

1 p

V1p

(e~3

,

~)

+

2 q

V1q

(e~3

,

~

),

W2(t,  ) =  T P(t) ,

(2.96) (2.97)

where

V1(e~3, ~)

=

1 2

|e~3|2

+

1 2k¯2

~T ~,

1

= 2k¯1c2(2 )p-1, 2 = 2c2

k¯12 + k¯2212 k¯1

(2 )q-1 ,

p

=

 +1 2 ,

q=

3- 2 ,

(2.98) (2.99) (2.100)

and a positive constant ; while P(t) is a continuously differentiable, symmetric, bounded, and positive definite matrix, i.e. 0 < c1I  P(t)  c2I , for all t  0, which satisfies the following matrix differential equation:

P (t) = -P(t)A(t) - AT (t)P(t) - Q(t), t  0,

(2.101)

where Q(t)  c3I > 0, for all t  0, is a continuous, symmetric, and positive definite matrix; and c1, c2 and c3 are positive constants. The existence of P(t) and Q(t) follows from the persistence of excitation condition of 1(t).
Let us introduce the following Lyapunov function candidate:

W (t, e~3, ~) = W1(e~3, ~) + W2(t,  (t)).

(2.102)

It is possible to show that its derivative along the trajectories of the system (2.91)­ (2.92), for all |e~3| > 1 satisfies

W (t, e~3, ~)  -  ,

(2.103)

where  := c3 - (c2/). On the other hand, for all |e~3|  1, W satisfies W (t, e~3, ~)  -  + 2c2k¯2212.

(2.104)

Therefore, uniform stability is concluded for the error dynamics (2.91)­(2.92), and then by homogeneity, one may conclude that the error dynamics (2.91)­(2.92) is GUAS [52].

State estimation and parameter identification via sliding-modes 61

2.5.2 Finite-time algorithm

The finite-time parameter identification algorithm takes the following form [31]:

x¯3 = -k¯1

e¯3

1 2

+

e¯3

1

+

1(t)^ + fn1 (x^, y, u),

(2.105)

^ = -k¯2

1 2

e¯3

0+

3 2

e¯3

1 2

+

e¯3

1

T 1

(t),

(2.106)

where k¯1 and k¯2 are positive gains, e¯3 = x¯3 - x^3 is a state estimation error with x^3 given by the super-twisting or the fixed-time observer.
The following theorem describes the convergence properties of the finite-time algorithm.

Theorem 2.4. [31] Let the finite-time algorithm (2.105)­(2.106) be applied to the dynamics (2.79), and the regressor vector 1 be PE. Then for any k¯1, k¯2 > 0 the identification error ~ is UFTS.

Proof. The error dynamics is given by
e~3 = -k¯1~1(e¯3) + 1(t)~ + fn1 (x^, y, u) - fn1 (x, u) ~ = -k¯2~2(e¯3) 1T (t),

(2.107) (2.108)

where

~1(e¯3) :=

e¯3

1 2

+

e¯3 1,

~2(e¯3) :=

1 2

e¯3

0+

3 2

e¯3

1 2

+

e¯3

1.

(2.109) (2.110)

Using the same arguments that in the previous proof, for the homogeneous algo-
rithm, one can ensure that after a finite time x^3  x3, and thus, after a finite time e~3  e¯3 and fn1 (x^, y, u)  fn1 (x, u). Hence, the error dynamics can be rewritten as follows:

e~3 = -k¯1~1(e~3) + 1(t)~ ~ = -k¯2~2(e~3) 1T (t).

(2.111) (2.112)

Let us consider the following Lyapunov function candidate:

V (t, e~3, ~) =  T P(t) ,

(2.113)

where  T := (~1, ~T ), and with P(t) symmetric, bounded, and positive definite matrix, i.e. 0 < c1I  P(t)  c2I , for all t  0, satisfying

P (t) = -~1(e~3) P(t)A(t) + AT (t)P(t) + Q(t) ,

A(t) =

-k¯1 -k¯2 1T (t)

1(t) , 0

t  0,

(2.114) (2.115)

62 The inverted pendulum in control theory and robotics
where Q(t)  c3I > 0, for all t  0, is a symmetric and positive definite matrix. The function V is continuous and continuously differentiable everywhere in R4, except on the set S = e~3, ~  R4 | e~3 = 0 , where it is not Lipschitz continuous. The derivative of V is not well defined for the partial derivative ~1(e~3), but if ~ stays at zero just in isolated, i.e. the measure of the set S is zero, an analysis can be done. When e~3 = 0 in isolated points

~2(e~3) = ~1(e~3) ~1(e~3) ,

 = ~1(e~3) -k1~1(e~3) + 1(t) ~

-k2~2(e~3)

T 1

(t)

= ~1(e~3) A(t) .

(2.116) (2.117)

Note that this derivative is well defined. The time derivative of V along the trajectories of the system (2.111)­(2.112) is given by

V t, e~3, ~ =  T P (t) + ~1(e~3)P(t)A(t) + 1(e~3)AT (t)P(t)  ,

(2.118)

at the points where V is differentiable, i.e. for all points except those on the set {e~3 = 0}. This implies that

V t, e~3, ~

= -~1(e~3)  T Q(t)  = -

1

2

|e~3

|

1 2

+1

 T Q(t) .

(2.119)

Note

that

|e~3

|

1 2





2, with



2 2

=

|e~3|

+

2

|e~3|

3 2

+

e~32

+

~

2
2 as the Euclidean

norm of  . Thus, V may be upper bounded as follows

V t, e~3, ~

-

1 2 c3



2 + c3



2 2

,



-

c3
1

V

1 2

2c22

t, e~3, ~

- c3 V c2

t, e~3, ~

.

(2.120) (2.121)

Note that the previous expression is the derivative of V when the trajectories of system (2.111)­(2.112), i.e. (t, t0, e~3(t0), ~(t0)), are outside of the set S , and it indicates that it is negative definite in S c, the complement of S . To stay on the set S for an interval of time, it is necessary that e~3(t) = 0 and 1(t) ~(t) = 0 during that interval. From the PE condition, it follows that the condition 1(t) ~(t) = 0 cannot be satisfied during any interval t  [t, t + T0], such that the trajectories of system (2.111)­(2.112) cannot stay in the set S for a long time, in fact if the system
has sufficiently excitation, e~3(t) crosses zero and does not stay there. Following the
reasoning presented in [32], V is decreasing. It follows from Zubov's theorem [55]

State estimation and parameter identification via sliding-modes 63

that the origin is asymptotically stable. Note that V is absolutely continuous, and it is therefore the integral of its derivative [56], then

V t, (t, t0, e~3(t0), ~(t0)) - V t0, e~3(t0), ~(t0)

=

t
V

 , ( , t0, e~3(t0), ~(t0))

d



-

c3
1

t0

2c22

t

1
V2

 , ( , t0, e~3(t0), ~(t0))

d.

t0

(2.122)

The Bihari's inequality [55] implies that



2

V

t, (t, t0, e~3(t0), ~(t0))



V

1 2

t0, e~3(t0), ~(t0)

-

c3
1

(t - t0)

,

(2.123)

4c22

such that V , and also (t, t0, e~3(t0), ~(t0)), converge to zero in a finite time smaller than

1

T t0, e~3(t0), ~(t0)

=

4c22

V

1 2

c3

t0, e~3(t0), ~(t0)

.

(2.124)

This concludes the proof.

Remark 2.2. The detailed convergence proofs for the Homogeneous and finite-time algorithms can be seen in [52] and [31], respectively. In this chapter, the given proofs for Theorems 2.3 and 2.4 are only brief sketches; and the provided results are particularly given for the pendulum­cart system.

2.5.3 Experimental results
In order to depict the workability of the previous identification algorithms, some experiments have been done over the same real pendulum­cart system by INTECO. All the experiments have been implemented with the Euler's integration method and with a sampling time equal to 1 × 10-2 s.
The control input u is designed as u = 0.245 sin(3t) in order to excite the system from the initial position x = [0,  , 0, 0]T . Then, the Homogeneous and the finitetime algorithms are implemented in MATLAB Simulink. The parameters for both algorithms were chosen as the observer parameters and are given in Table 2.3.

Table 2.3 Parameters of the identification algorithm

Parameter
k¯1 k¯2 

Homogeneous alg.
20 20 0.75

Finite-time alg.
2.3 2.3 ­

64 The inverted pendulum in control theory and robotics

2

Numerical differentiation

1.5

Homogeneous algorithm

Finite-time algorithm

1

x3 [m/s]

0.5

0

-0.5

-1

-1.5 0

5

10

15

20

25

30

35

40

Time [s]

Figure 2.8 Cart velocity estimation

fc

0.6

0.5

0.4

0.3

0.2

0.1 0
-0.1 0

Real value Homogeneous algorithm Finite-time algorithm

50

100

150

200

250

300

Time [s]

Figure 2.9 Dynamic friction coefficient identification

In order to provide the state estimation x^3, the fixed-time observer was implemented as in the experimental Section 2.4.3. The results are presented in Figures 2.8­2.11. One can see that both identification algorithms provide a very good identification of the real friction coefficients.

fs

2.5 2
1.5 1
0.5 0
-0.5 -1
-1.5 -2 0

State estimation and parameter identification via sliding-modes 65

Real value Homogeneous algorithm Finite-time algorithm

50

100

150

200

250

300

Time [s]

Figure 2.10 Dry friction coefficient identification

0.1 Real value Homogeneous algorithm Finite-time algorithm
0.05

fp

0

-0.05 0

50

100

150

200

250

300

Time [s]

Figure 2.11 Rotational friction coefficient identification

In order to illustrate the performance of both observers the following index is implemented:

I= 1

t

1/2

|~( )|2d ,

T t- T

(2.125)

66 The inverted pendulum in control theory and robotics

3 Homogeneous algorithm

2.5

Finite-time algorithm

2

I

1.5

1

0.5

0

0

50

100

150

200

250

300

Time [s]

Figure 2.12 Performance index of identification

where ~ is the identification error vector and T is a time window width, which was selected as 2.
The behaviour of the performance index during the experiment is shown in Figure 2.12. It is easy to see that both algorithms provide practically the same index performance. On the other hand, as in the observer algorithms, the Homogeneous algorithm has more parameters than the finite-time algorithm and can be more difficult in its tuning.

2.6 Conclusions

The problems of state estimation and parameter identification for the pendulum­cart system have been addressed. Two HOSM observers, i.e. the super-twisting and the fixed-time, are proposed to estimate the state, in spite of disturbances; exactly and in a finite or fixed time, respectively. Based on the exact state estimation, two parameter identification algorithms, i.e. the Homogeneous and the finite-time, based on slidingmodes techniques are introduced to identify the unknown parameters of the system, i.e. the friction coefficients. The corresponding convergence proofs have been given based on Lyapunov function approach. Some experiments and comparisons have illustrated the effectiveness of the presented algorithms.

References
[1] C. Edwards and S. Spurgeon, Sliding Mode Control: Theory and Applications. London: Taylor and Francis, 1998.

State estimation and parameter identification via sliding-modes 67
[2] Y. Shtessel, C. Edwards, L. Fridman, and A. Levant, Sliding Mode Control and Observation. Intuitive theory of sliding mode control. New York, USA: Birkhauser, 2014.
[3] V. Utkin, J. Guldner, and J. Shi, Sliding Modes in Electromechanical Systems. London: Taylor and Francis, 1999.
[4] J. Slotine, J. Hedrick, and E. Misawa, `On sliding observers for nonlinear systems', Transactions of the ASME: Journal of Dynamic Systems, Measurement and Control, 1987, 109, 3, pp. 245­252.
[5] B. Walcott and S. Zak, `State observation of nonlinear uncertain dynamical systems', IEEE Transaction on Automatic Control, 1987, 32, 2, pp. 166­170.
[6] C. Edwards, S. Spurgeon, and R. Patton, `Sliding mode observers for fault detection and isolation', Automatica, 2000, 36, 4, pp. 541­553.
[7] C. Tan and C. Edwards, `Sliding mode observers for detection and reconstruction of sensor faults,' Automatica, 2002, 38, 10, pp. 1815­1821.
[8] M. Hautus, `Strong detectability and observers', Linear Algebra and Its Applications, 1983, 50, pp. 353­368.
[9] J. Barbot and T. Floquet, `Super twisting algorithm-based step-by-step sliding mode observers for nonlinear systems with unknown inputs', International Journal of Systems Science, 2007, 8, 10, pp. 803­815.
[10] F. J. Bejarano, L. Fridman, and A. Poznyak, `Unknown input and state estimation for unobservable systems', SIAM Journal on Control and Optimization, 2009, 48, 2, pp. 1155­1178.
[11] J. Davila, L. Fridman, and A. Levant, `Second-order sliding-mode observer for mechanical systems', IEEE Transactions on Automatic Control, 2005, 50, 11, pp. 1785­1789.
[12] L. Fridman, A. Levant, and J. Davila, `Observation of linear systems with unknown inputs via high-order sliding-modes', International Journal of System Science, 2007, 38, 10, pp. 773­791.
[13] L. Fridman, Y. Shtessel, C. Edwards, and X. Yan, `Higher-order sliding-mode observer for state estimation and input reconstruction in nonlinear systems', International Journal of Robust and Nonlinear Control, 2008, 18, 4­5, pp. 399­413.
[14] H. Du, C. Qian, S. Yang, and S. Li, `Recursive design of finite-time convergent observers for a class of time-varying nonlinear systems', Automatica, 2013, 49, 2, pp. 601­609.
[15] T. Menard, E. Moulay, and W. Perruquetti, `A global high-gain finite-time observer', IEEE Transactions on Automatic Control, 2010, 55, 6, pp. 1500­ 1506.
[16] W. Perruquetti, T. Floquet, and E. Moulay, `Finite-time observers: Application to secure communication', IEEE Transactions on Automatic Control, 2008, 53, 1, pp. 356­360.
[17] Y. Shen and Y. Huang, `Uniformly observable and globally Lipschitzian nonlinear systems admit global finite-time observers', IEEE Transactions on Automatic Control, 2009, 54, 11, pp. 2621­2625.

68 The inverted pendulum in control theory and robotics
[18] A. Polyakov, D. Efimov, and W. Perruquetti, `Homogeneous differentiator design using implicit Lyapunov function method', in The 2014 European Control Conference, Strasbourg, France, 2014, pp. 288­293.
[19] A. Polyakov, `Nonlinear feedback design for fixed-time stabilization of linear control systems', IEEE Transactions on Automatic Control, 2012, 57, 8, pp. 2106­2110.
[20] E. Cruz-Zavala, J. Moreno, and L. Fridman, `Uniform robust exact differentiator', IEEE Transactions on Automatic Control, 2011, 56, 11, pp. 2727­2733.
[21] M. Angulo, J. Moreno, and L. Fridman, `Robust exact uniformly convergent arbitrary order differentiator', Automatica, 2013, 49, 8, pp. 2489­2495.
[22] H. Huijberts, H. Nijmeijer, and R. Willems, `System identification in communication with chaotic systems', IEEE Transactions on Circuits and Systems ­ I: Fundamental Theory and Applications, 2000, 47, 6, pp. 800­808.
[23] Q. Zhongfang, `Distributed parameter system identification and its application to geophysical parameter identification', in The 1994 IEEE International Conference on Industrial Technology, Guangzhou, China, 1994, pp. 799­802.
[24] W. Sun, H. Li, and Q. Han, `Identification of mechanical parameters of hardcoating materials with strain-dependence', Journal of Mechanical Science and Technology, 2014, 28, 1, pp. 81­92.
[25] J. Hasenauer, S. Waldherr, K. Wagner, and F. Allgöwer, `Parameter identification, experimental design and model falsification for biological network models using semidefinite programming', IET Systems Biology, 2010, 4, 2, pp. 119­130.
[26] P. Ioannou and J. Sun, Robust Adaptive Control. Englewood Cliffs, NJ, USA: Prentice-Hall, Inc., 1996.
[27] R. Isermann and M. Munchhof, Identification of Dynamic Systems. An Introduction with Applications. Berlin: Springer-Verlag, 2011.
[28] L. Ljung, System Identification: Theory for the User. New Jersey, USA: Prentice Hall Information and System Sciences Series, 1999.
[29] T. Soderstrom and P. Stoica, System Identification. Cambridge, Great Britain: Prentice Hall International, 1989.
[30] A. Polyakov and L. Fridman, `Stability notions and Lyapunov functions for sliding mode control systems', Journal of the Franklin Institute, 2014, 351, 4, pp. 1831­1865.
[31] J. Moreno and E. Guzman, `A new recursive finite-time convergent parameter estimation algorithm', in The 18th IFAC World Congress, Milano, Italy, 2011, pp. 3439­3444.
[32] J. Moreno and M. Osorio, `Strict Lyapunov functions for the super-twisting algorithm', IEEE Transactions on Automatic Control, 2012, 57, 4, pp. 1035­ 1040.
[33] J. Davila, L. Fridman, and A. Poznyak, `Observation and identification of mechanical systems via second order sliding modes', International Journal of Control, 2006, 79, 10, pp. 1251­1262.

State estimation and parameter identification via sliding-modes 69
[34] N. M'sirdi, A. Rabhi, L. Fridman, J. Davila, and Y. Delanne, `Second order sliding mode observer for estimation of velocities, wheel sleep, radius and stiffness', in Proceedings of the 2006 American Control Conference, Minneapolis, Minnesota USA, 2006, pp. 3316­3321.
[35] V. Adetola and M. Guay, `Finite-time parameter estimation in adaptive control of nonlinear systems', IEEE Transactions on Automatic Control, 2008, 53, 3, pp. 807­811.
[36] T. Accadia, F. Acernese, P. Astone et al., `A state observer for the Virgo inverted pendulum', Review of Scientific Instruments, 2011, 82, 9, pp. 34­44.
[37] L. Canete and T. Takahashi, `Modeling, analysis and compensation of disturbances during task execution of a wheeled inverted pendulum type assistant robot using a unified controller', Advanced Robotics, 2015, 29, 22, pp. 1453­1462.
[38] M. Ramírez-Neria, H. Sira-Ramírez, R. Garrido-Moctezuma, and A. LuvianoJuárez, `Linear active disturbance rejection control of underactuated systems: The case of the Furuta pendulum', ISA Transactions, 2014, 53, 4, pp. 920­928.
[39] N. Khalid and A. Memon, `Output feedback control of a class of under-actuated nonlinear systems using extended high gain observer', Arabian Journal for Science and Engineering, 2016, 41, 9, pp. 3531­3542.
[40] J. Lee, R. Mukherjeea, and H. Khalil, `Output feedback stabilization of inverted pendulum on a cart in the presence of uncertainties', Automatica, 2015, 54, pp. 146­157.
[41] J. Huang, S. Ri, L. Liu, Y. Wang, J. Kim, and G. Pak, `Nonlinear disturbance observer-based dynamic surface control of mobile wheeled inverted pendulum', IEEE Transactions on Control Systems Technology, 2015, 2014, 6, p. 2400­2407.
[42] S. Ri, J. Huang, Y. Wang, M. Kim, and S. An, `Terminal sliding mode control of mobile wheeled inverted pendulum system with nonlinear disturbance observer', Mathematical Problems in Engineering, 2014, 2014, pp. 1­8.
[43] A. Roffel and S. Narasimhan, `Extended Kalman filter for modal identification of structures equipped with a pendulum tuned mass damper', Journal of Sound and Vibration, 2014, 333, 23, pp. 6038­6056.
[44] O. Garcia-Alarcon, S. Puga-Guzman, and J. Moreno-Valenzuela, `On parameter identification of the Furuta pendulum', Procedia Engineering, 2012, 35, pp. 77­84.
[45] G. Ronquillo-Lomeli, G. Ríos-Moreno, A. Gómez-Espinosa, L. MoralesHernández, and M. Trejo-Perea, `Nonlinear identification of inverted pendulum system using Volterra polynomials', Mechanics Based Design of Structures and Machines, 2016, 44, pp. 5­15.
[46] Y. Liang and B. Feeny, `Parametric identification of a base-excited single pendulum', Nonlinear Dynamics, 2006, 46, 1, pp. 17­29.
[47] Y. Liang and B. Feeny, `Parametric identification of a chaotic baseexcited double pendulum experiment', Nonlinear Dynamics, 2008, 52, 1, pp. 181­197.
[48] INTECO, Pendulum-Cart System. User's Manual, U.S.A.: INTECO, 2012.

70 The inverted pendulum in control theory and robotics
[49] A. Filippov, Differential Equations with Discontinuous Right-hand Sides. Dordrecht, The Netherlands: Kluwer Academic Publishers, 1988.
[50] H. Khalil, Nonlinear Systems. New Jersey, USA: Prentice-Hall, 2002. [51] W. Haddad, S. Nersesov, and L. Du, `Finite-time stability for time-varying
nonlinear dynamical systems', in The 2008 American Control Conference, Seattle, USA, 2008, pp. 4135­4139. [52] H. Ríos, D. Efimov, L. Fridman, J. Moreno, and W. Perruquetti, `Homogeneity based uniform stability analysis for time-varying systems', IEEE Transactions on Automatic Control, 2016, 61, 3, pp. 725­734. [53] K. Narendra and A. Annaswamy, Stable Adaptive Systems. Mineola, NY, USA: Dover Publications, 2005. [54] H. Ríos, D. Efimov, A. Polyakov, and W. Perruquetti, `Homogeneous timevarying systems: Robustness analysis', IEEE Transactions on Automatic Control, 2016. DOI:10.1109/TAC.2016.2540806. [55] A. Poznyak, Advanced Mathematical Tools for Control Engineers: Volume 1: Deterministic Techniques. Amsterdam-Boston: Elsevier Science, 2008. [56] V. I. Bogachev, Measure Theory, Vol. 1. Berlin: Springer-Verlag, 2007.

Chapter 3
Higher order sliding-mode stabilization of inverted cart­pendulum
Jesus Mendoza-Avila1 and Ismael Castillo1
Abstract
Stabilization of a cart­pendulum system through a generalized higher order surfacecontroller design is presented. The singular Linear Quadratic (LQ) method presents a natural relationship between order of singularity of a given performance index and the order of sliding-mode controller. Thus, several arbitrary relative degree optimal sliding surfaces and its corresponding higher order sliding-mode controller can be specified for a given system.
Continuous higher order sliding-mode controllers are obtained through a robustification method for arbitrary relative degree nominal controllers based on integral sliding modes and supertwisting algorithm.
An agreement between the accuracy/complexity of the Continuous Higher Order Sliding Mode (CHOSM) controller and the limited accuracy offered by the system's sensors and actuators is obtained through several experiments.
3.1 Introduction
Sliding-mode control (SMC) is one of the main approaches to stabilize uncertain nonlinear systems. One of the main features of SMC is the exact compensation of matched disturbances and the finite-time convergence of the system trajectories to the sliding surface [1].
The conventional sliding-mode design consists of two steps [1­3]: 1. Design of a sliding variable. 2. Sliding-mode control design to enforce the finite-time convergence of system
trajectories to the sliding surface. One advantage of designing a sliding surface, in the first step, is the reduction of the system dynamics to the sliding dynamics. This should exhibit a desired behavior [2]
1Departamento de Ingeniería de Control y Robótica, Universidad Nacional Autónoma De México, Mexico

72 The inverted pendulum in control theory and robotics
and, recently, a desired order of the reduced system specified by the optimization of a singular performance index [4].
On the other hand, for the second step, higher order sliding modes (HOSM) controllers have been developed [5,6] in order to ensure the finite-time convergence of the system state to a sliding surface of relative degree higher than one (closely related with a higher order of the sliding mode which is indeed the codimension of the sliding surface).
There are some advantages in the realization of HOSM, for example, when the controller's order is equal to the system's relative degree, the design of the sliding variable is not necessary and the controller can drive the system's states to zero in finite time. Furthermore, HOSM controllers provide the ultimate accuracy and can reduce the chattering by means of continuous control signal. Nevertheless, the complexity and computational resources grow exponentially as the order of the HOSM controller. Also, when a sliding variable is designed, there is no theoretical methodology to find the precision on the system's states in spite of the controller order.
In the present chapter, several sliding variables with different relative degrees and its corresponding HOSM controllers are to be tested in order to find a fair compromise between the order reduction and order complexity. Accuracy analysis is presented to show the performance of each case.

3.2 Singular LQ sliding variable design

In [4,7], an extended method to design higher order sliding variables based in optimal singular LQ stabilization [2] is presented.
Consider the system

x(t) = Ax(t) + Bu(t),

x(0) = x0, x0  L, L  R+

(3.1)

where A  Rn×n is the system state matrix, B  Rn is the input matrix, x(t)  Rn is the state vector, u(t)  R is the control input. The initial conditions of the system must be in the set defined by L. Pair (A,B) is supposed controllable.
Besides, consider the cost function singular with respect to the control

J=1


xT (t)Qx(t)dt

2 t1

(3.2)

where Q  Rn×n is symmetric and positive semidefinite.

The design algorithm presented in [4] consist of the following steps:

1. Transformation of the system (3.1) to a controllable canonical form, by means of a nonsingular transformation T, such that the transformed system is

z(t) = A¯ z(t) + B¯ u(t),

(3.3)

where z = Tx, A¯ = TAT -1, B¯ = TB, and A¯  Rn×n, B¯  Rn×1.

Higher order sliding-mode stabilization of inverted cart­pendulum 73

The matrices A¯ and B¯ have the Brunovsky form:

 01

 0 ··· 0

 0

A¯ = 

0 ...
0

0 ...
0

1 ...
0

··· ...
···

0 ...
1



,

B¯

=



0 ...
0

 ,

(3.4)

-an -an-1 -an-2 . . . a1

1

where an, . . . , a1 are the coefficients of the characteristic polynomial of (3.1). The weighing matrix Q in the function (3.2) needs to be transformed to keep
its original meaning for the transformed system

Q¯ = (T -1)T QT -1

(3.5)

2. Singularity order of the performance index is defined by means of an analysis of the weighing matrix Q¯ where the scalar Q¯ 22 is looked for. In higher order case, the matrix Q¯ can only have the form

 Q¯ 11 Q¯ 12 0 · · · 0 

Q¯

=



Q¯ 21 0 ...

Q¯ 22 0 ...

0 0 ...

··· ··· ...

0 0 ...



,

(3.6)

0 0 0 ··· 0

where Q¯ 11  Rn-k-1×n-k-1 is symmetric positive semidefinite matrix, Q~ 22 > 0 and Q~ 22  R.
The singularity order is the number i = k + 1, where k is the number of zero columns of the weighing matrix Q¯ such that Q~ 22 > 0, Q~ 22  R.
3. Perform partitions to the system (3.3) according to (3.6). The state vector z is partitioned in three subsets z = [z¯1T z¯2T z¯3T ]T , where z¯1 is the sliding mode reduced dynamics, z¯2 is a virtual control and z¯3 the rest of the variables states.

z¯1 = [z1 . . . zn-i]T , z¯2 = zn-i+1, z¯3 = [zn-i+2 . . . zn]T .

(3.7)

The obtained partitioned system has the form

 z¯1   A¯ 11  z¯2  =  A¯ 21

A¯ 12 A¯ 22

A¯ 13 A¯ 23

 

 

z¯1 z¯2

 

+

 

B¯ 1 B¯ 2

 

u.

z¯3

A¯ 31 A¯ 32 A¯ 33

z¯3

B¯ 3

(3.8)

Note that subsystem z¯1 is z¯1 = A¯ 11z¯1 + A¯ 12z¯2,

(3.9)

74 The inverted pendulum in control theory and robotics

where A¯ 11 has the same dimension as Q¯ 11, A¯ 12 is a column matrix with the same rows as Q¯ 11, and the partitions A¯ 11 and A¯ 12 have the Brunovsky form:





0 1 0 ··· 0

 0

A¯ 11

=



0
0 ...

0
0 ...

1
0 ...

··· ··· ...

0 0
1



,

A¯ 12

=



0
0 ...



.

(3.10)

0 0 0 ··· 0

1

4. Design the sliding variable by means of the design of an optimal stabilizing con-

trol for the subsystem z¯1 solving an optimal control problem with the performance index

J¯ = 1 2


(z¯1T (t)Q^ z¯1(t) + vT (t)R^ (t))dt,
t0

(3.11)

where the variable

(t) = z¯2(t) + Q¯ 2-21Q¯ 1T2z¯1(t),

(3.12)

eliminate crossterms of z¯1(t) and z¯2(t) due to the partitions in the system (3.3) and the weighing matrix Q¯ . Q^ = Q¯ 11 - Q¯ 12Q¯ 2-21Q¯ 1T2 is the state weighing matrix for the subsystem z¯1 and R^ = Q¯ 22 is the control weighing matrix. Due to the change variable (3.12), the subsystem (3.9) is

z¯1 = A^ z¯1 + B^ v,

(3.13)

where A^ = A¯ 11 - A¯ 12Q¯ 2-21Q¯ 1T2  R(n-i)×(n-i),

B^ = A¯ 12

 Rn-i.

(3.14)

This standard problem is solved though

A^ T P + PA^ - PB^ R^ -1B^ T P + Q^ = 0,

(3.15)

where P is the only positive definite solution of (3.15) if the pair (A^ , D¯ ) is observable with D¯ a matrix such that D¯ T D¯ = Q^ .
A stabilizing optimal virtual control law with respect to (3.11) for the subsystem
(3.13) is given by

z¯2 = -K z¯1,
= -(R^ )-1(B^ T P + Q¯ 1T2)z¯1, = -(Q¯ 22)-1(A¯ T12P + Q¯ 1T2)z¯1.

(3.16)

Then, the sliding variable with relative degree r  1 can be designed as

 = z¯2 + (Q¯ 22)-1(A¯ T12P + Q¯ 1T2)z¯1.

(3.17)

Note that the sliding variable's relative degree is equal to the performance index singularity order.

Higher order sliding-mode stabilization of inverted cart­pendulum 75

There exists aToolbox for MATLAB® presented in [4] which permit to automatize the sliding variable design method described early.

3.2.1 MATLAB® function: SSLQ
[T , Ss, Qc, Ueqn, Algorithm] = SSLQ(A, B, Qb, AlphaGain) Arguments

(3.18)

 A--System matrix of the original linear time invariant system.
 B--Input matrix of the original linear time invariant system.  Qb--Is the transformed weighing matrix Q¯ . For simplicity in the practice is better
manipulate and adjust matrix Q¯ directly in order to manage the order of singularity,
and therefore, the relative degree of the designed sliding variable.
 AlphaGain--Is the gain of the quasicontinuous controller. This must satisfy AlphaGain > F, where | f |  F.

Outputs

 T--Nonsingular transformation matrix to a controllable canonical form, z = Tx.  Ss--Matrix of order (i - 1) × n, containing sliding surface and its i - 1 time
derivatives. The sliding variable and its time derivatives are expressed as

[  · · ·  (i-1)]T = Ssz.

(3.19)

 Qc--String variable containing the quasicontinuous algorithm of order i.  Uneq--Matrix of order (1 × n) containing the linear terms of nominal equivalent
control.

uneq = Uneqz

(3.20)

 Algorithm--String variable which contains all the algorithm in .m code.

3.3 Continuous higher order sliding-mode controllers

The main idea of HOSM is to design an arbitrary order-sliding variable and keep it in zero by means of properly chosen HOSM controller. There exist some HOSM controllers that ensure the convergence to zero of a sliding variable. For example, the sliding variables of relative degree one can be driven to zero by

 Supertwisting algorithm (STA) [8]

u

=

-k1

|

|

1 2

sign(

)

+

w,

w = -k2sign( ),

(3.21)

where k1 and k2 are the controller's gains and can be designed as is described in [9].

and the sliding variables of relative degree two by

76 The inverted pendulum in control theory and robotics

 Integral discontinuous control (IDC) [10]

u

=

-k1

|

|

1 3

sign(

)

-

k2

|

|

1 2

sign(

)

+

z,

z = -k3sign( ),

(3.22)

where k1, k2 and k3 are the controller's gains and must be properly selected to achieve the control aim.

The algorithms STA and IDC presented above can compensate Lipschitz disturbances |(x, t) | < C; furthermore, these algorithms generate a continuous signal control reducing the chattering effect.
There exist some controllers for sliding variables of relative degree greater than two but in the most of cases those controllers produce discontinuous control signals. However, there exist the so-called integral sliding-mode control (ISMC) which is possible inherit the properties of exact compensation of Lipschitz perturbations to any continuous arbitrary order controller.

3.3.1 Integral sliding-mode control
A way to design a robust control is designing a controller which stabilize the nominal system, later applying a robustify method such that the final controller can stabilize the system with the same nominal convergence features but in presences of disturbances [11].
The sliding-mode-based auxiliary controller that compensates the disturbance from the beginning of the control action, while retaining the order of uncompensated system, is named integral sliding mode (ISM) controller [12,13].
Using ISMC, it is possible to inherit the SMC's properties of exact compensation of disturbances to an arbitrary order nominal controller respecting its convergence features.

3.3.2 Continuous integral sliding-mode control

In [14], a robustification method for arbitrary order controllers via STA is proposed. The main advantage of this method is that the robustified control signal is continuous which reduce significantly the chattering effect.
Considering an arbitrary order dynamic system

xi = xi+1 i = 1, 2, . . . , n - 1 xn = f (x) + g(x)(u + (t)),

(3.23)

where x = [x1, x2, . . . , xn]T is the state vector, u  R is the control input, f (x) and g(x) are smooth state functions representing the nominal and known dynamics. In addition, 0 < km  g(x)  kM , (t) is a Lipschitz function which represents the matched disturbances acting on the system.
If for a nominal system ((t) = 0) there exists a controller u = u0(x) such that the close loop system origin is stable, then it is possible to design a sliding variable
and a controller, such that a disturbed system have a robust behavior with respect

Higher order sliding-mode stabilization of inverted cart­pendulum 77

to Lipschitz disturbances, keeping all stability features of the nominal close loop system [14].
Defining the virtual sliding variable

t
(x(t), u0(x(t))) = xn(t) - (f (x( )) + g(x( ))u0(x( )))d
0

(3.24)

where x(t) are the system's trajectories. When  (x(t), u0(x(t))) = 0, the system trajectories behave with nominal dynamics, even in presence of disturbances.
To ensure the finite-time convergence to zero of (3.24), a possible control law is

u = u0 + v

(3.25)

where v is an additional control input. The sliding variable dynamics are given by

 = g(x)(v + (t)).

(3.26)

Note that siding variable has relative degree one, and STA can be implemented to enforce the system trajectories to zero in finite-time.
Finally, the control law is given by

u = u0 + v

v

=

-k1r

||

1 2

sign()

+

w

w = -k2rsign()
t
 = xn(t) - ( f (x( )) + g(x( ))u0(x( )))d
0

(3.27)

and stability of the system (3.23) is guaranteed even in presence of Lipschitz matched disturbances. Stability proof of controller (3.27) is presented in [14].

3.3.3 Arbitrary order controllers design
Some controller that can be used as nominal control in (3.27) are

 Exponential convergence controller: The LQR control is designed given the weighing matrices of the states Q and of input R then

u(t) = -Kx(t),

(3.28)

where K is the gain matrix given by K = R-1BT X , where X is the unique positive semidefinite solution of the algebraic Riccati equation

AT X + XA - XBR-1BT X + Q = 0

(3.29)

such

that

the

performance

index

J

=

1 2

 t0

(xT (t)Qx(t)

+

uT (t)Ru(t))dt

is

mini-

mized [15].

78 The inverted pendulum in control theory and robotics

DC motor

Control force

Belt

Rail Pendulum
Figure 3.1 The cart­pendulum setup

 Finite-time convergence controller: Considering the Hong's controller of orders r  4 as

u1 = -k1||1|0.9sign(1)|sign(|1|0.9sign(1)) u2 = -k2||2|1.11sign(2) - u1|1.25sign(|2|1.11sign(2) - u1) u3 = -k3||3|1.37sign(3) - u2|1.57sign(|3|1.37sign(3) - u2) u4 = -k4||4|1.71sign(4) - u3|2sign(|4|1.71sign(4) - u3)

(3.30) (3.31) (3.32) (3.33)

where  is the sliding variable, k1, k2, k3 and k4 are the controller's gain which must be properly adjusted to achieve the control aim [16].

3.4 Cart­pendulum system
The cart­pendulum consists of a pole mounted on a cart in such a way that the pole can swing freely only on the vertical plane. The cart is driven by a DC flat motor through a belt. In order to swing and to balance the pole, the cart moves back and forward on a rail of 2 m of length (see, Figure 3.1) [17].
The cart­pendulum system can show some nontrivial and complex problems of the control theory as
 subactuated fourth-order system,  nonlinear system,  four state variables and one control variable,  infinite number of equilibrium points,  unstable equilibrium points,  the control input is bounded,  the cart position is bounded by the rail length [17].
Generally, the cart­pendulum control problem is to bring the pole, as fast as possible, to one of the unstable equilibrium points and keep it there despite of disturbances [17]. In order to design a control law for the cart­pendulum, its mathematical model is needed.

Higher order sliding-mode stabilization of inverted cart­pendulum 79
x2

mg x1
l Rail center

Mass center F

Figure 3.2 Cart­pendulum system

3.4.1 Mathematical model
The dynamic equations which can describe the behavior of the cart­pendulum system are given by four first-order ordinary differential equations.

3.4.1.1 Nonlinear model The nonlinear mathematical model of the cart­pendulum considering the diagram depicted in Figure 3.2, is given by [17]

x1 = x3

x2 = x4

x3

=

a1w1(x,u) + w2(x) cos (x2) d(x)

x4

=

w1(x,u) cos (x2) + a2w2(x) d(x)

(3.34)

where the state vector x = x1 x2 x3 x4 T represents: x1 cart position (m), x2 pendulum angular position (rad), x3 cart velocity (m/s) and x4 pendulum angular velocity (rad/s),

w1(x, u) = k1(u + 1) + x42sin(x2) - k2x3, w2(x, u) = -gsin(x2) - k3(x4 + 2),
d(x) = b - cos2(x2),

(3.35) (3.36) (3.37)

u is the control input (N), 1, 2 represent the external matched and unmatched disturbances (N), respectively.
The system's parameters

a1=

Jp ml

,

a2=

1 l

,

b

=

a1

a2

=

Jp ml2

,

k1 =

p1 ml

,

k2 =

fc -p2 ml

,

k3=

fp ml

,

given by the user's manual [17], are given in Table 3.1.

(3.38)

80 The inverted pendulum in control theory and robotics Table 3.1 Table of original system parameters

Symbol Description

Value

m

Equivalent mass of cart and pendulum

0.872 (kg)

l

Distance from axis of rotation to center of mass of system 0.011 (m)

fc

Dynamic cart friction coefficient

0.5 (N s/m)

fs

Cart static friction

1.203 (N)

fp

Rotational friction coefficient

6.5·10-5 (N m s/rad)

Jp

Pendulum inertial moment with respect to rotation axis 0.00292 (kg m2)

g

Gravity acceleration

9.81 (m/s2)

p1

Control-force-to-PWM-signal ratio

p2

Control-force-to-cart-velocity ratio

umax

Maximum value of PWM signal

mc

Equivalent cart mass

9.4 (N) -0.548 (N s/m) 0.5 0.768 (kg)

mps

Pole mass

mpw

Load mass

Rl

Rail length

lp

Pole length

0.038 (kg) 0.014 (kg) 1.8 (m) 0.5 (m)

lpo

Distance between pole mass center and axis rotation

0.107 (m)

lc

Load length

0.03 (m)

lpw

Distance between load mass center and axis rotation

0.354 (m)

T

Pendulum period

1.17 (s)

J

Inertial moment related to the mass center

0.00282 (kg m2)

Rail center
Figure 3.3 Cart­pendulum interesting equilibrium point

3.4.1.2 Equilibrium points
Considering u = 0,  = 0 and making (3.34) equal to zero the equilibrium points of the cart­pendulum are obtained. There exists many solutions for the equations system, however, the equilibrium point of interest is x0 = 0 0 0 0 T .
This interesting point represents the upper pendulum position and the cart position at the middle rail as shown in Figure 3.3. The instability of the point x0 is intuited.

3.4.1.3 Stability analysis

In order to prove the instability of x0 the Chetaev's instability theorem is applied. For the system (3.34) with x0 as an equilibrium point consider the function

V (x) = x12 + x22 + x32 + x42 > 0,

(3.39)

Higher order sliding-mode stabilization of inverted cart­pendulum 81

and V (0) = 0. The derivative of (3.39) along the trajectories of the system (3.34) is

V (x) = dV x, dx



x3



=

[2x1, 2x2, 2x3, 2x4] 

x4
0.304w1(x,u)+w2(x) cos (x2)

 ,

d(x)

w1(x,u) cos (x2)+90.91w2(x)

d(x)

=

2x1x3

+ 2x2x4

+

2x3

0.304w1

(x,

u) + w2 d(x)

(x)

cos

(x2

)

(3.40)

+

2x4

w1(x,

u)

cos

(x2) + d(x)

90.91w2(x)

.

If the trajectories of (3.34) are in Br = {x  Rn | x  r} where r = 0.01 and defining the set U = {x1, x3 > 0, x2, x4 < 0, x  Br | V (x) > 0}. In U , (3.40) is
positive definite, thus X01 is an unstable equilibrium point.

3.4.2 Linear model

The linear model of the system (3.34) can be obtained by Taylor series approximation

[11,18] as

0 0 1 0 

0

A = df dx

(x0 ,u=0)

=



0 0

0
g 1-b

0
a1 k2 1-b

1
k3 1-b

 ,

0

a2 g 1-b

k2 1-b

k3 1-b

B=

df du

(x0 ,u=0)

= 

0
a1 k1 b-1

 ,

(3.41)

k1 b-1

then, the linear approximation of (3.34) is given by

0 0 1 0   0 

x

=



0 0

0
g 1-b

0
a1 k2 1-b

1
k3 1-b

 x

+



0
a1 k1 b-1

 u.

0

a2 g 1-b

k2 1-b

k3 1-b

k1 b-1

(3.42)

The output system is given by

y = Cx =

1 0

0 1

0 0

0 0

x,

(3.43)

due to the measurable states are x1 and x2.

3.4.2.1 Controllability and observability analysis The controllability matrix for the system (3.42) is
C = [B | AB | A2B | A3B],

(3.44)

82 The inverted pendulum in control theory and robotics

substituting the values in Table 3.1

 0

11.18

-14

C

=



0 11.18

36.74 -13.95

-45.8 3.9

36.74 -45.82 -1171.1

3.9 

-1171.1 12.3



1516.2

(3.45)

and its determinant is det(C) = -175,320,000 = 0 then the matrix (3.45) has complete rank thus the system (3.42) is completely controllable.
The observability matrix for the system (3.42) is

O = [C | A C | A 2C | A 3C ],

(3.46)

substituting the values in Table 3.1



1

0

0

O

=



0 0 0 0 0 0

1 0 0 -0.3678 -33.4333 0.4686

0 1 0 -1.2469 -4.0959 1.5560

0 1.5165 5.1084

 0

0 0 1 -0.0003 -0.0003 -0.3674

 .

-33.43216

(3.47)

and its determinant is det(C) = -1357.1 = 0 then the matrix (3.47) has complete rank thus the system (3.42) is completely observable. As the system, (3.42) is controllable and observable is possible to design a control law to locally stabilize the equilibrium point x0.

3.4.2.2 Controllable canonical form

The linear system (3.42) is transformed to the controllable canonical form by means

of

the

transfor0m.0a0t2io8n

x¯ = Tx where -0.0008

0

0

T = 

0 0

0 0.0272

0.0028 0

-0.0008 0



.

(3.48)

0

0

0

0.0272

Applying the transformation A¯ = TAT -1, B¯ = TB, C¯ = CT -1, the system (3.42)

in controllable canonical form is

0

1

0

x¯ = 00

0 0

1 0

0 -40.1813 -33.4325

 

0

0

0 1

 x¯ + 00 u

-1.2472

1

(3.49)

y = [0.4045 -0.0066 47.9224 0] x¯

(3.50)

The system (3.49) is important in the SMC design.

Higher order sliding-mode stabilization of inverted cart­pendulum 83
3.5 Continuous higher order sliding-mode controllers: cart­pendulum system realization

The steps to implement control schemes based on HOSM consist first in the design of the sliding variable and later choose an appropriate HOSM controller to ensure the convergence to the origin.
For the design of sliding variables for the system (3.34), the function (3.18) is used. An interesting output is given by Ss  Rr×n which contain the gain vector of the sliding variable given by









 ...

 = Ssx¯.

 (r-1)

(3.51)

The arguments of the function (3.18) are given by the matrices A and B of the system (3.42), the weighting matrix Qb = Q¯ from Table 3.2 and AphaGain = 1.
After the sliding variable design, corresponding order HOSM controller is
selected and tuned for the experimental results.

Table 3.2 Sliding surfaces designed by SSLQ function

Relative degree 1 2 2 3

Qb





560,000 0 138,680 0



0 138,680

100 0

0 34,609

0 0



0

 544,000



0 131,750

0

0

0 131,750 10 0 34,000

14

 0

0 0



0000





5,299,200 0 1,093,650 0



0 1,093,650

1 0

0 230,000

0 0



0

0

0

0





49 0 0 0



0 0

9 0

0 0

0 0



0 000

Ss 200 14 50 1

4 0.7 1 0 0 4 0.7 1

4.8 0.5 1 0 0 4.8 0.5 1





2.333 1

00

 0 2.333 1 0 

0

0 2.333 1

84 The inverted pendulum in control theory and robotics

x

10 5

xxxx4213

0

-5

-10 4



0

u

-4 1
0.5 0
-0.5 -1 0

5

10

15

20

25

30

Time (s)

Figure 3.4 Supertwisting algorithm and sliding surface of relative degree one on cart­pendulum system

The experiments are implemented in a cart­pendulum plant developed by INTECO [17]. The control law is programmed in MATLAB with Simulink® and the RTWT (real-time windows target) MathWorks Toolbox is included. Through a data acquisition card RTDAC4/PCI, the communication between the plant and a computer is achieved. The control signal is computed by the PC and sent to the DC flat motor as a PWM signal.
In the experiments, the pendulum is driven near to x0 by means of a swingup algorithm which is taken from the test examples of the INTECO cart­pendulum system [17]. When the pendulum angular position is in a region less than 0.2 (rad), i.e., ||x2|| < 0.2, the control signal switch to a HOSM controller which stabilize the origin of the system. The initial conditions are different to zero for all states and the sample time is 1 ms. When the system is stable in steady state, two perturbations are exercised: the first one, is a matched perturbation at second 10 of the experiment which consist of applied force to the cart; the second one is an unmatched perturbation (perturbation in subactuated dynamics) at second 20 which consist of hit the pendulum. For the robustified controllers implemented in this work the robustification gains are k1r = 5 and k2r = 5.

Higher order sliding-mode stabilization of inverted cart­pendulum 85

x

10

x1 x2

5

xx34

0

-5

0.3





0.2

0.1

0

-0.1 1



u

0

-1

0

5

10

15

20

25

30

Time (s)

Figure 3.5 Integral discontinuous control and sliding surface of relative degree two on cart­pendulum system

10 5

xxxx2314

0

x

-5

-10

0.5







0

u

-0.5 1
0.5 0
-0.5 -1 0

5

10

15

20

25

30

Time (s)

Figure 3.6 Robustified Second-Order Hong Controller and sliding surface of relative degree two on cart­pendulum system

86 The inverted pendulum in control theory and robotics

x

10

x1

x2

5

xx43

0

-5

-10



1



¨

0



-1

u

1 0.5
0 -0.5
-1 0

5

10

15

20

25

30

Time (s)

Figure 3.7 Robustified Third-Order Hong Controller and sliding surface of relative degree three on cart­pendulum system

3.5.1 Relative degree one SMC
A sliding variable of relative degree one designed for the system (3.34) is given by 1 = [200 14 50 1]x~ (see Table 3.2). To drive the system trajectories to the sliding surface in finite-time, the Supertwisting algorithm (3.21) is used with gains k1 = 20 and k2 = 13. The experimental results are shown in Figure 3.4.
3.5.2 Relative degree two SMC
A sliding variable of relative degree two designed for the system (3.34) is given by 2 = [4 0.7 1 0]x~ (see Table 3.2). The system trajectories can be carried to the sliding surface in finite-time by Integral Discontinuous Control (3.22) with gains k1 = 26, k2 = 25 and k3 = 10. The experimental results are shown in Figure 3.5.
Another controller which can drive to zero sliding variables of relative degree two in finite-time is the Robustified second-order Hong's controller (3.31). In this case, the sliding variable is given by 2 = [4.8 0.5 1 0]x~ (see Table 3.2) and the controller gains are k1 = 4.3, k2 = 120. The experimental results are shown in Figure 3.6.

Higher order sliding-mode stabilization of inverted cart­pendulum 87

10

xxx321

5

x4

x

0

-5

-10 1

0.5

u

0

-0.5

-1

0

5

10

15

20

25

30

Time (s)

Figure 3.8 Robustified Fourth-Order Hong Controller on cart­pendulum system

3.5.3 Relative degree three SMC
A sliding variable of relative degree three designed for the system (3.34) is given by 3 = [2.333 1 0 0] x~ (see Table 3.2). In order to drive the sliding variable to zero in finite-time the Robustified Third-Order Hong Controller (3.32) is used with gains k1 = 1, k2 = 1.6, k3 = 70. The experimental results are shown in Figure 3.7.
3.5.4 Relative degree four SMC
To stabilize the origin of the system (3.34) in finite time the Robustified Fourth-Order Hong Controller (3.33) is used with gains k1 = 0.8, k2 = 0.9, k3 = 2, k4 = 140. The experimental results are shown in Figure 3.8.
Another choice to stabilize the trajectories of the system in the unstable equilibrium point x0 is the Robustified LQR controller (3.28) with gains K = [7.2 42 8.4 7.2]. Note that this algorithm gives exponential convergence to the trajectories of the system but with insensitivity with respect to the matched perturbations. The experimental results are shown in Figure 3.9.

88 The inverted pendulum in control theory and robotics

10

x1 x2

x3

5

x4

x

0

-5

-10

1

0.5 0

u

-0.5

-1

0

5

10

15

20

25

30

Time (s)

Figure 3.9 Robustified LQR Controller on cart­pendulum system

3.6 Results

The experiments show that HOSM controllers can stabilize the unstable equilibrium point of the system in finite-time (except LQR). Moreover, the controllers provide insensibility to Lipschitz continuous matched disturbances. A quantitative analysis is made to determinate that which controller has the best performance with respect to the accuracy of the sliding variables and states [8].

3.6.1 Accuracy analysis

An accuracy analysis of realized controllers can be done as [8] proposed, let l = [r] be the maximum integer not exceeding r. If the lth derivative  (t, x(t, )) is uniformly bounded in , for the steady-state part of x(t, ), then there exist positive constant C1, C2, . . . , CL-1, such that for the steady-state process the following inequalities hold

|  | C0 l, |  | C1 l-1, | ¨ | C2 l-2, . . . , |  l-1 | Cl-1.

(3.52)

In Table 3.3, it can be seen the accuracy, both in the sliding surface and in the states, obtained in the experiments realized, the accuracy is measured as the maximum value when the system is steady state stable.

Higher order sliding-mode stabilization of inverted cart­pendulum 89
Table 3.3 Accuracy of controllers to stabilize the cart­pendulum with sample time 1 ms

Controller

| |

| |

|¨ |

|x1|

|x2|

|x3|

|x4|

Super

15 · 10-3 *

*

0.02 0.025 0.25 0.5

twisting

Algorithm

Integral

440 · 10-6 7 · 10-3 *

0.015 0.022 0.08 0.33

Discontinuous

Control Robustified

300 · 10-6 5 · 10-3 *

0.043 0.033 0.12 0.27

Second-Order

Hong Controller

Robustified

1.5 · 10-3 3 · 10-3 28 · 10-3 0.018 0.018 0.085 0.3

Third-Order

Hong Controller

Robustified

*

*

*

0.015 0.024 0.07 0.28

Fourth-Order

Hong Controller

Robustified

*

*

*

0.021 0.011 0.085 0.35

LQR

Ideal behavior

Accuracy

440e-6

300e-6

Real behavior
1.5e-3

15e-3

STA

CID

H2R

H3R

Figure 3.10 Sliding surface accuracy in the experiments

In theory, the accuracy of the sliding surface increases according to the order of the controller. In physical realization, it does not happen. In Figure 3.10, the difference between ideal behavior and real behavior is shown.
In Figure 3.10, it can be seen that in the experiments STA have less accuracy than IDC and robustified second-order Hong controller, but this behavior is no preserve

90 The inverted pendulum in control theory and robotics

Accuracy

0.5

STA

0.4

IDC

2-Hong
0.3
3-Hong

0.2

4-Hong

LQR

0.1

0

×1

×2

×3

×4

System states

Figure 3.11 System states accuracy in the experiments

in higher order controllers due to the uncertainties in actuators and sensors of the system. However, the accuracy in the system states is similar in all the experiments, as Figure 3.11 shows.
3.7 Conclusions
In this chapter, the generalized higher order two-step sliding-mode methodology to stabilize a cart­pendulum system is implemented. The realization of several Sliding-Mode variables and controllers allows to find a fair compromise between the precision-performance and complexity of the controller that theory is not able to predict.
The sliding variable design is systematically implemented due to the usage of a MATLAB Toolbox for singular LQ design, while HOSM controllers are built by means of a robustification method which allows to inherit the exact compensation of Lipschitz matched perturbations to any arbitrary order nominal controller.
After several experiments, the accuracy analysis shows that the best performance is achieved in a case of order of singularity between the extreme cases, i.e., for this fourth-order system, the best performance is achieved in case of order two.
Moreover, it is shown that HOSM technique is a good option to stabilize uncertain nonlinear systems like the cart­pendulum. The exact compensation of matched disturbances can be appreciated in each experiment.
References
[1] Y. Shtessel, C. Edwards, L. Fridman, and A. Levant. Sliding Mode Control and Observation. Series: Control Engineering. Brikhauser: Basel, 2013.
[2] V. I. Utkin, Sliding Modes in Control and Optimization, Vol. 116. Berlin: Springer-Verlag Berlin, 1992.

Higher order sliding-mode stabilization of inverted cart­pendulum 91
[3] C. Edwards and S. K. Spurgeon, Sliding Mode Control: Theory and Applications. Padstow, UK: CRC, 1998.
[4] I. Castillo and L. Fridman. `Matlab toolbox for singular lq based sliding mode control design', In Decision and Control (CDC), 2013 IEEE 52nd Annual Conference on, IEEE, 2013, pp 4242­4247.
[5] L. Fridman and A. Levant. Higher Order Sliding Modes in Sliding Mode Control in Engineering. J.P. Barbot, W. Perriguetti (Eds.), New York: Marcel Dekker, 2002.
[6] A. Levant. `Higher-order sliding modes, differentiation and output­feedback control', International Journal of Control, 2003, 76, pp. 924­941.
[7] I. Castillo, F. Castaños, and L. Fridman. `Sliding surface design for higherorder sliding modes', Recent Trends in Sliding Mode Control, 2016, 102, p. 29.
[8] A. Levant. `Sliding order and sliding accuracy in sliding mode control', International Journal of Control, 1993, 58, 6, pp. 1247­1263.
[9] J. A. Moreno and M. Osorio. `Strict lyapunov functions for the supertwisting algorithm', IEEE Transactions on Automatic Control, 2012, 57, 4, pp. 1035­1040.
[10] C. A. Zamora, J. A. Moreno, and S. Kamal. "Control integral discontinuo para sistemas mecánicos," in 2013 Congreso Nacional de Control Automático (CNCA AMCA). Ensenada, Baja California, Mexico: Asociación de México de Control Automático (AMCA), Oct. 2013, pp. 11­16. [Online]. Available: http://amca.mx/memorias/amca2013/articulos/0155.pdf
[11] H. Khalil. Nonlinear Systems (third ed.). Upper Saddle River, NJ: PrenticeHall, 2002.
[12] V. Utkin and J. Shi. `Integral sliding mode in systems operating under uncertainty conditions', Decision and Control, 1996, Proceedings of the 35th IEEE Conference on, IEEE, 1996. volume 4, pp. 4591­4596.
[13] L. Fridman, A. S. Poznyak, and F. J. Bejarano. Robust output LQ Optimal Control via Integral Sliding Modes. New York: Springer, 2014.
[14] I. Castillo, J. A. Moreno, and L. Fridman. "Método para robustecer controladores para sistemas de orden arbitrario vía algoritmo supertwisting", in XVI Congreso Latinoamericano de Control Automático (CLCA AMCA). Cancun, Quintana Roo, Mexico: Asociación de México de control Automático (AMCA), Oct. 2014, pp. 206­211. [Online]. Available at: http://amca.mx/memorias/amca2014/
[15] S. Skogestad and I. Postlethwaite. Multivariable Feedback Control: Analysis and Design, Vol. 2. New York: Wiley, 2007.
[16] Y. Hong, J. Wang, and Z. Xi. `Stabilization of uncertain chained form systems within finite settling time', Automatic Control, IEEE Transactions on, 2005, 50, 9, pp. 1379­1384.
[17] INTECO. Pendulum­Cart System User's Manual, 2008. [18] J.-J. E. Slotine and W. Li. Applied Nonlinear Control, Vol. 199. Englewood
Cliffs, NJ: Prentice-Hall, 1991.

Chapter 4
Stabilization and tracking control of the inverted pendulum on a cart via a modified PSO fractional order PID controller
Haifa Mehdi1 and Olfa Boubaker1
Abstract
In this chapter, a fractional-order proportional integral derivative controller, PID, based super-twisting observer for the cart inverted pendulum system is proposed. The mathematical model of the underactuated robotic system is derived using Lagrange equation and Grunwald­Letnikov fractional calculus with the physical parameters of a commercial device, the Googol Technology experimental Laboratory. PID parameters are optimized using a modified Particle Swarm intelligence optimization approach with the help of a multiobjective fitness function. A comparative analysis with the classical Particle Swarm Optimization algorithm shows the superiority of the proposed approach.
4.1 Introduction
In spite of its simple structure, the inverted pendulum on a cart remains one of the most difficult and interesting problems in control theory. Such system is an unstable with highly nonlinear dynamics, a nonminimum phase and an underactuated system, so thus an excellent benchmark for testing different control algorithms. Nevertheless, many standard techniques in control theory are ineffective when tested on the cart inverted pendulum for many reasons [1]. For example, many geometric properties of the system are lost when the pendulum moves through horizontal positions [2]. Moreover, the output-zeroing manifold does not contain any equilibrium points, the relative degree of the system is not constant and the controllability distribution of the system does not have a constant rank. The system is therefore not linearizable [3].
On the other hand, the control problem of the inverted pendulum system can be broadly divided into three sections, swing-up control, stabilization and tracking control. Swing up control is basically used to swing the pendulum rod from pending
1National Institute of Applied Sciences and Technology (INSAT), Tunisia

94 The inverted pendulum in control theory and robotics
position to stabilization zone. Then, stabilization control is essential to uphold it around the unstable equilibrium point, in upright position, for long interval [4]. So, finding a controller that can render the vertical upward position of the pendulum globally asymptotically stable has been considered a major problem.
In literature, there are many ways to bring the pendulum to the upper half plane [5]. One of the most popular is based on energy control [6,7]. Moreover, there are several different techniques accessible for stabilization and tracking control of inverted pendulum system [8­10]. One of the most used is proportional integral derivative (PID) controller. In fact, PID control is still the most broadly used strategies in the industry to control various real-world processes because of the design simplicity and implementation [11]. Nevertheless, in traditional PID control, there are some limitations. For example, it is a well-known fact that conventional PID controllers cannot effectively control high-order or nonminimum-phase (linear) processes. The quality of control is not also satisfactory when the process is nonlinear or has large dead times [11]. So to improve the performances of PID controllers systems, many researchers have attempted to develop new generations of such compensators. One of the main interesting suggested methods is the fractional-order PID (FOPID) controller approach proposed by Podlubny [12]. This type of PID controller provides us with more tuning parameters compared to the conventional one, and consequently, more control objectives can come into account when it is applied. Fractional-order calculus is a branch of mathematics which generalizes the conventional integer-order calculus to arbitrary orders. FOPID control is currently an emerging technology control with proven performances in numerous applications [13,14]. However, tuning FOPID controllers is a challenging work since there are more parameters to tune than the conventional PID. Indeed, five parameters must be tuned, which means two more parameters than the classical PID controller. More efficient global approach is then required to optimize these parameters automatically. In recent years, one of the most interesting evolutionary optimization techniques used to optimize such controllers for robotic systems is the Particle Swarm Optimization (PSO) [14­17].
The PSO algorithm, introduced by Eberhart and Kennedy in 1995 [18], is a swarm-based metaheuristic technique that models the social behavior of bird flocking. It is well adapted to the optimization of nonlinear functions in multidimensional space. PSO is easy to implement and may outperform other evolutionary algorithms [19]. However, it is liable to trap local optimization and cause premature convergence.
On the other hand, the state estimation problem is one of the most important problems in control theory and for robotic systems. There exist many kinds of observers in the literature in this framework [16,20­22]. The observation problem has been also studied in different types of pendulums. In the context of state estimation, in [23] Kalman filters are introduced to estimate the state of the Virgo inverted pendulum. To estimate the state of the wheeled inverted pendulum, a velocity estimator and linear observers have been presented by [24,25]. An extended high-gain observer and a full-order state observer have been implemented in the inverted pendulum­cart by Lee et al. [26] and Hashimoto et al. [27].
Motivated by the above discussions, this chapter proposes a FOPID controller based on the Grunwald­Letnikov (GL) fractional calculus and tuned by a modified

Stabilization and tracking control of inverted pendulum on a cart 95
PSO (MPSO) intelligence for stabilization and tracking control of the inverted pendulum system. In addition, the problem of state estimation for the pendulum­cart system is addressed in spite of disturbances using a super-twisting observer.
The rest of the paper is divided into the following sections. Section 4.2 gives a description of the inverted pendulum system and derivation of system equations in state space form. Section 4.3 describes the super-twisting observer, the FOPIDbased controller design and gives details about MPSO algorithm. Section 4.4 gives a complete description of the control strategy with simulation results and comparative analysis between proposed MPSO-FOPID controllers and PSO-FOPID controllers for different scenarios.
4.2 The cart-inverted pendulum system
4.2.1 System presentation
Consider the cart inverted pendulum system shown by Figure 4.1. The aim is to move the cart along the x-direction to a desired point without the pendulum falling. First, we assume that the pendulum rod is mass-less and that the cart mass and the pendulum mass are denoted as M and m, respectively. The pendulum rod length is l. There is an externally x-directed force on the cart, F, a gravity force mg acts on the point mass at all times and a force of friction Ffric between the cart and the track. The coordinate system considered is shown in Figure 4.1, where x represents the cart position, and  is the tilt angle referenced to the vertically upward direction.
In this chapter, the parameters of the experimental device of the Googol Technology Linear single inverted pendulum (GLIP2001) system is considered for simulation results [28]. The system consists of the following components: the mechanical system, the sensors and actuators, the control hardware and the control software. The block diagram of the setup is shown in Figure 4.2. The system is a single-input and multiple-output system. The voltage acts as a control input for the system and the linear cart displacements and angular position of pendulum are the outputs of the system. Moreover, the mechanical system design, shown in Figure 4.3, consists of a linear servo motion cart with a freely pivoted pendulum above it, a base, a sliding shaft, a timing belt, a timing wheel, an optical encoder and a limit switch.



m

l

F

Ffric

M

x

Figure 4.1 Inverted pendulum on a cart

96 The inverted pendulum in control theory and robotics
Position & angle sensors

Control input

Measurements

AC motor &
interface
Control algorithms
Figure 4.2 Block diagram of the inverted pendulum system

AC servo motor
Timing wheel

Timing belt

Pendulum Optical encoder Sliding shaft

Base

Limit switch

Figure 4.3 Mechanical system of the GoogolTech Linear single inverted pendulum

Stabilization and tracking control of inverted pendulum on a cart 97

4.2.2 Dynamic modeling

The Lagrange's equations of the inverted pendulum system are given as follows:

d dt

L  x

-

L x

=

F

+

Ffric

(4.1)

d dt

L  

-

L 

=

0

(4.2)

where L is the Lagrangian defined as

L

=

1 (M

+

m)x 2

+

1 ml22

+ mlx cos( )

-

mgl cos( )

(4.3)

2

2

and Ffric is the force of friction between the cart and the track defined as

Ffric = -bx

(4.4)

By putting the expressions (4.3) and (4.4) in (4.1) and (4.2) and after solving it, Lagrange's equations of the inverted pendulum system can be expressed as

(M + m)x¨ + ml cos( )¨ - ml2 sin( ) + bx = F

(4.5)

m cos()x¨ + ml¨ - mg sin( ) = 0

(4.6)

In the other hand, the experimental setup considered in simulation results uses an AC servo motor, which is controlled by motion controller card via motor drive amplifier. So, in order to develop a more realistic dynamic model, the dynamics of AC servo motor is also taken into account, which is given as

Bmm = Tm - T

(4.7)

where m is the rotor velocity displacement. Bm is the viscous-friction coefficient. Tm and T are the torque generated by a motor and the load torque used to move the cart

through a timing pulley and a synchronous belt, respectively.

The torque generated by a motor can be represented as follow [29]:

Tm = Km

- Kb Rm

m

+

u Rm

(4.8)

where u is the voltage applied to alternating current (AC) servo motor. Km, Kb and Rm are the torque and back electromotive force (EFM) constant and the motor armature resistance, respectively.
In this work, we consider a timing pulley and synchronous belt arrangement to convert rotational motion to translation motion. So the relation between those variable can be written as

x = rm

(4.9)

where r is the radius of timing pulley. So the motor torque (4.8) can be written as follows:

Tm

=

- KmKb x rRm

+

Km u Rm

(4.10)

98 The inverted pendulum in control theory and robotics

From (4.7), (4.9) and (4.10), the load torque can be defined as

T = Km u - Bm + KmKb x

Rm

r rRm

and the force acting on the cart is defined as

(4.11)

F = T = Km u - Bm + KmKb x = u - x

r rRm

r2 r2Rm

(4.12)

Finally, by substituting the force given in (4.12) into (4.5), the system equations

describing the cart position dynamics and the pendulum angle dynamics, respectively,

can be described as follows:

u + ml2 sin( ) - mg sin( ) cos( ) - (b + )x x¨ =
(M + m) - m cos2( )

(4.13)

¨

=

u

cos( )

+

ml2

sin( ) cos( ) - (M + m)g sin( ) - (b cos( ) ml cos2( ) - (M + m)l

+

)x

(4.14)

For numerical simulation of the nonlinear model for the inverted pendulum system, it is required to represent the nonlinear equations (4.13) and (4.14) into the standard state space form:

dz = f (t, z, u) dt

(4.15)

Let, z1 = x, z2 = x = z1, z3 =  , z4 =  = z3, the system dynamics may be written

as follows:



z1 z2

= =

z2 f1(t,

z,

u)

+

1(t,

z,

u)



z3 z4

= =

z4 f2(t,

z,

u)

+

2(t,

z,

u)

(4.16)

and the measurable output is given by

y = (y1, y2)T = (z1, z3)T

(4.17)

where the nominal part of the system dynamics is represented by the functions:

f1(t, z, u)

=

u

+

mlz42 sin(z3) (M

- mg sin(z3) cos(z3) + m) - m cos2(z3)

-

(b +

 )z2

(4.18)

f2(t, z, u) = u cos(z3) + mlz42 sin(z3) cos(z3) - (M + m) g sin(z3) - (b cos(z3) + )z2 ml cos2(z3) - (M + m)l (4.19)
while the uncertainties are concentrated in the terms 1(t, z, u) and 2(t, z, u). For the case study of system (4.16) and for i = 1, 2, fi(t, z, u) and i(t, z, u) are Lebesguemeasurable and uniformly bounded in any region of the state space.

Stabilization and tracking control of inverted pendulum on a cart 99
4.3 Control system

4.3.1 Super-twisting observer
For the Googol-inverted pendulum experimental setup, only the cart position, x, and the pendulum angle,  , are directly measured. This means that the cart velocity and the pendulum angular velocity are not immediately available for use in any control schemes beyond just stabilization. Thus, an observer is relied upon to supply accurate estimation of the states at all cart­pendulum positions.
In [30], Davila et al. proposed a super-twisting observer which reconstructs for second-order mechanical systems the velocity from the position measurements with finite time convergence using the principle of the second-order sliding-mode presented in [31]. It is shown that the separation principle theorem is trivial in this case, and the observer can be designed separately from the controller. Thus, if the controller is known to stabilize the process, then the stabilization of the system in closed-loop is assured whenever the super-twisting observer dynamics are fast enough. Furthermore, not only stabilization problem can be achieved but also tracking problem since the time variable is explicit in the observer model [32­34]. Only partial knowledge of the system model is required in such a case.

Theorem 4.1. The proposed super-twisting observer given by

 

z^1 z^2

= =

z^2 f1

+ 1 z1 t, z1, z^2,

- z^1 1/2sign z1 - z3, z^4, u + 1sign

z^1 z1

-

z^1



z^3 z^4

= =

z^4 f2

+ 2 z3 t, z1, z^2,

- z^3 1/2sign z3 - z3, z^4, u + 2sign

z^3 z3

-

z^3

(4.20)

converges in finite time to the states of system (4.16) if the observer parameters are

chosenas:



1 1

> >

f1+
2 1 -f1+

(1 +f1+ )(1+p1 )
(1-p1 )



2 2

> >

f2+
2 2 -f2+

(2 +f2+ )(1+p2 )
(1-p2 )

(4.21)

with known positive constants f1+ and f2+ and the following conditions:

f1(t, z, u) - f1 t, z1, z^2, z3, z^4, u + 1(t, z, u) < f1+ f2(t, z, u) - f2 t, z1, z^2, z3, z^4, u + 2(t, z, u) < f2+

(4.22)

hold for system (4.16) for any possible t and z^2  2sup|z2| and z^4  2sup|z4|. p1 and p2 are constants chosen as 0 < p1, p2 < 1 and f1(t, z1, z^2, z3, z^4, u) and f2(t, z1, z^2, z3, z^4, u) are known nominal functions defined as

f1(t, z1, z^2, z3, z^4, u)

=

u

+

mlz^42 sin(z3) - mg sin(z3) cos(z3) (M + m) - m cos2(z3)

-

 z^2

(4.23)

100 The inverted pendulum in control theory and robotics f2(t, z1, z^2, z3, z^4, u) = u cos(z3) + mlz^42 sin(z3) cos(z3) - (M + m) g sin(z3) - z^2 ml cos2(z3) - (M + m)l
Proof. See [30].

(4.24)

4.3.2 Fractional controller

4.3.2.1 Fractional order calculus

Fractional-order integration and differentiation are the generalization of the integer-

order ones to a real or complex order. Efforts to extend the specific definitions of the

traditional integer-order to the more general arbitrary order context led to different

definitions for fractional derivatives [35]. Fractional calculus is also three centuries

old as is conventional calculus, but is not very popular in the research field. However,

since the last few decades, many researchers have done work in different areas of

science and engineering (control system, modeling, etc.) using fractional calculus

[36,37].

The real order generalization is as follows:

 

d dt

if  > 0

D

=  1

t
d -

if  = 0 if  < 0

(4.25)

0

There are many definitions of fractional calculus but the three most frequently used definitions are Riemann­Liouville (RL), Caputo and GL [38]. The first one is Caputo witch expression is given by

aDtf (t) =

1 (n - )

t a

(t

f (n)( ) -  )-n+1

d



(4.26)

where  is a real number, a and t are the limits of operator, n is the integer value which satisfies the condition n - 1 <  < n and is the Gamma function defined by



(z) =

tz-1e-t dt

0

(4.27)

The Caputo definition is popular mostly in engineering applications [39], as it directly connection between the type of the initial conditions and the type of the fractional derivative.
The second definition is the RL given as

aDtf (t) =

1 (n - )

d n t f ( )

dt

a (t -  )-n+1 d

(4.28)

The RL definition for the fractional integral and derivative is appropriate for finding the analytical solution of simple functions like cos(t), et [40].

Stabilization and tracking control of inverted pendulum on a cart 101

The Caputo and RL formulation have the same view when the initial conditions are zero.
The third definition is GL given by

a Dt f

(t)

=

lim
h0

1 h

[(t-a)/h]

(-1)r

r!

(

! -

r

+

1)

f

(t

-

rh)

r=0

(4.29)

The GL definition is used for numerical evaluations. This definition is very beneficial in obtaining a numerical solution of fractional differential equations [41].
In this work, the GL definition will be used. In such a case, the choice of the initial conditions doesn't play an important role in the obtained solutions.

4.3.2.2 Fractional order PID (FOPID) controller
PID controllers have been used for several decades in industries for process control applications [42]. The reason for their popularity is in the simplicity of its design and good performance [42]. A FOPID controller is an extension of the classical PID controller in which the introduction of two extra parameters  and  makes it complex as compared to PID controller because of introduction of fractional calculus in it.
The control signal u(t) can then be expressed in the time domain as

u(t) = kpe(t) + kiD-e(t) + kd De(t)

(4.30)

where e(t) is the error signal. kp, ki and kd are proportional, integral and derivative gains, respectively.  is the order of integration and  is the order of differentiator.
In the Laplace domain, assuming zero initial conditions, the FOPID controller
has the following form:

C(s)

=

kp

+

ki s

+

kd s

(4.31)

All the classical PID controllers are particular cases of the fractional controller:

 if  = 1 and  = 1, then it is classical PID controller.  if  = 0 and  = 1, then it is classical PD controller.  if  = 1 and  = 0, then it is classical PI controller.  if  = 0 and  = 0, then it is classical P controller.

A FOPID controller works better in the following situations/applications [43]:

 Five different specifications can be achieved, which is not possible in the case of classical PID controller.
 The FOPID controller can easily attain the property of iso-damping, compared to classical PID controller.
 For higher order systems, the performance of classical PID controller deteriorates, whereas FOPID controller provides better results.
 For a system with long time delay, a FOPID controller provides better results than classical PID controller.
 A classical PID controller provides lower robust stability, whereas FOPID controller has more robust and stable.

102 The inverted pendulum in control theory and robotics
 It is difficult to control the system with nonlinearities using classical PID controller, whereas the FOPID controller can perform better.
 The FOPID controller can achieve better response for nonminimum phase system.  Mostly, nonlinear system is linearized at different operating points, and controllers
are designed for different operating points, whereas one FOPID controller is mostly sufficient for nonlinear system.
The fractional controllers have two parameters more than the conventional PID controllers, thus two more specifications can be met, which improves the performance of the overall system. It can be expected that the FOPID controller may enhance the performance of the system. So, finding an optimal set of values for kp, ki, kd,  and  in order to meet the user specifications for a given process needs parameter optimization in five-dimensional hyperspace witch remain a complex and time consuming procedure [44]. For those reasons, researchers have used different methods of tuning like Ziegler­Nichols modified method, PSO, neural network, etc. [45,46].
4.3.3 Tuning parameters of fractional-order controller
Tuning controllers is always a challenging task. In case of FOPID controllers, there are five parameters to tune. Because of a larger number of parameters, it is challenging to tune this controller [47]. Various methods are used for tuning of fractional order controllers (Rule-based methods, analytical methods, numerical methods, etc.) [48­50]. In this work, we will use one of the soft computing methods: the PSO approach. Indeed, PSO has been regarded widely as a promising optimization algorithm due to its combination of simplicity, low computational cost and good performance. In the other hand, the optimal problems solved by genetic algorithms can obtain better solutions with PSO in comparison with conventional methods [51]. However, the classic PSO algorithm has a major problem which is premature convergence. So, to address this problem, we will use in this work the MPSO proposed by Zhao et al. [52]. In fact, PSO method was used for designing fractional order controllers by Cao and Cao [53]. The optimization performance target is the weighted combination of ITAE and control input. Hu et al. [54] have also used the PSO algorithm for tuning of the FOPID implemented with FPGA.
4.3.3.1 Particle swarm optimization The PSO method is an evolutionary algorithm inspired from study on swarm such as fish schooling and bird flocking [18]. During flight, each particle adjusts its position according to its own experience, and the experience of other particles, making use of the best position encounter by itself and its neighbors. The swarm direction of a particle is defined by the position of particles adjacent to the particle and its history. The best previous position of ith particle is recorded and represented as pbesti. The best particle among all the particles in the group is represented as gbest.
The PSO concept consists of, at each time step, changing the velocity (or acceleration) of each particle i toward its pbest and the gbest position. For the ith particle, a new velocity and position are updated such that [19]:
Vi(k+1) = w(k)Vi(k) + c1 rand() ( pbesti - pi(k)) + c2 Rand() (gbest(k) - pi(k)) (4.32)

Stabilization and tracking control of inverted pendulum on a cart 103

p(ik+1) = p(ik) + Vi(k+1)

(4.33)

for k = 1, 2, . . . , N and i = 1, 2, . . . , M and where M is the number of particles in a group, N is the maximum number of iterations, Vi(k) is the velocity of ith particle at iteration k, p(ik) is the position of ith individual at iteration k, pbesti(k) is the best position of ith individual at iteration k, gbest(k) is the best position of the group until iteration k, w(k) is the inertia weight factor at iteration k, c1, c2 is the acceleration
factors and rand (), Rand () is the Random numbers between 0 and 1.
In general, the inertia weight is calculated according to the following equation:

w(k) = k wmax - wmin N

(4.34)

4.3.3.2 Modified particle swarm optimization
The classic PSO algorithm has a major problem which is premature convergence. This problem incurs a rapid loss of diversity during the evolutionary processing. Therefore, to address this problem, Zhao et al. [52] propose a MPSO, which adopts an adaptive factor fa to prevent premature convergence and a perturbation operator ga help particles flight from local optima.
The adaptive factor is defined as follows:

k

fa = rand ×

1- N

(4.35)

where rand meets normal distribution within the range [0, 1]. Equation (4.35) means that the adaptive factor fa tends to decrease with the iterations k. By introducing fa, the position of particle (4.33) is modified as follows:

p(ik+1) = p(ik) + fa × Vi(k+1)

= p(ik) + rand ×

1- k N

× Vi(k+1)

(4.36)

It can be seen in relation (4.36) that in the beginning stage of the iteration fa is large, and the algorithm has strong ability to explore new areas continuously to overcome premature convergence, then as the number of iteration increases, fa decreases, thus the algorithm converges gradually and can search finely around the optimal solution. The adaptive factor fa balances the global and local search capability.
In PSO, the global best location gbest steers the flight direction for a particle, so it would be more effective to modify gbest to maintain particles diversity for jumping out of the potential local optima by using a perturbation operator ga. So, to better manage diversity and convergence, the perturbation range of gbest is limited to 0 max( p) - min( p) . max( p) - min( p) is the difference of maximum and minimum location of particles in different iteration. At the beginning of the iteration, max( p) - min( p) is large, and the extensive perturbation range keeps the diversity of particles. Then as the number of iteration increases, max( p) - min( p) decreases gradually, the lower perturbation rate can converges gradually and search

104 The inverted pendulum in control theory and robotics

finely around the optimal solution. So the best particle among all the particles in the

group gbest with perturbation operator ga will be defined as

gbest(k+1) = gbest(k) + ga

= gbest(k) + max p(k) - min p(k) × rand

(4.37)

The design steps for implementing the MPSO algorithm are given as follows:

1. Initialize a population of particles with arbitrary positions and velocities. 2. Update the inertial weight w. 3. For each particle, estimate the desired optimization fitness function. 4. Compare particle's fitness with its pbesti. If present value is better than pbesti,
then put pbesti equal to the recent value. 5. Update the velocity and position of the particle according to (4.32) and (4.36),
respectively. 6. Identify the particle in the area with the best success so far, and allocate it to
gbest. 7. If the maximum number of iterations is not reached, perturb the global best
location to take new gbest as the global best location by using (4.37). 8. If a criterion is meet (a sufficiently good fitness or a maximum number of
iterations), go to 9 else go to 2. 9. The particle that generates the latest gbest is an optimal controller parameter.

4.3.3.3 Fitness function

For getting good dynamic performance and avoiding large control input, the following fitness function is used in this paper:

T

J=

w1 × [d (t) -  (t)]T [d (t) -  (t)] + w2

0

× [xd (t) - x(t)]T [xd (t) - x(t)] + w3 × u(t) dt

(4.38)

where w1, w2 and w3 are the weights to give equal weightage to all parameters. T is the simulation time. The fitness function given by (4.38) has three terms. The first term is the integral square of pendulum angle error d(t) -  (t) which is used to stabilize pendulum angle. The second term is the integral square of cart position error xd(t) - x(t) which is used to track cart position. Finally, the third term is the integral square of control input u(t) which is used to minimize the required control voltage.

4.4 Simulation results
Simulation results are carried out based on the system model depicted in Section 4.2. The system parameter's values are listed in Table 4.1.
The FOPID-controller-based super-twisting observer is designed such as
 The cart position FOPID is given by u1(t) = kpe1(t) + kiD-e1(t) + kd De1(t)  The angle position FOPID is given by u2(t) = kpe2(t) + kiD-e2(t) + kd De2(t)

Stabilization and tracking control of inverted pendulum on a cart 105 Table 4.1 The Googol Technology experimental device parameters

Symbol
M M l b g Bm Km Kb Rm r

Parameter
Cart mass Pendulum mass Pendulum rod length Coefficient of friction of the cart Acceleration due to gravity Motor viscous friction coefficient Motor torque constant Motor back EFM constant Motor resistance Radius of timing pulley

Value
1.096 kg 0.109 kg 0.5 m 0.1 N s/m 9.8 m/s2 0.03 N m s/rad 2 kg m2 0.1 N s/rad 2.5 0.0195 m

xd +­ e1 d +­ e2

1 = z2 2 = f1(t, z, u) + 1(t, z, u) 3 = z4 4 = f2(t, z, u) + 2(t, z, u)

z3 +­

z1

+­

FOPID

u1

MPSO

u +

FOPID

u2

1

3

. .1

=

2

+

1|z1

­

1|1/2sign(z1

­

1)

.2 .3

= =

f1(t, 4 +

z1, 2, z3, 4, u) + k1sign(z1 2|z3 ­ 3|1/2sign(z3 ­ 3)

­

1)

4 = f2(t, z1, 2, z3, 4, u) + k2sign(z3 ­ 3)

1, 2

3, 4

Figure 4.4 FOPID-controller-based super-twisting observer tuned with MPSO

and where e1(t) = xd(t) - x (t), e2(t) = d(t) -  (t) and u(t) = u1(t) + u2 (t). Uncertainties are defined as external perturbations satisfying |i(t, z, u)| < 1.
They were taken as 1 = 2 = 0.03 sin(20t). In the other hand, to explore the performances of the proposed control approach, we consider two case studies for
simulation:
Case study 1: The control input is designed to track a smooth profile for the cart position reference given by xd = 0.3 sin(0.1t) and, to stabilize the pendulum in its upper position (d = 0).
Case study 2: The control is designed to track a nonsmooth trajectory for the cart position reference given by xd = 0.3 sin(0.1t) and, to stabilize the pendulum in its upper position.

106 The inverted pendulum in control theory and robotics Table 4.2 MPSO and PSO algorithm parameters

Designation
Number of particles in a group Maximum number of iterations Minimum inertia weight factor Maximum inertia weight factor Search interval for kp Search interval for ki Search interval for  Search interval for kd Search interval for  Search interval velocity of kp Search interval velocity of ki Search interval velocity of  Search interval velocity of kd Search interval velocity of  Acceleration constants

Variable
M N wmin wmax kpmin kpmax kimin kimax min max
kdmin kdmax min max 0 kpmax /2 0 kimax /2 0 max/2 0 kdmax /2 0 max/2 c1c2

Value
20 30 0.1 0.9 0 300 0 300 01 0 300 01 0 150 0 150 0 0.5 0 150 0 0.5 2

For the two cases, the optimal parameters of the FOPID controllers are determined
using the MPSO and classical PSO algorithms.
Figure 4.4 illustrates the block diagram of optimal design of the FOPID-
controller-based super-twisting observer for the inverted pendulum on a cart using
MPSO algorithm.
The MPSO and PSO algorithm's parameters are given in Table 4.2. The parameters of the fitness function (5) are chosen as w1 = 1, w2 = 1 and w3 = 0.1. The initial conditions are taken as follows: x = z1 = z^1 = 0.3 m, x = z2 = -0.1 m/s, z^2 = 0 m/s,  = z3 = z^3 = 0.2 rad,  = z4 = 0.03 rad/s and z^4 = 0 rad/s.
In the other hand, assume that |z1|, z^1  0.5 m, |z2|  1.5 m/s, z^2  3 m/s, |z3|, z^3  1 rad, |z4|  2.5 rad/s, z^4  5 rad/s and |u|  7 V, we obtain

f1(t, z, u) - f1(t, z1, z^2, z3, z^4, u) + 1(t, z, u) < 0.4 = f1+ f2(t, z, u) - f2(t, z1, z^2, z3, z^4, u) + 2(t, z, u) < 0.1 = f2+

(4.39)

Therefore, the observer parameters described by (4.21) are chosen as 1 = 2, 1 = 5, 2 = 1 and 2 = 3.

4.4.1 Simulation results and performance analysis: case study 1
The FOPID controller parameters tuned using the MPSO and the PSO approaches are given in Table 4.3.

Stabilization and tracking control of inverted pendulum on a cart 107 Table 4.3 Optimized controller parameters: case study 1

kp ki 

kd 

J

MPSO-FOPID Angle control 167 5 0.37 38 0.29 1.0054

controller

Position control 59 19 0.23 38 0.18

PSO-FOPID Angle control 123 10 0.65 19 0.76 1.117

controller

Position control 89 67 0.12 21 0.32

Cart position (m)

0.4 0.3 0.2 0.1
0 ­0.1 ­0.2 ­0.3 ­0.4
0

MPSO PSO Desired

10

20

30

40

50

60

70

80

Time (s)

Figure 4.5 Cart's position: case study 1

Figures 4.5­4.8 show the MPSO-FOPID response compared to the PSO-FOPID response for the system under consideration with the objective of controlling the cart position and stabilizing the pendulum angle. From Figure 4.5, we may conclude that there is some oscillations and large settling time for the PSO-FOPID controller regarding the cart's position. Such dynamics are not observed when using the MPSOFOPID controller. In the other hand, Figure 4.6 shows that cart position error is null after 20 s in the two cases. From Figure 4.7, we can observe oscillations for pendulum's angle when the PSO-FOPID controller is used compared to the MPSOFOPID controller. In Figure 4.8, both PSO and MPSO FOPID controller provide acceptable control laws but in case of MPSO-FOPID, less control effort is required.

108 The inverted pendulum in control theory and robotics
0.3
0.2

MPSO PSO

0.1

Cart position error (m)

0

­0.1

­0.2

­0.3

­0.4 0
0.4 0.3

10

20

30

40

50

60

70

80

Time (s)

Figure 4.6 Cart's position error: case study 1

MPSO PSO

0.2

Pendulum position (rad)

0.1

0

­0.1

­0.2

­0.3 0

10

20

30

40

50

60

70

80

Time (s)

Figure 4.7 Pendulum's position: case study 1

Control u

Stabilization and tracking control of inverted pendulum on a cart 109
1 MPSO PSO
0.5

0

­0.5

­1

­1.5 0

10

20

30

40

50

60

70

80

Time (s)

Figure 4.8 Control voltage: case study 1

Table 4.4 Optimized controller parameters: case study 2

kp ki 

kd 

J

MPSO-FOPID Angle control 202 18 0.15 31 0.11 1.4364

controller

Position control 122 3 0.36 28 0.2

PSO-FOPID Angle control 281 39 0.59 85 0.71 1.6871

controller

Position control 159 98 0.46 49 0.13

4.4.2 Simulation results and performance analysis: case study 2
Table 4.4 gives the best FOPID controller parameters using MPSO and PSO algorithm's for the second case study.
The desired and actual cart trajectories are shown in Figure 4.9. We can conclude that settling time is large for PSO-FOPID controller compared to MPSO-FOPID controller when desired trajectory cart is nonsmooth. From Figure 4.10, we also observe oscillations when parameters of FOPID controller are tuned using PSO algorithm. From Figure 4.11, we can conclude that the profile of the control laws present some oscillations during the deviation of the cart. Furthermore, more overshoots are

110 The inverted pendulum in control theory and robotics
0.6

0.4

0.2

Cart position (m)

0

­0.2

­0.4

­0.6
­0.8 0
0.08 0.07 0.06 0.05 0.04 0.03 0.02 0.01
0 ­0.01 ­0.02
0

10

20

30

40

50

60

Time (s)

Figure 4.9 Cart's position: case study 2

MPSO PSO Desired

70

80

MPSO PSO

10

20

30

40

50

60

70

80

Time (s)

Figure 4.10 Pendulum's position: case study 2

Pendulum position (rad)

Control u

Stabilization and tracking control of inverted pendulum on a cart 111
0.8

0.6

0.4

0.2

0

­0.2

­0.4

­0.6

­0.8

­1 ­1.2
0

10

20

30

40

50

60

Time (s)

Figure 4.11 Control voltage: case study 2

MPSO PSO

70

80

observed when system is controlled via PSO-PID controllers compared to MPSOFOPID controllers. Such observations prove that the MPSO algorithm performs well in adjusting the control laws parameter's for nonsmooth motions.
4.5 Conclusion
In this chapter, an MPSO-FOPID-controller-based super-twisting observer is applied for the inverted pendulum on a cart system with the consideration of optimization objectives. The super-twisting observer is proposed to estimate the state vector, in spite of disturbance, exactly and in a finite time. The MPSO algorithm that adopts adaptive factor and perturbation operator conquers the drawback of premature convergence of PSO method, has been improved and applied for simultaneous optimization of several parameters of the controllers. Performances of MPSO-FOPID and PSO-FOPID controllers are studied and compared. Analysis confirms the stability and robustness of the proposed FOPID controller in terms of tracking errors in the case of a smooth or a nonsmooth cart trajectory. The chapter has also shown that MPSO-FOPID gives more flexibility for the control system designing and has better opportunity to adjust system

112 The inverted pendulum in control theory and robotics
dynamic characteristics, which means that the proposed controller design technique may serve as an efficient alternative for the design of future controllers. The performance investigation of the FOPID control approach using MPSO with a different multiobjective fitness function including linear and angular velocity variables may be done as a future work.
References
[1] Boubaker O. `The inverted pendulum: A fundamental benchmark in control theory and robotics'. IEEE International Conference on Education and e-Learning Innovations (ICEELI2012); Sousse, Tunisia, Jul. 2012. pp. 1­6.
[2] Zhao J., Spong M.W. `Hybrid control for global stabilization of the cartpendulum system'. Automatica. 2001; 37(12): 1941­1951.
[3] Chung C.C., Hauser J. `Nonlinear control of a swinging pendulum'. Automatica. 1995; 31(6): 851­862.
[4] Agustinah T., Jazidie A., Nuh M. `Hybrid fuzzy control for swinging up and stabilizing of the pendulum­cart system'. IEEE International Conference on Computer Science and Automation Engineering (CSAE '11); Shanghai, China, Jun. 2011. pp. 109­113.
[5] Boubaker O. `The inverted pendulum benchmark in nonlinear control theory: A Survey'. International Journal of Advanced Robotic Systems. 2013; 10: 233­242.
[6] Astrom K.J., Furuta K. `Swinging up a pendulum by energy control'. Automatica. 2000; 36: 287­295.
[7] Benrejeb W., Boubaker O. `FPGA modeling and realtime embedded control design via LabVIEW Software: Application for swinging-up a pendulum'. International Journal on Smart Sensing and Intelligent Systems. 2012; 5(3): 576­591.
[8] Sarit K.D., Kaustav K.P. `Robust compensation of a cart­inverted pendulum system using a periodic controller: Experimental results'. Automatica. 2011; 47: 2543­2547.
[9] ZhangY., Yu X., YinY., Peng C., Fan Z. `Singularity-conquering ZG controllers of z2g1 type for tracking control of the IPC system'. International Journal of Control. 2014; 87(9): 1729­1746.
[10] Ngadengon R., Sam Y.M., Osman J.H.S., Tomari R., Wan Zakaria W.N. `Multirate output feedback with discrete time sliding mode control for inverted pendulum system'. Procedia Computer Science. 2015; 76: 290­295.
[11] Astrom K.J., Hagglund T. Advanced PID control. Pittsburgh, PA: ISA ­ The Instrumentation, Systems, and Automation Society; 2006.
[12] Podlubny I. `Fractional-order systems and PID controller'. IEEE Transactions on Automatic Control. 1999; 44: 208­214.
[13] Efe M.Ö. `Neural network assisted computationally simple PID control of a quad rotor UAV'. IEEE Transactions on Industrial Informatics. 2011; 7: 354­361.

Stabilization and tracking control of inverted pendulum on a cart 113
[14] Howimanporn S., Parnichkun M. `Control of an X­Y planar inverted pendulum using PSO-based SMC'. International Journal of Robotics & Automation. 2015; 30(4): 310­321.
[15] Mehdi H., Boubaker O. `Position/force control optimized by particle swarm intelligence for constrained robotic manipulators'. IEEE International Conference on Intelligent Systems Design and Applications (ISDA'2011); Cordoba, Espagne, Nov. 2011. pp. 190­195.
[16] Mehdi H., Boubaker O. `Robust impedance control based Lyapunov­ Hamiltonian approach for constrained robots'. International Journal of Advanced Robotic Systems. 2015; 12: 190­202.
[17] Mehdi H., Boubaker O. `PSO-Lyapunov motion/force control of robot arms with model uncertainties'. Robotica. 2016; 34(3): 634­651.
[18] Kennedy J., Eberhart R. `Particle swarm optimization'. Proceeding of the IEEE International Conference of Neural Networks; Perth, 1995. pp. 1942­1948.
[19] Eberhart R.C., Shi Y. `Comparison between genetic algorithms and particle swarm optimization'. in Porto V.W., Saravanan N., Waagen D., Eiben A.E. (eds.). Evolutionary Programming VII. Berlin, Heidelberg: Springer; 1998. pp. 611­616.
[20] Shtessel Y., Edwards C., Fridman L., Levant A. Sliding mode control and observation. New York, NY: Springer; 2014.
[21] Chen L., Edwards C., Alwi H. `LPV sliding mode observers for sensor fault reconstruction with erroneous scheduling parameter measurements'. 54th IEEE Conference on Decision and Control (CDC); Osaka, Japan, Dec. 2015. pp. 4080­4085.
[22] Chan L., Naghdy F., Stirling D.J. `An improved extended active observer for adaptive control of a n­DOF robot manipulator'. Journal of Intelligent & Robotic Systems. 2016. DOI: 10.1007/s10846-016-0402-8.
[23] Accadia T., Acernese F., Astone P., et al. `A state observer for the Virgo inverted pendulum'. Review of Scientific Instruments. 2011; 82(9): 34­44.
[24] MarukiY., Kawano K., Suemitsu H., Matsuo T. `Adaptive backstepping control of wheeled inverted pendulum with velocity estimator'. International Journal of Control Automation and Systems. 2014; 12(5): 1040­1048.
[25] Canete L., Takahashi T. `Modeling, analysis and compensation of disturbances during task execution of a wheeled inverted pendulum type assistant robot using a unified controller'. Advanced Robotics. 2015; 29(22): 1453­1462.
[26] Lee J., Mukherjee R., Khalil H.K. `Output feedback stabilization of inverted pendulum on a cart in the presence of uncertainties'. Automatica. 2015; 54: 146­157.
[27] Hashimoto Y., Otsuki Y., Matsuno T., YanouA., Minami M. `Posture control of inverted pendulum cart with balancing mechanism using full-order state observer'. IEEE/SICE International Symposium on System Integration (SII); Tokyo, Japan, Dec. 2014. pp. 398­403.
[28] Googol Technology. Inverted pendulum instruction manual. 2006. Available from http://www.googoltech.com/web/eng/product_details_frame. jsp?module=Educational%20Products&gid=569 [Accessed Dec. 2016].

114 The inverted pendulum in control theory and robotics
[29] Kuo B.C., Golnaraghi G. Automatic control systems. 8th edn. NewYork: Wiley; 2003.
[30] Davila J., Fridman L., Levant A. `Second-order sliding-mode observer for mechanical systems'. IEEE Transactions on Automatic Control. 2005; 50(11): 1785­1789.
[31] Levant A. `Sliding order and sliding accuracy in sliding mode control'. International Journal of Control. 1993; 58(6): 1247­1263.
[32] Fang X., Wu A., Shang Y., Du C. `Multivariable super twisting based robust trajectory tracking control for small unmanned helicopter'. Mathematical Problems in Engineering. 2015; 2015: 13 pp. Article ID 620357.
[33] Zong Q., Dong Q., Wang F., Tian B. `Super twisting sliding mode control for a flexible air-breathing hypersonic vehicle based on disturbance observer'. Science China Information Sciences. 2015; 58(7): 1­15.
[34] Hu J., Qiu Y., Liu L. `High-order sliding-mode observer based output feedback adaptive robust control of a launching platform with backstepping'. International Journal of Control. 2016; 89(10): 2029­2039.
[35] Kilbas A.A., Srivastava H.M., Trujillo J.J. Theory and applications of fractional differential equations. Amsterdam, The Netherlands: Elsevier B.V; 2006. p. 135.
[36] Monje C.A., Chen Y., Vinagre B.M., Xue D., Feliu-Batlle V. Fractional-order systems and controls: Fundamentals and applications. London: Springer; 2010.
[37] Zheng W., Luo Y., Chen Y., Pi Y. `Fractional-order modeling of permanent magnet synchronous motor speed servo system'. Journal of Vibration and Control. 2016; 22(9): 2255­2280.
[38] Podlubny I. Fractional differential equation. New York, NY: Academic Press; 1998.
[39] Cafagna D. `Fractional calculus: A mathematical tool from the past for present engineers'. IEEE Industrial Electronics Magazine. 2007; 2(1): 35­40.
[40] Loverro A. Fractional calculus: History, definitions and applications for the engineer. Rapport Technique University of Notre Dame, Department of Aerospace and Mechanical Engineering, Indiana; 2004.
[41] Petras I. `Tuning and implementation methods for fractional-order controllers'. Fractional Calculus and Applied Analysis. 2012; 15(2): 282­303.
[42] Anguluri R., Vedurupaka C., Swagatam D. `Fractional order PID controller design using a modified artificial bee colony algorithm'. In: Panigrahi B.K., Suganthan P.N., Das S., Satapathy S.C. (eds.). Swarm, Evolutionary, and Memetic Computing. Berlin, Heidelberg: Springer-Verlag; 2011. pp. 670­678.
[43] Shah P., Agashe S. `Review of fractional PID controller'. Mechatronics. 2016; 38: 29­41.
[44] Chen C., Hu L., Wang L., Gao S., Li L. `Adaptive particle swarm algorithm for parameters tuning of fractional order PID controller'. Telkomnika. 2016; 14(2): 478­488.
[45] Luo Y., Chen Y.Q., Wang C.Y., Pi Y.G. `Tuning fractional order proportional integral controllers for fractional order systems'. Journal of Process Control. 2010; 20(7): 823­831.

Stabilization and tracking control of inverted pendulum on a cart 115
[46] Padula F., Visioli A. `Tuning rules for optimal PID and fractional-order PID controllers'. Journal of Process Control. 2011; 21(1): 69­81.
[47] Astrom K.J. PID controllers: Theory, design and tuning. Pittsburgh, PA: Instrument Society of America; 1995.
[48] Valério D., Sa da Costa J. `Tuning of fractional PID controllers with Ziegler­Nichols-type rules.' Signal Processing. 2006; 86(10): 2771­2784.
[49] Deepak V.D., Usha Kumari S. `Modified method of tuning for fractional PID controllers'. International Conference on Power Signals Control and Computations (EPSCICON); Thrissur, India, Jan. 2014. pp. 1­6.
[50] Muresan C.I., De Keyser R., Ionescu C.M. `Autotuning method for a fractional order controller for a multivariable 13C isotope separation column'. European Control Conference; Aalborg, Denmark, Jun. 2016. pp. 358­363.
[51] Song M.P., Gu G.H. `Research on particle swarm optimization: A review'. International Conference on Machine Learning and Cybernetics; Shanghai, China, Aug. 2004. pp. 2236­2241.
[52] Zhao X., Turk M., Li W., Lien K.C., Wang G. `A multilevel image thresholding segmentation algorithm based on two-dimensional K­L divergence and modified particle swarm optimization'. Applied Soft Computing. 2016; 48: 151­159.
[53] Cao J.Y., Cao B.G. `Design of fractional order controllers based on particle swarm optimization'. International Journal of Control, Automation, and Systems. 2006; 4(6): 775­781.
[54] Qu L., Hu H., Huang Y. `Fractional order PID controller based on particle swarm optimization implemented with FPGA'. International Conference on Artificial Intelligence and Computational Intelligence (AICI); Sanya, China, Oct. 2010. pp. 165­169.

Part II
Controllers for underactuated mechanical systems

Chapter 5
Model-free control of the inertia wheel inverted pendulum with real-time experiments
Ahmed Chemori1
5.1 Introduction
The inertia wheel inverted pendulum belongs to the class of underactuated mechanical systems [10,12,22]. These systems are characterized by less control inputs than degrees of freedom, meaning that they have at least one unactuated generalized coordinate. Underactuation in these systems has two main sources, the first one is intentionally, i.e., decided in the design stage to minimize the cost, the weight, consumption, etc. The second is nonintentionally, where a fully actuated mechanical system can become underactuated after the deficiency of one or more actuators. Underactuated mechanical systems are characterized by a high nonlinear coupling between actuated and unactuated coordinates [7], and an internal dynamics which is often unstable (i.e., nonminimum phase systems [2]). In the real world many examples of such systems exist, they include, among others, inverted pendulums [18,21], underactuated robot manipulators [6], gymnast robots [23,31], undersea vehicles [17], aircrafts [26] and some mobile robots [20].
The inertia wheel inverted pendulum [34] is a benchmark for nonlinear control of underactuated mechanical systems. It has attracted the attention of many researchers within control community. Indeed, different control solutions have been proposed in the literature these last decades. In [1], strong damping force on the inertia wheel is taken into account in the design of the controller. The stabilization is achieved via nested saturation based controller. Reference [19] solves the limit cycles generation problem on the inertia wheel pendulum using virtual holonomic constraints. Realtime experiments were carried out showing the robustness of the proposed approach. In [27], collocated partial feedback linearization was performed to exhibit the nonlinear core subsystem which is stabilized using an implicit control. The remaining subsystem is stabilized using multiple sliding mode control technique. In our previous work [4,5], noncollocated partial feedback linearization is used; this gives rise to an unstable internal dynamics, which is stabilized using trajectory optimization and model-based error estimation. In [36], a generalized predictive controller is proposed
1Laboratoire d'Informatique, de Robotique et de Microélectronique de Montpellier (LIRMM), France

120 The inverted pendulum in control theory and robotics
for the stabilization of the inertia wheel inverted pendulum. In [9], the proposed control solution deals with external disturbance rejection in passivity-based control of the inertia wheel inverted pendulum. All the above-mentioned techniques require knowledge of the system dynamics and parameters, furthermore only [3,4,9,19,36] present real-time experiments as a validation on a prototype of the inertia wheel inverted pendulum.
In this chapter, we propose to design a control scheme based on model-free technique to deal with underactuation in stable limit cycle generation. In order to achieve stable limit cycles on both coordinates of the inertia wheel inverted pendulum, we first design a family of p-parameterized periodic trajectories for the pendulum's angle. Those trajectories are then tracked using the control input thanks to a classical model-free controller [8,15]. Since the system is underactuated and nonminimum phase, a second controller is needed to update the parameter p of the above trajectories in order to deal with the convergence of the internal dynamics of the system. To achieve this control, we propose a second model-free controller using actuated coordinate (inertia wheel) as output and trajectories' parameter p as control input. Note that this control scheme can be easily applied to the stabilization case by carefully choosing appropriate trajectories. Numerical simulations as well as real-time experiments are presented to show the effectiveness of the proposed control scheme and its ability for external disturbances rejection.
The rest of this chapter is organized as follows. In Section 5.2, the experimental platform of the inertia wheel inverted pendulum is presented, with a description of its main components. Then, the proposed control solution is described in Section 5.3 for the general case of underactuated mechanical systems. Section 5.4 is devoted to the application of the proposed control scheme to the case of inertia wheel inverted pendulum. Numerical simulations are introduced in Section 5.5, where a first validation of the proposed control solution is illustrated. In Section 5.6, real-time experimental results are presented and discussed. Finally, Section 5.7 is devoted to some concluding remarks.
5.2 Description of the system: inertia wheel inverted pendulum
The testbed of the inertia wheel inverted pendulum system is shown in Figure 5.1, with its different components. It consists of three main parts:
 the mechanical part,  the electronic part and  the computer (control PC).
These three main parts will be described in the following sections.
5.2.1 Description of the mechanical part of the system
The mechanical part of the inertia wheel inverted pendulum is shown in Figure 5.2, which consists of an inverted pendulum equipped with an actuated rotating wheel.

Control of the inertia wheel inverted pendulum with experiments 121

Pendulum body

Inclinometer

Control PC DC power supply (12 V) Driver

Actuated inertia wheel

Interface card (I/O)

Figure 5.1 View of the testbed of the inertia wheel inverted pendulum system

Inclinometer Pendulum body
Inertia wheel
Active joint Passive joint
Frame
Figure 5.2 View of the mechanical part of the inertia wheel inverted pendulum
The joint between the pendulum body and the frame is unactuated whereas the joint between the pendulum body and the wheel is actuated by a Maxon EC-powermax 30 DC motor.
The pendulum angle qna (with respect to the vertical) is constrained to remain within the interval [-10, +10] due to mechanical stops (cf. Figure 5.2).
5.2.2 Description of the electronic part of the system
The actuator of the system is a Maxon EC-powermax 30 DC motor, equipped with an integrated incremental encoder allowing the measurement in real-time of the inertia wheel angular position. To measure the angle of the pendulum with respect to the vertical, the system is equipped with an inclinometer FAS-G of Micro strain. The electronic part of the testbed includes also a MAGMA driver to control the DC

122 The inverted pendulum in control theory and robotics
motor with a power up to 200 W, a DC power supply and an I/O interface card. These components are visible on Figure 5.1 of the testbed.
5.2.3 Description of the control PC and software
As illustrated in Figure 5.1, the whole system is controlled with a computer equipped with a 2.4-GHz microprocessor. The control software is implemented using C++ language, and the whole system is running under Ardence RTX (Real-Time Extension for Windows) operating system. The computer is the heart of the control system, it is connected to the I/O interface card to communicate with the physical system.

5.3 A proposed control solution for underactuated systems
In this section, the proposed control scheme is detailed. The main idea is to develop a control architecture based on model-free control for tracking of reference periodic trajectories while keeping stable the internal dynamics of underactuated mechanical systems.

5.3.1 Brief background on model-free control
Model-free control strategy has been initially proposed in [8,15] resulting in a breakthrough in nonlinear control. This technique is based on previous results on fast estimation and identification of nonlinear signals [16,24]. The control scheme is based on local linear approximation of the controlled system dynamics which is valid for a small time window. This approximation is updated in an online fashion thanks to a fast estimator. The control law proposed consists in a PID controller augmented with compensating terms provided by online estimation of the system dynamics. The overall controller is also called i-PID (standing for intelligent PID). Comparison of such a controller with classical PID controller can be found in [11]. The main advantage of this control strategy is that it doesn't require neither prior knowledge of the system dynamics nor complex parameters tuning. Consequently, it can be easily applied to controller unknown systems. Some efforts have been made for two particular cases of underactuated systems: the ball and beam [14] (where the dynamics of the beam has not been taken into account) and the Planar Vertical Take Off and Landing (PVTOL) aircraft [28] where the addressed control problem is limited to stabilization.
For the sake of simplicity, we present in the following model-free control for a single-input­single-output nonlinear systems.

5.3.1.1 Nonlinear dynamics
Consider a nonlinear system with unknown dynamics. The input­output behavior of the system can be expressed in the following general form as an ordinary differential equation (ODE):

E(y, y, . . . , y(a), u, u, . . . , u(b)) = 0

(5.1)

Control of the inertia wheel inverted pendulum with experiments 123

Given that this finite dimensional ODE is smooth enough, it can be approximated for a short time-window by the following simplified model:

y() = F + u

(5.2)

The derivation order  and the constant parameter   R can be arbitrarily chosen by the designer. In model-free control literature,  is generally chosen to be 1 or 2. The nonphysical constant  is a design parameter. F  R captures all the unknown nonlinearities in the input­output behavior and can be compensated in the control
law. Since (5.2) is valid for a short time window, it must be updated at each sample time. Therefore, the value of F is updated from the measurement of u and y() in the
following manner:

[F(k)]e = [y()(k)]e - u(k - 1)

(5.3)

where [F(k)]e is the estimated value of F at sample time k which will be used for the computation of the control input u(k). [y()(k)]e is the estimated value of the th derivative of the output y at discrete time k and u(k - 1) is the control input previously
applied at discrete time k - 1. The value of F can be initialized to 0 at initial time
k = 0.

5.3.1.2 The control law
Given numerical knowledge of F (based on estimation) expressed by (5.15), the control input may cancel the unknown nonlinearities and add compensating terms corresponding to a closed-loop tracking of a given reference trajectory y(t) using a conventional PID controller resulting in an intelligent-PID (often referred to as i-PID):

u

=

1 

-F + y() + Kpe + Ki

e + Kd e

(5.4)

where y() is the th derivative of the reference trajectory y. Kp, Ki, Kd are the PID feedback gains, e = y - y is the output tracking error, and e is its first time-derivative.
The tuning of the PID feedback gains can be performed using poles placement tech-
niques since all nonlinearities are supposed to be canceled. It is no longer necessary to perform complex system identification [13,14]. If  = 1, the PID controller reduces to a PI controller since the first derivative of output y is taken into account in the
estimation of F in (5.15).

5.3.2 Proposed control solution
In our case, we are interested in tracking of periodic reference trajectories for stable limit cycles generation on underactuated mechanical systems (mainly known as nonlinear and nonminimum phase) and particularly the inertia wheel inverted pendulum. In order to simplify our presentation of the control problem as well as the proposed solution, let as focus on 1-input­2-degree-of-freedom underactuated mechanical systems (these are the minimum dimensions for a system to be underactuated) without

124 The inverted pendulum in control theory and robotics

loss of generality. The dynamics of such systems takes the following Lagrangian matrix form [29,33]:

M (q)q¨ + H (q, q) + G(q) = Ru

(5.5)

where M  R2×2 is the inertia matrix of the system, q  R2 is the vector of generalized coordinates. q, q¨  R2 are, respectively, their first and second time-derivatives. H  R2 is a vector of centrifugal and Coriolis forces and G  R2 is a vector of gravitational terms. u  R is the control input and R  R2×1 is a matrix distributing the effects of u on the generalized coordinates of the system. Consider the following partition q = [qa, qna]T of the vector of generalized coordinates, where qa is the actuated coordinate
and qna is the unactuated one, then (5.5) may be rewritten as:

m11(q)q¨a + m12(q)q¨na + h1(q, q) + g1(q) = u m21(q)q¨a + m22(q)q¨na + h2(q, q) + g2(q) = 0

(5.6) (5.7)

with:

M=

m11 m12 m21 m22

;

H=

h1 h2

;

G=

g1 g2

(5.8)

We suppose that the state of the system is the vector [qa qna qa qna]T . Our goal is to generate stable limit cycles on both actuated and unactuated
coordinates of the underactuated mechanical system described by (5.6) and (5.7).

5.3.2.1 Basic principle of the proposed control scheme

A family of p-parameterized  -periodic reference trajectories qna(p,  , t) should be defined for the unactuated coordinate. Those trajectories should have the same bound-

ary conditions for all p values, allowing the controller to switch from one trajectory to

another while keeping the overall trajectory smooth. Thanks to the dynamic coupling

existing between the actuated and unactuated coordinates of the system, it is possible

to control the unactuated coordinate using the control input u (i.e., the torque on the

actuated coordinate) which allows those trajectories to be tracked on the unactuated

coordinate qna using the control input u. Indeed, the dynamics (5.6) and (5.7) can be rewritten in a form with a relation
between unactuated coordinate and control input [30]. First, (5.6) is solved for q¨a1:

q¨a = m1-11(-m12q¨na - h1 - g1 + u) .

(5.9)

Injecting this solution in (5.7) leads to:

m2q¨na + h2 + g2 = -m21m-111u

(5.10)

where m2 = m22 - m21m1-11m12, h2 = h2 - m21m1-11h1 and g2 = g2 - m21m1-11g1. Based on the resulting dynamics (5.10), involving a relationship between q¨na and
u, a model-free controller can then be designed to perform the tracking of reference

trajectories on unactuated coordinate qna using the control input u. However, since

1For clarity reasons, the dependency in q and q of the involved terms is omitted in the adopted notation.

Control of the inertia wheel inverted pendulum with experiments 125

p

Stabilizing

model-free

controller

Trajectory generator

y*

e

+-

Tracking model-free controller

u Controlled y system

Figure 5.3

Schematic view of the proposed dual model-free controller. The
controlled system has as output y and as input u. The reference output trajectories y are generated given a parameter p, and tracked by the
first model-free controller (called also tracking controller) based on the evaluation of the error e = y - y. The parameter p is updated at each period by the second model-free controller (called also stabilizing
controller)

the internal dynamics of the system is unstable (the inertia wheel is a nonminimum
phase underactuated mechanical system), even a perfect tracking of these trajectories
cannot guarantee the stability of the internal dynamics of the system (i.e., the inertia
wheel dynamics). Consequently, a second controller is needed to manage the stability
of the system's internal dynamics.
Indeed, the closed-loop system dynamics can be obtained by substituting u in (5.6) by its value taken from (5.7). This requires the invertibility of -m21m-111 and particularly of m21. This invertibility constraint is also known as Strong Inertial Coupling [35]. The resulting internal dynamics is then the following:

q¨a + m1-21m22q¨na + m1-21h2 + m1-21g2 = 0.

(5.11)

Note that q¨na depends on the control input u and therefore on the reference parameterized trajectory and its design parameter p. This second controller therefore will acts on the reference trajectory's parameter p (this parameter is considered as the control input to be generated by this second controller) in the aim of keeping the stability of the internal dynamics of the system (i.e., the actuated coordinate is considered as the output to be controlled). In other words, a periodic parameterized reference trajectory is tracked on the unactuated coordinate by the first controller, and at the end of each period, the second controller chooses the new trajectory parameter p in order to stabilize the actuated coordinate. The chosen parameter p is used in the reference trajectory of the forthcoming cycle. The overall control scheme is illustrated in the block-diagram of Figure 5.3.

5.3.2.2 Cyclic reference trajectories generation
The proposed control framework needs a trajectory generator to provide parameterized reference trajectories qna(p,  , t) to be tracked on the unactuated coordinate of the system. The proposed trajectories must fulfill some necessary conditions. First of

126 The inverted pendulum in control theory and robotics

all, they have to be continuous, time-derivable and periodic in order to generate limit

cycles. This consideration leads to design oscillatory shaped trajectories which are

split up in half period, where we will use symmetry to generate the whole cycle. The

parametrization of these trajectories must allow the controller to update the parameter

p (which corresponds to the time at which the trajectory qna crosses zero) during tracking, while the overall trajectory remains smooth. This leads to some initial and

final conditions of each half period part. That is for a given period  and amplitude

2A:

 

qna(p,



,

0)

=

qna(p,



,



)

=

A

p



P,



qna(p, q na (p,

 

, ,

 2

)

=

-A

0) = qna(p,

,

 2

)

=

q na (p,



,



)

=

0

(5.12)

for some domain P  R (chosen to keep an oscillatory shape). We propose to use a six-degree polynomial function parameterized with p such that:

p  P, qna(p,  , t = p) = 0

(5.13)

Figure 5.4 shows normalized reference trajectories (for  = 2 and A = 1) for different values of the parameter p during half a period. The domain P is restricted to interval
[pmin, pmax] guaranteeing an oscillatory shape trajectory. It is worth to note, due to the symmetry property of half period trajectory parts, pmin = 1 - pmax.

5.3.2.3 The dual model-free controller Consider the design of a model-free tracking controller (the first controller in the control framework of Figure 5.3). The first step is to consider the unactuated coordinate

1.5

p = 0.5

1

p = pmax p = pmin

p > pmax

0.5

p < pmin

0

-0.5

-1

-1.5

0

0.2

0.4

0.6

0.8

1

Figure 5.4 Examples of normalized reference trajectories during a half-period for different values of p, the period  is 2 s and the amplitude 2A is 2

Control of the inertia wheel inverted pendulum with experiments 127

nonlinear dynamics (5.10) to be replaced by a local model according to model-free control principle:

q¨na = F1 + 1u

(5.14)

where the constant parameter 1 is a control design parameter. The term F1 is supposed to capture the nonlinearities in the unactuated coordinate dynamics and is updated at each sample time according to the following equation:

[F1(k)]e = [q¨na(k)]e - 1u(k - 1)

(5.15)

where the notation [.]e states for the estimated value. The tracking controller is obtained using numerically computed value of F1 in
(5.15) using the first model-free controller (i-PID) as follows:

1 u=
1

-F1 + q¨na(p,  , t) + Kp1e + Ki1

e + Kd1e

(5.16)

where the feedback gains Kp1, Ki1, Kd1 can be chosen using poles placement technique

based on the assumption that the system's nonlinearities are compensated by the

term F1. The unactuated coordinate qna should follow therefore the desired periodic

trajectory qna(p,  , t).

The parameter p, in the tracking control input (5.16), is constant over half a

period, i.e., i.e., at time

t

k

 2



[k

 2

(k

+

1)

 2

],

k



N

and

is

updated

at

the

end

of

each

, k  N by a second model-free controller to be designed.

half

period,

For that purpose, let us consider now the dynamics of the actuated coordinate of

the system. This dynamics may be approximated by the following local discrete-time

model:

 va = F2 + 2p

(5.17)

where



va

=

q a (k

 2

)

-

q a ((k

-

1)

 2

)

is

the

variation

of

the

velocity

of

the

actuated

joint (inertia wheel) va = qa measured between half periods and the constant 2 is

a control design parameter. According the basic principle of model-free control the

value

of

F2

is

updated

at

the

end

of

each

half

cycle

(t

=

k

 2

for

k



N)

as

follows:



F2

k 2

=
e

 qa

 k
2

- 2p
e

(k - 1)  2

(5.18)

Note that continuous dynamics of the actuated coordinate within the half cycle t =

[k

 2

(k

+

1)

 2

]

is

not

taken

into

account

in

this

local

model.

The

idea

is

that

we

only

aim at limit cycle generation on this coordinate; therefore, it is only required that its

evolution should be periodic. In other words, the aim of the second controller is to

bring the actuated coordinate as close as possible to a fixed desired state (qad, qad) at the end of each half period, ensuring a certain periodicity of its evolution, leading

therefore to limit cycles generation. The resulting second model-free controller should

updates the trajectory parameter p according to the following control law:

p

=

1 2

-F2 + Kp2(qad - qa) + Ki2

(qad - qa) + Kd2(qad - qa)

(5.19)

128 The inverted pendulum in control theory and robotics

qa u
qna G

z
y x

O

Figure 5.5

Principle schematic view of the inertia wheel inverted pendulum: the joint between the frame and the beam is unactuated (passive joint), while the one between the beam and the inertia wheel is actuated (active joint)

where Kp2, Ki2, Kd2 are the PID feedback gains. It is worth to note that since the desired state for actuated coordinate (qad, qad) is constant, the (  qa) d term should be zero and is then omitted.

5.4 Application: the inertia wheel inverted pendulum system

The testbed of the inertia wheel inverted pendulum is presented in Section 5.2. The basis of its mechanical structure is illustrated in Figure 5.5. The actuator produces an angular acceleration of the rotating inertia wheel which generates, thanks to the dynamic coupling between coordinates, a torque acting on the pendulum's passive joint; therefore, this passive joint can be controlled through the acceleration of the inertia wheel. The goal of the proposed control solution (as introduced in Section 5.3) is to generate stable limit cycles on both coordinates (actuated and unactuated) using only one control input (namely the torque applied to the inertia wheel). The idea is to control the angular position qna of the pendulum with respect to the vertical by the first controller (tracking controller in Figure 5.3), while the angular velocity of the inertia wheel (system's internal dynamics) is controlled by the second controller (stabilizing controller in Figure 5.3).

5.4.1 Dynamic modeling of the system

The mechanical structure of the inertia wheel inverted pendulum is sketched in Figure 5.5. The nonlinear dynamic model [4] of the plant is obtained using Lagrange formulation [32] and is given by:

(I1 + I2) q¨na + I2q¨a - mlg sin qna = 0 I2(q¨na + q¨a) = u

(5.20) (5.21)

Control of the inertia wheel inverted pendulum with experiments 129
Table 5.1 Description of dynamic parameters of the inertia wheel inverted pendulum

Parameter
m1 m2 I1 I2 l1 l2

Description
Body mass Wheel mass Body inertia Wheel inertia Body CoM position Wheel CoM position

Value
3.228 0.86422 3.042 × 10-2 7.986 × 10-4 6.354 × 10-4 52 × 10-3

Unit
kg kg kg m2 kg m2 m m

where I1, I2 are, respectively, the moments of inertia of the beam and the wheel. u is the torque generated by the motor acting on the inertia wheel. ml = m1l1 + m2l2 with m1 and m2 being the masses of the pendulum and the inertia wheel. l1, l2 are distances from origin O (cf. Figure 5.5) to the gravity centers of the pendulum and the rotating mass (respectively). This model has the general form (5.6) to (5.7) of dynamics of underactuated mechanical systems. The dynamic parameters of the inertia wheel inverted pendulum system are summarized in Table 5.1.
5.5 Numerical simulations
Reference trajectories are generated for the unactuated coordinate qna as presented in Section 5.3.2.2. The trajectories amplitude is 2A = 6 and period is  = 2 s. Numerical simulations have been performed using MATLAB®/Simulink® software of MathWorks. It is worth noting that the dynamic model (5.20) and (5.21) is used to simulate the dynamic behavior of the system, it is not used in the controller design.
The following design parameters were used in the implemented control scheme: 1 = -100, 2 = 50, the feedback gains of the first controller (tracking controller) are as follows: Kp1 = 200, Ki1 = 0 and Kd1 = 100. The feedback gains of the second controller (stabilizing controller) are given by: Kp2 = Ki2 = 0 and Kd2 = 1. The sampling frequency is set to 150 Hz which is a reasonable value for real-time implementation. The desired state for the inertia wheel velocity (controlled by the second controller) is set to qad = 0.
The obtained simulation results are depicted in Figure 5.6. It is worth to note that a disturbing torque of intensity 0.5 N m is applied to the pendulum beam at time t = 15 s. The convergence to a stable limit cycle can clearly be observed on the phase portrait of the pendulum angle qna. The controller reacts immediately to the disturbance as we can see a spike in the control signal (cf. Figure 5.6(e)). This disturbance induces a deviation from the reference trajectories of the pendulum angle position and velocity which is immediately compensated. Despite the big deviation of

130 The inverted pendulum in control theory and robotics

0.25 0.2 0.15 0.1 0.05
0 -0.05 -0.1
0 (a)

0.3

0.2

0.1

0

-0.1

-0.2

-0.3

-0.4 5 10 15 20 25 30 0

Time [s]

(b)

0.3

0.2

0.1

0

-0.1

-0.2

-0.3

-0.4 5 10 15 20 25 30 -0.1-0.05 0 0.05 0.1 0.15 0.2 0.25

Time [s]

(c)

Time [s]

250 200 150 100 50
0 -50 -100
0 (d)

1 0.5

0

-0.5 5 10 15 20 25 30 0

Time [s]

(e)

1 0.8 0.6 0.4 0.2
0 -0.2 -0.4 -0.6 -0.8
-1

5 10 15 20 25 30 0

Time [s]

(f)

2.5 × 104

2

1.5

Steady state

Transient

1

0.5

0 0 0.05 0.1 0.15 0.2 0.25 0.3

(g)

Time [s]

5 10 15 20 25 30 Time [s]

Figure 5.6

Simulation results. A punctual external disturbance is introduced as a
torque applied at time t = 15 s to the pendulum beam. (a) Pendulum
position qna [rad] real position (solid line) and desired position (dashed line). (b) Pendulum velocity qna [rad · s-1] real velocity (solid
line) and desired velocity (dashed line). (c) Phase portrait of the pendulum (qna [rad], qna [rad · s-1]). (d) Inertia wheel velocity qa [rad · s-1]. (e) Control input u[N · m] versus time. (f) evolution of parameter p [ - ]. (g) Motor rotationnal speed [rpm] vs Absolute motor torque [N · m]

the inertia wheel velocity oscillations at the beginning of the simulation due to nonzero initial conditions and just after the disturbance, the second controller successfully brings back the inertia wheel velocity trajectory to a periodic trajectory. Indeed, the internal dynamics of the systems converges also to a stable limit cycle. To check the admissibility of the scenario to be implemented on the real system, the motor power admissibility is depicted in Figure 5.6(g), where it can be seen clearly that the trajectories are inside the admissible region.

Control of the inertia wheel inverted pendulum with experiments 131

0.15

0.5

0.5

0.1

0

0

0.05

0

-0.5

-0.5

-0.05

-0.1

-1

-1

0 5 10 15 20 25 30 35 0 5 10 15 20 25 30 35 -0.1 -0.05 0 0.05 0.1 0.15

(a)

Time [s]

(b)

Time [s]

(c)

Time [s]

150 100 50
0 -50 -100 -150
0 (d)

1

0.8

0.6

0.4

0.2

0

-0.2

-0.4

-0.6

-0.8 5 10 15 20 25 30 35 0

Time [s]

(e)

1 0.8 0.6 0.4 0.2
0 -0.2 -0.4 -0.6 -0.8
-1

5 10 15 20 25 30 35 0

Time [s]

(f)

5 10 15 20 25 30 35 Time [s]

2.5 × 104

2

1.5

Steady state

Transient

1

0.5

0 0 0.05 0.1 0.15 0.2 0.25 0.3

(g)

Time [s]

Figure 5.7

Real-time experimental results in nominal case, without external
disturbances. (a) Pendulum position qna real position (solid line) and desired position (dashed line). (b) Pendulum velocity qna real velocity (solid line) and desired velocity (dashed line). (c) Phase portrait of the pendulum (qna, qna). (d) Inertia wheel velocity qa. (e) Control input u versus time. (f) Evolution of parameter p. (g) Check of power
admissible-region of the actuator

5.6 Real-time experiments
Real-time experiments are achieved thanks to the experimental testbed described in Section 5.2. It is worth to note that the control design parameters used for these experiments are different from those used in numerical simulation. The first controller parameters are chosen as 1 = -150, Kp1 = 70, Ki1 = 0 and Kd1 = 12. For the Second controller the following parameters are used 2 = 70, Kp2 = 0, Ki2 = 0 and Kd2 = 1. Noise filtering was performed through the use of an alpha-beta filter [25]

132 The inverted pendulum in control theory and robotics
to correctly estimate the pendulum acceleration used in (5.15). The following two experimental scenarios have been considered:  control in nominal case,  external disturbance rejection.
5.6.1 Scenario 1: Control in nominal case
In this first scenario, no external disturbances have been considered. The obtained results for this scenario are depicted in Figure 5.7. The experiment was started by an initial angular position corresponding to a pendulum body at the mechanical stop, introducing an initial position error of 0.125 rad (i.e., 7.16). Despite this initial error, the controller was able to steer rapidly the system toward the periodic reference trajectory as it can be observed on Figure 5.7(a). The convergence to a stable limit cycle is clearly visible in Figure 5.7(c). The control inputs are shown in Figure 5.7(e) for the first controller and in Figure 5.7(f) for the second one. The motor power admissibility is illustrated through the plot of Figure 5.7(g) showing the evolution of the motor speed (absolute value) versus its torque (absolute value).
5.6.2 Scenario 2: External disturbance rejection
In this experiment, external disturbances are introduced by pushing the pendulum body in a punctual manner as illustrated in Figure 5.8. Two external disturbances have been introduced at approximately t1 = 12 s and t2 = 23 s. The obtained experimental results are plotted in Figure 5.9. Noise in measurement is observable on all plots, particularly amplified on the pendulum velocity qna in Figure 5.9(b). Despite this fact, the first controller was able to track the reference trajectory on the pendulum (cf. Figure 5.9(a)). The effect of the introduced external disturbances can clearly be observed on the pendulum trajectories in Figure 5.9(a) and the control input in Figure 5.9(e). The tracking controller brings back rapidly the pendulum position and velocity to their respective reference trajectories. The convergence to a stable limit cycle is clearly visible on the phase portrait of the pendulum shown on Figure 5.9(c).
Fdist
Figure 5.8 Illustration of the external disturbance action applied on the pendulum body during experiments

Control of the inertia wheel inverted pendulum with experiments 133

0.15 0.1 0.05
0 -0.05 -0.1
0 (a)

0.8

Disturbances

0.6

0.4

0.2

0

-0.2

-0.4

-0.6

-0.8

-1

5 10 15 20 25 30 35

0

Time [s]

(b)

0.8

0.6

0.4

0.2

0

-0.2

-0.4

-0.6

-0.8

Disturbances

-1

5 10 15 20 25 30 35 -0.1 -0.05

Time [s]

(c)

0 0.05 Time [s]

0.1 0.15

200

1

1

150

0.8

100

0.5

0.6

0.4

50

0

0.2

0 -50 -100 -150 -200
0

-0.5
-1
-1.5 5 10 15 20 25 30 35 0

0 -0.2 -0.4 -0.6 -0.8 Disturbances -1
5 10 15 20 25 30 35 0

5 10 15 20 25 30 35

(d)

Time [s]

(e)

Time [s]

(f)

Time [s]

2.5 × 104

2

1.5

Steady state

Transient

1

0.5

0 0 0.05 0.1 0.15 0.2 0.25 0.3

(g)

Time [s]

Figure 5.9

Real-time experimental results. Two external disturbances have been
introduced at approximately t1 = 12 s and t2 = 23 s on the pendulum
body. (a) Pendulum position qna [rad] real position (solid line) and desired position (dashed line). (b) Pendulum velocity qna [rad · s-1]
real velocity (solid line) and desired velocity (dashed line). (c) Phase portrait of the pendulum (qna [rad], qna [rad · s-1]). (d) Inertia wheel velocity qa [rad · s-1]. (e) Control input u [N · m] versus time. (f) Evolution of parameter p [-]. (g) Motor rotational speed [rpm] vs Absolute motor torque [N · m]

The evolution of the inertia wheel velocity is depicted in Figure 5.9(d). Indeed, the introduced disturbances induce a shift in the inertia wheel velocity trajectory cycle. However, thanks to the second controller reaction, which is observable in Figure 5.9(f), the inertia wheel velocity converges back to the limit cycle in few periods. The absolute value of motor velocity versus the generated torque are displayed in Figure 5.9(g) to check the admissible-region of the actuator. Notice that the obtained trajectory remains, throughout the experiments, within the admissible region of the actuator's power.

134 The inverted pendulum in control theory and robotics
5.7 Conclusion
This chapter deals with the control problem of the inertia wheel inverted pendulum. This benchmark belongs to the class of underactuated mechanical systems. The proposed control solution, based on model-free control technique, includes two controllers to deal with stable limit cycle generation. The first controller (called tracking controller) is used to control the angular position of the pendulum (unactuated coordinate), while the angular velocity of the inertia wheel (actuated coordinate) is controlled by the second controller (called stabilizing controller). Indeed, to stabilize the resulting internal dynamics of the system, a family of p-parameterized periodic trajectories is generated and tracked by the first controller, while their parameter p is on-line updated by the second controller in the aim of improving the behavior the internal dynamics (i.e., convergence to a stable limit cycle). To validate the proposed control scheme, numerical simulations as well as real-time experiments are introduced. They show the effectiveness of the proposed control scheme as well as its ability to reject external disturbances. Future work may include the extension of the proposed control scheme to endow it with an automatic adaptive tuning of the parameters of the controllers, as well as its generalization to the case of underactuated systems with more than one degree of underactuation.
References
[1] C.F. Aguilar-Ibanez, O.O. Gutierrez F, and M.S. Suarez Castanon. `Stabilization of the strongly damping inertia wheel pendulum by a nested saturation functions', In Proc. of American Control Conference, 2008, pp. 3434­3439.
[2] S. Andary and A. Chemori. `A dual model-free control of non-minimum phase systems for generation of stable limit cycles', In IEEE CDC­ECC, Orlando, FL, USA, 2011, pp. 1387­1392.
[3] S. Andary, A. Chemori, M. Benoit, and J. Sallantin. `A dual model-free control of underactuated mechanical systems, application to the inertia wheel inverted pendulum', In American Control Conference (ACC'12), Montréal, Canada, 2012, pp. 1029­1034.
[4] S.Andary, A. Chemori, and S. Krut. `Control of the underactuated inertia wheel inverted pendulum for stable limit cycle generation', Advanced Robotics, 2009, 23, pp. 1999­2014.
[5] S. Andary, A. Chemori, and S. Krut. `Estimation-based disturbance rejection in control for limit cycle generation on inertia wheel inverted pendulum testbed', In IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS'09), St. Louis, MO, USA, 2009, pp. 1302­1307.
[6] M. Bergerman. Dynamics and Control of Underactuated Manipulators. PhD Thesis, Carnegie Mellon University, 1996.
[7] W. Blajer and K. Kolodziejczyk. `Modeling of underactuated mechanical systems in partly specified motion', Journal of Theoretical and Applied Mechanics, 2008, 46, 2, pp. 383­394.

Control of the inertia wheel inverted pendulum with experiments 135
[8] R. Bourdais, M. Fliess, C. Join, and W. Perruquetti. `Towards a model-free output tracking of switched nonlinear systems', In NOLCOS 2007--7th IFAC Symposium on Nonlinear Control Systems, Pretoria, South Africa, 2007.
[9] N. Khraief A. Chemori and S. Belghith. External disturbance rejection in IDAPBC controller for underactuated mechanical systems: from theory to real-time experiments. In IEEE Multi-Conference on Systems and Control (MSC'14), Antibes, France, 2014, pp. 1747­1752.
[10] A. Choukchou-Braham, B. Cherki, M. Djemai, and K. Busawon. Analysis and Control of Underacuated Mechanical Systems. London, UK: Springer, 2014.
[11] B. D'Andrea Novel, M. Fliess, C. Join, H. Mounier, and B. Steux. `A mathematical explanation via "intelligent" PID controllers of the strange ubiquity of PIDs'. In 18th Mediterranean Conference on Control and Automation, MED'10, Marrakech Morocco, 2010.
[12] I. Fantoni and R. Lozano. Non-linear Control for Underactuated Mechanical Systems. New York, USA: Springer-Verlag, 2001.
[13] M. Fliess and C. Join. `Intelligent PID controllers', In 16th Mediterranean Conference on Control and Automation, Ajaccio, France, 2008.
[14] M. Fliess and C. Join. `Model-free control and intelligent PID controllers: towards a possible trivialization of nonlinear control?', In 15th IFAC Symposium on System Identification (SYSID 2009), Saint-Malo, France, 2009.
[15] M. Fliess, C. Join, M. Mboup, and H. S. Ramirez. `Vers une commande multivariable sans modèle', In Conférence internationale francophone d'automatique (CIFA 2006), Bordeaux, France, 2006.
[16] M. Fliess, C. Join, and H. S. Ramirez. `Non-linear estimation is easy', International Journal of Modelling Identification and Control, 2008, 4, pp. 12­27.
[17] T. I. Fossen. Nonlinear Modelling and Control of Underwater Vehicles. PhD Thesis, Norwegian Institute of Technology, 1991.
[18] L. B. Freidovich, P. La Hera, U. Mettin, A. Robertsson, and A. S. Shiriaev. `Shaping stable periodic motions of inertia wheel pendulum: theory and experiments', Asian Journal of Control, 2009, 11, 5, pp. 548­556.
[19] L. Freidovich, P. La Hera, U. Mettin, A. Robertsson, A. Shiriaev, and R. Johansson. `Shaping stable periodic motions of inertia wheel pendulum: theory and experiments', Asian Journal of Control, 2009, 11, 5, pp. 548­556.
[20] S. Ge and F. Lewis. Autonomous Mobile Robots. Boca Raton, FL, USA: CRC Press, 2006.
[21] S. Jadlovska and J. Sarnovsky. `A complex overview of modeling and control of the rotary single inverted pendulum system', Power Engineering and Electrical Engineering, 2013, 11, 2, pp. 73­85.
[22] S. Jadlovska and J. Sarnovsky. `Modeling and optimal control of nonlinear underactuated mechanical systems ­ a survey', In 13th Scientific Conference of Young Researchers ­ FEI TU of Kosice, Herlany, Slovakia, 2013, pp. 32­35.
[23] A. De Luca, R. Mattone, and G. Oriolo. `Stabilization of underactuated planar 2r manipulator', International Journal of Robust and Nonlinear Control, 2000, 10, 4, pp. 181­198.

136 The inverted pendulum in control theory and robotics
[24] M. Mboup, C. Join, and M. Fliess. `Numerical differentiation with annihilators in noisy environment', Numerical Algorithms, 2009, 50, pp. 439­467.
[25] R. Penoyer. `The alpha-beta filter', The C Users Journal, 1993, 11, 7, pp. 73­86.
[26] G. Poulin, A. Chemori, and N. Marchand. `Minimum energy oriented global stabilizing control of the PVTOL aircraft', International Journal of Control, 2007, 80, 3, pp. 430­442.
[27] N. Qaiser, S. B. Tariq, N. Haq, and T. Aziz. `A novel nonlinear implicit sliding surface controller design for inertia wheel pendulum', In Proceedings of the 10th WSEAS International Conference on Robotics, Control and Manufacturing Technology, ROCOM'10, Stevens Point, Wisconsin, USA, 2010, pages 21­25. World Scientific and Engineering Academy and Society (WSEAS).
[28] S. Riachy, M. Fliess, C. Join, and J.-P. Barbot. `Vers une simplification de la commande non linéaire: l'exemple d'un avion à décollage vertical', In Sixième Conférence Internationale Francophone d'Automatique, CIFA 2010, Nancy, France, 2010.
[29] L. Sciavicco and B. Siciliano. Modeling and Control of Robot Manipulators. New York: McGraw-Hill, 1996.
[30] M. Spong. `Partial feedback linearization of underactuated mechanical systems', In EEE/RSJ/GI International Conference on Intelligent Robots and Systems, Munich, Germany, 1994, pp. 314­321.
[31] M. Spong. `The swing up control problem for the acrobot', IEEE Control Systems Magazine, February 1995, 15, 1, pp. 49­55.
[32] M. Spong and M. Vidyasagar. Robot Dynamics and Control. New York, USA: John Wiley and Sons, 1989.
[33] Mark W. Spong. Underactuated mechanical systems. In Control Problems in Robotics and Automation. London, UK: Springer-Verlag, 1998.
[34] M. W. Spong, P. Corke, and R. Lozano. Nonlinear control of the inertia wheel pendulum. Automatica, 1999, 37, pp. 1845­1851.
[35] M.W. Spong. `Partial feedback linearization of underactuated mechanical systems', In Proceedings of the IEEE/RSJ/GI International Conference on Intelligent Robots and Systems '94, 1994.
[36] N. Touati and A. Chemori. `Predictive control for the stabilization of a fast mechatronic system: from simulation to real-time experiments', In International IFAC Symposium on Mechatronic Systems (Mechatronics'13), Hangzhou, China, 2013, pp. 237­242.

Chapter 6
Output feedback second-order sliding-mode tracking control for perturbed inertia wheel pendulum
Luis T. Aguilar1 and Rafael Iriarte2
We address the robust output feedback tracking control problem for an inertia wheel pendulum in the presence of uniformly bounded matched disturbances. The periodic motion of the pendulum will be at the upright position which corresponds to the unstable equilibrium point of the unforced system. A two-relay-controller-based reference model was developed for generating the desired trajectories to be tracked by the unactuated link of the inertia wheel pendulum and then design an output feedback robust tracking controller. The desired amplitude and frequency were tuned by choosing the two-relay control gains properly. A second-order sliding-mode tracking controller interconnected with a second-order sliding-mode observer was capable to track the prescribed reference trajectory rejecting matched external disturbances. Performance issues of the constructed controller-observer were illustrated in a numerical study.
6.1 Introduction
For nonlinear mechanical systems, tracking control problem is known to be more difficult than stabilization mainly for underactuated systems whose initial conditions are close to an unstable equilibrium point. The tracking problem for nonminimumphase systems is a challenging topic in control since that further research applications in the motion control of underactuated systems have gone in many directions. Orbital stabilization problems where underactuated systems are evolved are the coordinated motion of biped robots [8,11,20], gymnastic robots, electrical converters [1,18], and others (see, e.g., [10,22] and references therein).
A strategy addressing the self-oscillation and motion planning for a class of underactuated systems is presented in [2] based on the two-relay controller methodology. In previous works [3­5], the oscillations at the output are generated for an inertia wheel pendulum using such methodology without a tracking controller, reason that we called
1Instituto Politécnico Nacional, México 2Department of Control and Robotics, National University of Mexico, UNAM, Mexico

138 The inverted pendulum in control theory and robotics
self-oscillation. The drawback of the method is that the closed-loop system turns out to be high sensitive to disturbances and the formulas of the two-relay controller are function of parameters of the plant. In other words, the deviation of the frequency and amplitude of the periodic trajectory at the output of the closed-loop structure proposed in [3­5] with respect to the desired ones, is related with the uncertainties of the parameters of the plant because formulas to compute the two values of the two-relay controller depends on the exact knowledge of the physical parameters (e.g., inertias, length of the links, and masses), while neglected dynamics, as friction, were not considered as part of the formulas. Iriarte et al. [12] develop the two-relay controller robustified with a state-feedback tracking controller, complemented with experimental verification, dealing with such inaccuracies. However, the output feedback case has remained unaddressed in the above papers.
The aim of this chapter is to solve the output feedback-tracking control problem for the inertia wheel pendulum under the presence of undesired disturbances. The periodic motion of the pendulum will be at the upright position which corresponds to the unstable equilibrium point of the unforced system. A two-relay-controllerbased reference model was used for generating the desired trajectories to be tracked by the unactuated link of the inertia wheel pendulum and then, design an output feedback robust tracking controller. The second-order sliding-mode observer was taken from [16]. The desired amplitude and frequency were set by choosing the tworelay control gains according to the formulas obtained from the describing function method [13]. This chapter also refines the results of [12] where the asymptotical stability proof of the closed-loop system is revisited.
The chapter is organized as follows. In Section 6.2, we give the dynamic model of the plant and define the problem statement. Moreover, the trajectory generation, via two-relay controller, to be tracked by the output of the plant is revised. In Section 6.3, the variable structure observer is designed to estimate the velocity of the motor and the pendulum. In Section 6.4, a second-order sliding-mode control is synthesized to guarantee robust tracking of the reference trajectory. Numerical results illustrate the performance of the proposed output feedback controller in Section 6.5. Finally, conclusions are provided in Section 6.6.

6.2 Dynamic model and problem statement

Dynamics of an inertia wheel pendulum, taken from [7], augmented with viscous friction and disturbances can be described as follows:

J1 J2 J2 J2

v1 + h sin q1 = 0  + w,

v2

fsv2

1

(6.1)

y = [q1, q2]T .

(6.2)

In the above equation, q1(t)  R is the absolute angle of the pendulum, counted clockwise from the vertical downward position, q2(t)  R is the absolute angle of the disk, v1(t) = q1(t) and v2(t) = q2(t) are the angular velocity of the pendulum and the

Output feedback second-order sliding-mode tracking control 139
q2 
g l q1

Figure 6.1 Inertia wheel pendulum

wheel, respectively; t  R+ is the time, y(t)  R2 is the measurement output,   R
is the controlled torque applied to the disk (see Figure 6.1), fsv2 represents the viscous friction force affecting the actuator where fs > 0 is the viscous friction coefficient, J1 and J2 are positive parameters denoting the inertia of the pendulum and that of the wheel, respectively; the factor h = mgl depends on the combined mass m of the
overall wheel pendulum, on the gravitational constant g, and on the length l of the link, and finally, w = (w1, w2)T are the external disturbances affecting the system. An upper bound Mi > 0, (i = 1, 2) for the magnitude of the disturbances is normally known a priori

sup |wi(t)|  Mi,
t

i = 1, 2.

(6.3)

It should be noted that the system (6.1) is nonlinear and underactuated. The control objective is to find  such that

lim
t

q1r(t) - q1(t)

=0

(6.4)

where q1r(t) is the desired trajectory of the pendulum. The desired trajectory is designed such that qr(t), qr(t), and q¨r(t)  R2 are uniformly bounded in t.

6.2.1 Generating desired trajectories centered at the upright equilibrium point

Let us recall from [12], the procedure to generate the set of trajectories for the inertia wheel pendulum to follow. First, let us consider the dynamics of the wheel pendulum in terms of the reference positions and velocities (qr, qr) without viscous friction

J1 J2 J2 J2

q¨ 1r q¨ 2r

+

h sin q1r 0

=

0 1

r .

(6.5)

Second, we need to find the reference torque r  R to produce a set of desired periodic motion of the underactuated link (y = q1r) such that the output has a periodic motion

140 The inverted pendulum in control theory and robotics

with desired frequency and amplitude Ap. Throughout, we confine our research interest in desired oscillations around the upright position of the pendulum which correspond to a challenging problem.
The inertia wheel pendulum has underactuation degree one satisfying certain structural property provided in [10] (see details in Appendix A). As a result, it is possible to make exact linearization thus achieving local stability of zero dynamics, that is,

p1 = q1r + J1-1J2q2r - 

(6.6)

 = J1q1r + J2q2r + Kp1

(6.7)

where K > 0 is a constant. The last term in (6.6) ensures that the desired trajectories will be generated around the equilibrium point q1r =  rad (see Figure 6.1). From the latter set of equations, it is easy to verify that

J1p1 =  - Kp1

(6.8)

while

 = KJ1-1J2q2r - h sin(q1r) + K q1r, ¨ = -h cos(q1r)q1r - KJ1-1h sin(q1r), ... = R(q1r, q1r) + H (q1r)r

(6.9) (6.10) (6.11)

where

H (q1r)

=

h cos(q1r) , J1 - J2

R(q1r, q1r)

=

h

q12r + H (q1r)

sin(q1r )

-

hK J1

q 1r

cos(q1r ).

Hence, we can take

(6.12) (6.13)

r = H -1(q1r) (ur - a0 - a1 - a2¨ - R(q1r, q1r)),

(6.14)

where H (qr) is nonsingular around the equilibrium point (q1r, q1r) = ( , 0), a0, a1,

and a2 are positive constants. Introducing the new state coordinates x = (x1, x2, x3)T =

(, , ¨)T , we obtain

 x1



 x2  = 

0 0

1 0

0 1

  x1 

 0

  x2  +  0  ur,

(6.15)

x3

-a0 -a1 -a2

x3

1

A

B

p 1

=

-

K J1

p1

+

1 J1

yr ,

yr = 1 0 0 x.

(6.16) (6.17)

C
Equation (6.16) constitutes the zero dynamics which is orbitally asymptotically stable [23].

Output feedback second-order sliding-mode tracking control 141

The following two-relay controller is proposed for the purpose of exciting a periodic motion in (6.15):

ur = -c1 sign(yr) - c2 sign(yr)

(6.18)

where c1 and c2 are scalars parameters designed such that the scalar-valued function

output yr(t) has a periodic motion with the desired frequency and amplitude Ap.

The formulas to compute c1 and c2, derived from the describing function method,

are [2]

c1

=

 

 4

 - 

Ap |W ( j
Ap

)|

4 |W ( j )|

-1
1 +  2 if  Q2  Q3
-1
1 +  2 elsewhere

(6.19)

c2 =  · c1

(6.20)

where W ( j) = C( jI - A)-1B is the corresponding transfer function of (6.15) and (6.17),  = -Im{W ( j )}/Re{W ( j )}, and the quadrants Qi (i = 1, . . . , 4) are defined as

Q1 = {  R : Re{W (j)} > 0, Im{W (j)}  0} Q2 = {  R : Re{W (j)}  0, Im{W (j)}  0} Q3 = {  R : Re{W (j)}  0, Im{W (j)} < 0} Q4 = {  R : Re{W (j)} > 0, Im{W (j)} < 0}.

(6.21) (6.22) (6.23) (6.24)

The difference between (6.18) and the second-order sliding-mode controller given, for example, in [15] is that c1 is not constrained to be positive and greater than c2. The orbital stability analysis of (6.5), (6.18) is detailed in [2, Ch. 3] and [12], and it is therefore omitted.

6.3 Observer design

In this work, the velocity estimation is carried out by a family of finite-time velocity observers [16]

Pendulum Wheel

q^1 = v^1 - l1p|q~1|1/2 sign(q~1) + pq~1

v^1

=

-

1 2

l2p

sign(q~ 1 )

+

3 2

|q~ 1

|1/2

sign(q~ 1 )

+

2p q~ 1

+

bp

q^2 = v^2 - l1w|q~2|1/2 sign(q~2) + wq~2

v^2

=

-

1 2

l2w

sign(q~ 2 )

+

3 2

|q~ 2 |1/2

sign(q~ 2 )

+

w2 q~2

+

bw 

(6.25) (6.26)

where q~1 = q^1 - q1 and q~2 = q^2 - q2 denote the estimation error of the position of the pendulum and the wheel, respectively; v^1 and v^2 are the estimated angular velocity of the pendulum and the wheel, respectively; p  0 and w  0 are nonnegative constants; bp = 1, bw = J1/J2 were chosen according to [16], and l1p, l2p, l1w, and l2w
are positive constants.

142 The inverted pendulum in control theory and robotics
6.4 Control synthesis

The control objective is to stabilize the pendulum around the desired trajectory and to keep the wheel velocity bounded. This last can be achieved by introducing a feedback from the rotor velocity. In this section, we will design an output feedback controller which ensures (6.4) while providing boundedness of v2(t) and attenuating external disturbances where the reference signal qr(t)  R2 is computed on line from (6.5), (6.14), and (6.18). The control law is based on the assumption that q(t)  R2 is the only measured variable.
Let the pendulum tracking error and the wheel velocity error be defined, respectively, as

e1(t) q1r(t) - q1(t), e1(t) q1r(t) - v^1(t), e2(t) q2r(t) - v^2(t).

(6.27) (6.28) (6.29)

Due to (6.1), (6.5)­(6.18), the errors dynamics are governed by

e¨1 = q¨1r + J2 (h sin(q1r - e1) - fs(q2r - e2)) - J2 (w1 - w2) + J2 

(6.30)

e¨2

=

q¨2r -

J2 h sin(q1r - e1) +

J1 fs(q2r - e2) -

1 (J1w2 - J2w1) -

J1 

(6.31)

where = (J1 - J2)J2. Under the following control law



=

- J2

(1

sign(e1)

+

2

sign(e1)

+

1e1

+

2e1

-



sign(e2))

- h sin(q1r - e1) + fs(q2r - e2) - J2 q¨1r

(6.32)

with parameters such that

1 > 2 > 2MJ2 -1 +  ,

1, 2,  > 0,

(6.33)

and using the fact that J1q¨1r + J2q¨2r = -h sin(q1r), the errors dynamics (6.31) result in

e¨1 = -1 sign(e1) - 2 sign(e1) - 1e1 - 2e1 +  sign(e2) - J2 (w1 - w2)

h

h

1

e¨2 = J2 sin(q1r - e1) - J2 sin(q1r) - (J1w2 - J2w1)

(6.34)

+

J1 J2

(1

sign(e1)

+

2

sign(e1)

+

1e1

+

2e1

-



sign(e2)).

(6.35)

Throughout, solutions of above system are defined in the sense of Filippov [9] as that of

a certain differential inclusion with a multivalued right-hand side. The discontinuous controller (6.32) consists of the linear gain -1e1 - 2e1, the twisting control part -1 sign(e1) - 2 sign(e1) which ensure robustness and finite-time stability, and the rest are the nonlinear compensation terms.

Output feedback second-order sliding-mode tracking control 143

To verify that (e1e, e1e, e2e)T = 0  R3 is an equilibrium point of the unperturbed closed-loop system, notice from (6.34) that

 sign(e2) = 1 sign(e1) + 2 sign(0) + 1e1,

(6.36)

since e1e = 0. Substituting the above equation into the last term of (6.35) together with e¨2 = 0, we find that e1e = 0.

Theorem 6.1. The controller introduced in (6.32) subject to parameters (6.33) ensures asymptotic stability of the equilibrium point e = (e1e, e1e, e2e)T = 0.

Proof. We break the proof in two steps. 1. Finite-time convergence of (e1, e1) to the origin. First, let us assume that v1(t)  v^1(t) and v2(t)  v^2(t). Now, we will demonstrate that (e1, e1) reach the origin asymptotically. To this end, we consider the Lyapunov function

V1

=

1 2

e1 T e1

1 + 2  1

e1 e1

+ 1|e1|

(6.37)

which is radially unbounded almost everywhere. The positivity of the Lyapunov function V1 is verified if and only if = T is positive definite and if 1 is also positive. In particular, matrix will be positive definite if 1 + 2 > 0 and if

1 + 2 - 2 > 0

(6.38)

are satisfied. By solving the latter quadratic inequality with respect to , we have

1 2

2

-

1 2

22

+ 41

<



<

1 2

2

+

1 2

22 + 41.

(6.39)

It is straightforward to show that the time derivative of V1 along the solution of the closed-loop system (6.34) and (6.35) satisfies

V1  -1e12 - (2 - )e12 - (2 -  - 2J2 -1M )|e1| - (1 - 2 -  - 2J2 -1M )|e1|,

(6.40)

where inequalities, due to (6.3),

J2 (w1 - w2)  J2 w1 - w2  2 J2 M

(6.41)

1 (J1w2 - J2w1)  1 J1w2 - J2w1  2 J1 M ,

(6.42)

has been used. The function V1 will be negative-definite provided that (6.33) and 2 -  > 0
are satisfied. Then, by applying [19, Th. 4.4] with parameters given in (6.33), it is
concluded that (6.4) is reached in finite-time ts.

144 The inverted pendulum in control theory and robotics

Now, we will proof that e2 will tends to the origin from ts to infinity. To this end, note that the remaining dynamics of the velocity error of the wheel (6.35) is

e¨2 = -J1J2-1 sign(e2).

(6.43)

Using the Lyapunov function V2(e2) = J1-1J2|e2| we have that

V2(e2) = - ,

(6.44)

therefore V2(e2) will be negative definite for all t  ts. 2. Boundedness of wheel velocity. Finally, we need to prove that e2 does not escape to infinity in finite time, that is, limtts e2(t) < . To this end, let us rewrite (6.35) as

e¨2 = -J1J2-1 sign(e2) + g(e1, e1, w)

(6.45)

where

h

h

1

g(e1, e1, w) = J2 sin(q1r - e1) - J2 sin(q1r) - (J1w2 - J2w1)

+

J1 J2

(1

sign(e1)

+

2

sign(e1)

+

1e1

+

2e1).

(6.46)

Since (6.41)­(6.42) and the fact that e1 and e1 decreases asymptotically to the origin (i.e., |e1(t)|  |e1(0)| and |e1(t)|  |e1(0)|), the following upper bound for g(e1, e1, w) is obtained

g(e1, e1, w)



2h J2

+

J1 J2

(1

+

2

+ 1|e1(0)| + 2|e1(0)|) +

2J1 M

.

=0

(6.47)

Consider now the following Lyapunov function

V (e2) = J1-1J2|e2|.

(6.48)

The time derivative of V (e2) along the solution of the closed-loop system (6.45)­ (6.46) is

V (e2) = -J1-1J2 sign(e2)e¨2 = -J1-1J2 sign(e2)(-J1J2-1 sign(e2) + g(e1, e1, w)) = - - J1-1J2 sign(e2)g(e1, e1, w)  - + J1-1J2 g(e1, e1, w)  - + J1-1J20

(6.49)

where inequality (6.47) has been used. Due to inequality (6.33), the time derivative of the Lyapunov function V (e2) is not negative definite. However, integrating V (e2(t))
from 0 to ts, we get

V (ts)  (J1-1J20 -  )ts + V (0)

(6.50)

Output feedback second-order sliding-mode tracking control 145

which implies

|e2(ts)|  (0 - J1J2-1 )ts + |e2(0)|.

(6.51)

Therefore, we conclude that e2 is finite for ts < .

6.5 Numerical results
In this section, we present simulation results using the laboratory inertial wheel pendulum manufactured by Quanser Inc., depicted in Figure 6.1 where J1 = 4.572 × 10-3 kg m2, J2 = 2.495 × 10-5 kg m2, and h = 0.3544 kg m2 s-2 (see [6]). The viscous friction coefficient fs = 8.80 × 10-5 N m s was identified by applying the procedure from [14]. Simulations were carried out to achieve the orbital stabilization of the unactuated link (pendulum) q1 around the equilibrium point q = ( , 0).
Setting = /2 rad/s and Ap = 0.07 as desired frequency and amplitude, respectively, we have c1 = 2 and c2 = -2 which have been computed from (6.19) and (6.20). Invoking [2, Th. 2.1], the system (6.15) was orbitally asymptotically stable under K = 1, a0 = 1, a1 = 2, and a2 = 1.

3.3

q1r [rad]

3.2

3.1

(a)

0

0.2

e1 [rad]

0

-0.2 0
(b) 1

^u2 [rad/s]

0

-1

(c)

0

2

 [N m]

1

0 0
(d)

5

10

15

20

25

5

10

15

20

25

5

10

15

20

25

5

10

15

20

25

Time [s]

Figure 6.2 Disturbance-free closed-loop system results: (a) desired trajectory to follow, (b) tracking pendulum position error, (c) wheel velocity, and (d) input torque

146 The inverted pendulum in control theory and robotics

3.3

q1r [rad]

3.2

3.1

(a)

0

0.5

e1 [rad]

0

-0.5 0
(b) 2

^u2 [rad/s]

0

-2 0
(c) 4

 [N m]

2

0 0
(d)

5

10

15

20

25

5

10

15

20

25

5

10

15

20

25

5

10

15

20

25

Time [s]

Figure 6.3 Perturbed closed-loop system results: (a) desired trajectory to follow, (b) tracking pendulum position error, (c) wheel velocity, and (d) input torque

The initial conditions for the inertia wheel pendulum, selected for the simulations, were close to q1(0) = 3 rad and q2(0) = 0 rad, whereas all the velocity initial conditions were set to v1(0) = v2(0) = 0 rad/s. The gains of the controller (6.32) were set to 1 = 5, 2 = 2, 1 = 2, 2 = 1, and  = 0.1. The gains of the observer (6.25)­ (6.26) were set to p = 0.1, w = 0.1, bp = 1, bw = 183.24, l1p = 10, l2p = 100, l1w = 100, and l2w = 10 × 103.
Figure 6.2 shows the desired trajectory to follow, the tracking pendulum position error, the wheel velocity, and the input torque for the disturbance-free case. This figure corroborates that second-order sliding-mode controller guarantee finite-time stabilization of the pendulum around the desired trajectory. In order to test the controller robustness, a harmonic external disturbance wi = 0.02 sin(t) (i = 1, 2) is then applied to the closed-loop system. Good performance and desired robustness properties of the controller are concluded from Figure 6.3.
6.6 Conclusions
In this paper, we have synthesized an output feedback second-order sliding-mode controller to solve the tracking control problem of the inertia wheel pendulum. Similar

Output feedback second-order sliding-mode tracking control 147
to [2], the periodic motion of the pendulum will be at the upright position around the unstable equilibrium point of the unforced system where the two-relay controller was also used to induce of oscillations at the scalar output of the inertia wheel pendulum reference model and then injected as desired trajectory to the closed-loop system. Such configuration allows to generate oscillations without depend on the neglected dynamics. Therefore, the resulting control law ensures rejection against bounded matched disturbances, while numerical study verifies the performance of the synthesized controller. The methodology allows to extend the results to a class of underactuated systems of relative degree one.

Appendix A
A.1 Normal form transformation of the inertia wheel pendulum reference model

In this Appendix we present the normal form transformation for the inertia wheel pendulum. To begin with, let us introduce the following Theorem extracted from [17, Th. 4.2.1].

Theorem 6.2. Consider an underactuated system with kinetic symmetry with respect to the unactuated variable q1 and fully actuated shape variables q2,

m11(q2)q¨1 + m12(q2)q¨2 + h1(q, q) = 0

(A.1)

m21(q2)q¨1 + m22(q2)q¨2 + h2(q, q) = .

(A.2)

Let  = (q2)u + (q, q) be the collocated partially linearizing change of control for (A.2). Assume all the elements of

 = m-111(q2)m12(q2)dq2

(A.3)

are exact one-forms and let  = d (q2). Then, there exists a global change of coordinates (i.e., diffeomorphism) obtained from the Lagrangian of the system

p1 = q1 + (q2)

(A.4)

L  = m11(q2)q1 + m12(q2)q2 = q1

(A.5)

that transforms the dynamics of the underactuated system in (A.2) into a cascade normal form in strict feedback form

p1 = m-111(q2)



=

-

V

(p1, q2  p1

)

q2 = ps

p2 = u,

(A.6) (A.7) (A.8) (A.9)

148 The inverted pendulum in control theory and robotics

where

q2

(q2) =

m1-11m12ds.

0

(A.10)

In addition, the (qt,  )-subsystem is a Lagrangian system with configuration vector qt that belongs to the reduced manifold Qr = (Q1 × Q2) with reduced Lagrangian

Lt

=

1 2

p T1

mr

(q2 )p 1

-

Vt (p1

-  (q2), q2)

(A.11)

that satisfies the unforced Euler­Lagrange equation

d Lt dt p1

-

 Lt  p1

= 0.

(A.12)

Let us consider the decomposition of (6.5) into its actuated and unactuated parts (A.2) with m11 = J1, m12 = m22 = J2, h1(qr, qr) = h sin(q1r), and h2(qr, qr) = 0. So, by Theorem 6.2, after applying the change of coordinates (A.5), that is

p1 = q1r -  + J1-1J2q2r



=

J1q1r + J2q2r

=

L ,
 q 1r

(A.13) (A.14)

the dynamics of the inertia wheel pendulum reference model into cascade system in strict feedback form is given by

q1r = J1-1 - J1-1J2q2r  = -h sin(q1r)
q¨2r = ur

(A.15) (A.16) (A.17)

where

(q2r) = J1-1J2q2r.

(A.18)

In the latter theorem, ur is an input which orbitally asymptotically stabilizes the system,  denote the generalized momentum conjugate to q1r, and L (qr, qr) = K(qr, qr) - V (qr) is the Lagrangian where K(qr, qr) and V (qr) denotes the kinetic and potential energy, respectively.
Defining the output as

 = Kp1 + 

(A.19)

along with (6.14) and (A.13)­(A.14), the system (A.15)­(A.17) in the coordinates (, , ¨, p1)T becomes (6.15)­(6.17). By applyingTheorem 6.1 from Grizzle et al. [10], it follows that the zero dynamics (6.16) is exponentially stable.

Output feedback second-order sliding-mode tracking control 149
Acknowledgments
L. Aguilar gratefully acknowledges the financial support from Consejo Nacional de Ciencia y Tecnología (CONACYT) under Grant number 268364. R. Iriarte acknowledges the financial support from UNAM-DGAPA PAPIIT Grant number IN112915.
References
[1] Albea, C., Canudas-de-Wit, C., and Gordillo, F. (2007). Adaptive control of the boost DC-AC converter. Proceedings of the IEEE International Conference on Control Applications, 611­616.
[2] Aguilar, L., Boiko, I., Fridman, L., and Iriarte, R. (2015). Self-Oscillations in Dynamic Systems--A New Methodology via Two-Relay Controllers. Birkhäuser, London, UK.
[3] Aguilar, L., Boiko, I., Fridman, L., and Freidovich, L. (2012). Generating oscillations in inertia wheel pendulum via two-relay controller. International Journal of Robust and Nonlinear Control, 22, 318­330.
[4] Aguilar, L., Boiko, I., Fridman, L., and Iriarte, R. (2009). Generating self-excited oscillations for underactuated mechanical systems via two-relay controller. International Journal of Control, 82(9), 1678­1691.
[5] Aguilar, L., Boiko, I., Fridman, L., and Iriarte, R. (2009). Generating selfexcited oscillations via two-relay controller. IEEE Transactions on Automatic Control, 54(2), 416­420.
[6] Åstrom, K., Block, D., and Spong, M. (2001). The Reaction Wheel Pendulum. Lecture Notes for the Reaction Wheel Pendulum (Part of the Mechatronics Control Kit). Quanser: Urbana-Champaign, IL.
[7] Block, D., Åstrom, K., and Spong, M. (2007). The Reaction Wheel Pendulum. Synthesis Lectures on Control and Mechatronics #1. Williston, VT: Morgan & Claypool Publisher.
[8] Chevallereau, C., Abba, G., Aoustin, Y., Plestan, E., Canudas-de-Wit, C., and Grizzle, J. (2003). Rabbit: a testbed for advanced control theory. IEEE Control Systems Magazine, 23(5), 57­79.
[9] Filippov, A. (1988). Differential Equations with Discontinuous Right-hand Sides. Kluwer Academic Publisher, Dordrecht.
[10] Grizzle, J., Moog, C., and Chevallereau, C. (2005). Nonlinear control of mechanical systems with an unactuated cyclic variable. IEEE Transactions on Automatic Control, 50(5), 559­576.
[11] Hurmuzlu, Y., Génot, F., and Brogliato, B. (2004). Modeling, stability, and control of biped robots--a general framework. Automatica, 40, 1647­1664.
[12] Iriarte, R., Aguilar, L., and Fridman, L. (2013). Second order sliding mode tracking controller for inertia wheel pendulum. Journal of the Franklin Institute, 350, 92­106.

150 The inverted pendulum in control theory and robotics
[13] Khalil, H. (2002). Nonlinear Systems. Third edition, Prentice-Hall, Upper Saddle River.
[14] Kelly, R., Llamas, J., and Campa, R. (2000). A measurement procedure for viscous and Coulomb friction. IEEE Transactions on Instrumentation and Measurements, 49(4), 857­861.
[15] Levant, A. (2003). High-order sliding modes: differentiation and outputfeedback control. International Journal of Control, 76, 924­941.
[16] Moreno, J. (2012). A Lyapunov approach to output feedback control using second-order sliding modes. IMA Journal of Mathematical Control and Information, 29(3), 291­308.
[17] Olfati-Saber, R. (2001). Nonlinear control of underactuated mechanical systems with applications to robotics and aerospace vehicles. Ph.D. dissertation, California Inst. Technol., Pasadena, CA.
[18] Olivier, J.C., Le Claire, J.C., and Loron, L. (2008). An efficient switching frequency limitation process applied to high dynamic voltage supply. IEEE Transactions on Power Electronics, 23(1), 153­162.
[19] Orlov, Y. (2009). Discontinuous Systems: Lyapunov Analysis and Robust Synthesis under Uncertain Conditions. Springer, London.
[20] Plestan, F., Grizzle, J.,Westervelt, E., and Abba, G. (2003). Stable walking of a 7-DOF biped robot. IEEE Transactions on Robotics and Automation, 19(4), 653­668.
[21] Reyhanoglu, M., van der Schaft, A., McClamroch, N., and Kolmanovsky, I. (1999). Dynamics and control of a class of underactuated mechanical systems. IEEE Transactions on Automatic Control, 44(9), 1663­1671.
[22] Shiriaev, A., Freidovich, L., Robertsson, A., and Sandberg, A. (2007). Virtualholonomic-constraints based design stable oscillations of Furuta pendulum: theory and experiments. IEEE Transactions on Robotics, 23(4), 827­832.
[23] Wiggins, S. (2000). Introduction to Applied Nonlinear Dynamical Systems and Chaos. Text in Applied Mathematics. Second edition, Springer, New York.

Chapter 7
Switched integral sliding mode control for robust generation of self-oscillation in pendulum systems
Juan Eduardo Velázquez-Velázquez1, Rosalba Galván-Guerra1, Rafael Iriarte2
Abstract
Self-oscillations for pendulum systems generated by a two-relay controller are robustified by using a switched integral sliding mode control. The robustification is theoretically exact, assuring the frequency and amplitude of the oscillations remain despite the presence of matched uncertainties/perturbations. To illustrate the efficacy of the proposed robustifying strategy, an inertial wheel pendulum is considered along the chapter.
7.1 Introduction
Self-oscillation (SO) is the generation and maintenance of a periodic motion by a source of power that lacks a corresponding periodicity: the oscillation itself controls the phase with which the power source acts on it (see [1] for more details about this physical phenomenon). This phenomenon appears when the trajectories of the system are attracted to a limit cycle [2].
The SO is characterized by its frequency and amplitude, which can be analyzed in the frequency or in the state-space domains. In the frequency domain, the describing function method [2­4] can be used to obtain an approximation of the oscillating characteristics (frequency and amplitude) of the periodic motion. In state-space domain, the Poincaré maps [2,3,5] give the necessary and sufficient conditions for the existence and stability of the periodic motion. Moreover, when a discontinuous controller is used to generate a SO, the locus of a perturbed relay system (LPRS) [5] tool can be used to find theoretically exactly the gains of the controller guaranteeing the desired oscillating characteristics of the periodic motion.
1Unidad Profesional Interdisciplinaria de Ingeniería campus Hidalgo, Instituto Politécnico Nacional, San Agustín Tlaxiaca, Mexico 2Facultad de Ingeniería, Universidad Nacional Autónoma de México, Ciudad Universitaria, Mexico

152 The inverted pendulum in control theory and robotics
A common method for producing periodic motions is through tracking, that gives traceability of different shapes, but if the desired frequency is high, it requires a lot of energy. While by using the principle of SO, the shape is hardly controllable, but it is possible to achieve high frequencies [6].
To generate SO, it is factible to introduce virtual holonomic constraints to the nonlinear system [7], generating an exponentially orbitally stable periodic solution of the system. To assure finite-time convergence to the limit cycle, a relay controller [5] can be used. However, there are some systems (e.g., a double integrator) in which the use of feedback having a single-valued nonlinearity (e.g., relay) may not produce a desirable result. For systems with relative degree two, the two-relay controller (TRC) [6] is capable to generate SO with a desired frequency and amplitude. But the main disadvantage with the SO generation methodologies is that they are not robust, and any uncertainty/perturbation may change the frequency and amplitude of the oscillations.
To robustify SO, the sliding modes methodologies are a good option when the uncertainties/perturbations are matched, i.e., they affect directly the channels of the controller. One way to robustify SO is to identify and to compensate the uncertainties/perturbations [8], to track an asymptotic harmonic generator based on a Van der Pol equation [9] using a twisting controller or to track a nominal trajectory generated by the TRC by using a high-order sliding mode control or a quasicontinuous one [10,11]. But during the reaching phase, those approaches are incapable to compensate the uncertainties/perturbations. Furthermore, by the intrinsic characteristics of theTRC, the closed-loop system has a switched behavior, and none of the mentioned approaches contemplate this issue.
The integral sliding modes (ISM) [12] allow theoretically exact compensation of the matched uncertainties/perturbations without explicit computation of the nominal trajectory. For switched linear systems, a switched ISM (SISM) approach has been recently extended in [13]. This approach allows to compensate theoretically exactly the matched uncertainties/perturbations just after the initial time despite the presence of switchings.
In this chapter, a robustifying methodology for SO with a given frequency and amplitude generated by a TRC is proposed. A SISM controller is used to compensate the matched uncertainties/perturbations right after the initial time.
The chapter is organized as follows: Section 7.2 presents some preliminaries concepts for stable SO generation with the TRC together with a motivational example of an inertial wheel pendulum (IWP) that shows the necessity of a robustifying procedure; this section ends with the problem formulation. Then, in Section 7.3, the robustifying strategy is presented, and a computational algorithm resumes the proposed strategy. In Section 7.4, robust SO are generated in the IWP by applying the robustifying strategy. Finally, in Section 7.5, some comments conclude the chapter.
Acronyms
 SO ­ self-oscillation  LPRS ­ locus of a perturbed relay system

SISM for robust generation of SO 153
 TRC ­ two-relay controller  ISM ­ integral sliding modes  SISM ­ switched integral sliding modes  IWP ­ inertia wheel pendulum  ULTIS ­ uncertain linear time-invariant system  NLTIS ­ nominal linear time-invariant system  ASNLTIS ­ affine switched nominal linear time-invariant system  ASULTIS ­ affine switched uncertain linear time-invariant system

7.2 Preliminaries and problem formulation

7.2.1 Uncertain system

Consider the following uncertain nonlinear system

x(t) = f (x, t) + g(x, t)(u(t) + w(t))

(7.1)

where f : Rn × R  Rn, g : Rn × R  Rn are known continuous functions, x(t)  Rn and u(t)  R are the states and control vector, respectively. Note that we are assuming the full state vector is available. w(t)  R denotes the uncertainties/perturbations present in the system, and it is assumed unknown but bounded, i.e., |w(t)|  wmax. By using any linearization method, the above system is represented by an uncertain
linear time-invariant system (ULTIS)

x(t) = Ax(t) + B(u(t) + (t))

(7.2)

we assume that the system (7.2) is controllable and B(t) = f (x, t) + g(x, t)(u(t) + w(t)) - Ax(t) - Bu(t). The last assumption assures the uncertainties/perturbations 
is matched. Moreover, if the system is stable, the uncertainties/perturbations remain bounded, i.e., |(t)|  max.
Without loss of generality, the control u(t) is designed such that it generates SO on an arbitrary scalar output y(t) = Cx(t), around a given reference yref  R with a desired frequency and amplitude A .

7.2.2 Generation of self-oscillations: two-relay controller

Let's define a nominal linear time-invariant system (NLTIS) by assuming the absence of uncertainties/perturbations, i.e., (t) = 0,

xNom(t) = AxNom(t) + Bu¯(t)

(7.3)

where the control vector u¯(t) = uNom(t) + uTRC(t) is composed by a stabilizer controller uNom(t) = -K xNom(t) and a TRC [6] uTRC given by

uTRC(t) = -c1sign( (t)) - c2sign((t))

(7.4)

where  (t) = yref - yNom(t), and c1 and c2 are design parameters chosen in such a way that the scalar output y has a steady periodic motion with frequency and amplitude

154 The inverted pendulum in control theory and robotics

A around the reference yref . Under these conditions, the nominal system takes the form

xNom(t) = A~ xNom(t) + BuTRC(t)

(7.5)

where A~ = A - BK is Hurwitz.

Assume the parameters c1 and c2 are designed using the LPRS method (see [6] for more details about this result)

A

1

c1  4 |W ( j )| 1 + 2 cos(2  ) +  2

(7.6)

c2



 4

A |W ( j

)|

 1 + 2 cos(2  ) +  2

where

W ( j) = C( jI - A~)-1B,  = - L( , 0)

(7.7)

L( ,  )

and  is solution of the equation

L(, 0)L1(, - ) - L(,  )L1(, 0) = 0

with

L(,  )

=

 C

eA~

2 

I

+

eA~

 

-1 A~-1

I

-

eA~

 

+ A~-1

eA~

2 

-I

B

4

(7.8) (7.9)

and

L1(,  )

=

 4

CA~

eA~

2 

I

+

eA~

 

-1 A~-1

I

-

eA~

 

+ A~ -1

eA~

2 

-I

B. (7.10)

To assure the orbital asymptotic stability of the SO periodic motion of the closed-loop system (7.3), the TRC gains must fulfill the following theorem.

Theorem 7.1. [6] Suppose that the selected parameters c1 and c2 of theTRC algorithm (7.4) result in a closed-loop that generates a periodic motion of the output y of the plant
(7.3). This solution is orbitally exponentially stable, if and only if all the eigenvalues of the matrix = ( 1 2)2, where

1=

I

-

1 C A~ CA~1

eA~

T 2

,

1 = A~p + B(c1 + c2),

2=

I

-

2 C C 2

eA~T ,

2 = A~p + B(c1 - c2),

p

=

eA~

T 2

p

+

A~

-1(eA~

T 2

- I )B(c1 + c2),

p = -eA~T p - A~ -1(eA~ T - I )B(c1 - c2);

(7.11)

are located inside the unit circle.

SISM for robust generation of SO 155

Note that theTRC can be seen as a switched controller of the form

uTRC(t)

=

 

uTRC,1 uTRC,2 uTRC,3 uTRC,4

= = = =

-c1 -c1
c1 c1

- + - +

c2 c2 c2 c2

if if if if

(t)  0 (t)  0 (t) < 0 (t) < 0

and and and and

(t)  0 (t) < 0 (t)  0 (t) < 0

(7.12)

Hence, (7.5) can be restated as an affine switched NLTIS (ASNLTIS)

xNom(t) = A~ xNom(t) + F (t)





(t)

=

 

1 2 3 4

if if if if

(t)  0 (t)  0 (t) < 0 (t) < 0

and and and and

(t)  0 (t) < 0 (t)  0 (t) < 0

(7.13) (7.14)

and Fi = BuTRC,i, i  {1, 2, 3, 4}. The nominal trajectory can be used to detect when the switching variables  and 

change their values, i.e., it can be used to detect the switching moments tj, defined as

tj = min{t : t > tj-1,  (t-) =  (t), j = 0, 1, . . .}

(7.15)

Observe that since the nominal trajectory is designed to assure a steady periodic motion with a desired frequency and amplitude, we can assume that the switching moments conform an ordered sequence

0 = t0 < t1 < · · · < tj-1 < tj < · · ·

(7.16)

7.2.3 Motivational example

Consider the dynamic model of an IWP with friction effects and exogenous perturbations [6] (see Figure 7.1)

J1 J2 J2 J2

q¨1(t) + h sin(q1(t)) = 0 ( (t) + w(t))

q¨ 2 (t )

fs q 2 (t )

1

(7.17)

where q1(t), q2(t)  R are the absolute angle of the pendulum and the disk, respectively, counted clockwise from the vertical downward position.  (t)  R is the controlled torque applied to the disk, while w(t) denotes external perturbations. J1, J2, and h are positive physical parameters, which depend on the geometric dimensions, and the inertia­mass distribution, while fs is the viscous friction coefficient, and it is considered unknown.
Consider the change of variable [14]

p1(t)

=

q1(t)

-



+

J2 J1

q2(t)

p2(t) = J1q1(t) + J2q2 + Kp1(t) and take x(t) = p2(t) p2(t) p¨2(t) T as the state variables, and

(7.18)

 (t) = H -1(q1(t)) (u¯(t) - R(q1(t), q1(t)))

(7.19)

156 The inverted pendulum in control theory and robotics

q2



q1

Figure 7.1 IWP schematic

with

H (q1(t))

=

h cos(q1(t)) , J1 - J2

R(q1(t), q1(t))

=

(q12(t) + H (q1(t)))h sin(q1(t)) -

hK J1

q 1

(t

)

cos(q1

(t

))

and K = [-a0 - a1 - a2].

Hence, the obtained linearized IWP model is given by





010

 0

 0

x(t) =  0 0 1  x(t) +  0  uTRC(t) +  0  (t),

-a0 -a1 -a2

1

1

(7.20)

F (t)

K

1

p1(t) = - J1 p1(t) + J1 x1(t);

(7.21)

where (t) = H (q1(t)) (w(t) - fsq2(t)).
The control objective is to achieve orbital stabilization of the unactuated link q1 around the unstable equilibrium point q = [ 0]T with a desired frequency
= 2 rad/s and amplitude A = 0.07 rad. For simulation purposes, it is assumed that q1(0) = 3 rad, q2(0) = 0 rad, q1(0) = q2(0) = 0 rad/s, J1 = 4.572 × 10-3, J2 = 2.495 × 10-5, fs = 8.80 × 10-5, h = 0.3544, K = 1 × 10-4, a0 = 350, a1 = 155 and a2 = 22. Here, we assume y(t) = q1(t).
Under the assumption that (t) = 0, to achieve the desired frequency and amplitude, the LPRS method was applied to obtain the TRC gains c1 = 2 and c2 = -2.5.
In Figure 7.2, the behavior of the IWP is obtained with the TRC. Observe that q1 has frequency of 2 rad/s and an amplitude of 0.07 rad. Recall that due to the switched
characteristic of theTRC, the IWP model is seen as a switched system whose switching

q1 [rad]

SISM for robust generation of SO 157

Nominal IWP

3.4

3.2

3

2.8

0

1

2

3

4

5

6

4

( .q1,q1)

2

0

0

1

2

3

4

5

6

t [s]

Figure 7.2 Nominal behavior of the IWP: TRC

moments are ruled by (7.14), the detected switching moments are depicted in the second graph of Figure 7.2.
Now, let's apply the same TRC designed previously to the IWP model (7.21). For simulations purposes,

w(t) = 0.2 sin

t 2cos( t)

+ 0.1.

(7.22)

The behavior of the pendulum angle is shown in Figure 7.3. Note that the nominal controller and the TRC are incapable to maintain the desired frequency and amplitude of the pendulum angle. Furthermore, the uncertainties/perturbations affect the trajectory of the system, and hence, the switching moments are quite different from the nominal ones (see second plot of Figure 7.3).

7.2.4 Problem statement

Considering a control input u(t) = u¯(t) + uInt, the linearized uncertain system (7.2) can be restated as an affine switched ULTIS (ASULTIS)

x(t) = A~ x(t) + F(t) + B(uInt(t) + (t)), y(t) = Cx(t).

(7.23)

In the rest of the chapter, we will design a robustifying controller uInt such that the ASULTIS (7.23) has SO with a desired frequency and amplitude A despite the presence of matched uncertainties/perturbations, i.e., the ASULTIS behaves as
the ASNLTIS (7.13) theoretically exactly right after the initial time.

q1 [rad]

( .q1,q1)

158 The inverted pendulum in control theory and robotics
Perturbed IWP 3.4 3.2
3 2.8
0123456
4
2
0 0123456
0.4 0.2
0 ­0.2
0123456 t [s]
Figure 7.3 Behavior of the IWP: TRC

H­1(q1)f (t)

7.3 Switched integral sliding modes

7.3.1 Sliding variable design
To compensate the uncertainties/perturbations, we use a SISM strategy [13] that compensates the effects of the matched uncertainties/perturbations theoretically exactly right after the initial time. A block diagram with the overall control strategy is shown in Figure 7.4.
Let's define the following integral sliding variable

t
s(x, t) = G(x(t) - x(tj)) - G A~ x() + F() d.
tj

(7.24)

with the projection matrix G = B+. Observe that this variable is in the origin at every switching moment, i.e., s(x(tj), tj) = 0. Now, taking the first derivative with respect to time along the trajectories of (7.23),

s(x, t) = uInt(t) + (t)

(7.25)

SISM for robust generation of SO 159

SISM controller

uInt

u

+ + ++

ULTIS

x

uTRC ASULTIS
uNom

TRC
Nominal controller

Figure 7.4 Block diagram of the proposed control strategy

and the equivalent control has the form

uInt,eq(t) = -(t).

(7.26)

Hence, the sliding modes dynamic of the system (7.23) takes the form

x(t) = A~ x(t) + F(t)

(7.27)

that is equivalent to the nominal system (7.13), if the establishment of the sliding mode since the initial time is assured.

7.3.2 Controller design

Let the SISM controller in the unitary form

uInt

=

-

s |s|

(7.28)

where  is a design constant. The next theorem gives sufficient conditions to assure the sliding variable (7.24) remains in the origin since the initial time.

Theorem 7.2. [13] If

 > B max

(7.29)

the sliding mode is established since the initial time, and the matched uncertainties/perturbations are compensated right after the initial time.

The robust SO control strategy based on the SISM controller can be summarized in the following algorithm (see Figure 7.5 for a flowchart of the algorithm).
SISM robustifying algorithm
1. Define the desired frequency and amplitude A for the output y(t) 2. Linearize the plant if necessary

160 The inverted pendulum in control theory and robotics

Begin

Desired frequency  and amplitude A

Yes Linearize

Is the plant nonlinear?

No

Is the system unstable?

No Design TRC gains (6)

Yes

Design stabilizing controller

End

Implement the control

Construct u(t)

Choose  Yes satisfying (16)

Is the bound of f
known?

q1,Nom, q1 [rad]

No Estimate the bound

Figure 7.5 Flowchart of the SISM algorithm

q2,Nom, q2 [rad]

Nominal vs perturbed: SISM

3.4

100

3.2

0

3

­100

2.8

­200

0

50

5

1

500

q2,Nom, q2 [rad/s]

.

.q1,Nom, q.1 [rad/s]

0

0

.

­1

­500

0

50

5

t [s]

t [s]

Figure 7.6 Nominal IWP vs perturbed IWP: SISM

3. If the system is unstable design the stabilizing nominal controller uNom 4. Design the TRC gains (7.6) 5. Determine the bound of the matched uncertainties/perturbations (t) 6. Choose a suitable constant  satisfying (7.29) 7. Construct the control signal u(t)

×10­3 1

SISM for robust generation of SO 161
Sliding surface: SISM

s(x,t)

0

­1

0

1

2

3

4

5

6

t [s]

Figure 7.7 Sliding variable: SISM

q1 [rad]

Perturbed IWP: SISM 3.4 3.2
3 2.8
0123456

. (q1,q1)

H­1(q1)f (t)

4
2
0 0123456
0.4 0.2
0 ­0.2
0123456 t [s]
Figure 7.8 Behavior of the IWP: SISM

7.4 Simulation example
To show the applicability of the proposed approach, let's robustify the IWP motivational example with the same control objective: to generate SO around the unstable equilibrium point q = [ 0], i.e., yref =  ; with a desired frequency = 2 rad/s and amplitude A = 0.07 rad. Let's recall the linearized model (7.21), and by using the nominal model, it can be shown that the matched uncertainties/perturbations are bounded, i.e., |(t)|  30.

 (t)

162 The inverted pendulum in control theory and robotics
Control effort 1 0.5 0 ­0.5 ­1
0123456 t [s]
Figure 7.9 Applied torque: SISM
The behavior of the IWP with the SISM controller is illustrated in Figure 7.6, and the sliding mode variable is given in Figure 7.7. Observe that the perturbed IWP is in the sliding mode since the initial time and behaves as the nominal one right after the initial time; this assures the switching moments coincide, and as it is shown in Figure 7.8, the desired frequency and amplitude for the pendulum angle is achieved despite the presence of the matched uncertainties/perturbations. Finally, the applied torque is given in Figure 7.9.
7.5 Conclusion
For pendulum systems with SO generated by the TRC, a robustifying strategy based on an ISM approach is proposed. The TRC generates SO with a desired frequency and amplitude, and due to the intrinsic switching characteristic of the TRC, the closedloop system is considered a switched affine one. The considered approach robustifies the SO against bounded matched uncertainties/perturbations. By using MATLAB® simulations, for the IWP example, it is shown that the SISM compensates right after the initial time the matched uncertainties/perturbations, assuring the switching moments and the desired frequency and amplitude of the SO remain.
Acknowledgment
The authors gratefully acknowledge the financial support from PAPIIT, UNAM, grants IN112915 and IN113216.
References
[1] A. Jenkins. "Self-oscillation", Physics Reports, 525(2), pp. 167­222, (2013), [Online]. Available: http://www.sciencedirect.com/science/article/ pii/S0370157312004073, self-oscillation.

SISM for robust generation of SO 163
[2] H. K. Khalil. Nonlinear Systems, third edition, (Prentice-Hall, Upper Saddle River, New Jersey 07458, 2002).
[3] A. Gelb, W. Velde. Multiple-Input Describing Functions and Nonlinear Systems Design, (McGraw-Hill, New York, 1968).
[4] D. Atherton. Nonlinear Control Engineering­Describing Function Analysis and Design, (Van Nostrand, Wokingham, 1975).
[5] I. Boiko. Discontinuous Control Systems: Frequency-domain Analysis and Design, (Birkhäuser Boston, 2009), [Online]. Available: http://books. google.com.mx/books?id=P0palNA5BIMC.
[6] L. T. Aguilar, I. Boiko, L. Fridman, R. Iriarte. Self-Oscillations in Dynamic Systems: A New Methodology via Two-Relay Controllers, first edition, (Basel, Switzerland: Birkhäuser Basel, 2015).
[7] A. Shiriaev, J. W. Perram, C. C. de Wit. "Constructive tool for orbital stabilization of underactuated nonlinear systems: Virtual constraints approach", IEEE Transactions on Automatic Control, 50(8), pp. 1164­1176, (Aug 2005).
[8] L. T. Aguilar, I. Boiko, L. Fridman, A. Ferreira. "Identification based generation of self-excited oscillations for underactuated mechanical systems via two-relay algorithm", 2008 International Workshop on Variable Structure Systems, pp. 41­46, (2008).
[9] Y. Orlov, L. T. Aguilar, L. Acho, A. Ortiz. "Asymptotic harmonic generator and its application to finite time orbital stabilization of a friction pendulum with experimental verification", International Journal of Control, 81(2), pp. 227­234, (2008), [Online]. Available: http://dx.doi.org/10.1080/ 00207170701516371.
[10] A. Ferreira, F. J. Bejarano, L. M. Fridman. "Robust control with exact uncertainties compensation: With or without chattering?", IEEE Transactions on Control Systems Technology, 19(5), pp. 969­975, (Sept 2011).
[11] A. Estrada, L. T. Aguilar, R. Iriarte, L. Fridman. "Two relay controller for real time trajectory generation and its application to inverted orbital stabilization of inertia wheel pendulum via quasi-continuous hosm", Asian Journal of Control, 14(1), pp. 58­66, (2012), [Online]. Available: http://dx.doi.org/10.1002/asjc.339.
[12] V. I. Utkin. Sliding Modes in Control and Optimization, (Berlin, Heidelberg: Springer-Verlag, 1992).
[13] R. Galván-Guerra, L. Fridman. "Output integral sliding mode based lq control for switched uncertain systems", 13th International Workshop on Variable Structure Systems, (2013).
[14] J. W. Grizzle, C. H. Moog, C. Chevallereau. "Nonlinear control of mechanical systems with an unactuated cyclic variable", IEEE Transactions on Automatic Control, 50(5), pp. 559­576, (May 2005).

Chapter 8
Finite-time stabilization of underactuated mechanical systems in the presence of
uncertainties: application to the cart­pole system
Jawhar Ghommam1, Ahmed Chemori2, and Faiçal Mnif 3
8.1 Introduction
Underactuated mechanical systems [13,14,27] are those systems with less control inputs than generalized coordinates (called also degrees of freedom), i.e., they have unactuated generalized coordinates. For such systems, the unactuated generalized coordinates may indirectly be controlled by the actuated coordinates through the dynamic coupling, inherent to these systems [8]. This coupling is often nonlinear, resulting in generally nonintegrable dynamic constraints and therefore second-order nonholonomic.
Many examples of such systems exist, and mainly in robotics. They include, among others, inverted pendulums [16,25,26], underactuated robot manipulators [6], gymnast robots and particularly the acrobot [41] and the pendubot [31], undersea vehicles [15], PVTOL (Planar Vertical Takeoff and Landing) aircrafts [35] and mobile robots [18].
Underactuation in these mechanical systems is generally introduced intentionally at the design level to reduce the manufacturing cost, the weight and/or failure rate; consequently, the obtained systems may be able to perform complex tasks with a reduced number of actuators. The source of underactuation may also be unintentionally due to failure of one or more actuators in a fully actuated system.
Underactuated systems may require new approaches/techniques to design effective control strategies; therefore, they constitute a good framework for nonlinear control problems regarding both theoretical and practical aspects. For these reasons, they are attracting more and more attention of researchers from nonlinear control community as well as from many research fields in robotics.
In the literature, many research efforts have been made in control aspects [30­32,39,41­43], giving rise to multiple control solutions; however, control problem of such systems is still open.
1National Institute of Applied Sciences and Technology (INSAT), Tunisia 2Laboratoire d'Informatique, de Robotique et de Microélectronique de Montpellier (LIRMM), France 3College of Engineering, Sultan Qaboos University, Sultanate of Oman

166 The inverted pendulum in control theory and robotics
For instance in [9], a technique of pseudolinearization using spline functions is proposed to control the acrobot underactuated system. In [42], a design technique combining partial feedback linearization and Lyapunov methods based on saturation functions, switching and energy shaping has been proposed. In [43], the author discuss a survey on some existing results such as geometric nonlinear control and passivity-based control for stabilization and tracking control of such systems. Three control algorithms have been proposed in [30] for an underactuated two-link robot, namely an optimal LQ controller, a partial feedback-linearizing regulator and a sliding mode controller. In [31], the testbed is also a two-link underactuated robot but the actuator is located at the base (in contrast to the one proposed in [30] where the actuator is located at the joint between the two links), and the authors propose a method based on partial feedback linearization [40], nilpotent approximation and an iterative stabilization procedure. Roughly speaking, they propose an open-loop controller able to steer the system closer to the desired equilibrium point in finite time, and apply it iteratively, which provides a robust exponential convergence to the equilibrium. In [32], the authors propose to study the nonlinear behavior of the same robot proposed in [31] through a graphical tool based on Poincaré map. The study in [39] concerns underactuated mechanical systems with several actuated degrees of freedom and a single unactuated degree of freedom, where a discontinuous nonlinear feedback controller is proposed, allowing the closed-loop equilibrium at the origin to be globally attractive. In [45], a generalized predictive controller has been proposed, based on the linearized dynamics of the system. In [10], a nonlinear predictive controller is proposed for both stabilization and stable-limit cycle generation with an application to the ECP 505 inverted pendulum. In [44], a technique based on switching and saturation control is proposed. In [11], a passivity-based approach has been proposed to control the inertia wheel inverted pendulum. In [17], the technique of virtual holonomic constraints has been proposed with an application to the pendubot for generation of periodic motions, and to the Inertia Wheel Pendulum in [16]. In [3], the proposed control techniques are based on partial feedback linearization, combined with the optimization of the reference trajectories to stabilize the internal dynamics of the system. In [4] and [5], a dual-model-free control technique is proposed. The control architecture includes two model-free controllers, the first one is used to track the reference trajectories on the actuated degrees of freedom of the system, whereas the second one is used to stabilize the internal dynamics. In [25], a technique based on Riccati and nonlinear control is proposed for inverted pendulums. Output feedback control with an extended high gain observer was recently proposed in [28].
To deal with model uncertainties, a time-scale approach along with the Lyapunov design has been proposed in [38]. The authors in [34] used a sliding mode technique for the cart­pole system to stabilize the system in presence of disturbances. Model uncertainties however have not been tackled in this work. In [1], disturbances and model uncertainties have been fully considered in a technique that involves a backstepping procedure combined with sliding mode, applied to the inverted pendulum system after the system was converted into a normal form. Integral sliding mode control was also applied in [46] to deal with uncertainties in the two-wheeled mobile

Finite-time stabilization of underactuated mechanical systems 167
inverted pendulum. The control law being designed is based on the linearized system dynamics which resulted in a small region of attraction for the equilibrium. The problem becomes more challenging whenever nonparametric uncertainties and unknown time-varying disturbances are considered in the design of effective and robust control law for the underactuated system.
An important research issue which has attracted the attention of the control community is the finite-time convergence and finite-time stabilization [2,7,19­21,24], that ensures faster convergence rate, better disturbance rejection and robustness against uncertainty. Although myriad approaches have been proposed in the literature that tackle the problem of finite-time stabilization, they are not effective in dealing with time-varying and state-depending uncertainties. Few attempts have been concentrated in the design of adaptive schemes [22,23] to resolve the problem of state dependent and time-varying uncertainties. However, the adaptive scheme has only been applied to a class of p-normal forms [12]. To the best of the authors'knowledge, few have dealt with finite-time stabilization of underactuated systems subject to time-varying and state-dependent uncertainties. This chapter focuses on the design of a novel nonlinear controller for a class of underactuated system; we would like to introduce a new strategy that addresses an adaptive robust finite-time stabilization law derived from adding power integrator (API) [36] technique to a class of single input dynamics described as a normal form system [33]. The idea is to generate coordinate transformations that decouple the underactuated dynamics into an upper-triangular form allowing for only one control input governing the whole system to be designed, whereby a continuous finite-time stabilizing control law is derived from the API technique, and an adaptive compensator is proposed to compensate for the matched and unmatched uncertainties collected throughout the steps of the design. As a consequence, the resulting control law is able to stabilize the underactuated mechanical system in a finite time.
The reminder of this chapter is organized as follows. Section 8.2 discusses the Lagrangian model of mechanical underactuated systems and the coordinate transformation that transforms this model into a normal-form representation. Section 8.3 formulates the finite-time stabilization problem for the nth-order underactuated system. Section 8.4 gives a background on finite-time stability and provides some useful lemmas needed throughout the paper. The control design is developed in Section 8.5. Simulation results with an application to the cart­pole system are presented and discussed in Section 8.6. Finally, Section 8.7 draws a conclusion for this chapter.
8.2 Dynamic modeling of underactuated mechanical systems: Lagrangian formalism
The Lagrangian formalism is one among the powerful mathematical tools based on the vibrational method to model a large class of mechanical systems. Underactuated mechanical systems are branches of this class. They can be modeled using the Euler­ Lagrange equations. Let Q be an n-dimensional configuration manifold, and q  Q is a

168 The inverted pendulum in control theory and robotics

vector of generalized coordinates. The Euler­Lagrange equations for any mechanical system of n degrees of freedom (DOF) are given by [33]

d L(q, q) - L(q, q) = B(q)u

(8.1)

dt q

q

where u  Rm and B(q) is the external forces matrix. L(q, q) is the Lagrangian associated to the mechanical system and expressed by the difference between kinetic and potential energies:

L(q, q) = K - V = 1 q M (q)q - V (q)

(8.2)

2

where K is the kinetic energy, V (q) denotes the potential energy and M (q) = M (q)  Rn×n is a positive definite inertia matrix. Let mik  R+ denote the entries of the inertia matrix M with i = 1, . . . , n and k = 1, . . . , n. Based on (8.1) and (8.2), the equations
of motion can be deduced as follows:

mik (q)q¨k +

ik (q)qiqk + gi(q) = e B(q)u,

k

i,k

= 1, . . . , n

(8.3)

where e is the th standard basis in Rn, gi = qiV (q), and ik (q) is the Christoffel symbol defined by

1 ik (q) = 2

m k (q) + m i(q) - mik (q)

 qi

 qk

q

In a matrix form, (8.3) can be rewritten as

(8.4)

M (q)q¨ + C(q, q)q + G(q) = B(q)u

(8.5)

The term C(q, q) includes two distinct terms, in particular, the first term qiqk involves the centrifugal forces (i = k), and the second is the Coriolis forces for (i = k), and G(q) represents the gravity vector. It is interesting to point out that the mechanical system described by (8.5) satisfies the skew symmetric property of the matrix M (q) - 2C(q, q).
It is important to distinguish two categories of mechanical systems governed by the equation of motion (8.5). A mechanical system described by (8.5) is said to be fully actuated if m = n, which is equivalent to say that the matrix B(q)  Rn×m is invertible. In other words, it can be roughly inferred that the mechanical system is fully actuated, if the number of actuators is equal to the dimension of its configuration manifold. On the other hand, if m < n, the mechanical system is said to be underactuated, which is equivalent to have fewer independent inputs than the number of degree of freedom to be controlled. This implies that the matrix B(q) becomes noninvertible and consequently the underactuated mechanical system as opposed to fully actuated systems is not exact feedback linearizable. Because the number of inputs is less than the number of degree of freedom, the controllability of the mechanical underactuated system is not always satisfied. In this chapter, however, we will assume that the

Finite-time stabilization of underactuated mechanical systems 169

considered mechanical systems are controllable. Furthermore, we suppose that the equation of motion (8.5) can be rearranged so that the matrix B(q) can be written as:

B(q) =

0(n-m)×m Im

(8.6)

where the first n - m equations of (8.5) represent the unactuated dynamics while the last m equations are the actuated dynamics. The generalized coordinates q can further be partitioned as follows:

q=

qu qa

(8.7)

where qu  R(n-m) is the vector of unactuated configuration variables and qa  Rm is the vector of actuated configuration variables. Then, it is straightforward to rewrite
the equation of motion (8.5) as follows:

m11(q) m12(q) m21(q) m22(q)

q¨ u q¨ a

+

c11(q) c12(q) c21(q) c22(q)

q u q a

+

g1(q) g2(q)

=

0 u2

(8.8)

The partitioned equation of motion (8.8) can also be represented in component form as follows:

m11(q)q¨u + m12(q)q¨a + h1(q, q) = 0

(8.9)

m21(q)q¨u + m22(q)q¨a + h2(q, q) = u2

(8.10)

where h1(q, q) = c11(q)qu + c12(q)qa + g1(q) and h2(q, q) = c21(q)qu + c22(q)qa + g2(q). It is worth to notice that there is no control input in (8.9); therefore, it is not possible to feedback linearize the system (8.9) and (8.10). It is however possible to partially feedback linearize the system using a change of control. The procedure of linearization of the actuated dynamics is called collocated partial linearization which is credited to Spong [43] and consists in finding a global invertible change of control of the form u2 = (q)v + (q, q) that partially linearizes the dynamics (8.8) such as, after partial linearization, the new control v appears in the nonlinear-subsystem dynamics as well as in the linearized subsystem dynamics as follows:

q¨u = f 1(q, q) + g1(q, q)v q¨a = v

(8.11) (8.12)

It can be observed that the unactuated part (8.11) is still complex, while the actuated part (8.12) is linearized into a double-integrator dynamics. The new control input v is present in both subsystems, which largely increases the difficulty in the control design. The author in [33] introduced a global change of coordinates that decouples these two subsystems and transforms the dynamics of the system into a cascaded form called the normal form, where the control input of the original actuated subsystem does not appear in the unactuated subsystem. This significantly simplifies the control design for the underactuated mechanical system. However, with this approach, there is an inherent requirement that the model parameters of the mechanical system must be perfectly known to be able to design controller for the transformed normal form.

170 The inverted pendulum in control theory and robotics

Due to lack of knowledge on the system parameters and the inability to measure the whole system state, the controller has to cope with these uncertainties. This situation justifies the need for the development of a global transformation that decouples the underactuated mechanical system without passing by the partial feedback linearization of the system.
Consider the dynamic (8.9), resolve for q¨u, it gives

q¨u = -m11(q)-1(m12(q)q¨a + h1(q, q))

(8.13)

Substituting (8.13) into (8.10), after some manipulation, we obtain

q¨a = f 3(q, q) + b3(q)u2

(8.14)

Again substituting the resulting dynamics (8.14) into the dynamics of (8.10), then solving for q¨u leads to the following dynamics:

q¨u = f 4(q, q) + b4(q)u2

(8.15)

where f 3(q, q) = (m22 - m21m-111m12)-1[m21m1-11h1(q, q) - h2(q, q)] =, b3(q) = (m22 - m21m-111m12)-1, f 4(q, q) = -m1-11m12 f4(q, q - m-111h1(q, q)) and b4(q) = -m1-11m12b3(q). Regrouping the dynamic (8.14) and (8.15), one can obtain a state-space representation
of the system as follows:

x1 = x2 x2 = f 3(q, q) + b3(q)u2 x3 = x4 x4 = f 4(q, q) + b4(q)u2

(8.16)

where the state space vector x has been defined as [x1, x2, x3, x4] = [qu, qu, qa, qa] . Note the structural difference between (8.12), (8.11) and (8.16) is that the actuated dynamics in (8.12) is a double integrator, while in (8.16), the actuated dynamics has some nonlinearities.
To decouple the nonlinear system represented by (8.16), we may use the global transformation proposed in [33] as follows:

z1 = x1 -

x3 b3(s) ds 0 b4(s)

z2

=

x2

-

b3(x) b4(x)

z3 = x3

z4 = x4

(8.17)

Finite-time stabilization of underactuated mechanical systems 171

The equation dynamics in the Z-space is found by taking the time derivative of (8.17), leading to

z1

=

z2

+

b3(z) b4(z)

z4

-

d dt

z3 b3(s) ds 0 b4(s)

z2

=

f3(z) -

b3(z) b4(z)

f4

(z)

-

d dt

z3 = z4

b3(z) b4(z)

z4

(8.18)

z4 = f4(z) + b4(z)u2

Clearly, the dynamics of the underactuated system in Z-space, is in a special cascade

form with only one control input appearing in the last subsystem. To ease the represen-

tation,

let us

define

d1(z)

=

b3 b4

(z) (z)

z4

-

d dt

z3 0

b3 b4

(s) (s)

ds,

d2(z

)

=

-z3

+

f3(z)

-

b3 b4

(z) (z)

f4

(z)

-

d dt

b3 (z) b4 (z)

z4, d3(z) = 0, then the system (8.18) can be rewritten as

z1 = z2 + d1(z)

z2 = z3 + d2(z)

z3 = z4 + d3(z)

(8.19)

z4 = f4(z) + b4(z)u2

where d1(z), d2(z) and d3(z) are regarded as unmatched uncertainties to be compensated by the control u2. In a similar manner, an nth-order underactuated system can be represented in the state space form as

x1 = x2 x2 = f 3(q, q) + b3(q)u x3 = x4 x4 = f 4(q, q) + b4(q)u
...

(8.20)

xn-1 = xn xn = f n(q, q) + bn(q)u

To decouple the nth order system (8.20), the global transformation as proposed in [33] can be extended to nth order recursively as follows:

z1 = x1 -

x3 b3(s) ds, 0 b4(s)

z2

=

x2

-

b3(x) , b4(x)

z3 = x3 -

x5 b4(s) ds 0 b5(s)

172 The inverted pendulum in control theory and robotics

z4

=

x4

-

b4(x) b5(x)

...

zn-3 = xn-3 -

xn-1 bn-2(s) ds

0

bn(s)

zn-2

=

xn-2

-

bn-1(x) bn(x)

zn-1 = xn-1

zn = xn

(8.21)

Hence, the system dynamics in Z-space can similarly be obtained, taking the time derivative of (8.21), we have

z1

=

z2

+

b3(z) b4(z)

z4

-

d dt

z3 b3(s) ds 0 b4(s)

z2

=

f3(z)

-

b3(z) b4(z)

f4

-

d dt

b3(z) b4(z)

z4

z3

=

z4

+

b4(z) b6(z)

z6

-

d dt

z5 b4(s) ds 0 b6(s)

z4

=

f4(z)

-

b4(z) b6(z)

f6(z)

-

d dt

b4(z) b6(z)

z6

...

zn-3

=

zn-2

+

bn-2(z) bn(z)

zn

-

d dt

zn-1 bn-2(s) ds 0 bn(s)

zn-2

=

fn-2(z) -

bn-2(z) bn(z)

fn

-

d dt

bn-2(z) bn(z)

zn

zn-1 = zn

zn = fn(z) + bn(z)u

(8.22)

Let us now define the following transformation:

d1(z)

=

b3(z) b4(z)

z4

-

d dt

z3 b3(s) ds 0 b4(s)

d2(z)

=

-z3

+ f3(z)

-

b3 b4

(z) (z)

f4

-

d dt

b3(z) b4(z)

z4

...

(8.23)

Finite-time stabilization of underactuated mechanical systems 173

dn-3

=

bn-2(z) bn(z)

zn

-

d dt

zn-1 bn-2(s) ds 0 bn(s)

dn-2

=

-zn-1 + fn-2(z) -

bn-2(z) bn(z)

fn

-

d dt

bn-2(z) bn(z)

zn

dn-1 = 0

dn = fn(z)

The dynamics in (8.23) can be similarly written in a standard form like in (8.18) as follows:

zi = zi+1 + di(z), 1  i  n - 1 zn = bn(z)u + dn(z) y = h(z)

(8.24)

where di(z)  R, i = 1, 2, . . . , n are regarded as matched and unmatched uncertainties. It can be noticed that by construction, the variation bounds of the uncertainties di(z), i = 1, . . . , n are not assumed to be known and also cannot be assumed linearly parameterizable into a multiplication of a known regressor and a vector of unknown constant parameters. Also for the simplicity of the control design, let us consider the following two assumptions:

Assumption 8.1. The terms di(z), i = 1, . . . , n are all unknown functions, whose bounds are also unknown.

Assumption 8.2. The uncertain control coefficient bn(z) is bounded as bmin  bn(z)  bmax and bn(z) is sign-definite such that sign(bn(z)) = +1. Further, it is convenient to assume that bn(z) = 0.

8.3 Control problem formulation

In this chapter, we consider a class of underactuated systems of the form (8.20),
which can be transformed without partial feedback linearization and through the
global change of coordinates (8.21) into the cascaded form (8.24). Where z = [z1, z2, . . . , zn]  , where is a compact set of Rn, u  R is the control input and di(z)  R, i = 1, . . . , n - 1 are unmatched uncertainties, while dn is the matched
uncertainty. Under Assumptions 8.1 and 8.2, the idea is to design the controller u such that the system state z tracks in finite time the desired trajectory zd = [z1d , z2d , . . . , znd ]  d where d is a compact set of . This means that for any finite initial condition zi(0), i = 1, . . . , n, there exists a finite time T such that

lim
tT

zi - zid

= 0,

i = 1, . . . , n

(8.25)

Remark 8.1. The control design satisfying the limit (8.25) guarantees stabilization in finite time of the underactuated mechanical system of the form (8.20) to a desired reference input xd. In most of the cases, stabilization around the origin of the first state

174 The inverted pendulum in control theory and robotics
x1 is desired. The reference input for the Z-subsystem z1d = 0 implies stabilization of the state variable x1 to zero.

8.4 Preliminaries
In this section, a review of some basic concepts and lemma related to the concept of finite-time stability and the corresponding Lyapunov theorem are presented; they will be useful for most of the stability analysis of this chapter.

8.4.1 Notions of finite stability
Theorem 8.1. [7]: Consider the non-Lipschitz continuous autonomous system x = f (x), f (0)  R. Assume, there are C1 function V (x) defined on a neighborhood D  R of the origin, and real numbers c > 0 and 0 <  < 1 such that

1. V (x) is positive definite on D 2. V (x) + cV   0, x  D

Then, the origin x is locally finite-time stable. If D = R, and V (x) is radially

unbounded, then the origin x = 0 is globally finite-time stable. Moreover, it can be

verified that the settling time being dependent on the initial state x(0) = x0 satisfies

Tx (x0 )



V (x0)1- c(1-)

for all x0

in some open neighborhood of the origin.

Lemma 8.1. [36] For any xi  R, i = 1, . . . , n and 0 < p  1, the following inequal-

ity holds (|x1| + · · · + |xn|)p  |x1|p + · · · + |xn|p  n1-p(|x1| + · · · + |xn|)p. When

0

<

p

=

p1 p2



1, where p1

and

p2

are positive odd integers, then the

following holds

|xp - yp|  21-p|x - y|p, for any x, y  R.

Lemma 8.2. [36] For any x  R, y  R, c > 0, d > 0 and  (x, y) > 0, a real-valued function, the following holds: |x|c|y|d  (c (x, y)/(c + d))|x|c+d + (d (x, y)-c/d /(c + d))|y|c+d .

8.5 Proposed control design
The purpose of this section is to devise a control law that stabilizes the system (8.24) in finite time. Given the fact that the Z-system (8.24) contains unmatched uncertainty, traditional adaptive techniques like the backstepping technique [29] and the multiple-surface sliding [37] cannot be used, because the variation bounds of di, i = 1, . . . , n are not assumed to be known. To solve the problem of finite-time stabilization with unmatched uncertainties, we propose a novel robust finite-time control scheme whereby a continuous recursive finite-time stabilizing control law is derived from the API technique [36] and an adaptive compensator.

Finite-time stabilization of underactuated mechanical systems 175

To develop the finite-time controller for (8.24), we first introduce the following tracking error e1 and the virtual errors em, m = 2, . . . , n as follows:

e1 = z1 - z1d

(8.26)

and

em = zm1/qm - zm1d/qm , m = 2, . . . , n

(8.27)

where qm = (4 n + 3 - 2m)/(4 n + 1) > 0, (  Z+); zm , m = 2, . . . , n is the virtual control given by zm d = -m-1emqm-1 with m-1 being positive constant to be determined later. One main feature for the use of the parameter in the fraction power qm is that
it allows adjusting the control precision and finite-time convergence of the state
variables.
The design procedure consists in n steps, throughout the n - 1 steps, the virtual controllers z(m-1)d will be designed. Upon the completion of step n, the fast control term as well the adaptive compensator are designed.

Step 1: Consider the following Lyapunov candidate function:

V1(z)

=

1

1 +

S e11+S

(8.28)

where S = (4 n - 1)/(4 n + 1). The time derivative of (8.28) gives

V1(z) = e1S e1

= e1S z2 + e1S (z2 - z2d ) + e1S d1(z)

(8.29)

By introducing the virtual control z2d = -1e1S , where 1 is a design parameter, V1(z) rewrites:

V1(z) = -1e12S + e1S (z2 - z2d ) + e1S d1(z)

(8.30)

Using Lemmas 8.1 and 8.2, the second term of (8.30) can be upper-bounded as follows:

e1S (z2

- z2d )



21-S |e2|S |e1|S



1 2

|e1|2S

+ C2|e2|2S

(8.31)

where C2 is a positive constant. In light of (8.31), the time derivative of V1(z) can be written as follows:

V 1 (z)



-1e12S

+

1 2

|e1|2S

+

C2|e2|2S

+

e1S d1(z)

(8.32)

Step 2: According to [24], a C1 and positive definite Lyapunov candidate function is constructed as

V2((z)) = V1(z) + W2(z1, z2)

(8.33)

with

W2(z1, z2) =

z2 z2d

1
 q2

- z2dq12

1+S -q2
d

(8.34)

176 The inverted pendulum in control theory and robotics

then it is easy to show that the Lyapunov function candidate V2(z) is positive definite

and

satisfies

V2(z)



max{

1 1+S

,

2}(e11+S

+

e21+S ).

Note

that

the

function

W2(z1,

z2)

has

the following properties:

 W2 (.)  z2

=

e21+S-q2

 W2 (.)  z1

=

-(1

+

S

-

q2

)

 z2dq12  z1

z2 z2d

1
 q2

- z2dq12

S -q2
d

=

-  z2dq12  z1

(z2

- z2d )

Hence, the derivative of W2(.) can be computed as follows:

(8.35) (8.36)

W 2(.)

=

e2z2

-

((z2

-

z2d

)

 z2dq12  z1

z1)

=

e2(z3

- z3d ) +

e2z3

+

e2d2(z)

-

(z2

-

z2d

)

 z2dq12  z1

z1

using the fact that

(8.37)

(z2

-

z2d

)

 z2dq12  z1

z1

 21-q2 e2q2

 z2dq12  z1

z2

+ 21-q2 e2q2

 z2dq12  z1

d1(z)

(8.38)

1
Let the first lumped unmatched uncertainty be 1 = e2d2(z) + 21-q2 1q2 e2q2 d1(z), it is then straightforward to obtain

W 2



e2(z3

-

z3d )

+

e2z3d

+

21-q2 

1 q2

e2q2 |z2|

+

1

(8.39)

According to Lemma 8.1, the third term of the right hand side of (8.39) can be bounded

such that

|z2|  |e2 + z2dq12 |q2  |e2|q2 + 1|e1|q2

(8.40)

which implies that

|e|2q2

21-q2



1 q2

|z2|



21-q2



1 q2

|e2|2q2

+

21-q2

 1+

1 q2

|e2|q2

|e1|q2



22(1-q2

)-1



2(1+

1 q2

)

|e2

|2q2

+

1 2

|e1|2q2

+

21-q2



1 q2

|e2|2q2

=

1 2

|e1

|2q2

+ C¯ 2|e2|2q2

(8.41)

where

C¯ 2

=

22(1-q2

)



2(1+

1 q2

)

+

21-q2 

1 q2

.

Combining (8.32), (8.39) and (8.41) yields the following:

V2(.)  -(1 - 1)|e1|2S + (C1 + C¯ 2)|e2|2S + e3z3d + e2(z3 - z3d ) + 1 (8.42)

Finite-time stabilization of underactuated mechanical systems 177

At

this

stage,

it

is

worth

to

note

that

q3

=

q2

-

4

2 n+1

,

which

implies

that

q3 =

1 + 2q2 = 1 + 2S. Therefore, by selecting 1 > n - 1 - , where  > 0 is a design parameter, and the virtual control z3d = -2z2qd3 with 2  n - 2 +  + C2 + C¯ 2,

we obtain

V2  -(n - 2 + )|e1|2S - (n - 2 + )|e2|2S + e2(z3 - z3d ) + 1

(8.43)

Step k (k: = 3 . . . n - 1): We proceed to the derivation of the virtual control by using an inductive argument. Suppose at step k - 1, that there exists a C1 Lyapunov candidate function Vk-1(z1, . . . , zk-1), positive definite and verifies

Vk-1(.)



max{

1

1 +

S

,

2}

k -1 m=1

em1+S

(8.44)

such that

k -1

k -2

Vk-1(.)  -(n - k + 1 + )

em2S + ek1+-S1-qk-1 (zk - zkd ) +

m

m=1

m=1

(8.45)

Now let us claim that (8.44) and (8.45) hold as step k. To prove this claim, consider the following Lyapunov candidate function:

Vk (z1, . . . , zk ) = Vk-1(.) + Wk (z1, . . . , zk )

(8.46)

with

Wk (.) =

zk

1

( qk

zdk

- zdkq1k )1+S-qk d

(8.47)

From the previous step, it can be observed that Wk (.) has the following properties:

Wk (.) = e1+S-qk  zk

Wk (.)  zm

=

-(1

+

S

-

qk

)

 zdkq1k  zm

zk

1

( qk

zdk

1
- zdqkk )S-qk d

(8.48) (8.49)

also, it is easy to show that Vk (.) is C1 and positive definite, which verifies Vk (.) =

max

1 1+S

,

2

k m=1

em1+S .

The

time

derivative

of

Vk

(.)

satisfies

178 The inverted pendulum in control theory and robotics

k -1

Vk (.)  -(n - k + 1 + )

em2S + ek1+-S1-qk-1 (zk - zdk ) + ek1+S-qk zk+1

m=1

+ ek1+S-qk dk (z)

+

k -1 m=2



Wk (.)  zm

zm

+

k -1 m=1

m

k -1

 -(n - k + 1 + )

em2S + ek1+-S1-qk-1 (zk - zdk ) + ek1+S-qk zk+1

m=1

+

k -1 m=2



Wk (.)  zm

zm+1

+

ek1+S-qk dk (z)

+

k -1 m=2



Wk (.)  zm

dm

(z)

k -1
+ m
m=1

(8.50)

If the kth lumped unmatched uncertainty is defined as k = ek1+S-qk dk (z) +

k -1 m=2



Wk (.)  zm

dm

(z),

then

(8.50)

rewrites:

k -1

Vk (.)  -(n - k + 1 + )

em2S + ek1+-S1-qk-1 (zk - zdk ) + ek1+S-qk zk+1

m=1

+

k -1 m=2



Wk (.)  zm

zm+1

+

k m=1

m

(8.51)

Next, we bound the second and the fourth terms of the right hand side of (8.51). First according to Lemma 8.2, it holds that

|ek1+-S1-qk-1 (zk - zdk )|  21+S-qk-1 |ek-1|1+S-qk-1 |ek |qk



|ek-1|2S 2

+ Ck |ek2S |

(8.52)

with Ck a positive constant. As for the fourth term, it is easy to obtain the following:

k -1 m=2



Wk (.)  zm

zm+1

 (1 + S - qk )21-qk |ek |S

k -1 m=2

 zdk  zm

zm+1

(8.53)

To further bound the fourth term in (8.51), we need to conduct the analysis by inductive argument and assume that at step k - 1, the following holds

k -2 m=2

 zdk  zm

zm+1

k -1



(k -1)m emS

m=1

(8.54)

where (k-1)m  0, then show the inequality also holds for k. Therefore, we have

k -1 m=2

 zdk  zm

zm+1



1
-kq-k 1

k -1 m=2

 ek -1  zm

zm+1

1
 kq-k 1

zkq1-k 1-1 qk -1

zk

+

k -2 m=2



z

1 qk -1

k -1

 zm

zm+1

(8.55)

Finite-time stabilization of underactuated mechanical systems 179

In light of the definition of the tracking error, it is worth recalling that em

=

1
zmqm

- zm dq1m

and zm = -m-1emqm-1, it can then be inferred that zm q1m

1
= -mqm-1em-1, and therefore,

the following inequality holds

|zm|  |em + zm q1m |qm  |em|qm + m-1|em-1|qm

(8.56)

Applying (8.56) to the inequality (8.55) and using the assumption of the inequality (8.54) yields

k -1 m=2

 zdk  zm

zm+1

1
 kq-k 1

1 qk -1

|ek -1 |1-qk -1

+

 e 1 qk -1

-1

1-qk -1

k -2

k -2

+ k-1|ek-1|qk

+

k -2 m=2

 zdk  zm

zm+1

k
 km|em|S
m=1

with km being a positive constant. Therefore,

k -1 m=2



Wk (.)  zm

zm+1

 (1 + S - qk )21-qk |ek |S



1 2

k -1 m=1

em2S

+

C¯ k |ek |2S

k
km|em|S
m=1

with C¯ k  0 being a positive constant. Substituting (8.52) and (8.58) into (8.51) leads to

|ek |qk (8.57) (8.58)

Vk (.)



-(n - k

+

1 + )

k -1

em2S

+ (Ck

+ C¯ k )|ek |2S

+

|ek-1| 2

+

1 2

k -1

em2S

m=1

m=1

k

+

k + ek1+S-qk (zk+1 - zd(k+1)) + ek1+S-qk zk+1

m=1

k -1
 -(n - k + ) em2S + (Ck + C¯ k )|ek |2S + ek1+S-qk (zk+1 - zd(k+1))
m=1

k

+ ek1+S-qk zk+1 +

k

m=1

(8.59)

By introducing the virtual control z(k+1)d = -k ekqk+1 with k selected such that k  n - k +  + Ck + C¯ k > 0, we get

180 The inverted pendulum in control theory and robotics

k

k

Vk (.)  -(n - k + ) em2S + ek1+S-qk (zk+1 - z(k+1)d ) + k

m=1

m=1

(8.60)

Step n: This is the final stage of the design where the real control input appears in the dynamics. For this step, consider the nth part of the Lyapunov candidate function

Vn(z1, . . . , zn) = Vn-1(.) + Wn(z1, . . . , zn)

(8.61)

where

Wn(.) =

zn

(

1 qn

1
- znqn )1+S-qn d

znd

(8.62)

then, it is obvious to conclude that Vn(.) is C1, positive definite and satisfies Vn(.) 

max{

1 1+S

,

2}

n m=1

em1+S

.

Furthermore,

let

G

=

G

-G

be

the

estimate

error

of

the

matched and unmatched uncertainty and G is the total lumped uncertainty to be

defined later. From the above inductive argument, one can conclude that

n-1

n-1

Vn  - em2S + en1+S-qn zn + (Cn + C¯ n)en2S + m

m=1

m=1

n-1
 - em2S + en1+S-qn (bnu + dn(z)) + (Cn + C¯ n)en2S
m=1

+ en1+S-qn

n-1

enqn -1-S

m

m=1

n-1

 -

em2S + bnen1+S-qn u + (Cn + C¯ n)en2S + bnen1+S-qn

m=1

+

enqn -1-S bn

n-1
m
m=1

dn(z) bn

(8.63)

where Cn > 0 and C¯ n > 0 are positive constants. The actual control law can therefore be designed as follows:

u = -nenqn+1 - Gsign( ) with the compensator being designed as follows:
G = | |,  = e1+S-qn

(8.64) (8.65)

where G is the estimation of the total uncertainty function G defined as G =

+ dn (z)
bn

enqn -1-S bn

the designer.

n-1 m=1

m

and

n

is

a

positive

design

parameter

chosen

arbitrarily

by

The main result of this chapter can be summarized in the following theorem.

Finite-time stabilization of underactuated mechanical systems 181

Theorem 8.2
Consider the nth order underactuated system in the X -space represented by (8.20), through the coordinate transformation (8.21) and under Assumptions 8.1 and 8.2, the finite-time convergence objective specified in (8.25) is achieved by the control input u consisting of (8.64) and the compensator (8.65) with the virtual control zm d , m = 1, . . . , n being applied.

Proof.

Consider the Lyapunov function V

= Vn(.).

Since

bn 2

G2

is positive definite,

then

V



Vn(.) +

bn 2

G2

.

Taking

the

derivative

of

V

along

(8.63),

yields

V  Vn - bnGG

n-1

 -

em2S + bnen1+S-qn u + (Cn + C¯ n)en2S + bnen1+S-qn

m=1

dn(z) bn

+

enqn -1-S bn

n-1
m
m=1

- bnGG

n-1

 -

em2S + bnen1+S-qn u + (Cn + C¯ n)en2S + bnen1+S-qn G - bnGG (8.66)

m=1

Substituting the control law (8.64) and the update law (8.65) in (8.66) leads to

n-1
V  - em2S - bnnen1+S-qn+qn+1 + (Cn + C¯ n)en2S - bn Gsign( )
m=1
+ bn G - bnGG
n-1
 - em2S - (bnn - Cn - C¯ n)en2S + bn(G - G| |) - bnG| |
m=1

(8.67)

If n is chosen such that nbmax - Cn - C¯ n > , it follows from (8.67) that

n
V  - em2S
m=1

(8.68)

Noting

that V

=

Vn(.)



max{

1 1+S

,

2}

n m=1

em1+S

and

using

Lemma

8.1,

we

have

Vn

(.)

2S 1+S

 max

1 1+S,2

n
em2S
m=1

(8.69)

Let



:=

2S 1+S

,

then

it

is

easy

to

conclude

that

dV (.)  V  dt

(8.70)

182 The inverted pendulum in control theory and robotics

with



=

. 

max{

1 1+S

,2}

From

(8.70),

it

is

straightforward

to

conclude

from Theorem

8.1

that the solutions of the closed-loop system consisting of (8.24) and the control input

(8.64) along with the compensator (8.65) are finite-time stable, and therefore, the

limit in (8.25) is satisfied. This completes the proof.

8.6 Numerical simulations: the case of the cart­pole system

The cart­pole inverted pendulum depicted schematically in Figure 8.1 consists of a pole mounted on a cart by means of a pivot in such a way that the pole can freely swing in the x­y plane. The equations of motion can be obtained by neglecting friction in the pivot and by applying the Euler­Lagrange formulation. The system model can be represented as follows [34]:

(M + m sin2  )x¨ - m sin  (l2 - g cos  ) = u

(8.71)

(M + m sin2  )l¨ + ml2 sin  cos  - (M + m)g sin  = - cos  (u)

where M is the mass of the cart, m is the mass of the pendulum, l is half the length of
the pendulum, i.e., the distance from the pivot to the center of mass of the pendulum,
g is the acceleration due to gravity. The cart­pole system has two equilibrium points, one of which is known as the stable vertically downward position where  = , and the other one being the unstable vertically upward position where  = 0. F(t)
is the horizontal force being applied to the cart to swing the pendulum until it reaches the desired unstable position where  = 0,  = 0 and x = 0. As can be seen from the
equations of motion (8.71), only one control u appears in both dynamic equations of
the cart­pole system; therefore, the whole system is underactuated. Meaning that it has fewer control inputs than degrees of freedom. Let x = [x, x,  , ] = [x1, x2, x3, x4]  R4, then the state-space representation of the cart­pole system becomes

u(t) x(t)

m, l 
M

Figure 8.1 Schematic view of the cart­pole inverted pendulum

Finite-time stabilization of underactuated mechanical systems 183

x1 = x2 x2 = f2(x) + b2(x)u x3 = x4 x4 = f4(x) + b4(x)u

(8.72)

where

f2(x)

=

, mlx42 sin x3-mg sin x3 cos x3
M +m sin2 x3

b2(x)

=

M

1 +m sin2

x3

,

f4(x) =

(M +m)g sin x3-mlx42 sin x3 cos x3 Ml+ml sin2 x3

and

b4(x)

=

- cos x3 Ml+ml sin2

x3

.

The state-space representation

(8.72) is in the form (8.20) with n = 4. The system can be readily transformed from

the X -space into Z-space using the coordinate transformation (8.21) as follows:

z1 = x1 -

x3 0

b2(s) ds b4(s)

=

x1

+

l

ln(

sec x3

+

tan

x3)

z2

=

x2

-

b2 b4

(x) (x)

x4

=

x2

+ lx4 sec x3

z3 = x3

z4 = x4

(8.73)

with the change of coordinate (8.73), the system dynamics in the Z-space becomes

z1 = z2 + d1(z) z2 = z3 + d2(z) z3 = z4 + d3(z) z4 = b4(z)u + d4(z)

(8.74)

where d1(z) = d3(z) = 0 and

d2(z)

=

-z3

-

lz42 sec z3

tan z3

+

(M

+

m)g tan z3 - mg sin z3 M + m sin2 z3

cos z3

d4(z) =

(M + m)g sin z3 - mlz42 sin z3 cos z3 Ml + ml sin2 z3

b4(z) =

- cos z3 Ml + ml sin2 z3

(8.75)

The objective is then to control the transformed system (8.74) such that all states z1, z2, z3 and z4 converge in finite time to zero regardless of the internal uncertainties and external disturbances. For such system, the virtual controllers and the actual

184 The inverted pendulum in control theory and robotics

Position (m)

20 15 10 5 0 ­5
0
1.5 1
0.5 0
­0.5 ­1 0

5

10

15

20

25

30

Time (s)

5

10

15

20

25

30

Time (s)

Angle (rad)

Figure 8.2 Trajectories of the cart position and pendulum angle versus time

control law are designed according to the development of Theorem 8.2 and are as

follows: 

zz12dd

= =

0, -1e1q2 ,

zz43dd

= =

-2e2q3 , -3e3q4 ,

e1

1
= z1q1

- z1dq11

e2

1
= z2q2

- z2dq12

e3

1
= z3q2

- z3dq12

e4

1
= z4q2

- z4dq12

(8.76)

and

u = -4e4q5 - Gsign( ) G = | |,  = e1+S-q4

(8.77)

To demonstrate the performance of the proposed robust finite control law, we have

performed numerical simulations on MATLAB®/Simulink® framework, considering

the following system parameters m = 1 kg, M = 2 kg and l = 0.5 m. The initial

conditions

are

chosen

as

x

=

[1,

0,

 3

,

0]

, the desired state is xd = [0, 0, 0, 0]

. The

control gains are chosen to be  = 10, 1 = 13, 2 = 12, 3 = 11 and 4 = 20. Dif-

ferent simulation scenarios have been considered. The first simulation scenario is

the control of uncertain cart­pole system without external disturbances. The second

one considers the case of an uncertain cart­pole system with the presence of external

disturbances.

1. Scenario 1: Uncertain cart­pole system without external disturbances In this scenario, we assume that the system dynamics is completely unknown except for the sign condition in Assumption 8.2. The obtained simulation results

Control effort (N)

Finite-time stabilization of underactuated mechanical systems 185
20

15

10

5

0

­5

­10

0

2

4

6

8

10

12

14

16

18

20

Time (s)

Figure 8.3 Evolution of the control effort versus time

z3

z1

20 15 10
5 0 ­5
0
1.5 1
0.5 0
­0.5 ­1 0

10

20

30

Time (s)

10

20

30

Time (s)

10

5

z2

0

­5

40

0

1

0.5

0

z4

­0.5

­1

­1.5

40

0

10

20

30

40

Time (s)

10

20

30

40

Time (s)

Figure 8.4 Evolution of the trajectories of Z-space state variables versus time

are shown in Figures 8.2­8.4. It is clear in Figure 8.2 how the cart displacement and the pendulum angle converge in finite time to zero despite the uncertainties present in the system dynamics. The control effort being deployed is shown in Figure 8.3. Figure 8.4 shows the convergence to zero of the state variables in the Z-space. Clearly, the algorithm performs well in the presence of model parameters' uncertainties.

186 The inverted pendulum in control theory and robotics

Position (m)

10 5 0 ­5 ­10 0
1.5 1
0.5 0
­0.5 ­1 0

5

10

15

20

25

30

35

40

45

50

Time (s)

5

10

15

20

25

30

35

40

45

50

Time (s)

Angle (rad)

Figure 8.5 Evolution of the trajectories of the cart position and pendulum angle accounting for disturbances

Control effort (N)

25 20 15 10 5 0 ­5 ­10 ­15 ­20
0

5

10

15

20

25

30

35

40

45

50

Time (s)

Figure 8.6 Evolution of the control effort accounting for disturbances

2. Scenario 2: Uncertain cart­pole system with external disturbances In this simulation scenario, on top of the uncertainties that the system dynamics contains, a periodic perturbation d(t) = sin (2t) is added as an external excitation to the cart­pole system during the time interval t  [20, 35] s in order to test the robustness of the proposed control approach. The obtained simulation results are depicted in Figures 8.5­8.7. From Figure 8.5, it can be noticed that despite the existing uncertainties and the considered external disturbance,

Finite-time stabilization of underactuated mechanical systems 187

z1

10 5 0 ­5 ­10
0
1.5 1
0.5 0
­0.5 ­1 0

10

20

30

40

50

Time (s)

10

20

30

40

50

Time (s)

z4

z2

4

2

0

­2

­4

­6

0

10

20

30

40

50

Time (s)

2

1

0

­1

­2

­3

0

10

20

30

40

50

Time (s)

z3

Figure 8.7 Evolution of the trajectories of Z-space state variables accounting for disturbances

the controller is able to steer the system to its desired values. The control effort after the application of the disturbances is shown in Figure 8.6, clearly the amplitude of the control input even with the external perturbation remains with reasonable size. The convergence of the state variables in Z-space is shown in Figure 8.7. From these figures, it can be seen that our control design is robust to tolerate significant variation of the system parameters as well as the external disturbances.

8.7 Conclusion
In this paper, the problem of global finite-time stabilization was addressed for the control of a class of uncertain underactuated mechanical systems. By integrating a fractional power feedback control method with a compensator, the uncertainties in the system can be effectively handled and finite-time stabilization is achieved. Future work is to extend the current design technique to a class of chained form systems perturbed by external disturbances as well as experiments on the inertia wheel inverted pendulum.

References
[1] N. Adhikary and C. Mahanta. `Integral backstepping sliding mode control for underactuated systems: swing-up and stabilization of the cart­pendulum system', ISA Transactions, 2013, 58, pp. 870­880.

188 The inverted pendulum in control theory and robotics
[2] F. Amato, M. Ariola, and P. Dorato. `Finite-time control of linear systems subject to parametric uncertainties and disturbances', Automatica, 2001, 37, 9, pp. 1459­1463.
[3] S.Andary, A. Chemori, and S. Krut. `Control of the underactuated inertia wheel inverted pendulum for stable limit cycle generation', RSJ Advanced Robotics, 2009, 23, 15, pp. 1999­2014.
[4] S. Andary and A. Chemori. `A dual model-free control of non-minimum phase systems for generation of stable limit cycles', In Proc. 50th IEEE Conf. Decision Contr. (CDC'11), Montreal, Canada, 2011, pp. 1387­1392.
[5] S. Andary, A. Chemori, M. Benoit, and J. Sallantin. `A dual model-free control of underactuated mechanical systems, application to the inertia wheel inverted pendulum', In American Control Conference (ACC'12), Montreal, Canada, 2012, pp. 1029­1034.
[6] M. Bergerman. Dynamics and Control of Underactuated Manipulators. PhD Thesis, Carnegie Mellon University, 1996.
[7] S. P. Bhat and D. S. Bernstein. `Finite-time stability of continuous autonomous systems', SIAM Journal on Control and Optimization, 2000, 38, 3, pp. 751­766.
[8] W. Blajer and K. Kolodziejczyk. `Modeling of underactuated mechanical systems in partly specified motion', Journal of Theoretical and Applied Mechanics, 2008, 46, 2, pp. 383­394.
[9] S. A. Bortoff and M. W. Spong. `Pseudolinearization of the acrobot using spline functions', In Proc. 31st IEEE Conf. Decision Contr., Tucson, Arizona, USA, 1992, pp. 593­598.
[10] A. Chemori and M. Alamir. `Nonlinear predictive control of under-actuated mechanical systems, application: the ecp 505 inverted pendulum', In MTNS'06 Proc. Mathematical Theory of Networks and Systems, Leven, Belgium, 2004.
[11] N. Khraief, A. Chemori and S. Belghith. ` External disturbance rejection in IDA-PBC controller for underactuated mechanical systems: from theory to real-time experiments', In IEEE Multi-Conference on Systems and Control (MSC'14), Antibes, France, 2014, pp. 1747­1752.
[12] D. Cheng and W. Lin. `On normal form of nonlinear systems', IEEE Transactions on Automatic Control, 2003, 48, 11, pp. 1242­1248.
[13] A. Choukchou-Braham, B. Cherki, M. Djemai, and K. Busawon. Analysis and Control of Underwatcuated Mechanical Systems. London, UK: Springer, 2014.
[14] I. Fantoni and R. Lozano. Non-linear Control for Underactuated Mechanical Systems. New York, USA: Springer-Verlag, 2001.
[15] T. I. Fossen. Nonlinear Modelling and Control of Underwater Vehicles. PhD Thesis, Norwegian Institute of Technology, 1991.
[16] L. B. Freidovich, P. La Hera, U. Mettin, A. Robertsson, and A. S. Shiriaev. `Shaping stable periodic motions of inertia wheel pendulum: theory and experiments', Asian Journal of Control, 2009, 11, 5, pp. 548­556.

Finite-time stabilization of underactuated mechanical systems 189
[17] L. Freidovicha, A. Robertssona, A. Shiriaeva, and R. Johanssonb. `Periodic motions of the pendubot via virtual holonomic constraints: theory and experiments', Automatica, 2008, 44, pp. 785­791.
[18] S. Ge and F. Lewis. Autonomous Mobile Robots. Boca Raton, FL: CRC Press, Taylor & Francis Group, 2006.
[19] V. T. Haimo. `Finite-time controllers', SIAM Journal on Control and Optimization, 1986, 24, pp. 760­770.
[20] Y. Hong. `Finite-time stabilization and stabilizability of a class of controllable systems', System & Control Letters, 2002, 46, pp. 231­236.
[21] Y. Hong, J. Wang, and Z. Xi. `Stabilization of uncertain chained form systems within finite settling time', IEEE Transactions on Automatic Control, 2005, 50, 9, pp. 1379­1384.
[22] Y. G. Hong and Z. P. Jiang. `Finite-time stabilization of nonlinear systems with parametric and dynamic uncertainties', IEEE Transactions on Automatic Control, 2006, 51, pp. 1950­1956.
[23] Y. G. Hong, K. Wang, and D. Cheng. `Adaptive finite-time control of nonlinear systems with parametric uncertainty', IEEE Transactions on Automatic Control, 2006, 51, pp. 858­862.
[24] X. Huang, W. Lin, and B. Yang. `Global finite-time stabilization of a class of uncertain nonlinear systems', Automatica, 2005, 41, pp. 881­888.
[25] S. Jadlovska and J. Sarnovsky. `Application of the state-dependent riccati equation method in nonlinear control design for inverted pendulum systems', In IEEE 11th International Symposium on Intelligent Systems and Informatics (SISY'13), pages 209­214, Subotica, Serbia, 2013.
[26] S. Jadlovska and J. Sarnovsky. `A complex overview of modeling and control of the rotary single inverted pendulum system', Power Engineering and Electrical Engineering, 2013, 11, 2, pp. 73­85.
[27] S. Jadlovska and J. Sarnovsky. `Modeling and optimal control of nonlinear underactuated mechanical systems a survey', In 13th Scientific Conference of Young Researchers FEI TU of Kosice, Herlany, Slovakia, 2013, pp. 32­35.
[28] N. Khalid and A. Y. Memon. `Output feedback control of a class of underactuated nonlinear systems using extended high gain observer', Arabian Journal for Science and Engineering, 2016, 41, 9, pp. 3531­3542.
[29] H. Khalil. Nonlinear Systems. Prentice-Hall, Upper Saddle River, Second ed., NJ, USA, 1996.
[30] K. Lee and V. `Coverstone-Carroll. Control algorithms for stabilizing underactuated robots'. Journal of Robotic Systems, 1998, 15, 12, pp. 681­697.
[31] A. De Luca, R. Mattone, and G. Oriolo. `Stabilization of underactuated planar 2r manipulator', International Journal of Robust and Nonlinear Control, 2000, 10, 4, pp. 181­198.
[32] Y. Nakamura, T. Suzuki, and M. Koinuma. `Nonlinear behavior and control of nonholonomic free-joint manipulator', IEEE Transactions on Robotics and Automation, 1997, 13, 6, pp. 853­862.

190 The inverted pendulum in control theory and robotics
[33] R. Reza Olfati-Saber. Nonlinear Control of Underactuated Mechanical Systems with Application to Robotics and Aerospace Vehicles. PhD Thesis, Massachusetts Institute of Technology, 2001.
[34] M. Park and D. Chwa. `Swing-up and stabilization control of inverted pendulum systems via coupled sliding-mode control method', IEEE Transactions on Industrial Electronics, 2009, 56, pp. 3541­3555.
[35] G. Poulin, A. Chemori, and N. Marchand. `Minimum energy oriented global stabilizing control of the PVTOL aircraft', International Journal of Control, 2007, 80, 3, pp. 430­442.
[36] C. Qian and W. Lin. `A continuous feedback approach to global strong stabilization of nonlinear systems', IEEE Transactions on Automatic Control, 2001, 46, 7, pp. 1061­1079.
[37] D. Qian, J. Yi, and D. Zhao. `Hierarchical sliding mode control for a class of SIMO under-actuated systems', Control and Cybernetics, 2008, 37, 1, pp. 1­18.
[38] M. T. Ravichandran and A. D. Mahindrakar. `Robust stabilization of a class of underactuated mechanical systems using time scaling and Lyapunov redesign', IEEE Transactions on Industrial Electronics, 2011, 58, pp. 4299­4313.
[39] M. Reyhanoglu, S. Ludvigsen, and O. Egeland. `Discontinuous feedback control of a special class of underactuated mechanical systems', International Journal of Robust and Nonlinear Control, 2000, 10, 4, pp. 265­282.
[40] M. Spong. `Partial feedback linearization of underactuated mechanical systems', In EEE/RSJ/GI International Conference on Intelligent Robots and Systems, Munich, Germany, 1994, pp. 314­321.
[41] M. Spong. `The swing up control problem for the acrobot', IEEE Control Systems Magazine, February 1995, 15, 1, pp. 49­55.
[42] M. Spong. `Energy based control of a class of underactuated mechanical system', In 13th IFAC World Congress, San Francisco, USA, 1996, pp. 431­436.
[43] M. Spong. Underactuated mechanical systems. Control Problems in Robotics and Automation, B. Siciliano and K. P. Valavanis Eds., LNCIS, Springer Verlag, 230:135­150, 1998.
[44] M. W. Spong and L. Praly. Control Using Logic-Based Switching, volume 222 of Lecture Notes in Control and Information Sciences, chapter Control of underactuated mechanical systems using switching and saturation, pages 162­172. Springer, Heidelberg, Germany, 2006.
[45] N. Touati and A. Chemori. `Predictive control for the stabilization of a fast mechatronic system: from simulation to real-time experiments', In, Hangzhou, China, 2013 International IFAC Symposium on Mechatronic Systems (Mechatronics'13), pp. 237­242.
[46] J. Xu, Z. Guo, and T. H. Lee. `Design and implementation of integral sliding mode control on an underactuated two-wheeled mobile robot', ISA Transactions, 2013, 58, pp. 870­880.

Part III
Nonlinear controllers for mobile inverted pendulum systems

Chapter 9
Advances in robust control of mobile wheeled inverted pendulum
Jian Huang1 and Toshio Fukuda2
Abstract
There has been increasing interest in a type of underactuated mechanical systems, mobile-wheeled inverted-pendulum (MWIP) models, which are widely used in autonomous robotics and intelligent vehicles. To cope with the model uncertainties and external disturbances, several robust controllers are designed for the MWIP models. For the velocity-tracking problem of the MWIP systems, we proposed two sliding-mode-control (SMC) methods. There is still a steady tracking error when the first SMC method is used. By assuming a novel sliding surface, the second SMC method is designed to solve this problem. Using a coordinate transformation, the non-"Class-I" type underactuated MWIP system is presented as a semistrict feedback form which is convenient for controller design. A dynamic surface controller with a nonlinear disturbance observer (DSCNDO) is then designed to solve the balance control problem of the MWIP systems. The proposed DSCNDO can compensate the external disturbances and the model uncertainties to improve the system performance significantly. The stabilities of the closed-loop MWIP systems using the proposed methods are proved by Lyapunov theorem. The effectiveness of all the methods is verified by numerical simulations.
9.1 Introduction
In the past decades, many efforts have been devoted to controlling problems of mobile wheeled inverted pendulum (MWIP) models, which are widely applied in the field of autonomous robotics and intelligent vehicles [1­10]. The MWIP is a typical underactuated system, which is nonlinear and inherently unstable. This makes the control of MWIP to be a very challengeable problem. On the other hand, there are a lot of
1School of Automation, Huazhong University of Science and Technology, China 2Faculty of Science and Engineering, Meijo University, Nagoya, Japan

194 The inverted pendulum in control theory and robotics
practical systems implemented based on MWIP models, including the JOE [5], the Nbot [6], the Legway [7], the B2 [8], the Segway [9], the UW-Car [11] and so on. These systems are characterized by the ability to balance on its two wheels and spin on the spot. This additional maneuverability allows easy navigation on various terrains, turning sharp corners and traversing small steps or curbs. In addition, the compact structure design allows drivers to access most places that can only be accessed by walkers in the past. Moreover, people can travel in short distances in a small area by such kind of vehicles instead of by cars or by buggies that are more polluted.
Due to the nonlinear, underactuated and inherent unstable dynamics, the MWIP models have attracted much attention in the field of control theory and engineering. It should be noted that there are a lot of control methods have been applied in benchmark underactuated systems including the inverted pendulum, the acrobot and the rotating pendulum [12­15], whereas most of these methods are based on exact mathematical models. Therefore, they are lack of robustness to model errors and external disturbances. In the practical applications, there are unavoidable uncertainties caused by both internal and external effects. Therefore, the robust control of MWIP has to be dealt with.
It is not easy to design robust controllers for nonlinear underactuated systems, whose control problems have been proved to be challenging because the techniques of fully actuated systems cannot be used directly. With the great efforts of researchers, several robust control methods have been proposed for the underactuated system in the recent years. The first common-used robust control strategy is the sliding mode control (SMC) technique. Sankaranarayanan [16] proposed a SMC algorithm to robustly stabilize a class of underactuated mechanical systems that are not linearly controllable and violate Brockett's necessary condition for smooth asymptotic stabilization of the equilibrium, with parametric uncertainties. Park et al. [17] proposed an adaptive neural SMC method for trajectory tracking control of nonholonomic wheeled mobile robots with model uncertainties and external disturbances. The second robust control strategy discussed in this chapter is the dynamic surface control (DSC). In order to avoid the "explosion of terms" problem of Integrator Backstepping controller and the "chattering problem" of SMC controller, the DSC method was developed by Swaroop et al. [18]. Recently, the DSC technique has been applied into the control of different underactuated mechanical systems, including the underactuated marine vessels [19], the inertia wheel pendulum, the translational oscillator with rotational actuator, the acrobot [20] and so on. For the MWIP model, we investigated both the SMC and DSC strategies in our previous studies [11,21,22].
To reduce the effect from uncertainties to the MWIP system, the nonlinear disturbance observer (NDO) might be a candidate solution. It is found that using a disturbance observer can further improve the robustness of controller. A NDO was proposed by Mohammadi to manage the disturbance of nonlinear system, which is applied for a four-degree of freedom selective compliance assembly robot arm (SCARA) manipulator [23]. Chen proposed a NDO to deal with the disturbance of nonlinear system [24], which is applied to tracking control of pneumatic artificial muscle actuator by using DSC control method [25]. For an uncertain structural systems, Wei et al. proposed a new type of composite control scheme of disturbance

Advances in robust control of mobile wheeled inverted pendulum 195
observer-based control and terminal SMC [26]. Yang et al. [27] for systems with mismatched uncertainties proposed a SMC approach by using a novel sliding surface based on a disturbance observer.
In this chapter, we first introduce the mathematical model of MWIP using Lagrange motion equations in Section 9.2. The velocity SMC controller of the MWIP with modeling uncertainties and external is designed in Section 9.3. In Section 9.4, a new dynamic surface controller with nonlinear disturbance observer (DSCNDO) is developed by combining conventional DSC and NDO techniques for the balancing control of MWIP system. For all these controllers, the stabilities of closed-loop MWIP system are proved. Finally, numerical simulations are presented to verify the effectiveness of the proposed approaches.
9.2 Modeling of mobile wheeled inverted pendulum
9.2.1 Derivation of dynamic model
The MWIP system is modeled as a one dimensional inverse pendulum which rotates about the wheels' axles. Hence, the body's motion on a plane is determined by the inclination and translational motion. Figure 9.1 shows the structure of an MWIP system, where w and b are the wheel's rotation angle and the inclination angle of the body, respectively. The coordinates of the wheel and body are denoted by (xw, yw) and (xb, yb), respectively. We suppose that the system moves on a slope with constant but uncertain angle , which is hard to be measured by sensors. To describe the parameters of the MWIP system, some notations should be clarified first (see also Figure 9.1):
1. mb, mw--masses of the body and the wheel. 2. Ib, Iw--moments of inertia of the body and the wheel. 3. l--length between the wheel axle and the center of gravity of the body.

b

(xb, yb)

(xw, yw) y
x

W 

 
mw, Iw, rw

mb, Ib

Figure 9.1 The mobile wheeled inverted pendulum system model

196 The inverted pendulum in control theory and robotics

4. rw--radius of the wheel. 5. Db--viscous resistance in the driving system. 6. Dw--viscous resistance of the ground.

The positions and velocities of the wheel and the body can be given by

xb = l sin b + rww cos  ,
yb = l cos b + rww sin 

xw = rww cos  yw = rww sin 

xb = lb cos b + rww cos  ,
yb = -lb sin b + rww sin 

xw = rww cos  yw = rww sin 

(9.1) (9.2)

The Lagrangian equation of motion is used for the derivation of the dynamic equation. The kinetic, potential and dissipated energy and their contributions to the dynamic equation are computed as follows.
The kinetic energies of the body and the wheel can then be computed as

1 Vb = 2 mb

xb2 + yb2

+

1 2

Ibb2

=

1 2 mb

rw2 w2

+ 2rwlbw cos(b

+ ) + l2b2

+

1 2

Ib

b2

(9.3)

Vw

=

1 2 mw

xw2

+ yw2

+

1 2

Iw

w2

=

1 2

mw

rw2

w2

+

1 2

Iw

w2

.

(9.4)

The gravitational potential energy of the body and the wheel can be computed as

Ub = mbg(l cos b + rww sin ) Uw = mwgrww sin 

(9.5) (9.6)

Therefore, the Lagrange function L is given by

L = Vb + Vw - Ub - Uw

(9.7)

According to Lagrange's motion equation, the dynamic model of an MWIP system can be represented by

d dt

L  b

-

L  b

=

-

- Db

b - w

d dt

L  w

-

L  w

=

+ Db

b - w

- Dww

It follows from (9.8) that the final nonlinear model can be

 

m11¨w

+

(m12

cos(b

+

))¨b

=

- Dww + Db

b - w



+ (m12

m12b2 sin(b + cos(b + ))¨w

) +

- M~ m22¨b

= -

- Db

b - w

+ Gb sin b

(9.8) (9.9)

Advances in robust control of mobile wheeled inverted pendulum 197

where parameters m11, m12, m22 and Gb satisfy





m11 m12

= =

(mb + mblrw

mw )rw2

+

Iw



m22 = mbl2
Gb = mbgl M~ = (mb +

+ Ib mw )rw

g

sin

.

(9.10)

9.2.2 Analysis of equilibriums

By choosing the state variable as x = x1 x2 x3 T = b w b T, the state model of an MWIP system can be represented by

x1 = x3

(9.11a)

m11x2 + (m12 cos(x1 + )) x3 =  - Dwx2 + Db(x3 - x2) + m12x32 sin(x1 + ) - M~
(m12 cos(x1 + ))x2 + m22x3 = - - Db(x3 - x2) + Gb sin x1 Then we can get the vector form of this dynamic model:

(9.11b) (9.11c)

M(x)x = F(x) + u

(9.12)

where





1

0

0

M(x) =  0

m11

m12 cos(x1 + ) 

0 m12 cos(x1 + )

m22





x3

F(x) =  -Dwx2 + Db(x3 - x2) + m12x32 sin(x1 + ) - M~ 

-Db(x3 - x2) + Gb sin x1

u = 0  - T.

(9.13) (9.14) (9.15)

Suppose x = x1 x2 x3 T is the desired equilibrium of system (9.12), satisfying

x3 = 0, Gb sin x1 = Dwx2 + M~

(9.16)

In the case of velocity control problem, the desired velocity w = x2 is always given in advance. The desired inclination angle of the body, x1, is then determined by (9.16), whereas different body parameters and unknown slope angle result in different inclination angle x1, which makes it impossible to compute the exact equilibrium before the controller design. Normally, it is difficult to design a controller if we do not
know the exact equilibrium in advance. Especially in the case of using a linearized
model, we even cannot obtain such model because it is generated by linearizing
the nonlinear system around the equilibrium. This problem can be partially solved
by estimating the equilibrium using nominal system parameters without considering
any uncertainties, whereas the controller based on the estimated equilibrium cannot

198 The inverted pendulum in control theory and robotics
guarantee that the system finally moves at the desired velocity, even if it is asymptotic stable. This will be further discussed in the rest of this chapter.
In the rest of this chapter, "a^" denotes that the term a is evaluated based on corresponding parameter of the nominal system moving on a flat ground without any uncertainties and disturbances.

9.3 Sliding mode controller design for mobile wheeled inverted pendulum

9.3.1 Type-I sliding mode controller for MWIP

Two types of SMC controllers, Type-I and Type-II, will be discussed for the MWIP system. We first introduce the design procedure of Type-I SMC controller for the MWIP system. This controller design is based on full state feedback. The sliding surface is defined as a weighted combination of position tracking error and velocity tracking error, which is given by

s = 1x~1 + 2x~2 + x~3

(9.17)

where x~i = xi - x^i are the tracking errors with i = 1, 2, 3 and coefficients 1, 2 are constants to be determined. As pointed out in the previous section, exact system
equilibriums cannot be obtained in advance. Hence we use nominal system parameters to calculate the estimation x^i of the actual desired xi. Thus the estimation x^i is given by

x^3 = 0, x^2 = x2, G^ b sin x^1 = Dwx^2

(9.18)

The state trajectories can be driven to the sliding surface by choosing the control law  such that

ss  - |s|

(9.19)

where  is a positive constant. From (9.11), it follows that
M1(x)x2 + M2(x)x3 = -Dwx2 + Gb sin x1 + m12x32 sin(x1 + ) - M~

(9.20)

where

M1(x) = m11 + m12 cos(x1 + ) , M2(x) = m22 + m12 cos(x1 + ) (9.21)

From (9.20), we can rewrite (9.11) as



 x1 = x3



M¯ M¯

(x)x2 (x)x3

+ +

b(x) a(x)

= =

M2(x) -M1(x)

(9.22)

where M¯ (x) = m11m22 - (m12 cos(x1 + ))2,

(9.23)

Advances in robust control of mobile wheeled inverted pendulum 199

a(x) = -[m12(Db + Dw) cos(x1 + ) + m11Db]x2

+ (m11 + m12 cos(x1 + ))Dbx3 + (m12x3)2 cos(x1 + ) sin(x1 + )

- m11Gb sin x1 - m12 cos(x1 + )M~ ,

(9.24)

b(x) = [m22(Db + Dw) + m12Db cos(x1 + )]x2

- (m22 + m12 cos(x1 + ))Dbx3 - m12m22x32 sin(x1 + )

+ m12Gb sin x1 cos(x1 + ) + m22M~ .

(9.25)

Note that variable M¯ is positive because it is the determinant of the positive

definite matrix of the kinetic energy [28].

Define

f1(x)

=

a(x) + 2b(x) M¯ (x)

,

f^1(x)

=

a^(x) + 2b^(x) M^¯ (x)

(9.26)

and the estimation error caused by modeling uncertainty and disturbances is assumed to be bounded by some known function F1(x),

f1(x) - f^1(x)  F1

(9.27)

Further, we assume that

2M2(x) - M1(x) M¯ (x)

=

(1

+

)

2

M^ 2(x) - M^ 1 M¯^ (x)

(x)

,

| |  1 < 1

(9.28)

Note that the assumptions (9.27) and (9.28) are common-used in the SMC, which can be found in [29].

Theorem 9.1. The achievement of a sliding motion on the surface (9.17) can be guaranteed by selecting the control law



=

1 2M^ 2(x) -

M^ 1(x)

a^(x) + 2b^(x)

-

1M¯^ (x) 2M^ 2(x) - M^ 1

(x)

x3

+

M¯^ (x) 2M^ 2(x) - M^ 1(x) k(x)sgn(s)

(9.29)

where

k (x)



- F1(x)

+ 1 1-

|r(x)| 1

+



,

r(x)

=

f^1(x)

-

1x1

(9.30)

Proof. Using the equivalent control method, the equivalent control law ^ can be easily obtained as

^

=

1 2M^ 2(x) -

M^ 1(x)

a^(x) + 2 · b^(x)

-

1M^¯ (x) 2M^ 2(x) - M^ 1(x)

x3

(9.31)

Choose the sliding control law  as  = ^ +  , the rest work is to find appropriate switching control law  .

200 The inverted pendulum in control theory and robotics

From (9.17), (9.22) and (9.31), the derivative of s is given by

s = 1x1 + 2x2 + x3

= 1x1 + 2

-

b(x) M¯ (x)

+

M2(x)(^ + M¯ (x)

)

+

-

a(x) M¯ (x)

-

M1(x)(^ + M¯ (x)

)

=

1x1

+

1 M¯ (x)

-a(x) - 2b(x) + 2M2(x)^ - M1(x)^

+

2M2(x) - M1(x) M¯ (x)



=

1 M¯ (x)

2M2(x) - M1(x) 2M^ 2(x) - M^ 1(x)

a^(x) + 2b^(x)

- [a(x) + 2b(x)]

-

M^¯ (x) M¯ (x)

·

2M2(x) 2M^ 2(x)

- -

M1(x) M^ 1(x)

-

1

1x1

+

2M2(x) - M1(x) M¯ (x)

 = f^1(x) - f1(x)

+

f^1(x) - 1x1 +

2M2(x) - M1(x) M¯ (x)



(9.32)

Choose



=

M¯^ (x) 2M^ 2(x) - M^ 1(x) k(x)sgn(s)

(9.33)

where k = k(x) is a state-dependent function and sgn( · ) is the signum function. It

follows that

ss = s f^1(x) - f1(x) + r(x) + ( + 1) k(x)sgn(s)  |s| (F1(x) + 1 |r(x)| + (1 - 1) k(x)).

(9.34)

If k has the bound defined by (9.30), then the sliding condition (9.19) is satisfied.

The controller (9.29) ensures that all system trajectories will reach the surface and remain there in the presence of model uncertainties and disturbances. The next step is to find appropriate coefficients 1, 2 that guarantee the trajectories are asymptotically stable during the sliding phase. On the sliding surface, the closed-loop system dynamics is represented by the combination of the sliding surface in the form s = 0 and (9.20):

x1 = x3

(9.35a)

M1(x)x2 + M2(x)x3 = -Dwx2 + Gb sin x1 + m12x32 sin (x1 + ) - M~ (9.35b)

1 x1 - x^1 + 2 x2 - x^2 + x3 = 0
To avoid the confusion of notations, we use x¯ = equilibrium of system (9.35), which is given by

(9.35c) x¯1 x¯2 x¯3 T to denote the real

x¯3 = 0, 1 x¯1 - x^1 + 2 x¯2 - x^2 = 0, Gb sin x¯1 = Dwx¯2 + M~ . (9.36)
If the closed-loop system is asymptotically stable, it will finally converge to x¯. It should be noted that usually the values of three kinds of equilibriums x, x^ and

Advances in robust control of mobile wheeled inverted pendulum 201
x¯ are different because they are determined by different (9.16), (9.18) and (9.36), respectively.

Theorem 9.2. For the MWIP system (9.11), design sliding surface (9.17) and con-
trol law (9.29). Assume inequalities M1(x¯), M2(x¯) > 0 and cos(x¯1) > 0 hold, if coefficients 1, 2 satisfy

1, 2 > 0, 2M2(x¯) - M1(x¯) < 0

(9.37)

then the closed-loop system is locally asymptotically stable around equilibrium x¯.

Proof. From (9.35a) and (9.35c), we have

x2 = -1x1 - x1 + 1x^1 + 2x^2 2 x2 = (-1x1 - x¨1) 2

(9.38)

By substituting (9.38) into (9.35b) and introducing a new state vector y = y1 y2 T = x1 x1 T
a new system is derived as

(9.39)

y = (y)

(9.40)

where (y) =

1(y) 2(y)

,

1(y) = y2,

(9.41)

2(y)

=

1 2M2 -

M1

(1M1 + Dw) y2 + 2M12y22 sin(y1 + )

+ 1Dwy1 + 2Gb sin y1 - Dw 1x^1 + 2x^2 - 2M~

(9.42)

It is apparent that system (9.35) and (9.40) are equivalent in the sense of stability. The equilibrium of (9.40) is denoted by y = y1 y2 T = x¯1 x¯3 T. As Ashrafiuon did in [30], we linearize (9.40) about the equilibrium y to establish linear stability cri-
teria that guarantee local exponential stability of the nonlinear system. The linearized
system is described by

y = Ay

(9.43)

where

A= 

=

y y

01 ,
12

1=

2  y1

,
y

2=

2  y2

y

(9.44)

The characteristic polynomial for the eigenvalues of matrix A is represented in Laplace domain as

|SI - A| = S2 - 2S - 1 = 0

(9.45)

where S is the Laplace variable. According to the Hurwitz stability criteria, the equilibrium of linearized system (9.43) is asymptotically stable if we have

1, 2 < 0

(9.46)

202 The inverted pendulum in control theory and robotics

After computing the two derivatives in (9.44), we have

1

=

1Dw + 2Gb cos y1 2M2(y) - M1(y)

,

2

=

1M1(y) + Dw 2M2(y) - M1(y)

If we choose 1, 2 that satisfy (9.37), inequality (9.46) is then satisfied.

(9.47)

Because the MWIP system is required to move with a nearly upright body, the values of M1(x¯) and M2(x¯) are usually positive if the slope angle is small enough. The value of cos(x¯1) is positive for the same reason. Hence, the assumptions of Theorem 9.2 are naturally satisfied. It is found that if the coefficients 1 and 2 satisfy 1 > 0, 0 < 2 < min (1, m11/m22), then the assumptions (9.37) will hold.
Note that the real equilibrium x¯ is the intersection point of curve x2 = g(x1) =
Gb Dw sin (x1) - M~ Dw and a straight line crossing equilibrium x^ with a slope
-1 2 in the x1 - x2 coordinate frame. Although the steady tracking error x¯2 - x2 cannot be eliminated, it can be reduced to some extent by decreasing 1 2 .

9.3.2 Type-II sliding mode controller for MWIP

When using the Type-I SMC controller, the real equilibrium x¯ is usually different from the desired equilibrium x, even if the closed-loop system is asymptotically
stable. This leads to a steady tracking error in the case of velocity control for MWIP systems. To ensure an MWIP system can move at a desired velocity w, a novel sliding surface and the corresponding SMC controller design scheme is proposed in
this section.
We start by introducing a new state vector

z = z1 z2 z3 z4 T = 1 1 w - wt w - w T

(9.48)

The new sliding surface is given by

s = 1z1 + z2 + 2z3 + 3z4

(9.49)

where coefficients 1, 2, 3 are constants to be determined. Define

f2(x)

=

a(x)

+ 3 M¯

b(x)

,

f^2(x)

=

a^ (x)

+ 3b^(x) M¯^

(9.50)

and the estimation error caused by modeling uncertainty and disturbances is assumed to be bounded by some known function F2(x),

f2(x) - f^2(x)  F2(x).

(9.51)

Further, we assume that

3M2(x) - M1(x) M¯ (x)

= (1 +

~

)

3

M^ 2(x) - M¯^ (x)

M^ 1

(x)

,

| ~ |  2 < 1

The Type-II SMC controller is proposed by the following theorem.

(9.52)

Advances in robust control of mobile wheeled inverted pendulum 203

Theorem 9.3. The achievement of a sliding motion on the surface (9.49) can be guaranteed by selecting the control law



=

1 3M^ 2(x) - M^ 1(x)

a^(x) + 3b^(x)

-

1M^¯ (x) 3M^ 2(x) - M^ 1(x)

z2

-

3

2M^¯ (x) M^ 2(x) - M^ 1

(x)

z4

+

3M^ 2

M^¯ (x) (x) -

M^ 1

(x)

k~

(x)sgn(s)

(9.53)

where a^(x) and b^(x) are the same as described in Section 9.2.1, and k~, r~ satisfy

k~ (x)



- F2

+

2 |r~(x)| 1 - 2

+



,

r~(x) = f^2(x) - 1z2 - 2z4

(9.54)

Proof. This theorem can be easily proven using the similar method in the proof of Theorem 9.1.

A similar approach as used in Section 9.2.1 is assumed to analyze the stability of the sliding surface (9.49). Choosing a new state vector q = q1 q2 q3 T =
z1 z2 z4 T, the closed-loop system dynamics on sliding surface (9.49) is repre-
sented by

q1 = q2,

(9.55a)

M1q3 + M2q2 = -Dw q3 + w + Gb sin q1 + m12q22 sin (q1 + ) - M~ , (9.55b)

1q2 + q2 + 2q3 + 3q3 = 0

(9.55c)

Equations (9.55a)­(9.55c) can be further transformed into the following vector form:

q = (q)

(9.56)

where

(q) = 1(q) 2(q) 3(q) T,

1(q) = q2,

2(q)

=

1 3M2 - M1

[1M1q2 + (2M1 - 3Dw) q3

+ 3m12q22 sin(q1 + ) + 3Gb sin q1 - Dw3w - 3M~ , (9.57)

1 3(q) = 3M2 - M1 [-1M2q2 - (2M2 - Dw) q3
- M12q22 sin(q1 + ) - Gb sin q1 + Dww + M~ .

Obviously point q = x1 0 0 is one of the equilibriums of the nonlinear system (9.56), where x1 is the real desired inclination body angle determined by (9.16).

204 The inverted pendulum in control theory and robotics
Our aim is to choose suitable coefficients 1, 2, 3 that guarantee the asymptotical stability of this equilibrium.

Theorem 9.4. For the MWIP system (9.12), design sliding surface (9.49) and control law (9.53). Assume inequalities M1(q), M2(q) > 0 and cos(x1) > 0 hold, if coefficients 1, 2, 3 satisfy

1M1(q) + Dw > 2M2(q), 3M2(q) - M1(q) < 0,
1, 2, 3 > 0, 13 > 2

(9.58)

then the closed-loop system is locally asymptotically stable around equilibrium q.

Proof. We linearize (9.57) about the equilibrium q to establish linear stability criteria that guarantee local exponential stability of the nonlinear system. The linearized system is described by

q = B(q - q)

(9.59)

where





B=

 q

=
q

0
1 4

1
2 5

0 3
6

(9.60)

1=

2  q1

,
q

2=

2  q2

,
q

3=

2  q3

,
q

4=

3  q1

,
q

5=

3 ,  q2 q

6=

3  q3

q

(9.61)

According to the Hurwitz stability criteria, the equilibrium of linearized system (9.59) is asymptotically stable if we have

2 + 6 < 0,

1 6 - 3 4 > 0, ( 2 + 6) ( 3 5 - 2 6)

+ 1 2+ 3 4>0

(9.62)

It follows from (9.57) and (9.61) that

2 + 6 = -1M1(q) + 2M2(q) - Dw, 1 6 - 3 4 = 2Gb cos x1, 3 5 - 2 6 = ()21Dw(3M2(q) - M1(q)), 1 2 + 3 4 = ()2Gb cos x1[(13 - 2) M1(q) + 3Dw],
where  is given by

(9.63)



=

M1(q)

1 - 3M2(q)

(9.64)

Apparently inequalities (9.62) hold if coefficients 1, 2, 3 are chosen to satisfy (9.58). This completes the proof.

Advances in robust control of mobile wheeled inverted pendulum 205
It is found that if inequalities 1 min(m11 m22, 1) >2 and 3 < min(m11 m22, 1) hold, then inequalities (9.58) are always satisfied. It is also should be noted that the problem of uncertain equilibriums is solved by using a special sliding surface (9.49). The third item of (9.49) plays an important role in avoiding uncertain equilibriums. In fact, state z3 is the integration of state z4, which can eliminate the static tracking error like an integral part in a common-used PID controller.

9.4 Dynamic surface controller with nonlinear disturbance observer for MWIP

In this section, we proposed a DSCNDO for the balance control of an MWIP sys-

tem. Compared with the linear controllers, larger stability region can be achieved

by applying the DSC strategy. The introduction of NDO enhances the robustness of

closed-loop MWIP system to model errors and external disturbances. Moreover, the

"explosion-term" problem is also avoided in the controller design.

Here we rewrite the dynamic model (9.9) as

 

m11¨w + m12 cos(b) = u - (Dw + Db) w

¨b +

Dbb

+

m12b2

sin(b)

+

ext1,



(m11 + m12 cos(b)) ¨w + (m22 + m12 cos(b)) ¨b = -Dww + m12b2 sin(b) + Gb sin(b) + ext2

(9.65)

where all model uncertainties and external disturbances are lumped to ext1 and ext2.

9.4.1 Nonlinear disturbance observer design for MWIP

To improve the robustness and control performance of the closed-loop MWIP control system, it is necessary to apply a NDO estimating model uncertainties, frictions and external disturbances. This subsection illustrates the design procedure of a NDO in the MWIP system.
Considering the nonlinear underactuated system with disturbance, to simplify the denotation, we rewrite (9.65) as vector form:

M(q) q¨ + N(q, q ) + F(q ) =  + ext

(9.66)

where q = q1 q2 T = w b T ,

(9.67)

M(q) =

m11

m12 cos(q2)

m11 + m12 cos(q2) m22 + m12 cos(q2)

,

(9.68)

N(q, q ) =

-m12q22 sin(q2) -Gb sin(q2) - m12q22 sin(q2)

,

F(q ) =

(Dw + Db)q1 - Dbq2 Dw q 1

,

(9.69) (9.70)

206 The inverted pendulum in control theory and robotics

=

u 0

, ext =

ext 1 ext1 + ext2

(9.71)

Let us assume that M^ (q) and N^ (q, q ) are the estimates of the actual M(q) and N(q, q ), and that M(q) and N(q, q ) are the corresponding additive uncertainties presented in the model of the MWIP. That is we have

M(q) = M^ (q) + M(q) N(q, q ) = N^ (q, q ) + N(q, q )

(9.72)

The lumped disturbance vector d is defined as d = d1 d2 T = ext - M(q) q¨ - N(q, q ) - F(q )

(9.73)

By this definition, the effect of all dynamic uncertainties, joint frictions and external disturbances is lumped into a single disturbance vector d. From (9.66), it is seen that

M^ (q) q¨ + N^ (q, q ) =  + d

(9.74)

To estimate the lumped disturbance d , the NDO is designed as

^d = -L(q, q ) ^d + L(q, q ) M^ (q) q¨ + N^ (q, q ) - 

(9.75)

Define ~d = d - ^d as the disturbance tracking error and using (9.75), it is observed that

^ d = L(q, q ) ~d

(9.76)

or, equivalently

~ d = d - L(q, q ) ~d

(9.77)

In general, there is no prior information about the derivative of the disturbance d. When the disturbance varies slowly relative to the observer dynamics, it is reasonable to suppose that d = 0. Therefore, we have

~ d = -^d = -L(q, q ) ~d

(9.78)

Let us define an auxiliary variable z = z1 z2 T = ^d - p(q, q ), where

d p(q, q ) = L(q, q ) M^ (q) q¨ . dt And substitute it to (9.75), the observer can be designed as

(9.79)

z = L(q, q ) N^ (q, q ) -  - p(q, q ) - z ^d = z + p(q, q )

(9.80)

In this study, the following disturbance observer gain matrix L(q, q ) and vector p(q, q ) is used as

L(q, q ) = L(q) = X-1M^ -1(q) p(q, q ) = p(q ) = X-1q

(9.81)

Advances in robust control of mobile wheeled inverted pendulum 207

where X is a constant invertible matrix to be determined, that is

X=

c1 c2 c3 c4

,

ci  0, i = 1, 2, 3, 4

Substituting (9.81) and (9.82) into (9.80), and using (9.66) we have

(9.82)

z =

z1 z2

= A-1

c1D1 - c2D2 c2m^ 11 - c1m^ 12 cos(b) c3D1 - c4D2 c4m^ 11 - c3m^ 12 cos(b)

(9.83)

×

-m^ 12b2 sin(b) - u - c1w - c2b - z1 -G^ b sin(b) - m^ 12b2 sin(b) - c3w - c4b - z2

and

^d1 ^d2

=

z1 z2

+

c1 c2 c3 c4

w b

where   D1 = m^ 22 + m^ 12 cos(b) D2 = m^ 11 + m^ 12 cos(b)  A = det M^ (q) = m^ 11m^ 22 - m^ 12 cos(b) 2

(9.84) (9.85)

Therefore, the disturbance observer can be designed as follows

 

z1 - z2

= A-1 c2m^ 11 = A-1

(c2D2 - c1D1) - c1m^ 12 cos(b) (c4D2 - c3D1)

m^ 12b2 sin(b) + u + c1w + c2b + z1 G^ b sin(b) +m^ 12b2 sin(b) + c3w +
m^ 12b2 sin(b) + u + c1w + c2b + z1

c4b

+ z2



-
^d1 ^d2

c4m^ 11 - c3m^ 12 = z1 + c1w + = z2 + c3w +

cos(b) c2b c4b

G^ b sin(b) + m^ 12b2 sin(b) + c3w + c4b + z2 (9.86)

9.4.2 Controller design

To analyze the type and features of the underactuated systems, we first introduce the following definition and lemma.

Definition 9.5. ([31], Definition 3.9.1.) (Class-I, II underactuated systems) We call
an underactuated system (9.87) Class-I underactuated system, if q2 is actuated. We call it a Class-II underactuated system, if q2 is unactuated. In order words, for a Class-I system 1 = 0 and 2 = 0 for a Class-II system.

m11(q2) q¨1 + m12(q2) q¨2 + m 11(q2) q1q2 + m 12(q2) q22 - g1(q1, q2) = 1

m21(q2)

q¨ 1

+

m22(q2)

q¨ 2

-

1 2

m

11(q2)

q 12

+

1 2

m

22(q2)

q 22

-

g2(q1,

q2)

=

2

(9.87)

208 The inverted pendulum in control theory and robotics

Lemma 9.1. ([31], Proposition 3.9.1.) (Class-I normal form) Consider a Class-

I underactuated system with two DOF. Then, the following global change of

coordinates obtained from the Lagrangian of the system

 

z1 z2

 1

= = =

q1 +  (q2) m11(q2) p1 + q2

m12(q2) p2

=

L  q 1

1 = p2

(9.88)

where
q2
 (q2) = m-111( ) m12( ) d
0

(9.89)

transforms the dynamics of the system into a cascade nonlinear system in strict

feedback form

 

z1 z2

= =

m1-11(1) z2 g1(z1 -  (1)

,

1)



1 2

= =

2 u

(9.90)

where u is the new control from collocated partial feedback linearization and g1(q1, q2) = -V (q)/q1.

Lemma 9.2. ([31], Proposition 3.9.2.) (Class-II normal form) Consider a Class-

II underactuated system with two DOF. Then, the following change of coordinates

obtained from the Lagrangian of the system

 

z1 z2

 1

= = =

q1 +  (q2) m21(q2) p1 + q2

m22(q2) p2

=

L  q 2

1 = p2

(9.91)

where

q2
 (q2) = m2-11( ) m22( ) d

(9.92)

0

is defined over U = {q2 |m21 (q2) = 0 } transforms the dynamics of the system into a cascade nonlinear system in quadratic nontriangular form where u is the new control from noncollocated partial feedback linearization.

From Definition 9.5 and MWIP system model (9.9), it is found that the MWIP system belongs to neither the Class-I nor the Class-II underactuated mechanical systems.

Advances in robust control of mobile wheeled inverted pendulum 209

In general, the DSC control design requests the strict or semistrict feedback form

of the nonlinear system model [18,25]. According to Lemma 9.1, the dynamics of a

Class-I underactuated mechanical system may be transformed into a cascade nonlin-

ear system in strict feedback form. However, the dynamics of a Class-II underactuated

system may only be transformed into a cascade nonlinear system in a quadratic

nontriangular form from Lemma 9.2. Similarly, the dynamics of an MWIP-type

underactuated system may not be transformed into a cascade nonlinear system in

strict feedback form. This makes it difficult to design a DSC controller for the MWIP

system.

In order to solve this problem, we propose a coordinate transformation approach

to transform an MWIP model into a cascade nonlinear system in semistrict feedback

form.

Let us introduce the following variables:





x1 x2

= =

m^ 11 + m^ 12 q2 = b

cos(x2)

x4 +

m^ 22 + m^ 12 cos(x2)

x3



x3 x4

= =

q 2 q 1

= =

b w

(9.93)

then the MWIP system model (9.65) can be rewritten as





m^ 11x4 + m^ 12 = u + m^ 12x32

cos(x2) sin(x2)

x3 +

d

1



m^ 11 + m^ 12 cos(x2) x4 + m^ 22 + m^ 12 = m^ 12x32 sin(x2) + G^ b sin(x2) + d2

cos(x2)

x3

(9.94)

Theorem 9.5. For the MWIP system (9.94), the global change of coordinates (9.93) transforms the dynamics of the system into a cascade nonlinear system in semistrict feedback form

x1 = -m^ 12 sin(x2) x3x4 + G^ b sin(x2) + d2

(9.95a)





x2 x4

= =

x3

=

m^ 22

+

x1 m^ 12

cos(x2)

-

m^ 11 m^ 22

+ +

m^ 12 m^ 12

cos(x2 cos(x2

) )

x4

= f1(x1, x2) + g1(x1, x2) x4

A-1m^ 12m^ 22 sin(x2)

x1 - m^ 11 + m^ 12 cos(x2) m^ 22 + m^ 12 cos(x2)

x4

2



 - m^ 12G^ b sin(x2) cos(x2) + A-1 m^ 22 + m^ 12 cos(x2) u
+ A-1 m^ 22 + m^ 12 cos(x2) d1 - m^ 12 cos(x2) d2] = f2(x1, x2, x4) + g2(x1, x2, x4) u + (x1, x2, x4, d1, d2)

(9.95b)

210 The inverted pendulum in control theory and robotics

Proof of the theorem is similar to the work in [32]. After coordinate transformation the MWIP system model is represented in a semistrict feedback form as cascade of an outer (9.95b) and a core (9.95a) subsystem.

Assumption 9.1. The uncertainties and disturbances of the system are bounded and satisfy

|d1|  d¯1, |d2|  d¯2, |~d1|  1, |~d2|  2

(9.96)

where d¯1, d¯2, 1 and 2 are known bounds.

Our purpose is to design a control u forcing x2 to be stabilized around zero. Together with the proposed disturbance observer, for MWIP system (9.95) we design a new DSCNDO as follows:

u = uDSC - ud

(9.97)

ud = ud1 - ud2

(9.98)

where

 ud1 = ^d1

 ud2

=

m^ 12 cos(x2) m^ 22 + m^ 12 cos(x2)

^d

2

(9.99)

For convenience of the mathematical derivation, we define following notations

in advance:





MC12 = m^ 12 cos(x2) GS2 = G^ b sin (x2) =
MC22 = m^ 22 cos(x2)

= m^ 12 cos(S1), G^ b sin (S1),
= m^ 22 cos(S1)

,



SC2

=

sin(x2) cos2(x2)

=

MS12 = m^ 12 sin(x2)

A¯ = m^ 11m^ 22 - m^ 122

sin(S1) , cos2(S1) = m^ 12 sin(S1

),

(9.100)

The pure DSC component of DSCNDO, uDSC, can be obtained through the following procedure:
Step 1: Design the virtual control law x¯4 1. Define the first dynamic surface

S1 = x2 - xd = x2 - 0 = x2.

(9.101)

Then, from the first equation of (9.95b) the derivative of S1 can be expressed as

S1

=

x2

=

m^ 22

x1 + MC12

-

m^ 11 m^ 22

+ +

MC MC

12 12

x4

(9.102)

2. Select the virtual control law x¯4 as

x¯4

=

m^ 22 m^ 11

+ MC12 + MC12

m^ 22

1 + MC12

x1

+

k1S1

(9.103)

where k1 > 0.

Advances in robust control of mobile wheeled inverted pendulum 211

3. Input x¯4 to a first order filter, then we have
4x4d + x4d = x¯4, x4d (0) = x¯4(0)
where 4 > 0 is the filter time constant. Step 2: Design the actual control law uDSC 1. Define the second dynamic surface

(9.104)

S2 = x4 - x4d

(9.105)

Then, from the second equation of (9.95b), (9.97)­(9.99) and (9.104), the derivative of S2 can be expressed as

S2 = x4 - x4d



2

= A-1 m^ 22 + MC12 uDSC + A-1 m^ 12m^ 22 sin(x2)

x1 - m^ 11 + MC12 x4 m^ 22 + MC12

-MC12GS2

- x¯4 - x4d + A-1 4

m^ 22 + MC12 ~d1 - MC12~d2

(9.106)

2. Select the control law uDSC as follows:

uDSC

=

m^ 22

A + MC12

x¯4

- x4d 4

- k2S2

+ MC12GS2 m^ 22 + MC12

-

m^ 12m^ 22

sin

(x2) x1 - m^ 11 m^ 22 + MC12

+
3

MC12

x4

2

(9.107)

where k2 > 0.

The whole control system block diagram is shown in Figure 9.2.

Dynamic surface control

xd

S1 ­

k1 Virtual

k2 Controller

uDSC +

u

d MWIP system

x1 x4

+

control

x­4

­ ud

x2

4 Filter x4d

Nonlinear equation

­ + S2

d
++ z

Xq.

d/dt

dz Nonlinear equation

Nonlinear disturbance observer

Figure 9.2 Block diagram of MWIP system with DSCNDO

212 The inverted pendulum in control theory and robotics
To analyze the stability of system (9.95) controlled by the proposed DSCNDO, we first introduce the following lemma.

Lemma 9.3. [33]. For a nonlinear system (9.95), suppose that a positive definite function V (x(t)) = V (t) satisfies the following differential inequality:

V (t)  -V + C

(9.108)

where constants  and C satisfy  > 0 and C  0. Then, for any given t0, function V (t) satisfies the following inequality:

0  V (t)  [C - (C -  V (t0)) exp(- (t - t0))] / , t  t0

(9.109)

This implies that V (t) is eventually bounded by C/ , and the exponential convergence rate of V (t) to the bound is . Thus, the state of the system (9.95) is uniformly and ultimately bounded.

The stability analysis of the whole system is concluded in the following theorem:

Theorem 9.6. Considering a system (9.95) with modeling errors, external distur-
bance, unknown payloads and frictions, there exists a set of the surface gains k1, k2, the filter time constant 4 and the observer gains c1, c2, c3, c4 satisfying

 = min(a1, a2, a3, a4, a5) > 0, 

(9.110)

where

  

a1 a2 a3 a4 a5

= = = = =

k1

-

m^ 11 + m^ 12 m^ 22

k2

-

k1 2

-

m^ 11 + m^ 12 2m^ 22

1 4

-

3k1 2

-

m^ 11 + m^ 12 2m^ 22

c1 m^ 11 c4 m^ 22

- -

m^ 11 + m^ 12

A¯

m^ 12c3 A¯

-

1

c2

-

1

(9.111)

such that the NDO-based dynamic surface controller guarantees: Based on the control law (9.97)­(9.99) and (9.107), system (9.95) is semi-globally uniformly and ultimately bounded.

Proof. Choose the following Lyapunov function candidate

V

=

1 2

S12

+

1 2

S22

+

1 e2 2

+

1 2

~dT

~d

If the filter error is defined as follows:

e = x4d - x¯4

(9.112) (9.113)

Advances in robust control of mobile wheeled inverted pendulum 213

By combining the above equation with (9.103), we have

e

=

x4d

-

m^ 22 m^ 11

+ +

MC12 MC12

m^ 22

x1 + MC12

+ k1S1

(9.114)

From (9.101)­(9.103), (9.105) and (9.113), the derivative of S1 can be written as

S1

=

m^ 22

x1 + MC12

-

m^ 11 m^ 22

+ +

MC12 MC12

x4

=

- m^ 11 m^ 22

+ +

MC12 MC12

(S2

+ e)

-

k1S1

(9.115)

Substituting (9.107) to (9.106), we obtain

S2 = -k2S2 + A-1 m^ 22 + MC12 ~d1 - A-1MC12~d2

(9.116)

Then, from (9.104) and (9.113) and (9.114), the derivative of e is given by

d e = x4d - dt

m^ 22 + MC12 m^ 11 + MC12

m^ 22

x1 + MC12

+ k1S1

e =- -
4

x1 m^ 11 + MC12 + x1x3MS12 m^ 11 + MC12 2

+

m^ 22 - m^ 11

m^ 11 MS12 + MC12 2

x3

k1

S1

+k1S1

m^ 22 m^ 11

+ +

MC12 MC12

(9.117)

Substituting (9.95a) and x2 = x3 into (9.117)

e

=

-

e 4

+

MS12x3x4 m^ 11 + MC12

-

GS2 + d2 m^ 11 + MC12

-

MS12x1x3 m^ 11 + MC12 2

-

m^ 22 - m^ 11 MS12k1 m^ 11 + MC12 2

S1

S1

-

m^ 22 m^ 11

+ +

MC12 MC12

k1

S1

(9.118)

From (9.103), (9.105) and (9.113), we have

x4

=

S2

+

x4d

=

S2

+ x¯4

+

e

=

S2

+

m^ 11

x1 + MC12

+

m^ 22 m^ 11

+ +

MC MC

12 12

k1

S1

+

e

(9.119)

Substituting (9.119) into (9.118)

e

=

-

e 4

+

MS12x3 m^ 11 + MC12

S2

+

m^ 11

x1 + MC12

+

m^ 22 m^ 11

+ +

MC12 MC12

k1S1

+

e

- GS2 + d2 - m^ 11 + MC12

MS12x1x3 m^ 11 + MC12

2

-

m^ 22 - m^ 11 MS12k1S1 m^ 11 + MC12 2

S1

-

m^ 22 m^ 11

+ +

MC12 MC12

k1S1

=

-

e 4

+

MS12x3 m^ 11 + MC12

S2

+

m^ 22 m^ 11

+ +

MC12 MC12

k1S1

+

e

- GS2 + d2 - m^ 11 + MC12

m^ 22 - m^ 11 MS12k1 m^ 11 + MC12 2

S1

S1

-

m^ 22 m^ 11

+ +

MC12 MC12

k1

S1

(9.120)

214 The inverted pendulum in control theory and robotics

According to the fact that x2 = S1 and x3 = x2 = S1, we have

e

=

-

e 4

-

GS2 + d2 m^ 11 + MC12

+

MS12 m^ 11 + MC12

S2

+

m^ 22 m^ 11

+ +

MC12 MC12

k1S1

+

e

-

m^ 22 - m^ 11 MS12k1S1 m^ 11 + MC12 2

-

m^ 22 m^ 11

+ +

MC12 MC12

k1

S1

(9.121)

Substituting (9.115) into (9.121), we have

e

=

-

e 4

-

m^ 11

GS2 + MC12

-

m^ 11

d2 + MC12

-

MS12(S2 + e)2 m^ 22 + MC12

-

MS12k1S1 [2 (S2 + e) m^ 11 + MC12

+

k1S1]

+

m^ 22 - m^ 11 MS12k1S1 (S2 + e) m^ 11 + MC12 m^ 22 + MC12

+ k1 (S2 + e) +

m^ 22 + MC12 k12S1 m^ 11 + MC12

(9.122)

From (9.74), we have

~d = d - ^d = M^ (q) q¨ + N^ (q, q) -  - ^d .

(9.123)

It follows from (9.78), (9.81)­(9.82) and (9.123) that

d dt

1 2

~dT

~d

= ~dT ~d = -~dT ^d = -~dT L~d = -~dT X M^ -1~d

= A-1 m^ 11 + MC12 c2~d21 - m^ 22 + MC12 c1~d21

- m^ 22 + MC12 c3 + m^ 11c2 ~d1~d2

+ m^ 11 + MC12 c4 + MC12c1 ~d1~d2 + MC12c3~d22 - m^ 11c4~d22

(9.124)

Note that the following inequalities hold

m^ 11m^ 22  A  A¯ = m^ b + m^ w r^2 + I^w m^ b^l2 + I^b - m^ 2b^l2r^2

= m^ b + m^ w m^ b^l2r^2 + m^ b + m^ w r^2I^b + m^ b^l2I^w + I^wI^b - m^ b2^l2r^2

= m^ wm^ b^l2r^2 + m^ b + m^ w r^2I^b + m^ b^l2I^w + I^wI^b > 0

(9.125)

In addition, we have





0 0

 

m^ 11 +
-c1~d21 m^ 11

MC12 A
- 

c2~d21 

m^ 11 + m^ 12 A¯

m^ 22 + MC12 c1~d21 ,

A

c2~d21 ,



0 0

 

MC12c3~d22 A
-c4~d22 



m^ 12c3~d22 A¯

,

-m^ 11c4~d22

m^ 22

A

(9.126)

Advances in robust control of mobile wheeled inverted pendulum 215

It follows from (9.124) to (9.126) that

d dt

1 2

~dT

~d



m^ 11 + m^ 12 A¯

c2 - c1 m^ 11

~d21

+

m^ 12c3 A¯

-

c4 m^ 22

~d22

+ A-1 (c1 + c4) MC12 + c4m^ 11

- m^ 11c2 + m^ 22c3 + MC12c3 ~d1~d2

From (9.115)­(9.116), (9.122) and (9.127), we have

(9.127)

V



-k1S12

- k2S22

-

e2 4

+ k1eS2

+ k1e2

-

c1 m^ 11

-

m^ 11 + m^ 12 A¯

c2

~d21

-

c4 m^ 22

-

m^ 12c3 A¯

~d22

-

m^ 11 m^ 22

+ +

MC12 MC12

(S2

+

e)

S1

+

A-1

m^ 22 + MC12

S2~d1

- A-1MC12S2~d2

-

GS2e m^ 11 + MC12

-

ed2 m^ 11 + MC12

-

MS12(S2 + e)2e m^ 22 + MC12

- MS12k1S1 [2 (S2 + e) + k1S1] e + m^ 22 - m^ 11 MS12k1S1 (S2 + e) e

m^ 11 + MC12

m^ 11 + MC12 m^ 22 + MC12

+

m^ 22 + MC12 k12S1e m^ 11 + MC12

+

A-1

(c1 + c4)MC12 + c4m^ 11

- m^ 11c2 + m^ 22c3 + MC12c3 ~d1~d2

(9.128)

According to the Young's inequality, it follows that



k1eS2



k1 e2 2

+

k1 2

S22

,

-

m^ 11 + MC12 S1S2 m^ 22 + MC12



m^ 11 + m^ 12 2m^ 22

-

m^ 11 + MC12 S1e m^ 22 + MC12



m^ 11 + m^ 12 2m^ 22

A-1 m^ 22 + MC12 S2~d1  ~d21

+

1 4

A-2S22

m^ 22 + MC12 2 ,

S12 + S22 S12 + e2 ,

,



-A-1MC12S2~d2



~d22

+

1 4

A-2

M2 C12

S22

,

-

ed2

m^ 11 + MC12

 4

e2 m^ 11 + MC12

2 + d22,

A-1 (c1 + c4) MC12 + c4m^ 11

- m^ 11c2 + m^ 22c3 + MC12c3 ~d1~d2

 A-2 (c1 + c4) MC12 + c4m^ 11

- m^ 11c2 + m^ 22c3 + MC12c3

2

+

1 4

~d21~d22

(9.129)

216 The inverted pendulum in control theory and robotics Thus,

V  -

k1

-

m^ 11 + m^ 12 m^ 22

S12 -

k2

-

k1 2

-

m^ 11 + m^ 12 2m^ 22

S22

-

1 - 3k1 - m^ 11 + m^ 12

4 2

2m^ 22

e2 -

c1 - m^ 11

m^ 11 + m^ 12 A¯

c2 - 1

~d21

-

c4 m^ 22

-

m^ 12c3 A¯

-

1

~d22

+

1 4

A-2S22

m^ 22 + MC12 2 + MC212

- GS2e + MS12k1S1 [2 (S2 + e) + k1S1] e +

m^ 11 + MC12

4

e2 m^ 11 + MC12

2

-

MS12 (S2 m^ 22 +

+ e)2 MC12

e

+

m^ 22 - m^ 11 MS12k1S1 (S2 + e) e + m^ 11 + MC12 m^ 22 + MC12

m^ 22 + MC12 k12S1e m^ 11 + MC12

+ A-2 (c1 + c4) MC12 + c4m^ 11 - m^ 11c2 + m^ 22c3 + MC12c3

2

+

d22

+

1 4

~d21~d22

(9.130)

Then, there exists a nonnegative continuous function 1( · ) satisfying

0

1 4

A-2S22

m^ 22 + MC12 2 + MC212

- GS2e + MS12k1S1 [2 (S2 + e) + k1S1] e m^ 11 + MC12

+ 4

e2 m^ 11 + MC12

2

-

MS12 (S2 + e)2 e m^ 22 + MC12

+

m^ 22 - m^ 11 MS12k1S1 (S2 + e) e m^ 11 + MC12 m^ 22 + MC12

+

m^ 22 + MC12 k12S1e m^ 11 + MC12

+

A-2

(c1 + c4) MC12 + c4m^ 11

- m^ 11c2 + m^ 22c3 + MC12c3 2

 1 (k1, S1, S2, c1, c2, c3, c4, e)

(9.131)

Given any p > 0, let us introduce a set := {S12 + S22 + e2 < 2p}. Apparently set is compact in R3. Therefore, the continuous function 1( · ) has a maximum, say M on . It follows that

V

-

k1

-

m^ 11 + m^ 12 m^ 22

S12 -

k2

-

k1 2

-

m^ 11 + m^ 12 2m^ 22

S22

-

1 4

-

3k1 2

-

m^ 11 + m^ 12 2m^ 22

e2 -

c1 - m^ 11

m^ 11 + m^ 12 A¯

c2 - 1

~d21

-

c4 m^ 22

-

m^ 12c3 A¯

-

1

~d22

+

d¯22

+

1 4

12

22

+

M

(9.132)

According to Lemma 9.3, if the following inequalities are satisfied:

ai > 0, i = 1, 2, 3, 4, 5

(9.133)

then, we have V  -2 V + M1

(9.134)

Advances in robust control of mobile wheeled inverted pendulum 217 Table 9.1 Exactly known physical parameters of the MWIP system

Mass of the wheel (kg)

Moment of
inertia of the wheel (kg m2)

Radius of the wheel (m)

Length between the wheel axle and the center of gravity of the body (m)

Viscous resistance in the driving system (N s/m)

Viscous resistance of the ground (N s/m)

mw = 29.0 Iw = 0.6

r = 0.254

l = 0.267

D1 = 0.1 Dw = 3.3

where

M1

=

M

+

1222 4

+

d¯22 2m^ 12

>

0

 = min (a1, a2, a3, a4, a5) > 0

(9.135) (9.136)

By the selections of k1, k2, 4 and c1, c2, c3, c4, we can make  > M1/2p. This results in V  0 on V = p. Thus, V  p is an invariant set, i.e., if V (0)  p then V (t)  p for all t  0. Therefore, V (t) is bounded, so are S1, S2, e and ~d1, ~d2. According to above analysis and Lemma 9.3, the overall closed-loop control system is semiglobally
uniformly and ultimately bounded. This completes the proof.

9.5 Simulation study

9.5.1 Simulation of SMC for MWIP

Consider an MWIP system whose exactly known system parameters are listed in Table 9.1. To test the robustness of the proposed controllers, it is assumed that the actual physical parameters of the body are different from that of the nominal system. Table 9.2 shows the actual and nominal body parameters. An LQR controller designed by linearizing nominal system was found cannot stabilize the actual system.

9.5.1.1 Simulation study for the Type-I SMC controller The function F1 in (9.27), the parameter 1 and  were selected as 0.1 × f^1 , 0.1 and 1, respectively. Function k was given by

k = - (F1 + 1 |r| + ) (1 - 1) - 1

(9.137)

Assume the desired moving velocity is x2 = w = 7 rad/s. From (9.18) we can compute the estimated equilibrium x^, which is used to construct the initial sliding surface (9.17). Therefore, the final SMC controller (9.29) can be obtained from Theorem 9.2 by selecting appropriate 1 and 2.

218 The inverted pendulum in control theory and robotics

b [rad ]

0.3 0.2 0.1
0 -0.1
0
0.6 0.4 0.2
0

10

20

30

Time [s]

 = 0 deg  = 4 deg  = -4 deg

 [Nm]

w [rad/s]

20 15 10 5 0 -5
0
200
100
0

10

20

30

Time [s]

b [rad/s]

-0.2 0

10

20

Time [s]

-100

30

0

10

20

30

Time [s]

Figure 9.3 System trajectories of using the Type-I SMC controller on different slopes. (Black dot line denotes the desired velocity.)

To validate the robustness of the Type-I SMC controller, we performed the velocity control simulation of an MWIP system on different slopes. Three different cases of ground slope  = 0,  = 4 and  = -4 were considered in the simulation. The simulation results are shown in Figure 9.3. In all cases, the system was stabilized while the modeling uncertainties and external disturbance exist. Note that there are unavoidable steady tracking errors in all the three cases.

9.5.1.2 Simulation study for the Type-II SMC controller The function F1 in (9.51), the parameter 2 and  were selected as 0.1 × f^2 , 0.1 and 1, respectively. Function k~ was given by

k~ = - (F2 + 2 |r~| + ) (1 - 2) - 1

(9.138)

Assume the desired moving velocity is x2 = w = 7 rad/s. According to Theorem 9.4, coefficients 1, 2, 3 were selected as 1 = 1.5, 2 = 0.01 and 3 = 0.05. Three different cases of ground slope  = 0,  = 4 and  = -4 were also
assumed. The final simulation results of using the Type-II SMC controller are depicted
in Figure 9.4. In all the three cases, the MWIP system is asymptotically stable with
very small steady tracking error, which substantiates the efficiency of the presented

Advances in robust control of mobile wheeled inverted pendulum 219

0.3

15

0.2

10

w [rad/s]

b [rad ]

0.1

5

0

0

-0.1 0
0.6 0.4 0.2
0

10

20

30

Time [s]

 = 0 deg  = 4 deg  = -4 deg

 [Nm]

-5 0
200 100
0

10

20

30

Time [s]

b [rad/s]

-0.2 0

10

20

Time [s]

-100

30

0

10

20

30

Time [s]

Figure 9.4 System trajectories of using the Type-II SMC controller on different slopes. (Black dot line denotes the desired velocity.)

approach. If the physical parameters of MWIP system are very close to that of the nominal system, the maximum slope we achieved in the simulation is about 45 degree. This also demonstrates the robustness of proposed approach. Compared with the TypeI SMC controller, the most significant advantage of the Type-II SMC controller is its ability to eliminate the steady tracking error.

9.5.2 Simulation of DSCNDO for MWIP

In this simulation, we use the same parameter assumptions as given in the previous
subsection. The dissipation parameter Dw is assumed to be Gaussian random variable with known covariance (0.2 N s/m) and mean value (0.5 N s/m). And the external disturbances are assumed as:

ext1 = 30 sin (2t + /2)(N m), ext2 = 0.2 sin (t)(N m).

(9.139)

An obvious equilibrium of the MWIP system can be easily obtained:

x = [x2, x3, x4]T = [0, 0, 0]T

(9.140)

Based on (9.111) and Tables 9.1 and 9.2, the controller parameters are chosen as

k1 = 6, k2 = 6, 4 = 0.1, c1 = c4 = 100, c2 = c3 = 0.

(9.141)

220 The inverted pendulum in control theory and robotics Table 9.2 Uncertain body parameters of the MWIP system

Actual system Nominal system

Mass of the body (kg)
mb = 310.6 m^ b = 137.6

Moment of inertia of the body (kg m2)
Ib = 65.0 I^b = 35.0

0.2

2

w [rad/s]

b [rad ]

0.1 0
0
-2 -0.1

b [rad/s]

-0.2 0
1.5 1
0.5 0
­0.5 -1 0

5

10

Time [s]

DSCNDO DSC LQR

-4 0
500 100
0

 [Nm]

­500

5 Time [s]

-1000

10

0

5

10

Time [s]

5

10

Time [s]

Figure 9.5 System trajectories of using DSCNDO, DSC and LQR control strategies in the balance control of MWIP system (b(0) = ­15)

The equilibrium control simulation results of the actual MWIP system with considering any uncertainties and disturbances using DSCNDO, DSC and LQR controller are shown in Figure 9.5. Suppose that the initial conditions of the system are x(0) = [-0.2617, 0, 0]T .
As shown in Figure 9.5, the LQR controller cannot suppress the effect of system uncertainties and disturbance. The two DSC controllers have better performance than the LQR controller. Note that although the DSC controllers can make the state variables to be semiglobally uniformly and ultimately bounded, they do not guarantee that the states converge to the desired value. There are small oscillations in the response trajectories all the time due to the external disturbances. Compared with a pure DSC controller, the control performance seems better when using a DSCNDO because the amplitudes of oscillations are significantly reduced.

Advances in robust control of mobile wheeled inverted pendulum 221
In a word, the simulation results show that the DSCNDO controller is more effective than a pure DSC or LQR controller when there exists model uncertainties and external disturbances.
9.6 Conclusion
Robust controller design for underactuated systems is a hard problem. In this chapter, we proposed two kinds of robust controllers for the MWIP, which is a typical underactuated system. The first kind of robust controllers is based on SMC, which is very suitable for the MWIP suffering from both parameter uncertainties and external disturbances. With a specially designed sliding surface, the proposed SMC controller not only stabilizes the MWIP but also eliminates the steady tracking error even the equilibrium is uncertain.
Considering the deficiency of chattering in SMC controllers, a novel global coordinate transformation was proposed to achieve the DSC control of an MWIP system. The proposed method partially solves the difficulty in designing a DSC controller for a non-Class-I type underactuated mechanical system. To compensate for parametric uncertainties in a real MWIP-based robot system as well as external disturbances, we combined the proposed DSC controller and an NDO. The efficiency of all proposed controllers is validated by numerical simulations.
Acknowledgment
This work was supported by the National Natural Science Foundation of China under Grant number 61473130, the Science Fund for Distinguished Young Scholars of Hubei Province (2015CFA047), the Fundamental Research Funds for the Central Universities (HUST: 2015TS028) and the Program for New Century Excellent Talents in University (NCET-12-0214).
References
[1] Pathak, K., Franch, J., Agrawal, S.K.: `Velocity and position control of a wheeled inverted pendulum by partial feedback linearization', IEEE Transactions on Robotics, 2005, 21, (3), pp. 505­513.
[2] Salerno, A., Angeles, J.: `The control of semi-autonomous two-wheeled robots undergoing large payload-variations', Proc. IEEE Int. Conf. on Robotics and Automation, New Orleans, LA, 2004, pp. 1740­1745.
[3] Ha, Y.-S. and Yuta, S.: `Trajectory tracking control for navigation of the inverse pendulum type self-contained mobile robot', Robotics andAutonomous Systems, 1996, 17, pp. 65­80.
[4] Baloh, M. and Parent, M.: `Modeling and model verification of an intelligent self-balancing two-wheeled vehicle for an autonomous urban transportation system', Proc. Conf. Comp. Intelligence, Robot. Autonom. Syst., Singapore, 2003, pp. 1­7.

222 The inverted pendulum in control theory and robotics
[5] Grasser, F., D'Arrigo, A., Colombi, S. and Rufer, A.: `Joe: A mobile, inverted pendulum,' IEEE Transactions on Industrial Electronics, 2002, 49, 1, pp. 107­114.
[6] `nBot Balancing Robot', http://www.geology.smu.edu/dpa-www/robo/ nbot/, accessed 14 Sep 2013.
[7] `Steve's LegWay' http://www.teamhassenplug.org/robots/legway/, accessed 17 Jan 2003.
[8] Tirmant, H., Baloh, M., Vermeiren, L., Guerra, T. M. and Parent, M.: `B2, an alternative two wheeled vehicle for an automated urban transportation system', Proc. IEEE Intelligent Vehicle Symposium, Paris, France, 2002, pp. 594­603.
[9] `SegWay' http://www.segway.com/, accessed 15 Aug 2016. [10] Karkoub, M., Parent, M.: `Modelling and non-linear feedback stabilization of
a two-wheel vehicle', Proceedings of the Institution of Mechanical Engineers, Part I: Journal of Systems and Control Engineering, 2004, 218, 8, pp. 675­686. [11] Huang, J., Ding, F., Fukuda, T., Matsuno, T.: `Modeling and Velocity Control for a Novel Narrow Vehicle Based on Mobile Wheeled Inverted Pendulum', IEEE Transactions on Control Systems Technology, 2013, 21, 5, pp. 1607­ 1617. [12] Spong, M. W.: `The swing up control problem for the acrobat', IEEE Control Systems Magazine, 1995, 15, 1, pp. 49­55. [13] Fantoni, I., Lozano, R., and Spong, M. W.: `Energy based control of the pendubot', IEEE Transactions on Automatic Control, 2000, 45, 4, pp. 725­729. [14] Gu, Y.-L.: `Direct adaptive control scheme for underactuated dynamic systems', Proc. IEEE Conference on Decision and Control, San Antonio, Texas, 1993, pp. 1625­1627. [15] Bloch, A. M., Leonard, N. E. and Marsden, J. E.: `Stabilization of the pendulum on a rotor arm by the method of controlled Lagrangians', Proc. IEEE International Conference on Robotics and Automation, Piscataway, New Jersey, 1999, pp. 500­505. [16] Sankaranarayanan, V. and Mahindrakar, A. D.: `Control of a class of underactuated mechanical systems using sliding modes', IEEETransactions on Robotics, 2009, 25, 2, pp. 459­467. [17] Park, B. S., Yoo, S. J., Park, J. B. and Choi, Y. H., `Adaptive neural sliding mode control of non-holonomic wheeled mobile robots with model uncertainty', IEEE Transactions on Control Systems Technology, 2009, 17, 1, pp. 207­214. [18] Swaroop, D., Gerdes, J. C., Yip, P. P. and Hedrick, J. K.: `Dynamic surface control of nonlinear systems', Proc. the 16th American Control Conference (ACC), Albuquerque, USA: NM, 1997, pp. 3028­3034. [19] Oh, S.-R., Sun, J., Li, Z.: `Path following control of underactuated marine vessels via dynamic surface control technique', Proc. the ASME Dynamic Systems and Control Conference, 2008, pp. 81­88. [20] Qaiser, N., Iqbal, N. and Hussain, A.: `Exponential stabilization of a class of underactuated mechanical systems using dynamic surface control', International Journal of Control, Automation and Systems, 2007, 5, 5, pp. 547­558.

Advances in robust control of mobile wheeled inverted pendulum 223
[21] Huang, J., Guan, Z.-H., Matsuno, T., Fukuda T. and Sekiyama, K.: `Sliding mode velocity control of mobile wheeled inverted pendulum systems', IEEE Transactions on Robotics, 2010, 26, 4, pp. 750­758.
[22] Huang, J., Ri, S., Liu, L., Wang, Y., Kim, J. and Pak, G.: `Nonlinear disturbance observer-based dynamic surface control of mobile wheeled inverted pendulum', IEEE Transactions on Control Systems Technology, 2015, 23, 6, pp. 2400­2407.
[23] Mohammadi, A., Tavakoli, M., Marquez, H. J. and Hashemzadeh, F.: `Nonlinear disturbance observer design for robotic manipulators', Control Engineering Practice, 2013, 21, pp. 253­267.
[24] Chen, W. H.: `Disturbance observer based control for nonlinear systems', IEEE/ASME Transactions on Mechatronics, 2004, 9, 4, pp. 706­710.
[25] Wu, J., Huang, J., Wang, Y. and Xing, K.: `Nonlinear disturbance observerbased dynamic surface control for trajectory tracking of pneumatic muscle system', IEEE Transactions on Control Systems Technology, 2014, 22, 2, pp. 440­455.
[26] Wei, X., Zhang, H. F. and Guo, L.: `Composite disturbance-observer-based control and terminal sliding mode control for uncertain structural systems', International Journal of Systems Science, 2009, 40, 10, pp. 1009­1017.
[27] Yang, J., Li, S. and Yu, X.: `Sliding-mode control for systems with mismatched uncertainties via a disturbance observer', IEEE Transactions on Industrial Electronics, 2013, 60, 1, pp. 160­169.
[28] Formal'skii, A. M.: `An inverted pendulum on a fixed and a moving base', Journal of Applied Mathematics and Mechanics, 2006, 70, pp. 56­64.
[29] Lee, K., Coverstone-Carroll, V.: `Control algorithms for stabilizing underactuated robots', Journal of Intelligent and Robotic Systems, 1998, 15, 12, pp. 681­697.
[30] Ashrafiuon, H., Erwin, R. S.: `Sliding control approach to underactuated multibody systems', Proc. American Control Conference, Boston, MA, 2004, pp. 1283­1288.
[31] Olfati-Saber, R.: `Nonlinear Control of Underactuated Mechanical Systems with Application to Robotics and Aerospace Vehicles', PhD Thesis, 1­307, MIT, USA, 2001.
[32] Yang, Z. J., Nagai, T., Kanae, S. and Wada, K.: `Dynamic surface control approach to adaptive robust control of nonlinear systems in semi-strict feedbackform', International Journal of Systems Science, 2007, 38, 9, pp. 709­724.
[33] Qu, Z., Dawson, D. M., Lim, S.Y. and Dorsey, J. F.: `A new class of robust control laws for tracking of robots', International Journal of Robotics Research, 1994, 13, 4, pp. 355­363.

Chapter 10
Case studies on non-linear control theory of the inverted pendulum
Xu Xu1, Hongwei Zhang1, and Giuseppe Carbone1
Abstract
This chapter deals with the control of inverted pendulums through non-linear control theory. Simulations of the proposed control method are carried out in MATLAB® environment with satisfactory results in controlling systems of single and double-link inverted pendulum installed in a cart, for a range of starting positions. The proposed control technique can be extended to the control of many other non-linear systems. Examples are proposed as referring to design and teaching applications. In particular, a single inverted pendulum system constructed using Lego bricks and controlled by Lego Mindstorms EV3 is used to prove the user-friendliness of the proposed control method as implemented by Master students at Sheffield Hallam University. Moreover, 3 degrees of freedom parallel manipulator Cassino Parallel Manipulator is investigated for replacing a cart and providing three dimensional motions to an inverted pendulum while minimising dynamics effects at design stage.
10.1 Introduction
The control of inverted pendulums and cart systems is a widely addressed topic in control literature, such as reported in [1­3]. In fact, the above-mentioned non-linear systems are highly unstable, and they cannot maintain the upright position without an appropriate control. One approach to the control problem of an inverted pendulum on a cart is to linearise the system locally around the upright position by approximating the non-linear terms to linear ones. Traditionally, inverted pendulum systems are controlled by an open-loop swing up controller forcing the pendulum to reach the top equilibrium, and then switching to a closed-loop linear controller to control the pendulum from this point to maintain the upright position [3,4]. Some more recent publications, such as in [5,6], the authors proposed non-linear techniques to extend the stability region to a bigger neighbourhood of the upright position, but these methods
1Department of Engineering and Mathematics, Sheffield Hallam University, UK

226 The inverted pendulum in control theory and robotics

still involved switching between at least two control strategies and are not in the true sense of global control. For a comprehensive and thorough review of non-linear control strategies in controlling inverted pendulum systems, we refer the readers to Boubaker's survey article in 2013 [7].
In this chapter, we study an approach to non-linear control theory that is based on a generalisation of the linear quadratic optimal control theory. This approach gives approximations to non-linear optimal control systems, by solving a Riccati equation. There is a brief introduction of the theory, and detailed derivation of it can be found in [8­10]. The inverted pendulum and cart control problem can be solved by applying this non-linear control technique, so the pendulum can be controlled globally. In particular, this non-linear control technique can be easily applied to more complicated versions of the inverted pendulum and cart family: multi-link inverted pendulum and cart systems, which has not been reported in the existing literature.
In Section 10.2, a single-link pendulum is modelled and analysed. This is then extended to a double-link pendulum (the general case being similar), and Lagrange's equations for the system are derived. In Section 10.3.1, linearized equations of the pendulum (where the mass is concentrated at the top) in the form of

x = Ax + Bu

(10.1)

are studied. If matrices A and B form a controllable pair, then the local optimal feedback control u is given by

u = -R-1BT Px,

(10.2)

where, P satisfies the algebraic Riccati equation and R is a weighting matrix. In Section 10.3.2, the global pendulum model in the form of

x = A(x)x + B(x)u,

(10.3)

and the corresponding controllability of (A(x) , B(x)) for `almost all' x (i.e. controllable, apart possibly from a set of measure zero [11]) are analysed. The x in A(x) and B(x) is fixed for each step; therefore, the non-linear model resembles the linear
case for one step. This method also demonstrates effective robust control because of the update at each step, so any inaccuracy of A and B is adjusted automatically. Furthermore, the global control u is shown to be

u = -R-1B(x)T P(x)x,

(10.4)

where P(x) satisfies the pointwise algebraic Riccati equation:

AT (x) P(x) + P(x) A(x) + Q - P(x) B(x) R-1B(x)T P(x) = 0,

(10.5)

where Q and R are weighting matrices. In Section 10.4, some simulation examples are demonstrated to verify the above non-linear control theory of the inverted pendulum. It is shown that the single pendulum installed on a cart can be controlled from a large range of initial positions, including the rest position where the pendulum hangs downwards. The double-link pendulum and car system can also be controlled from many initial positions.

Case studies on non-linear control theory of the inverted pendulum 227
Case studies have been proposed for demonstrating the proposed control architecture with single and double pendulums. In particular, in Section 10.5, a single inverted pendulum system constructed using Lego bricks and controlled by Lego Mindstorms EV3 is used to prove the user-friendliness of the proposed control method as implemented by Master students at Sheffield Hallam University. Then in Section 10.6, a case study has been proposed as referring to a 3 degrees of freedom parallel manipulator CaPaMan (Cassino Parallel Manipulator), which is designed to replace a cart and provide three dimensional motions to an inverted pendulum while minimising dynamics effects at design stage.

10.2 Modelling of the cart­pendulum systems

Often inverted pendulums are considered in combination with moving carts. The system of a single pendulum installed on a cart is drawn in Figure 10.1.
The dynamical model of the cart and the pendulum are equations of motions often obtained by applying force analysis using free body diagrams and Newton's second law F = ma. However, there are other methods available for achieving a system's dynamical model, for example the Lagrangian approach which calculates the difference between total kinetic energy T and the total potential energy V of the system:

L=T -V

(10.6)

and the Hamiltonian equation which calculates the sum of the two types of energy:

H = T +V.

(10.7)

It is usually easier to use the Lagrangian method than the one based on force analysis because all is required are the generalised kinetic and potential energy terms, so resolving of the forces (which is often complicated) is not needed. We adopt the

Vertical axis u

m2 r m1

Horizontal axis x1
Figure 10.1 The single inverted pendulum and cart diagram

228 The inverted pendulum in control theory and robotics

Lagrangian approach for its simplicity, where the Lagrange's equations [12,13] are given by

d L L dt xi - xi = fi, 1  i  n,

(10.8)

where xi represents the ith generalised coordinate and fi the ith generalised force applied on the object. These Lagrange's equations are equivalent to Newton's laws [14].
In the case of a single pendulum­cart system, there are two x variables shown in Figure 10.1, namely the horizontal distance x1 (m) travelled by cart from the left reference, and the angle  (rad) between the pendulum rod and the vertical axis. x1 and  represent velocity of the cart along the horizontal axis and angular velocity of the rod around the rod-cart connection point, respectively. Here,

f1 = u, f2 = 0.

(10.9)

The total kinetic energy of the pendulum­cart system can be written as

T

=

1 2

m1x12

+

1 2 m2

d dt (x1 + r sin  )

21 + 2 m2

d (r cos ) dt

2

=

1 2

m1x12

+

1 2 m2

x1 + r cos 

2

+

1 2 m2

-r sin 

2

=

1 2

(m1

+

m2)x12

+

m2rx1

cos



+

1 2

m2r2

2,

(10.10)

where m1 and m2 are the masses of cart and of pendulum, respectively, r denotes the length of the pendulum and g is acceleration due to gravity. The total potential energy of the system, using the bottom of the pendulum rest position as the vertical reference point, can be written as

V = m2g(r + r cos  ).

(10.11)

Therefore, the Lagrangian equation is given by

L = T -V

=

1 2 (m1

+

m2)x12

+

m2rx1

cos



+

1 2

m2r22

-

m2gr(1

+

cos



)

Substitute (10.12) into (10.8), we obtain

x¨1

=

m2r2 sin  - m2g sin  cos  m1 + m2 sin2 

+u ,

¨

=

-m2r2 sin  cos  + m2g sin  + m1g sin  r m1 + m2 sin2 

- u cos  ,

(10.12) (10.13)

where u represents the control as the force applied on the cart indicated in Figure 10.1. The equations in (10.13) satisfy Newtown's second law [14]. Note the two equations

Case studies on non-linear control theory of the inverted pendulum 229
in (10.3) both have second derivatives on the left-hand-side and are not yet in the standard state-space model form. A state-space representation of the system can be written as

x1 = x2

x2

=

m2rx42 sin x3 - m2g sin x3 cos x3 + u m1 + m2 sin2 x3

x3 = x4

x4

=

-m2rx42 sin x3 cos x3 + m2g sin x3 + m1g sin x3 - u cos x3 r m1 + m2 sin2 x3

(10.14)

by changes of variables, such that x2 = x1, x3 =  and x4 = x3 and splitting each of the (10.13) equations into two equations. This translates into the state-space matrix form as

 x1
xx32

=

 0
00

1 0 0

x4

00



0
-m2g sin x3 cos x3
(m1+m2 sin2x3 )x3 0
(m1+m2)g sin x3
r(m1+m2 sin2 x3)x3 

0

+ 

1 m1+m2 sin2 x3
0

 u,

- cos x3

r(m1+m2 sin2 x3)

0
m2rx4 sin x3 m1+m2 sin2 x3
1

 



x1 xx23



-m2rx4 sin x3 cos x3

x4

r(m1+m2 sin2 x3)

(10.15)

One particular advantage of this method is that it can be easily extended to a general multi-link pendulum case, without the need to perform complex force analysis on the new and previous pendulum objects. For example a double pendulum and cart system is illustrated in Figure 10.2, where 1 and 2 represent the angles between the first and the second pendulum rods and the vertical axis and u denotes the force (control) applied on the cart.
A similar energy analysis can be performed as before. Using the new vertical and horizontal references as indicated in Figure 10.2, the total kinetic energy and potential energy of the new system can be modified to

T2

=

T

+

1 2 m3

d dt

(x1

+

r1

sin

1

+

r2

sin

2)

2

+

1 2 m3

d dt

(r1

cos

1

+

r2

cos

2)

2

=

1 2 (m1

+

m2

+

m3)x12

+

1 2 (m2

+

m3)r1212

+

1 2

m3r2222

+

(m2

+

m3)r1x11

cos

1

+ m3r2x12 cos 2 + m3r1r212 cos(1 - 2),

(10.16)

230 The inverted pendulum in control theory and robotics

Vertical axis

2 m3 m2 r2
1 r1

u

m1

x1

Horizontal axis

Figure 10.2 The double-link inverted pendulum and cart system diagram

and

V2 = V + m3g(r1 + r2 + r1 cos 1 + r2 cos 2) = (m2 + m3)gr1(1 + cos 1) + m3gr2(1 + cos 2),

(10.17)

which lead to the new Lagrange's equation

L2 = T2 - V2

=

1 2 (m1

+

m2

+

m3)x12

+

1 2 (m2

+

m3)r1212

+

1 2

m3

r2222

+

(m2

+

m3)r1x11

cos

1

+ m3r2x12 cos 2 + m3r1r212 cos(1 - 2) - (m2 + m3)gr1(1 + cos 1)

- m3gr2(1 + cos 2),

(10.18)

where m3 denotes the mass of the newly added pendulum, and r1 and r2 are the lengths of the original rod and the new rod, respectively. The energy equations appear complicated; however, the analysis performed above is relatively straightforward in the sense that effect only comes from the new pendulum and corresponding energy terms can simply be added to the original equations.
The process of obtaining a state-space model for the double-link pendulum cart system is also similar as the one is the single pendulum case. By solving the Langrange's equation in (10.8) and splitting each differential equation with a second derivative into two equations containing only first derivatives (i.e. let x2 = x1, x3 = 1, x4 = x3, x5 = 2 and x6 = x5), we obtain standard state-space model of the double-link

Case studies on non-linear control theory of the inverted pendulum 231

pendulum cart system in matrix form:

 x1
xxxx2354

x6 

= 00000

1 0 0 0 0

0
m2ga sin x3 cos x3 -x3 d (x3 )
0
ge(x5) sin x3 2r1 x3 d (x3 )
0

0
m2r1ax4 sin x3 d (x3 )
1
x4f (x3,x5) -2d (x3 )
0

0
0
0
m1m3gb(x3,x5) sin x5 -r1 x5 d (x3 )
0

0

0

m1gab(x3,x5) sin x3
-r2 x3 d (x3 )

m1 r1 ax4 c(x3 ,x5 )
r2d(x3) 

m1ga cos2 x3 sin x5 r2 x5 d (x3 )



0

×

x1 xxxx2453
x6

+



m2

m2 +m3 c(x3 ,x5 )2 d (x3 )
0
cos x3-m3c(x3,x5) sin -r1 d (x3 )
0
ac(x3,x5) sin x3

x5



u,

-r2 d (x3 )



0

m2

m3

r2

x6 [sin(x5 -2x3 -2d (x3 )
0
r2 x6 h(x3 ,x5 ) -r1 d (x3 )
1

)-sin

x5

]



m1m3x6 sin(2x5-2x3) -2d (x3 )

(10.19)

where constant a and functions b(x3, x5), c(x3, x5), d(x3), e(x5), f (x3, x5) and h(x3, x5) have been defined as the following:

a = m2 + m3; b(x3, x5) = cos x3 cos x5; c(x3, x5) = sin(x3 - x5); d(x3) = m2a sin2 x3 + m1m3c2 + m1m2; e(x5) = 2m22 + m1m3 + 2m2m3 + 2m1m2 + m1m3 cos(2x5); f (x3, x5) = m2a sin(2x3) - m1m3 sin(2x5 - 2x3); h(x3, x5) = m2m3 sin x3 cos x5 + m1m3c.

(10.20) (10.21) (10.22) (10.23) (10.24) (10.25) (10.26)

Having now obtained the mathematical models (state-space representations) of the single pendulum installed on a cart and the double-link pendulum and cart system, we shall discuss how to achieve linear and non-linear quadratic optimal controls of the systems in theory in Sections 10.3.1 and 10.3.2, respectively.

232 The inverted pendulum in control theory and robotics
10.3 Control analysis

10.3.1 Linear control analysis

A general linear control system has the following form:

x = Ax + Bu,

(10.27)

where x is the state variable vector, u is the control vector and (A, B) is a controllable pair, or at least a stabilisable pair, to guarantee finite solutions of the Ricatti equation (see later for details). Linearised equations of the pendulum­cart system where the mass is concentrated at the top are in the form of (10.27).
The quadratic infinite-time cost function [3]:

J=1


(xT Qx + uT Ru)dt

20

(10.28)

leads to the linear optimal feedback control solution:

u = -R-1BT Px,

(10.29)

where R is a weighting matrix and P is a positive-definite Hermitian or real symmetric matrix. P satisfies the algebraic Riccati equation:

AT P + PA + Q - PBR-1BT P = 0.

(10.30)

The above Riccati equation can be solved using the LQR (linear-quadratic regulator) function in MATLAB [3]. To implement the optimal control solution, substitute (10.29) into (10.27), we obtain

x = Ax - BR-1BT Px

= [A - BR-1BT P]x,

(10.31)

which is a stable controlled system in the linearised case [3], as long as the condition

of

the

observability

of

the

pair

(Q

1 2

,

A)

is

satisf

ied.

In the cases of the two inverted pendulum and cart systems analysed in Sec-

tion 10.2, the non-linear state-space models of the systems can be considered as linear

representations when the inverted pendulums are kept in a small neighbourhood of

the vertical upright position. Then, for the single pendulum­cart case, we can assume

that x3 and x4 (which is x3) are small quantities, and the following approximations

can be made:

sin x3  x3, cos x3  1, sin2 x3  0 and x42 sin x3 = x32 sin x3  0.

(10.32)

The linearised state-space model can be simplified substantially from (10.14) and can

then be written into the form of (10.27), where

 01

A1 = 00

0 0

0

-

m2 g m1

0





0

0

10 and B1 = 

1 m1
0

 .

(10.33)

00

(m1 +m2 )g rm1

0

-

1 rm1

Case studies on non-linear control theory of the inverted pendulum 233

Similarly, for the double-pendulum­cart system, to achieve the linearised state-space model, we also assume that x3, x4, x5 and x6 are small such that sin x3  x3, sin x5  x5, cos x3  cos x5  1, sin2 x3  sin2 x5  0, cos2 x3  cos2 x5
 1, sin2(x3 - x5)  0 and x42 sin x3  x42 sin x5  x62 sin x3  x62 sin x5  0. (10.34)

These approximations simplify the state-space model of the double-link pendulum

and cart system into the linearised form of (10.27), where



01

0

0

A2 = 0000

0 0 0 0

-

(m2

+m3 m1

)g

0

Mg 2r1 m1 m2
0

0 1 0 0

0

0

0

-

m3 g r1 m2

0





0

0

1000 and B2 = -m001r1m11  ,

0

0

- (m2+m3)g
r2 m2

0

(m2 +m3 )g r2 m2

0

0

(10.35)

and M = 2m22 + m1m3 + 2m2m3 + 2m1m2 + m1m3. The linear models represent the systems adequately when the starting positions

of the inverted pendulums are near the vertical upright positions. Because the linear optimal feedback controlled systems are stable at the equilibriums where x = 0, the

linear representations of the systems will always be valid as long as the initial positions

are within a small neighbourhood of the vertical upright position. If the initial positions

are not within this range, however, the linear models obtained in this section are not

close approximations of the original systems and the control solutions achieved in

(10.29) do not provide satisfactory control.

Traditionally, the inverted pendulum systems are controlled by an open-loop

swing up controller forcing the pendulum to reach the top equilibrium, and then

switching to a linear feedback controller (e.g. a linear quadratic optimal controller

as the one we discussed in this section) to control the pendulum from this point. In

Section 10.3.2, we shall consider and analyse a freezing technique to control non-

linear dynamical systems originally introduced by Banks and Mhana in 1992 [8],

using the theory of linear quadratic optimal control. The inverted pendulum systems

can be controlled from a much wider range of starting positions by applying this

non-linear optimal control technique.

10.3.2 Non-linear control analysis

A general non-linear control system can be represented by the following:

x = f~ (x, u), x(0) = x0.

(10.36)

If f~ (x, u) is a linear-analytic function, the general non-linear system equation shown

in (10.36) is equivalent to

x = f (x) + g(x)u,

(10.37)

where f (x) and g(x) are non-linear, analytic functions and the controller u is affine.

234 The inverted pendulum in control theory and robotics

If f~ (x, u) is not a linear-analytic function, the system can always be written in the linear analytic form presented in (10.37) as long as the mild condition of the controller function u being differentiable is satisfied, although the trade-off is the increase of the dimensionality of the state space. This is done by introducing a new control function v such that

u = v.

(10.38)

Then a new state variable y can be defined as

y=

x u

.

(10.39)

Now a new system representing the original one in (10.36) but in linear analytic form can be written as

y =

f~ (x, u) v

=

f~~ (y) 0

+

0 I

v

= f (y) + g(y)v,

(10.40)

where I is the identity matrix and the new controller v is affine. It can be seen now that (10.40) is of the same form as (10.37), even though the new state space has a higher dimension.
Note that in the cases when f~ (x, u) is not linear-analytic and the technique of rewriting the system into a linear-analytic one as explained above is adopted, the new controller function v determined might not be the optimal control for the original system, as the original system might have a non-differentiable control u which works better. However, this situation is rare, as the optimal controller would be differentiable for the vast majority of physical systems. So most physical system models obtained are either in linear-analytic form or can be easily rewritten into a higher dimensional linear-analytic function, and this process does not affect the solution of the optimal controller.
The non-linear function f (x) can be taken out of (10.37) for further analysis. The function f (x) can be written analytically into a matrix function

f (x) = A(x)x,

(10.41)

provided it satisfies the condition

f (x) = 0 at x = 0.

(10.42)

The above condition essentially means that the non-linear system x = f (x) has an equilibrium at the origin. This condition is true for at least one of the models of any real system. For example in the single or multi-link inverted pendulum system, an unstable equilibrium exists at x = 0, where the cart is not moving, and all the pendulum mass is at the top (i.e. the angles are 0).

Case studies on non-linear control theory of the inverted pendulum 235

Then by substituting (10.41) into (10.37), the non-linear control system of (10.37) can be written as

x = A(x)x + B(x)u,

(10.43)

if B(x) = g(x). In the case when the system function in (10.36) is not analytic, but

the control u is differentiable, g(x) is simply

0 I

as shown in (10.40) and is linear.

One important point to note is that the non-linear state-space representation

(10.43) of the system is not unique. If the function f (x) is analytic, then it has a

convergent Taylor's series such that

f (x) =



1 i!

i xi

f

(0)

x

i

=



f

(i)(0) i!

xi

,

i=0

i=0

(10.44)

where xi = x1i1 , x2i2 , . . . xnin [15]. The Taylor series starts with a constant term for any function, but if f (0) = 0, it means the constant term for the function f is 0 in this case, then every other term is a polynomial which contains at least one x (x1 or x2 or x3 . . .). This is true for most physical systems, as discussed earlier for the equilibrium condition in (10.42). Then take each homogeneous component, i.e. take all powers of
order one (linear terms) and then all power of order two (quadratic terms) and so on.
That means, in any one of those homogeneous polynomials, there are always terms
with at least one x (x1 or x2 or x3) in it. Then an `x' can be pulled out to form the matrix A(x).
For any system which satisfied the origin equilibrium condition stated in (10.42),
a representation in the form of (10.43) can always be found, but this representation is
non-unique. A simple example to demonstrate this fact is shown below:

Example 10.1

An analytic system is governed by the following differential equations:

x1 = x1x2 x2 = x2 + u2.

(10.45)

The equations can be written in matrix form as

x1 x2

=

x2 0

0 1

x1 x2

+

0 1

u1 u2

,

or

x1 x2

=

0 0

x1 1

x1 x2

+

0 1

u1 u2

.

(10.46) (10.47)

Although the two state-space matrices are different, they represent differential equations which are equivalent. It can be seen from this example that the state-space model of a system is not unique. Depending on how the matrix is split out of the differential equations, there are often many valid mathematical representations of the same system, although some are more physical than others, or are expected to lead to simpler control calculations and implementations.

236 The inverted pendulum in control theory and robotics

Once a state-space model of the non-linear system is constructed in the form of (10.43), the global non-linear control theory [8,9] states that by attaching the generalised quadratic infinite time optimal cost function

J=1


(xT Q(x)x + uT R(x)u)dt

20

(10.48)

to (10.42), it generates the non-linear optimal control solution:

u = -R-1(x)BT (x)P(x)x,

(10.49)

where P(x) satisfies the algebraic Riccati equation: AT (x)P(x) + P(x)A(x) + Q(x) - P(x)B(x)R-1(x)BT (x)P(x) = 0.

(10.50)

The optimal stabilising control can be obtained by substituting (10.49) into (10.43) to produce a coupled control system:

x = A(x)x - B(x)R-1(x)BT (x)P(x)x

= [A(x) - B(x)R-1(x)BT (x)P(x)]x.

(10.51)

To solve the equations in (10.51) numerically, an integration method for each time
step can be used. For example the Euler's method or the fourth order Runge­Kutta
method can be adopted for the inverted pendulum cases. We use a freezing technique to solve for the next step of x iteratively using an
integration method. Starting at x(0) (which is a known chosen initial state), A(x(0)) and B(x(0)) are then fixed matrices at this initial step. MATLAB provides a LQR solution for P(x(0)) after solving the algebraic Riccati equation because at each time step for a fixed x, the system becomes essentially the same as the linear case, so linear control theory can be easily applied. Now substitute A(x(0)), B(x(0)) and P(x(0)) into (10.51) to solve for the next x, say x(1). Then having obtained x(1), the same process can be repeated for the next step and so on for the system.
One point to bear in mind is that as we discussed earlier in this section, the statespace representation A(x) of any system is not unique, so the state-space solution of the controlled system x may also vary. In the case of the single inverted pendulum, for example, even if we still adopt the Lagrangian approach to obtain the equations of
motions given by (10.14) in Section 10.2, it is possible to write a different state-space model in matrix by splitting the x from each equation of (10.15) differently. Therefore, the global non-linear optimal control solution (10.51) obtained by using the freezing
technique is not unique, because the model of the inverted pendulum­cart system
can be different to the one used for the control analysis. In Example 10.1, it is seen
that, in the first representation, the system is totally uncontrollable and the second is controllable apart from on the set where x1 = 0, which is of two-dimensional measure zero. Therefore, the controllability of the original system varies, depending on the
state-space model written.
In the linear control case for a single inverted pendulum, the closed-loop pendulum control needs an initial position of x3(0) = 0, i.e. the pendulum mass is concentrated at the top of the rod, or x3(0)  0, i.e. the mass is within a small neighbourhood of the top position so the approximations of sin x3  x3 and cos x3  1 are

Case studies on non-linear control theory of the inverted pendulum 237

true to linearise the system state-space model. To reach this initial position, either

the pendulum is manually placed, or an open-loop swinging up control is usually

implemented.

In the non-linear control case, the pendulum can start from any initial position

apart

from

two

initial states

of x3

=

±

 2

because (A(x), B(x)) is

unstabilisable

at

these

two positions [9,16]. But (A(x), B(x)) is controllable for all other x and in the rare

situation when the pendulum does start from the two angles stated above, the pendulum

will fall slightly due to gravity and hence changing the value of x2 to other values

than

±

 2

.

Then

the

non-linear

optimal

stabilising

control

will

kick

in

to

control

the

pendulum. Therefore, we say this condition does not change the overall controllability

of (A(x), B(x)) and the pendulum system is controllable for `almost all' x. In higher

order systems, such as the multi-link inverted pendulum systems, the nature of the

uncontrollable subspace will be more complicated and will require further analysis.

Another advantage of this non-linear global control method, apart from the fact

that it can be controlled from nearly any position, is that it is intrinsically robust. This

is because unlike the linear case, any inaccuracy in the modelling of A and B can be

taken account of and corrected at each time step and would therefore not affect the

eventual control result. To implement the control in real time, a powerful computer is

needed to solve the Riccati equation within the required time.

The control of inverted pendulum system is a benchmark in testing the general

non-linear optimal control theory discussed above. This method does not only apply to

the pendulum system but also to any general non-linear control systems, for example

aeronautical systems [8] or ship systems [17]. It is also worth noting that there are other

techniques for solving non-linear control problems, for example a linear, time-varying

approximation approach introduced in [18]. In the next section, we will demonstrate

some simulation results of the single and double-link inverted pendulum and cart

control systems, using the non-linear optimal control method discussed in this section.

10.4 Simulations for single and double pendulum control
We use a fourth order Runge­Kutta method (because of its high accuracy) to calculate and to apply the optimal control solutions to the inverted pendulum and cart systems numerically in MATLAB. The non-linear control theory and the simulation principles are discussed in Section 10.3.2. Simulation results for the single-pendulum and cart controlled system defined in (10.14) in Section 10.2 are plotted in Figures 10.3­10.5. Figures 10.6 and 10.7 display the simulation results for the double-pendulum and cart-controlled system presented in Section 10.2.
For the single pendulum and cart simulation, the parameters used are: mass of the cart: 2 kg, mass of the pendulum: 0.1 kg and the rod length 0.5 m. For the double pendulum and cart simulation, the parameters are: mass of the cart: 2 kg, mass of the first pendulum: 0.1 kg, mass of the second pendulum: 0.1 kg and both of the rods are 0.1 m long.
Sample MATLAB codes are attached in Appendix A for the convenience of the readers.

4

6

Cart velocity ×2 (m/s)

Cart displacement ×1 (m)

3

4

2 2
1

0

0

­1

­2

0

2

4

6

8

0

2

4

6

8

Time (s)

Time (s)

Pendulum angular velocity ×4 (rad/s)

1.5

1

Pendulum angle ×3 (rad)

1

0

0.5

­1

0

­2

­0.5

­3

­1

­4

0

2

4

6

8

0

2

4

6

8

Time (s)

Time (s)

Figure 10.3 The plots of x1 - x4 for the single pendulum control system starting

from

x3

=

 3

Cart displacement ×1 (m)

2

4

Cart velocity ×2 (m/s)

2 0
0

­2

­2

­4 ­4
­6

­6

­8

0

2

4

6

8

0

2

4

6

8

Time (s)

Time (s)

Pendulum angular velocity ×4 (rad/s)

Pendulum angle ×3 (rad)

5

2

4

0

3 ­2
2
­4 1

0

­6

­1 0

2

4

6

8

­80

2

4

6

8

Time (s)

Time (s)

Figure 10.4 The plots of x1 - x4 for the single pendulum control system starting

from

x3

=

4 3

Case studies on non-linear control theory of the inverted pendulum 239

Cart displacement ×1 (m)

2

5

Cart velocity ×2 (m/s)

0 0
­2

­4 ­5
­6

­8

­10

0

2

4

6

8

0

2

4

6

8

Time (s)

Time (s)

Pendulum angular velocity ×4 (rad/s)

4

2

Pendulum angle ×3 (rad)

3

0

2 ­2
1

0

­4

­1 0

2

4

6

­6

8

0

2

4

6

8

Time (s)

Time (s)

Figure 10.5 The plots of x1 - x4 for the single pendulum control system starting from x3 = 

10.5 Case study 1 ­ LEGO EV3-based inverted pendulum
10.5.1 Introduction
As a classical control problem, inverted pendulum provides a good understanding about control techniques of non-linear systems and their linearisation approaches. Controlling of inverted pendulum system lays strong background for a control engineer, and the depth of the inverted pendulum study can be varying from undergraduate level to the postgraduate level. There are many inverted pendulum systems developed for educational purposes, for example the Quanser Linear Servo Cart with the Inverted Pendulum (as shown in Figure 10.8), the Quanser Rotary Inverted Pendulum (as shown in Figure 10.9) and the Feedback Instruments Digital Inverted Pendulum (as shown in Figure 10.10) are very popular among the equipment offered by engineering teaching equipment providers. Many universities and researchers around the world have also designed and built their own inverted pendulum systems [19­21] to suit different teaching needs and research investigations. In recent years, rapid advancements in microprocessor technology have led to the development of many inverted pendulums controlled by microcontrollers such as Arduino, Raspberry Pi and PIC controllers

240 The inverted pendulum in control theory and robotics

Cart displacement ×1 (m)

0.5

0

­0.5

­1

­1.5

­2

0

2

4

6

8 10

Time (s)

1

Cart velocity ×2 (m/s)

3

2

1

0

­1

­2

­3

0

2

4

6

8 10

Time (s)

5

Pend-2 angular velocity ×6 (rad/s) Pend-1 angular velocity ×4 (rad/s)

Pend-1 angle ×3 (rad)

0.5

0

0

­5

­0.5

­10

­10

2

4

6

8 10

­15 0

2

4

6

8 10

Time (s)

Time (s)

Pend-2 angle ×5 (rad)

1

0.5

0

­0.5

­1

0

2

4

6

8 10

Time (s)

2 0

­2 ­4

­6

­8

0

2

4

6

8 10

Time (s)

Figure 10.6

Double pendulum

and

x5

=

 6

control

system

x1

-

x6

plots

starting

from

x3

=

 4

which are more affordable and transportable [22­24]. Another very popular inverted pendulum development is using the LEGO Mindstorms kit [25­27].
10.5.2 LEGO Mindstorms EV3
Initially designed as a toy for school children, LEGO Mindstorms is now widely used in university education and research, attracting applications in many areas, including artificial intelligence, embedded systems, control systems, robotics and operating systems. In additional to the characteristics that they are inexpensive, easily reconfigurable, reprogrammable, versatile and robust, another unique benefit of using LEGO Mindstorms is that the complete inverted pendulum system can be constructed and controlled by LEGO Mindstorms kit including over 500 TECHNIC elements for

Case studies on non-linear control theory of the inverted pendulum 241

Cart displacement ×1 (m)

Pend-2 angular velocity ×6 (rad/s) Pend-1 angular velocity ×4 (rad/s)

5 4 3 2 1 0 ­1
0
1.5 1
0.5 0
­0.5 0
1.5

5

10

Time (s)

5

10

Time (s)

6

Cart velocity ×2 (m/s)

4

2

0

15

­20

2

1

0

­1 ­2

­3

15

0

1

5

10

15

Time (s)

5

10

15

Time (s)

Pend-1 angle ×3 (rad)

Pend-2 angle ×5 (rad)

1

0

0.5

­1

0

­2

­0.5 0

5

10

Time (s)

­3

15

0

5

10

15

Time (s)

Figure 10.7 Double pendulum control system x1 - x6 plots starting from

x3

=

x5

=

 3

Figure 10.8 Quanser linear servo cart with the inverted pendulum [28]

242 The inverted pendulum in control theory and robotics
Figure 10.9 Quanser rotary inverted pendulum [29]
Figure 10.10 Feedback instruments digital pendulum [30] mechanical design and construction, 5 sensors, 3 motors and the programmable brick with powerful ARM9 CPU in its latest EV3 kit.
LEGO Mindstorms EV3 is the third generation of the LEGO robotics kit which was introduced in 2013. It has a more intelligent and powerful ARM9 CPU running Linux. A USB connector and Micro SD slot (up to 32 GB) as well as communication

Case studies on non-linear control theory of the inverted pendulum 243
Figure 10.11 LEGO Gyroboy (Segway)
capability through Wi-Fi are new features of the EV3 brick. There were many software and programming languages which can communicate with the LEGO Mindstorms. LabVIEW, MATLAB & Simulink®, RobotC for Mindstorms, C++ are the most common programming platforms and languages used in LEGO Mindstorms [31,32]. Mindstorms EV3 can use Bluetooth or wired USB connection for shortrange communication and Wi-Fi facilitates for long-range networking. For the Wi-Fi communications, EV3 brick needs to connect with an external Wi-Fi dongle, and the only supported Wi-Fi module with the LEGO Mindstorms platform is NETGEAR N150 (WNA1100) Wireless Adapter [31].
LEGO Mindstorms EV3 has four output ports and four input ports which can measure the data up to 1000 samples per second. The system has 16 MB of flash memory, inbuilt 64 MB RAM and enables to extend the memory up to 32 GB by a mini HDSC memory card reader [31]. The LEGO Mindstorms EV3 has two large interactive servo motors with encoders, a medium servo motor, a colour sensor, a touch sensor (two state pressure sensor), a gyro sensor and an IR sensor [31].
10.5.3 Construction of LEGO inverted pendulum
The most popular LEGO inverted pendulum was the so-called Gyro Boy which is a self-balancing Segway on two wheels (as shown in Figure 10.11). Gyro Boy uses a combination of the large servo motors' encoders working with the Gyro sensor to balance itself upright. LEGO provided the user with complex example models, such as Gyro Boy, as an inspiration of what can be built and controlled with LEGO MINDSTORMS. The robot also responds to commands and feedback from the colour sensor and the ultrasonic sensor.
More traditional inverted pendulum applications have also been developed using either LEGO Mindstorms NXT or EV3. As shown in Figure 10.12, a single inverted

244 The inverted pendulum in control theory and robotics
Figure 10.12 Single inverted pendulum on a cart using LEGO EV3
Figure 10.13 Rotary inverted pendulum using LEGO EV3 pendulum cart was developed by Professor Masakatsu Kawada and his students with LEGO EV3 [33]. In this application, a GlideWheel-AS Angle Sensor has been used to measure the angle of the pendulum and two large servo motors were used to control the cart as well as providing the cart displacement measurements. They have also developed a LEGO EV3 rotary inverted pendulum system as shown in Figure 10.13 [34­36].

Case studies on non-linear control theory of the inverted pendulum 245
Figure 10.14 Single inverted pendulum on a cart based on the Lego Mindstorms EV3
Figure 10.14 has shown the structure of the single inverted pendulum that was built using simple LEGO bricks, and the pendulum was attached onto the cart which was also made from LEGO bricks. With two heavy wheels on top, the centre of gravity of the pendulum was assumed at the top of pendulum. Two side bars were used for the protection of the brick screen and the pendulum. Pendulum was attached to the rotatable wheel on cart, and it could slow down the pendulum by using gears if required. Two large servo motors were used to move the cart, and the position of the cart was measured with the feedback from the motors' encoders. The Gyro sensor was used for measuring the angle and the angular velocity of the pendulum. The physical parameters of the LEGO-based single inverted pendulum system are shown in Table 10.1.
10.5.4 Controller design and Simulink model
Controller was designed in MATLAB and Simulink while Wi-Fi network connection was used to communicate the measurement and control information with the EV3 brick. The LEGO Mindstorms Simulink support package was used to develop the Simulink model as shown in Figure 10.15. The pendulum angle was obtained from taking an integration to the output from the Gyro sensor (in degrees/s). The cart position was measured by the other two large motors' encoders. The encoder

246 The inverted pendulum in control theory and robotics Table 10.1 Physical parameters of single inverted pendulum

Measurement

Value (units)

Mass of the cart Mass of the pendulum Length of the pendulum Diameter of a cart wheel Circumference of a cart wheel Length of the cart (among two wheels) Width of the cart (among two wheels) Height of the cart (from ground to pivot point of pendulum)

718 g 120 g 345 mm 56 mm 17.6 cm 20 cm 10 cm 15 cm

measurements were given in degrees, and it was converted to radians by adding a gain element after the encoder blocks. The cart position was measured in lengths but the obtained measurement was from the angle for the wheels. Therefore, angle measurements were converted into length. Low-pass filter was used before the position signals were differentiated. The Simulink controller used a MATLAB-function, as shown in Figure 10.16, which was using the four-state variables described in (10.14) as inputs and calculate the control signal using the non-linear optimal control method introduced in Section 10.3.2.
10.5.5 Experimental results
Experimental results of the controlled single inverted pendulum and cart system, using the non-linear optimal control method and the Runge­Kutta integration method, are presented in Figure 10.17, where pendulum started at initial position of 10 ( /18). Sampling time was set at 0.1 s. The speed of the two large motors was controlled using calculated controller output between a range of -100 to 100 as a percentage of the full speed (at 160 rpm) where the negative sign indicates reverse rotation. The outputs of the Gyro sensor were all integers in degree/s, thus the staircase shape of the graphs. The experiment results show that the inverted pendulum could stabilise fairly and quickly, which demonstrated the effectiveness of the non-linear optimal control method.
10.6 Case study 2 ­ a parallel manipulator as the cart
A parallel kinematic manipulator is a mechanical system that uses several serial chains to support a single movable platform, or end-effector. They are investigated and implemented in several application tasks ranging from industrial manipulations to service robotics, as described for example in [37]. There is a wide range of design solutions for PKM according to their specific application(s) also. A successful PKM laboratory prototype is CaPaMan. This robot has been built in several different design versions, and it has been investigated for various applications including, for example, robotic surgery [38] or earthquake shaking tests [39].

LEGO EV3
Port A Motor
LEGO EV3
Port D Motor1

X1

R

int32

U_FORCE Control signal

Saturation Data type conversion1

X2

K(z­1)

Ts z

­2 1­0.8z­1

Discrete derivative Low-pass filter

X3

K Ts

z­1

Discrete-time
integrator X4

z­1 Controller_15new_cnt

+ D2R

Degrees to

1/2

radians

+ D2R

Degrees to radians1

D2R
Degrees to radians2

Figure 10.15 Simulink model for single inverted pendulum on a cart

LEGO EV3 Port A
LEGO EV3 Port D
LEGO EV3 Port 2 Gyro sensor

248 The inverted pendulum in control theory and robotics

X1

1

u1

X2

2

u2

X3

y

3

u3

evalrhs_single

X4

4

u4

MATLAB function

Figure 10.16 Simulink model for control subsystem

1 Control signal

Cart displacement ×1 (m)

0.25

100

Motor speed (% of full speed)

0.2

0.15

50

0.1

0.05

0

0

­0.05

­50

0

2

4

6

8

0

2

4

6

8

Time (s)

Time (s)

10

10

Pendulum angular velocity ×4 (degree/s)

0 5
­10

­20 0
­30

­5

­40

0

2

4

6

8

0

2

4

6

8

Time (s)

Time (s)

Figure 10.17 Simulation results ­ single inverted pendulum starting at  /18

Pendulum angle ×3 (degree)

Figure 10.18(a) and (b) shows, respectively, a kinematic model of CaPaMan and a built prototype, which has a two links mechanism on its movable plate. CaPaMan is composed of a movable plate MP that is connected to a fixed plate FP by means of three identical articulated parallelograms AP, whose coupler carries a prismatic joint

Case studies on non-linear control theory of the inverted pendulum 249

Z 
ZP 

BJ

MP

H rP

YP

H1

CB

h1 XP s2

X3

SJ AP
Z3
O3

c1
b1 Zd1 Z1 1O rf

Z2 O2

a1 O1 FP

 Y
2

X X1

(a)

(b)

Figure 10.18 CaPaMan (Cassino Parallel Manipulator): (a) a kinematic scheme; (b) a built prototype with a pendulum on the movable plate [41,42]

Table 10.2 Sizes and motion parameters of the built prototype of CaPaMan, as referring to (Figure 10.18(a))

ak = ck (mm) 200

bk = dk (mm) 80

Hk (mm) 100

rP = rf (mm) 109.5

 (deg) 45; 135

sk (mm) -50; 50

SJ and a spherical joint BJ, as shown in the scheme of Figure 10.18(a). This specific kinematic architecture allows to keep the motors on the fixed base to reduce inertial forces. Additionally, the number of active degrees of freedom is limited to 3 while 6 degrees of mobility can be achieved with coupled motions of the movable plate. For example a synchronised motion of the three motors will allow a vertical motion along Z-axis coupled with a rotation about Z-axis.
Table 10.2 reports the values of main sizes of CaPaMan as referring to the model in Figure 10.18. A detailed modelling of CaPaMan, including close loop direct kinematics formulation, has been described, for example, in [40]. In particular, direct kinematics can provide the following expression for the centre point H of MP as

x = y3- y2 - rP (1 - sin ) cos( -  ) 32
y = y1 - rP(sin  cos  + cos  sin  sin  ) z = z1 + z2 + z3
3

(10.52)

250 The inverted pendulum in control theory and robotics

and the orientation Euler angles of MP as



=

tan-1

 3

z3 - z2 2z1 - z2 -

z3



= sin-1

2

y1 3rP

+ (1

y2 +

+ y3 sin )

-

 = cos-1 ± 2 3rP

z12 + z22 + z32 - z1z2 - z2z3 - z1z3

(z  z1  +; z < z1  -)

(10.53)

The sign ambiguity in (10.53) for ,  and  is solved when the values of z1 and z give the up and down orientation of the mobile plate and, therefore, the sign - or + is chosen, respectively.
In this chapter, CaPaMan is considered as a cart of an inverted pendulum, such as
shown in Figure 10.18(b). Accordingly, (10.52) and (10.53) have been expressed as a function of Hk coordinates yk , zk (k = 1, 2, 3), which can be given by the geometry of Figure 10.18(a) from the input variable k

yk = bk cos k zk = bk sin k + hk

(10.54)

so that they can be considered the input coordinates for the platform motion.

The symmetry characteristics of CaPaMan architecture have been useful to for-

mulate analytical dynamic equations to compute the input torques as reported in [40].

Assumptions have been made in order to simplify the equations such as the effects

of link elasticity and viscous damping of the joints have been neglected; links are

assumed to be rigid bodies and the joints are frictionless and have no clearance.

In addition, only the inertial effects of the movable platform have been considered

since the legs of parallel architectures are lighter than the movable plate. Based on

the above-mentioned assumption, the only forces that are applied to the rods CB by

the mobile platform are those, which are contained in the plane of the articulated

parallelogram, i.e. Fky and Fkz as shown in Figure 10.19. The Fkx component determines the sliding of the prismatic joint along sk
coordinate. Thus, the components of the resultant force F and torque N can be

computed as

 FFFyxz  NNyx
Nz

=











-

3 2

F2y

+

3 2

F3y

F1y

-

1 2

F2y

-

1 2

F3y

F1z + F2z + F3z



-u21 1-zF2133yuu+22zyF21-2uy2uz+F2x2y23F+u23y12z-Fu33yz21F-3yu+13xuFu311yyz

F1z + - u2x + u3x

u2yF2z + u3yF3z F2z - u3xF3z
F3y + u1xF1y



(10.55)

Case studies on non-linear control theory of the inverted pendulum 251

Movable plate

FZk FZk Hk
Base

in
Fbk bk

ck
Gbk k

Fcink Gck
in
Fdk Gdk
dk

(a)

(b)

Figure 10.19 Details for free body modelling of CaPaMan: (a) a detail of the reaction forces acting on one of the spherical joints; (b) location of the centre of mass and inertial forces

with

 ukx 

 cos k 

uukkyz 

=

rpR

sin k 0

;

(k = 1, 2, 3)

(10.56)

when the values 1 = 0; 2 = 2/3; 3 = 4/3 are considered. Equations (10.55) and (10.56) can be solved in a closed form to obtain an explicit
expression for forces Fky and Fkz. Referring to Figure 10.19 and once the reaction forces in the spherical joints Hk are computed, the torque  Pk (k = 1, 2, 3) on the input crank shaft of each articulated parallelogram can be obtained by considering
only the inertial effects of the movable platform in the form

Pk

=

Fkzbk sin 2k 2 sin k

- Fkybk

ck

hk tan k

+1

1

-

hk

cos

k

hk +

ck

sin

k

sin k

(10.57)

where bk , ck and hk are the geometrical dimensions shown in Figure 10.19; Fky and Fkz are the reaction forces in the spherical joints Hk . The contribution of the legs to the inverse dynamics of the CaPaMan can be determined by including a kinetostatic analysis of the articulated parallelograms. The reaction forces, centres of mass of the links and inertial forces can be identified by using free body diagrams as proposed in the schemes of Figure 10.19. Further details on the dynamic modelling and path planning of CaPaMan can be found in [40].
Simulations have been carried out by using the formulation in (10.12)­(10.14), (10.27), (10.29), (10.36), (10.37) and (10.40) in order to control an inverted pendulum

252 The inverted pendulum in control theory and robotics

Cart initial displacement z1 (m)

Cart displacement ×1 (m)

0.18

0.175

0.17

0.165

0.16

0.155 0
3.5

0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 Time (s)

3

2.5

2

1.5

1

0.5

0

­0.5 0 1 2 3 4 5 6 7 8 9 10 Time (s)
1

0.8

0.6

0.4

0.2

0

­0.2

­0.4 0 1 2 3 4 5 6 7 8 9 10 Time (s)
0.8

0.6

0.4

0.2

0

­0.2

Cart initial velocity along z (m/s)

Pend-1 angular velocity ×4 (rad/s)

Cart velocity ×2 (m/s)

0.05 0.045 0.04 0.035 0.03 0.025 0.02 0.015 0.01 0.005
0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 Time (s)
3.5 3
2.5 2
1.5 1
0.5 0
­0.5 ­1 0 1 2 3 4 5 6 7 8 9 10 Time (s) 1.5
1
0.5
0
­0.5
­1
­1.5
­2
­2.5 0 1 2 3 4 5 6 7 8 9 10 Time (s)
0.5
0
­0.5
­1
­1.5
­2

Pend-1 angle ×3 (rad)

Pend-2 angular velocity ×6 (rad/s)

Pend-2 angle ×5 (rad)

­0.4 0 1 2 3 4 5 6 7 8 9 10
Time (s)

­2.5 0 1 2 3 4 5 6 7 8 9 10
Time (s)

Figure 10.20 Simulation results for a double inverted pendulum mounted on CaPaMan cart with links starting both at  /4

Case studies on non-linear control theory of the inverted pendulum 253

accommodated on the movable plate of CaPaMan. Calculations through (10.41)­

(10.43) have been made to compute the initial position and velocity of the movable

plate. Results of the controlled inverted pendulum and cart system, using the non-

linear optimal control method and the Runge­Kutta integration method, are presented

in

Figure

10.20,

where

pendulum

started

at

initial

positions

x3 =

 4

and

x5 =

 4

.

It shows that the inverted pendulum was able to stabilise fairly quickly.

It is to note that the presence of disturbances due to the initial cart dynamics

can be minimised by statically/dynamically balancing the CaPaMan cart system. The

dynamic balancing can be achieved using several methods such as using

 counter-rotary counter-masses;  separate counter-rotations;  idler loops;  duplicated mechanisms/movements;  counterweights on the movable links;  harmonic balancing by two counter-rotating masses.

A case study as referring to CaPaMan 2bis (Cassino Parallel Manipulator version 2bis) has been carried out in [42]. Given the architecture of CaPaMan, one can use a total of six Counter-Rotary Counterweights and three Counterweights. A constant linear momentum can be obtained if the total centre of mass is stationary. For a proper balancing, one can impose a stationary centre of mass and search for the design parameters that can reduce to zero (or at least minimise) the moments of inertia, shaking forces and shaking moments, as reported in [42].

10.7 Conclusions
In this chapter, we have studied a freezing technique to control non-linear systems globally in general. We have shown two specific examples by using the non-linear optimal control technique: a single inverted pendulum and cart system and a two-link inverted pendulum and cart system. We have demonstrated good control results of the two pendulum systems in simulations. Two case studies further demonstrating the effectiveness of the non-linear control method have also been illustrated in this chapter. The theory presented in this chapter extends to multi-link pendulum control systems and indeed many other non-linear systems, e.g. aeronautical systems [8] or ship systems [17]. Note that we have only considered the control problem in this chapter, but not the state estimation problem. It is assumed that there is an effective state estimator for the optimal feedback control. It is also worth noting that there are other techniques for solving non-linear control problems, for example, a linear, time-varying approximation approach introduced in [18]. Future work will be focused on studying the non-uniqueness problem, and the identification of the uncontrollable subspace and how to avoid it.

254 The inverted pendulum in control theory and robotics
Appendix A Solving and implementing control solutions using MATLAB
Appendix A.1 Non-linear control of a single pendulum and cart system
Script file: single_pendulum_RK.m
clear all; close all;
x1(1)=0; %set initial cart displacement to be 0 (m) x2(1)=0; %set initial cart velocity to be 0 (m/s) x3(1)=pi; %set initial pendulum angle to be pi (rad) x4(1)=0; %set initial pendulum angular velocity to be 0 (rad/s)
h=0.01; %time step length t=800; %set number of iterations
for i=1:t x=[x1(i); x2(i); x3(i); x4(i)]; %define and update the x vector
k1=evalrhs_single(x); xtemp=x+k1*h/2; k2=evalrhs_single(xtemp); xtemp=x+k2*h/2; k3=evalrhs_single(xtemp); xtemp=x+k3*h; k4=evalrhs_single(xtemp); %call the `evalrhs_single' function to obtain k1-k4
x=x+h*(k1+2*k2+2*k3+k4)/6; %calculate the new `x' vector using a 4th order Runge-Kutta %integration method
x1(i+1)=x(1); x2(i+1)=x(2); x3(i+1)=x(3); x4(i+1)=x(4);
%Reset the x1, x2, x3 & x4 variables to new values and get ready %for the next iteration. end

Case studies on non-linear control theory of the inverted pendulum 255
subplot(2,2,1); plot([0:h:(t*h)],x1); grid; xlabel(`Time (sec)'); ylabel(`Cart displacement x1 (m)');
subplot(2,2,2); plot([0:h:(t*h)],x2); grid; xlabel(`Time (sec)'); ylabel(`Cart velocity x2 (m/s)');
subplot(2,2,3); plot([0:h:(t*h)],x3); grid; xlabel(`Time (sec)'); ylabel(`Pendulum angle x3 (rad)');
subplot(2,2,4); plot([0:h:(t*h)],x4); grid; xlabel(`Time (sec)'); ylabel(`Pendulum angular velocity x4 (rad/s)'); %plot x1, x2, x3 & x4 as 4 subplots in one figure window
Function file: evalrhs_single.m
function [fx] = evalrhs_single(x)
m1=2; %Mass of the cart (kg) m2=0.1; %mass of the pendulum (kg) r=0.5; %the rod length (m) g=9.8; %acceleration due to gravity (m^2/s)
x1=x(1); x2=x(2); x3=x(3); x4=x(4); %initialise x1-x4 using the input `x' vector
A=[0, 1, 0, 0; 0, 0,... -m2*g*sin(x3)*cos(x3)/((m1+m2*(sin(x3))^2)*x3),... m2*r*x4*sin(x3)/(m1+m2*(sin(x3)^2)); 0, 0, 0, 1; 0, 0,... (m1+m2)*g*sin(x3)/(r*(m1+m2*(sin(x3))^2)*x3),... -m2*r*x4*sin(x3)*cos(x3)/(r*(m1+m2*(sin(x3))^2))];
B=[0; 1/(m1+m2*(sin(x3))^2); 0; -cos(x3)/(r*(m1+m2*(sin(x3))^2))];

256 The inverted pendulum in control theory and robotics
%define A and B using a non-linear state-space single pendulum %and cart model
Q=[1, 0, 0, 0; 0, 1, 0, 0; 0, 0, 10, 0; 0, 0, 0, 1]; R=0.1; %set Q and R matrices
[K,P,E]=lqr(A,B,Q,R); %use the MATLAB `lqr' function to solve Riccati equation and %work out P
fx=(A-B*inv(R)*B'*P)*x; %calculate the function output `fx' based on values of A, B, P %and x. end
Non-linear control of a double-link pendulum and cart system:
Script file: two_link_pendulum_RK.m
clear all; close all;
x1(1)=0; %set initial cart displacement to be 0 (m) x2(1)=0; %set initial cart velocity to be 0 (m/s) x3(1)=pi/3; %set initial pendulum 1 angle to be pi/3 (rad) x4(1)=0; %set initial pendulum 1 angular velocity to be 0 (rad/s) x5(1)=pi/3; %set initial pendulum 2 angle to be pi/6 (rad) x6(1)=0; %set initial pendulum 2 angular velocity to be 0 (rad/s)
s=0.001; %time step length t=10000; %set number of iterations
for i=1:t x=[x1(i); x2(i); x3(i); x4(i); x5(i); x6(i)]; %define and update the x vector
k1=evalrhs_double(x); xtemp=x+k1*s/2; k2=evalrhs_double(xtemp); xtemp=x+k2*s/2; k3=evalrhs_double(xtemp); xtemp=x+k3*s; k4=evalrhs_double(xtemp); %call the `evalrhs_single' function to obtain k1-k4

Case studies on non-linear control theory of the inverted pendulum 257
x=x+s*(k1+2*k2+2*k3+k4)/6; %calculate the new `x' vector using a 4th order Runge-Kutta %integration method
x1(i+1)=x(1); x2(i+1)=x(2); x3(i+1)=x(3); x4(i+1)=x(4); x5(i+1)=x(5); x6(i+1)=x(6);
%Reset the x1, x2, x3, x4, x5 & x6 variables to new values and %get ready for the next iteration. end
subplot(3,2,1); plot([0:s:(t*s)],x1); grid; xlabel(`Time (sec)'); ylabel(`Cart displacement x1 (m)');
subplot(3,2,2); plot([0:s:(t*s)],x2); grid; xlabel(`Time (sec)'); ylabel(`Cart velocity x2 (m/s)');
subplot(3,2,3); plot([0:s:(t*s)],x3); grid; xlabel(`Time (sec)'); ylabel(`Pend-1 angle x3 (rad)');
subplot(3,2,4); plot([0:s:(t*s)],x4); grid; xlabel(`Time (sec)'); ylabel(`Pend-1 angular velocity x4 (rad/s)');
subplot(3,2,5); plot([0:s:(t*s)],x5); grid; xlabel(`Time (sec)'); ylabel(`Pend-2 angle x5 (rad)');
subplot(3,2,6); plot([0:s:(t*s)],x6); grid; xlabel(`Time (sec)'); ylabel(`Pend-2 angular velocity x6 (rad/s)'); %plot x1, x2, x3, x4, x5 & x6 as 6 subplots in one figure window
Function file: evalrhs_double.m
function [fx] = evalrhs_double( x )
m1=2; %Mass of the cart (kg) m2=0.1; %mass of the pendulum 1 (kg)

258 The inverted pendulum in control theory and robotics
m3=0.1; %mass of the pendulum 2 (kg) r1=0.1; %length of rod 1 (m) r2=0.1; %length of rod 2 (m) g=9.8; %acceleration due to gravity (m^2/s)
x1=x(1); x2=x(2); x3=x(3); x4=x(4); x5=x(5); x6=x(6);
%initialise x1-x6 using the input `x' vector
a=m2+m3; b=cos(x3)*cos(x5); c=sin(x3-x5); d=m2*a*(sin(x3))^2 + m1*m3*c^2 +m1*m2; e=2*m2^2+m1*m3+2*m2*m3+2*m1*m2+m1*m3*cos(2*x5); f=m2*a*sin(2*x3)-m1*m3*sin(2*x5-2*x3); h=m2*m3*sin(x3)*cos(x5)+ m1*m3*c;
%define a-h to reduce the coding complexity of A and B matrices
A=[0, 1, 0, 0, 0, 0; 0, 0,... m2*a*g*sin(x3)*cos(x3)/(-x3*d),... m2*a*r1*x4*sin(x3)/d, 0, ... m2*m3*r2*x6*(sin(x5-2*x3)-sin(x5))/(-2*d); 0, 0, 0, 1, 0, 0; 0, 0,... g*sin(x3)*e/(2*r1*d*x3), x4*f/(-2*d), ... m1*m3*g*sin(x5)*b/(-r1*d*x5), ... r2*x6*h/(-r1*d); 0, 0, 0, 0, 0, 1; 0, 0,... m1*a*g*sin(x3)*b/(-r2*d*x3), ... m1*a*r1*c*x4/(r2*d), ... m1*a*g*(cos(x3))^2*sin(x5)/(r2*d*x5), ... m1*m3*sin(2*x5-2*x3)*x6/(-2*d)];
B=[0; (m2+m3*c^2)/d; 0; (m2*cos(x3)-m3*sin(x5)*c)/(-r1*d); 0; a*sin(x3)*c/(-r2*d)];

Case studies on non-linear control theory of the inverted pendulum 259
%define A and B using a non-linear state-space 2-link pendulum %and cart model
Q=[1, 0, 0, 0, 0, 0; 0, 1, 0, 0, 0, 0; 0, 0, 1, 0, 0, 0; ... 0, 0, 0, 1, 0, 0; 0, 0, 0, 0, 1, 0; 0, 0, 0, 0, 0, 1];
R=1; %set Q and R matrices
[K,P,E]=lqr(A,B,Q,R); %use the MATLAB `lqr' function to solve Riccati equation and %work out P
fx=(A-B*inv(R)*B'*P)*x; %calculate the function output `fx' based on values of A, B, P %and x.
end
Acknowledgement
The first author Xu Xu would like to thank emeritus professor Stephen Paul Banks for the discussions and clarifications he generously provided regarding the optimal non-linear control technique presented in this chapter.
References
[1] Dutton, K., Thompson, S., & Barraclough, B. The art of control engineering. Harlow, England: Pearson Education Limited; 1997 Jun 1.
[2] d'Azzo, J. J., & Houpis, C. D. Linear control system analysis and design: conventional and modern. New York City, USA: McGraw-Hill Higher Education; 1995 Jan 1.
[3] Ogata, K., & Yang, Y. Modern control engineering. 1970. [4] Schaefer, J. F., & Cannon, R. H. `On the control of unstable mechanical sys-
tems'. In Automatic and Remote Control III: Proceedings of the Third Congress of the International Federation of Automatic Control, Paper C, 1966 June, Vol. 6, p. 1966. [5] Mazenc, F., & Praly, L. `Adding integrations, saturated controls, and stabilization for feedforward systems'. IEEE Transactions on Automatic Control. 1996; 41(11):1559­78. [6] Zhao, J. & Spong, M.W. `Hybrid control for global stabilization of the cart­ pendulum system'. Automatica, 2001, 37(12), pp. 1941­1951. [7] Boubaker, O. `The inverted pendulum benchmark in nonlinear control theory: a survey'. International Journal of Advanced Robotic Systems. 2013; 10(5):233.

260 The inverted pendulum in control theory and robotics
[8] Banks, S. P., & Mhana, K. J. `Optimal control and stabilization for nonlinear systems'. IMA Journal of Mathematical Control and Information. 1992; 9(Jan (2)):179­96.
[9] McCaffrey, D., & Banks, S. P. `Lagrangian manifolds and asymptotically optimal stabilizing feedback control'. Systems & Control Letters. 2001; 43(Jul (3)):219­24.
[10] Mracek, C. P., & Cloutier, J. R. `Control designs for the nonlinear benchmark problem via the state-dependent Riccati equation method'. International Journal of Robust and Nonlinear Control. 1998;8(Apr (4­5)):401­33.
[11] Halmos, P. R. Measure theory. New York, NY, USA: Springer-Verlag; 2013 Dec 19.
[12] Lanczos, C. The Variational Principles of Mechanics, 4th ed. NewYork: Dover, pp. 53 and 61, 1986.
[13] Goldstein, H. Classical mechanics, 2nd ed. Reading, MA: Addison-Wesley, p. 44, 1980.
[14] Hand, L. N., & Finch, J. D. Analytical mechanics, 2nd ed. Cambridge, UK: Cambridge University Press, p. 23, 2008.
[15] Perko, L. Differential equations and dynamical systems. New York, NY, USA: Springer-Verlag; 2013 Nov 21.
[16] Harrison, R. F. `Asymptotically optimal stabilising quadratic control of an inverted pendulum'. IEE Proceedings-Control Theory and Applications. 2003; 150(1):7­16.
[17] ÇImen, T., & Banks, S. P. `Nonlinear optimal tracking control with application to super-tankers for autopilot design'. Automatica. 2004; 40(11):1845­63
[18] Tomás-Rodriguez, M., & Banks, S. P. Linear, time-varying approximations to nonlinear dynamical systems: with applications in control and optimization. New York, NY, USA: Springer-Verlag; 2010 Feb 4.
[19] Bröckelt, R., & Li, H. `A light weight rotary double pendulum: maximizing the domain of attraction'. In Proceedings of the IEEE Conference on Decision and Control, 2003, Vol. 4, pp. 3299­304.
[20] Solis, J., & Takanishi, A. `Development of a wheeled inverted pendulum robot and a pilot experiment with master students'. In Mechatronics and Its Applications (ISMA). 2010 7th International Symposium on, 1­6.
[21] Turner, M., & Cooley, T. R. `A low-cost and flexible open-source inverted pendulum for feedback control laboratory courses'. In 2015 American Society for Engineering Education Annual Conference and Exposition, Seattle, Washington, pp. 26.63.1­13.
[22] Gramescu, B. S., Ni¸tu, C. I., Phuc, N., & Borzea, C. `PID control for two-wheeled inverted pendulum (WIP) system'. Romanian Review Precision Mechanics, Optics and Mechatronics. 2015; (48):246­51.
[23] Reck, R., & Sreenivas, R. `Developing an affordable and portable control systems laboratory kit with a Raspberry Pi'. Electronics. 2016; 5(3):36.
[24] Kang, M. T., Vo, H. D., Kim, H. K., & Kim, S. B. `Control system design for a mobile inverted pendulum via sliding mode technique'. In Mechatronics, ICM2007 4th IEEE International Conference on, 2007, pp. 1­6.

Case studies on non-linear control theory of the inverted pendulum 261
[25] Kapitonov, A. A., Bobtsov, A. A., Kapitanyuk, Y. A. et al. `Course of lab activities on control theory based on the LEGO NXT'. IFAC Proceedings Volumes. 2014; 47(3):9063­8.
[26] Canale, M., & Casale-Brunet, S. `A multidisciplinary approach for Model Predictive Control Education: a LEGO Mindstorms NXT-based framework'. International Journal of Control, Automation and Systems. 2014; 12(5): 1030­9.
[27] Mathew, S. T. & Mija, S. J. `Design of H2 controller for stabilization of two-wheeled inverted pendulum'. In International Conference on Advanced Communication Control and Computing Technologies (ICACCCT), 2014, pp. 174­9.
[28] Quanser. `Linear Servo Base Unit with Inverted Pendulum'. Viewed September 2016, http://www.quanser.com/products/linear_servo_IP02.
[29] Quanser. `Rotary Inverted Pendulum'. Viewed September 2016, http://www. quanser.com/products/rotary_pendulum.
[30] Feedback Instruments Ltd. `Digital Pendulum 33-005-PCI'. Viewed September 2016 http://www.feedback-instruments.com/products/education/control_ instrumentation/digital_pendulum.
[31] LEGO. `LEGO Mindstorms EV3 Support'. Viewed September 2016. https:// www.lego.com/en-gb/mindstorms/support.
[32] STARBLUE. `LEGO Answers Online'. Last updated 2012 November. http: / / bricks . stackexchange . com / questions / 679 / is-there-any-other-way-toprogram-the-lego-mindstorms-nxt-other-than-the-provide.
[33] Masakatsukawata. `Inverted Pendulum on a Cart (LEGO MINDSTORMS EV3)'. 2014. Available at: https://www.youtube.com/watch?v=vQ607X6Rid4 (accessed: 10/11/2016).
[34] Masakatsukawata. `Rotary Inverted Pendulum (LEGO MINDSTORMS EV3)'. 2014. Available at: https://www.youtube.com/watch?v=xrPAGlFUDlQ (accessed: 10/11/2016).
[35] Kawada, M. `Development of control engineering educational contents using LEGO MINDSTORMS and Simulink Support Package'. In Proceedings of Automatic Control Allied Lecture Papers, 2014, Vol. 57, pp. 598­605.
[36] Masakatsu, M. `Development of rotary inverted pendulum using LEGO MINDSTORMS'. Measurement and control. 2015; 54(3):192­5.
[37] Ceccarelli, M. Fundamentals of mechanics of robotic manipulation. Springer, Dordrecht; 2004.
[38] Carbone, G., & Ceccarelli, M. `A serial-parallel robotic architecture for surgical tasks'. Robotica: An International Journal. 2005; 23:345­54.
[39] Selvi, Ö., & Ceccarelli, M. `Interpretation of earthquake effects on mechanism operation: an experimental approach'. Journal of Naval Science and Engineering. 2012; 8(2):31­45.
[40] Carbone, G., Ceccarelli, M., Oliveira, P. J., Saramago, S. F. P., & Carvalho, J. C. M. `An optimum path planning of CaPaMan (Cassino Parallel Manipulator) by using inverse dynamics'. Robotica: An International Journal. 2008; 26(2):229­39.

262 The inverted pendulum in control theory and robotics
[41] LARM Webpage. Last accessed on November 2016. http://webuser. unicas.it/weblarm/larmindex.htm.
[42] Cafolla, D., Carbone, G., & Ceccarelli, M. `Chapter 8 in dynamic balancing of mechanisms and synthesizing of parallel robots'. Balancing of a 3-DOFs Parallel Manipulator. Springer, Dordrecht; 2015, pp. 173­91. (DOI) 10.1007/978-3-319-17683-3_8.

Chapter 11
Bipedal-double-pendulum walking robot control using recurrent hybrid neural network
S¸ahin Yildirim1
Abstract
This chapter presents neural control scheme of a planar-like double-pendulum-bipedal robot. For simplicity, only a five-link planar system is considered. The system effectively acts as two dynamically interacting planar robot arms. The scheme employs a single neural controller for the whole biped. Recurrent networks have feedback connections and thus an inherent memory for dynamics which makes them suitable for dynamic system modeling. A feature of the networks adopted is their hybrid hidden layer which includes both linear and nonlinear neurons. The standard proportional derivative (PD) controller is also employed for comparison. The results presented show the superior ability of the proposed neural control scheme at adapting to changes in the dynamics parameters of the bipedal robot.
11.1 Introduction
A bipedal-like double-pendulum robot can be seen as an extension of a twin-arm Selectively Compliant Assembly Robot Arm (SCARA) system if the third dimension is ignored. The main problem with a bipedal robot, however, is that of balance control to prevent the robot from falling over and enable it to walk.
Several researchers have proposed dynamic balance control systems for bipedal robots. A five-degree-of-freedom biped model moving in the sagittal plane has been investigated [1]. Three criteria have been introduced to evaluate the walk`stability', `maximum speed', and `energy consumption'. In their investigation, relations between these three criteria and the parameters (gait, speed, period, stride, length of the leg, joint angles, etc.) are formulated accordingly to dynamics of robot [2]. A systematic formulation was provided that yields itself to an increase in dimensionality of the model, nonlinear studies and simulation and analysis of single and double support. The dynamics of a three dimensional model of the human body has been derived by Huston and Passerello [3]. Their model was subjected to several specific motions and the ground reaction force and its distance from the center of gravity
1Mechatronic Engineering Department, University of Erciyes, Turkey

264 The inverted pendulum in control theory and robotics
of the body are calculated. State feedback laws have been suggested [3], since they are a natural control method for multivariable systems. Control methods using inverted pendulum type models to generate simple control laws have also been proposed [4]. A method of deriving the linear Quadratic Regulator for an n-legged robot that could be adapted for bipeds has been presented by Channon et al. [5].
A speed control problem of heavy duty vehicle trough angular position of throttle valve is researched by Yadav et al. [6]. Modified internal model control with fuzzy supervisor is used to control the speed of heavy duty vehicle. The time domain performance values were taken into consideration for performance analysis of the heavy duty vehicle for different uncertains.
An intelligent evolutionary least learning machine tool investigated to forecast the vehicle speed sequence [7]. Mozaffari et al. were used the driving data collected on the San Francisco urban roads by a private Honda insight vehicle. As results, proposed method by Mozaffari et al. was a powerful tool for predicting the vehicle speeds. Tagne et al. [8] researched to lateral displacement control of autonomous vehicle with respect to a given reference path. The proposed control law was validated a driving simulation engine according to several real driving scenarios. Simulations were also performed using experimental data acquired by a Peugeot 308.
Alam et al. [9] investigated the problem of finding a safety criterion between neighboring heavy duty vehicle platooning and real-life experimental results were presented in an attempt to validate the theoretical results in practice. Adaptive intelligent cruise control of heavy duty vehicle was investigated by Alam et al. [10]. In their study, a linear quadratic control framework used for the controller design. The proposed controller performance was evaluated through numerical and experimental studies. The experimental and simulation results showed that heavy duty vehicle platooning could be conducted at close spacing with standardized sensors and control units. Rödönyi et al. [11] researched novel numerical methods for analyzing robust peak-to-peak performance of heterogeneous platoons. The proposed method was indicated on three platoon controllers. A new speed controller for internal combustion engine designed by Tibola et al. [12]. The proposed controller was used for two approaches for the internal combustion engine speed control. The stability analysis for the developed controller was presented.
In this chapter, a neural control approach is used to control hip, foot trajectory and stability of a bipedal robot. The neural network scheme is employed a single neural controller for the whole bipedal robot.
11.2 Bipedal-like double-pendulum robot
Figures 11.1 and 11.2 illustrate a five-link planar bipedal robot. As can be seen from the figures, the torso has mass mt and inertia Jt measured about its center of mass which is located at distance lt above the hip joints.
The upper and lower leg elements are identical, with length 2le, mass me and inertia Je measured about their centers of mass. The feet have mass mf located at the ankle joint and are assumed to have negligible inertia. With both feet on the ground, the robot acts almost like the closed-loop linkage of two cooperating planar

Bipedal-double-pendulum walking robot control 265
 lt
2le 2 1
2le 2 1

Figure 11.1 A five-link planar bipedal robot

mt, Jt 2
1 me, Je 3

me, Je 4

me, Je
5 mf

me, Je mf

Figure 11.2 Schematic configuration of the bipedal robot

266 The inverted pendulum in control theory and robotics
SCARA robots. However, the goal of this chapter is to propose a control law for the walking is the control of the walking movements of the robot where only one foot remains on the ground.

11.2.1 Walking
Walking commences at time t = 0 with one foot, called the swing foot, leaving the ground as depicted in Figure 11.3(a). Then, over a period T , the swing foot moves forward a distance 2L and the hip a distance L. Walking ends at time t = T -, the instant just prior to the swing foot making contact with the ground. Throughout this period, the other foot, called the stance foot, remains fixed on the ground, thus providing a single support for the biped.
At a given instant during the single-support phase, the position of the bipedal robot relative to the stance foot can be specified by the following coordinate vector :

= [ 1 2 1 2]T

(11.1)

where  represents the angle of the torso with respect to the vertical, 1 and 2 are the angles of the upper leg elements relative to the vertical and 1 and 2 are the angles of the lower leg elements relative to the vertical, as shown in Figure 11.1.
Motors located at the robot's hip, knees and stance foot generate torques 1 to 5 as shown in Figure 11.2. These can be grouped into vector  where

 = [1 2 3 4 5]

(11.2)

Note that the torque arising from the swing foot ankle joint motor must be zero due
to the assumption of negligible foot inertia. Hence, it is not included in (11.2). The joint accelerations ¨ arising from the application of torques  can be derived
from the following [13]:

M( ) ¨ + V( ,  ) + G( ) = C1F1 + C2F2 + D

(11.3)

where M( ) is the mass matrix, V( ,  ) is a vector containing centripetal and Coriolis terms, G( ) is a vector of torques arising from gravitational loading, F1 and F2 are the foot forces, C1 and C2 are the foot force transformation matrices and D is the joint transformation matrix. General equation of biped motion is described in Appendix.

11.2.2 Impact
The second stage of a step results in the swing foot hitting the ground and the stance foot breaking contact with the ground. This stage, termed impact, is assumed to be instantaneous, commencing at time t = T - and finishing at some infinitesimally short time later t = T + (Figure 11.3(b)). Consequently, the position of the biped will not appreciably change during impact.

Bipedal-double-pendulum walking robot control 267

t=0

t = T­

Swing foot

L Stance foot

2L
Figure 11.3(a) Walking with swing foot while stance foot provides support
t = T+

Stance foot
2L
Figure 11.3(b) Impact of swing foot with the ground
11.3 Proposed neural network
Neural network can be represented in a general diagrammatic form as illustrated in Figure 11.4. This diagram depicts the hybrid hidden layer as comprising a linear part and a nonlinear part and shows that, in addition to the usual feedforward connections, the networks also have feedback connections from the output layer to the hidden layer and self-feedback connections in the hidden layer [14].

268 The inverted pendulum in control theory and robotics

Input layer
(t)

Hidden layer 
. .

Output layer




(t)

e(t)

.

.



: Feedback : Self-feedback : Nonlinear neuron

: Feedforward : Linear neuron

Figure 11.4 Neural network controller

At a given discrete time t, let (t) be the input to a recurrent hybrid network,  (t) the output of the network, x1(t) the output of the linear part of the hidden layer and x2(t) the output of the nonlinear part of the hidden layer.
The operation of the proposed network is summarized by the following equations:

x1(t + 1) = WI1 (t + 1) + x1(t) + J1 (t)

(11.4)

x2(t + 1) = F{ WI2 (t + 1) + x2(t) + J2 (t)}

(11.5)

 (t + 1) = WH1x1(t + 1) + WH2x2(t + 1)

(11.6)

where WI1 is the matrix of weights of connections between the input layer and the linear hidden layer, WI2 is the matrix of weights of connections between the input layer and the nonlinear hidden layer, WH1 is the matrix of weights of connections between the linear hidden layer and the output layer, WH2 is the matrix of weights of connections
between the nonlinear hidden layer and the output layer, F{} is the activation function of neurons in the nonlinear hidden layer and  and  are the weights of the selffeedback and output feedback connections. J1 and J2 are respectively nH1 × nO and nH2 × nO matrices with all elements equal to 1, where nH1 and nH2 are the numbers of linear and nonlinear hidden neurons and nO is the number of output neurons.

Bipedal-double-pendulum walking robot control 269

If only linear activation is adopted for the hidden neurons, the above equations simplify to:

 (t + 1) = WH1x(t + 1)

(11.7)

x(t + 1) = WI1 (t + 1) + x(t) + J1 (t) Replacing  (t + 1) by WH1 x(t + 1) in (11.8) gives

(11.8)

x(t + 1) = (I + J1WH1)x(t) + WI1 (t + 1)

(11.9)

where I is a nH1 × nH1 identity matrix. Equation (11.9) is of the form

x(t + 1) = Ax(t) + B (t + 1)

(11.10)

where A = I + JWH1 and B =WI1. Equation (11.10) represents the state equation of a linear system of which x is the state vector. The elements of A and B can be adjusted through training so that any arbitrary linear system of order nH1 can be modeled by the given network. When nonlinear neurons are adopted, this gives the network the ability to perform nonlinear dynamics mapping and thus model nonlinear dynamic systems. The existence in the recurrent hybrid network of a hidden layer with both linear and nonlinear neurons facilitates the modeling of practical nonlinear systems comprising linear and nonlinear parts. The inverse dynamics equation of the robot includes both linear terms and nonlinear terms. Thus, in theory, the inverse dynamics model of the robot and therefore an inverse model controller for it can be implemented using the proposed recurrent hybrid neural network structure.
In this work, the values of the weights of the recurrent connections,  and , were fixed. This means only the weights of the feedforward connections, WI and WH, needed to be adjusted and thus, it was possible to employ the standard backpropagation algorithm to train the neural network.

11.4 Control system

Figure 11.5 shows the control system adopted [14]. The system comprises a PD controller and a Neural Network (NN) controller, which is a recurrent hybrid network used to model the inverse dynamics of the biped. A trajectory generator (not shown) produces the required sequence of rotations for each joint to yield the desired walking movements of the biped. The NN is trained online during control to give the system the ability to adapt to change. Relative positions of the robot joint angles are used as reference signals to the controller:

= [1 2 3 4 5]T

(11.11)

1 = 1 -  , 2 = 2 -  , 3 = 1 - 1, 4 = 2 - 2, 5 = 1 - 1 (11.12)

270 The inverted pendulum in control theory and robotics



N



a

Neural

Biped

controller +

+

P

PD e

+

­

Figure 11.5 Bipedal robot control system 1

From Figure 11.5, the vector of input torques to the bipedal robot is given by

 = N + P

(11.13)

where

 N = f ( , e)

(11.14)

 P = KPe + KDe

(11.15)

 N is the output of the NN controller (Figure 11.4), which is seen as performing a nonlinear mapping f on the set point and the control error e.  P is the output of the
PD controller. KP and KD are the gains of the controller. In this work, the following empirically determined values were adopted for KP and KD: KP = diag [4000 4000 4000 4000 4000] and KD = diag [20 20 20 20 20].

11.4.1 Neural network controller

The NN controllers for biped control system 1 had three layers, as shown in

Figure 11.4. The first layer received reference inputs from the trajectory genera-

tor and also the control errors. Again, the second layer consisted of two parts, a linear

part and a nonlinear part. Finally, the third layer of the network produced outputs to

drive the robot joints.

The controller was trained by backpropagating the error e through the biped in a

way similar to that shown in Figure 11.5, with a minor modification as shown below.

Let Ek be the joint angle error for joint k. Using the chain rule, it follows that the gradient of Ek in weight space is

Ek = Ek  ak  k  Nk wij  ak  k  Nk wij

(11.16)

Bipedal-double-pendulum walking robot control 271 Table 11.1 Parameters of the bipedal robot

Kinematics parameters Mass parameters Inertia parameters

lt = 0.25 m, le = 0.175 m mt = 20­200 kg, me = 5 kg, mf = 2 kg It = 1 kg m2, Ie = 0.05 kg m2

Table 11.2 Structural and training parameters

NN









n

N

AF

RHN

0.0001

0.01

0.8

0.8

12 + 12

35,000

HT

In (11.16),

 Nk  wij

can be readily obtained through the Back Propogation (BP) algorithm

 but

ak is difficult to determine exactly because the robot dynamics are unknown.

k

To overcome this problem,

 ak k

is computed as follows:

ak

=

 ak k

k +

m

 ak  Fm

Fm

ak

=

 ak k

k +

m

 ak  k  k Fm

Fm

ak

=

 ak k

k

+

 ak k

m

k  Fm

Fm

 ak = k

1

k +

 k Fm

ak

m Fm

ak

(11.17a) (11.17b) (11.17c) (11.17d)

11.5 Results
The control system 1 architecture illustrated in Figure 11.5 was implemented on a Pentium 200-MHz personal computer using the MATLAB® software [15]. The kinematic and inertia parameter values used for the bipedal robot are given in Table 11.1. The structural and training parameters adopted for the neural controller are given in Table 11.2.

Y [m]

272 The inverted pendulum in control theory and robotics
NNC: ..... Actual ___ Desired 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1
0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 X [m] NNC: ..... Actual ___ Desired
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 X [m]
Figure 11.6 Foot and hip trajectories of the biped using control system 1 (mt = 200 kg)
The simulation results are presented below. They illustrate the effects of different torso masses, stances and step lengths on the performance of the control system 1.
Using the control system of Figure 11.5, the biped was trained for 35,000 iterations to carry a torso mass of 20 kg to 1,000 points randomly located in the vertical

Y [m]

Y [m]

Bipedal-double-pendulum walking robot control 273
PDC: ..... Actual ___ Desired 0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 X [m]
PDC: ..... Actual ___ Desired 0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 X [m]
Figure 11.7 Foot and hip trajectories of the biped using PD controller (mt = 200 kg)
(X ­Y ) plane. Following training, the biped was prescribed regular foot and hip trajectories. After just one attempt, it was able to trace the desired trajectories with only very small errors.
The biped was then made to carry a torso mass of 200 kg. The foot and hip trajectories of the biped on the second attempt, after the torso mass had increased to

Y [m]

Y [m]

274 The inverted pendulum in control theory and robotics
NNC: ..... Actual ___ Desired 0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 X [m]
NNC: ..... Actual ___ Desired 0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 X [m]
Figure 11.8 Foot and hip trajectories of the biped using control system 1 for a different stance (mt = 200 kg)
200 kg, are shown in Figure 11.6. For comparison, foot and hip trajectories obtained using the PD controller alone are depicted in Figure 11.7 for the cases with the increased torso mass.
The biped was next tested on different stances. The result with the increased torso mass is shown in Figure 11.8. For comparison, the performance of the PD controller is illustrated in Figure 11.9.

Y [m]

Y [m]

Bipedal-double-pendulum walking robot control 275
PDC: ..... Actual ___ Desired 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1
0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 X [m] PDC: ..... Actual ___ Desired
0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1
0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 X [m]
Figure 11.9 Foot and hip trajectories of the biped using PD controller for a different stance (mt = 200 kg)
Tables 11.3­11.5 summarize all the results obtained for the different controllers by giving the root mean square errors (RMSEs) in each case.
It can be noted from the figures and tables presented that of the proposed neural control system performed better than the PD controller alone.

Y [m]

276 The inverted pendulum in control theory and robotics Table 11.3 RMSEs for various step lengths

Step length (m)
0.62 0.57 0.51 0.43

PD controller (RMSE)
0.2067 0.2421 0.1787 0.2982

Biped control system 1 (RMSE)
0.0643 0.0731 0.0481 0.0792

Table 11.4 RMSEs errors for various stances

Stance H (m)
0.65 0.61 0.58 0.55

PD controller (RMSE)
0.2173 0.2362 0.2376 0.2409

Biped control system 1 (RMSE)
0.0621 0.0639 0.0648 0.0656

Table 11.5 RMSEs errors for different torso masses

mt (kg)
20 40 60 100 200

PD controller (RMSE)
0.2638 0.4011 0.5821 35.8588 63.0643

Biped control system 1 (RMSE)
0.0711 0.1281 0.1804 3.2285 6.8149

11.6 Conclusion
This paper has described the neural control systems for a whole bipedal robot. The main contribution of the paper consists in the solution of biped stability by means of neural network controllers. The system controls all of the robot joints simultaneously. Simulations have shown that proposed controllers are better than simple standard PD controllers at rejecting large load disturbances and accommodating different step lengths and walking stances.

Appendix A

Bipedal-double-pendulum walking robot control 277

Defining foot force vectors F1 and F2 which contain foot force components for foot 1 and 2, respectively:

F1 =

Rx1 Ry1

(A.1)

F2 =

Rx2 Ry2

(A.2)

where Rx1 and Ry1 are the horizontal and vertical components of the force acting on foot 1; Rx2 and Ry2 are similar components for foot 2.
The position and orientation of the biped in space may be completely specified by the general coordinate vector:

= [x y  1 2 1 2]

(A.3)

This vector consists of the joint coordinates with the addition of x and y, which are the Cartesian coordinates of the hip relative to some fixed frame of reference. The equations of motion corresponding to this general coordinate system may be derived using the method of Lagrange [6], thus yielding:

M( ) ¨ + V( ,  ) + G( ) = C1F1 + C2F2 + D

(A.4)

where the mass matrix M( ), the centrifugal and Coriolis component vector V( ,  ), the gravity vector G( ), the foot force matrices C1 and C2 and the torque matrix D are given by



k1

0 -k2C k3C1

M(

) = -kkk334kCCC20C112

k1 -k2 S  k3 S 1 k3 S 2 k4 S 1

-k2 S  k5 0 0 0

k3 S 1 0 k6 0
k8C(1 - 1)

k3 C 2 k3 S 2
0 0 k6 0



k4 C 1

k2 C 2

k4 S 1 0
k8C(1 - 1) 0 k7

k8

k4 S 2 0 0
C(2 - 0

2)



k4C2 k4S2

0

0

k8C(2 - 2)

0

k7

(A.5)

 k2S  2 - k3(S1 12 + S2 22) - k4(S112 + S222) 

V(

,

)

=

-k2 C  

2

-

k3(C1 12 + C2 22) - k4(C112
0 k8S(1 - 1)12 k8S(2 - 2)22 -k8S(1 - 1) 12

+

C  2 22 )

(A.6)

-k8S(2 - 2) 22

278 The inverted pendulum in control theory and robotics





0

G(

) = -kkk333kkggg21gSSSgS121 

k3 gS 2





00000

D = -00011

0 -1 0 1 0

0 0 -1 0 1

0 0 0 -1 0

0 0 0 0 -1



00010

(A.7) (A.8)

 1
C1 = 22lleeCC000 11 0



0

1 0 2le S 1 0 2le S 1



0

 1
C2 = 2leC0000 2 2le C 2



0

1 0 0 2le S 2 0



2le S 2

(A.9) (A.10)

where C and S represent the cosine and sine functions, respectively, and

Bipedal-double-pendulum walking robot control 279

k1 = mt + 4me + 2mf k2 = mtlt k3 = 3mele + 2mf le k4 = mele + 2mf le k5 = Jt + mtlt2 k6 = Je + 5mele2 + 4mf le2 k7 = Je + mele2 + 4mf le2 k8 = 2mele2 + 4mf le2

(A.11a) (A.11b) (A.11c) (A.11d) (A.11e) (A.11f ) (A.11g) (A.11h)

References
[1] Hemami H., Farnsworth R.L. `Postural and gait stability of a planar five link biped by simulation', IEEE Trans. Autom. Control. 1977; 22: 452­458.
[2] Kimua H., Shimoyama I., Miura H. `Criteria for dynamic walk of the quadruped', Proceedings of Int. Symposium and Exposition on Robots; Sydney, Australia, 1988. pp. 595­600.
[3] Huston R.L., Passerella C.E. `On the dynamics of human body model', J. Biomech. 1971; 4: 369­379.
[4] Goddard R.E., Hemami H., Weimer F.C. `Biped side step in the frontal plane', IEEE Trans. Autom. Control. 1983; 28: 179­186.
[5] Channon P.H., Hopkins S.H., Pham D.T. `Optimal control of an n-legged robot', IMechE. 1996; 210: 51­63.
[6] Yadav A.K., Gaur P. `Intelligent modified internal model control for speed control of nonlinear uncertain heavy duty vehicles', ISA Trans. 2015; 56: 288­298.
[7] Mozaffari L., Mozaffari A., Azad N.L. `Vehicle speed prediction via a slidingwindow time series analysis and an evolutionary least learning machine: A case study on San Francisco urban roads', Eng. Sci. Technol. Int. J. 2015; 18(2): 150­162.
[8] Tagne G., Talj R., Charara, A. `Design and validation of a robust immersion and invariance controller for the lateral dynamics of intelligent vehicles', Control Eng. Pract. 2015; 40: 81­92.
[9] Alam A., Gattami A., Johansson K.H. Tomlin C.J. `Guaranteeing safety for heavy duty vehicle platooning: Safe set computations and experimental evaluations', Control Eng. Pract. 2014; 24: 33­41.

280 The inverted pendulum in control theory and robotics
[10] Alam A., Martensson J., Johansson K.H. `Experimental evaluation of decentralized cooperative cruise control for heavy-duty vehicle platooning', Control Eng. Pract. 2015; 38: 11­25.
[11] Rödönyi G., Gaspar P., Bokor J., Palkovics L. `Experimental verification of robustness in a semi-autonomous heavy vehicle platoon', Control Eng. Pract. 2014; 28: 13­25.
[12] Tibola J.R., Lanzanova T.D.M., Martins M.E.S., Gründling H.A., Pinheiro H. `Modeling and speed control design of an ethanol engine for variable speed gensets', Control Eng. Pract. 2015; 35: 54­66.
[13] Craig J.J. Introduction to Robotics: Mechanics and Control. Reading, MA; Addison-Wesley, 1989.
[14] Pham D.T., Yildirim S¸ . `Control of the trajectory of a planar robot using recurrent hybrid networks', Int. J. Mach. Tools Manuf.: Des., Res. Appl. 1999; 39: 415­429.
[15] Matlab Release 2014, Simulink Toolbox, Mathworks Inc. Ltd., 2014.

Part IV
Robust controllers-based observers via Takagi­Sugeno or linear approaches

Chapter 12
A survey on the polytopic Takagi­Sugeno approach: application to the inverted pendulum
Souad Bezzaoucha1, Holger Voos1, and Mohamed Darouach2
Abstract
This chapter gives a general scope, states the main results obtained and methods used for the polytopic Takagi­Sugeno approach with a detailed application to the inverted pendulum. Modeling, observer and controller design will be considered.
12.1 Introduction
The modeling of complex dynamic systems such as in biochemical processes or mobile robotic applications often results in nonlinear models. In order to enhance their performance, this nonlinear behavior has to be taken into account in the control and/or observer design. The complexity of the resulting models to be dealt with then also requires the use of heavy mathematical tools.
In order to cope with the complexity introduced by various kind of nonlinearities (nonlinear behavior, time-varying parameters, saturation, hysteresis, sin and cos functions, ...) and since a considerable amount of results have been established in the linear systems framework, the idea behind the so-called Takagi­Sugeno (T­S) polytopic model is to extend these existing results for nonlinear models.
However, the direct transition from linear models to the nonlinear one remains delicate. Hence, new modeling techniques have been proposed in order to make "easier" and "elegant" this transition [1]. In fact, the polytopic T­S or multiple models (MMs) decomposition provides an alternative and attractive path to deal with complex nonlinear systems and to obtain an equivalent representation by bounding the parameters and using the well-known sector-nonlinearity transformation (SNT). This
1Interdisciplinary Centre for Security, Reliability and Trust (SnT), Automatic Control Research Group, University of Luxembourg, Luxembourg 2Research Center for Automatic Control of Nancy (CRAN), Université de Lorraine, France

284 The inverted pendulum in control theory and robotics

u B1 B2 Bn

µ1  A1
µ2
 A2
µn
 An

µ1

x

C1



µ2

C2



µn

y

Cn



Figure 12.1 Coupled T­S models

u B1

x1 C1

µ1 y1


A1 B2

x2 C2

µ2 y2


A2

µn

xn

yn

y

Bn

Cn



An

Figure 12.2 Decoupled T­S models

structure offers an efficient representation of nonlinear behaviors while remaining relatively simple compared to general nonlinear models.
The strength of these techniques consists in the fact that the properties of the nonlinear systems are expressed by a collection of linear subsystems, i.e., in a polytopic paradigm, where the overall model of the system is obtained by merging the local subsystems through a time-varying blending called weighting functions. Thanks to the convexity of the weighting functions and to the linearity of the subsystems defining the vertices, some results can be established for nonlinear systems [2­5] using tools borrowed from the linear theory [6,7].
As pointed in [1,8], different MMs can be obtained using different aggregation structures of the submodels. Basically, two major structures can be distinguished. As explained in the following table and illustrated by Figures 12.1 and 12.2, in the first structure, the submodels share the same state vector (the so-called polytopic T­S model); in the second one, known as decoupled MM, the submodels are decoupled, and their state vectors are different.

A survey on the polytopic Takagi­Sugeno approach 285

Coupled T­S models

Decoupled T­S models

The global state vector x is common
to all submodels  x(t) = n i( (t))(Aix(t) + Biu(t))
i=1
y(t) = n i( (t))Cix(t)
i=1

Each submodel has its own

independant state vector xi

yxii

(t) (t)

= =

Aixi(t) + Ci xi (t )

Bi u(t )

y(t) = n i( (t))yi(t)

i=1

In the following, only the coupled class will be addressed since its model may be obtained in a systematic way from the analytic expression of the nonlinear model without any loss of information by the SNT (presented in the next section). The decoupled representation is more interesting for the identification where the different dimension of the submodels may avoid an extra parametrization in certain working set [9]. However, since the work presented in this chapter does not concern the identification and for the estimation and control, the decoupled model may be easily transposed into a coupled one (by concatenating the local states xi), the presented study will be only about the coupled polytopic T­S models.
In the present chapter, a survey about the T­S polytopic approach and its application to an inverted pendulum is presented; two main problems will be addressed: the first one is the modeling and the second one is the control design (observer based).
The modeling process through the well-known SNT is introduced. This procedure is used as a systematic and analytical method to rewrite and thus transform a nonlinear system into a polytopic T­S form without any loss of information [10,11]. The observer design is then presented with a Lyapunov stability analysis used to derive sufficient existence conditions of the observer. These conditions are expressed in terms of LMI s, which can easily be solved by dedicated softwares (LMI toolbox in MATLAB®, YALMIP [12] or the SeDuMi package for solving optimization problems with linear, quadratic and semidefiniteness constraints [13].
The inverted pendulum example is considered to illustrate the effectiveness of the proposed approach. From the nonlinear equations of the inverted pendulum, using the SNT transformation, a T­S polytopic model of the system is deduced and used.
The overview of this chapter is as follows. A short introduction to T­S systems and SNT transformation is presented in Section 12.2, and some useful results on the observer and controller design are detailed in Sections 12.3 and 12.4. A numerical example of an inverted pendulum to illustrate each step is given for all sections.

12.2 Systematic transformation of a nonlinear system into a polytopic T­S form
An efficient way to deal with nonlinear system estimation or fault diagnosis consists in rewriting the original nonlinear system in a simpler form, like the polytopic T­S model. Originally introduced by [14], the T­S representation allows to exactly

286 The inverted pendulum in control theory and robotics
describe nonlinear systems, under the condition that the nonlinearities are bounded. This is reasonable since state variables as well as parameters of physical systems are bounded ([10,15] and the references therein). The polytopic T­S model is based on a nonlinear interpolation between certain linear submodels with adequate weighting functions.
The T­S systems, as proposed by Takagi and Sugeno [14], are described by local models merged together using fuzzy IF-THEN rules, as follows:
IF z1(t) is in Mi1 and ...and zp(t) is in Mip,

THEN x(t) = Aix(t) + Biu(t) i = 1, 2, . . . , r y(t) = Cix(t)

(12.1)

where Mij is the fuzzy set, and r is the number of model rules; x(t)  Rnx is the system state, u(t)  Rm is the input and y(t)  Rp is the system output. zi(t) are known premise variables and each linear consequent equation represented by Aix(t) + Biu(t) is called subsystem.
Note that for the "fuzzy" model, the fuzzification process consists in transforming crisp values into fuzzy linguistic variables. The membership function is used to associate a grade to each linguistic variable. Selection of the number of membership functions and their initial values is based on the process knowledge and intuition.
In order to obtain a polytopic T­S representation from a nonlinear system, in a systematic and more structured way, the SNT is applied. The SNT is a systematic procedure that guarantees an exact model construction for nonlinear systems with bounded nonlinearities. Starting with a general form of nonlinear systems, a quasi-linear parameter-varying (LPV) state representation is realized. The polytopic T­S form is then obtained by using the convex polytopic transformation where each vertex defines a linear submodel, and nonlinear parts are rejected into the weighting functions i( (t)).
On the opposite of a classical fuzzy model, the weighting functions premise variables of the polytopic T­S form may be either measurable or unmeasurable. For simplicity reasons, it is easier to consider a system with measurable premise variables (most of the available works in the literature have considered models with measurable premise variables). However, in most practical cases (and realistic models), the premise variables depend on the state variables of the plant (and even sometimes unknown input dependent), which brings some additional difficulties but leads to more challenging problems in the observer/controller design. In this chapter, both cases of measurable and unmeasurable premise variables are considered.
Consider a dynamic nonlinear system described by the following state equations:

x(t) = f (t, x, u) y(t) = g(t, x, u)

(12.2)

where f (.) and g(.) are vector functions of dimension Rnx and Rp, respectively.

A survey on the polytopic Takagi­Sugeno approach 287

The SNT allows to express nonlinear dynamic systems into a convex combination

of linear submodels:

  x(t) =

n
i(t)(Aix(t) + Biu(t))

i=1

 y(t) =

n
i(t)(Cix(t) + Diu(t))

(12.3)

i=1

with Xi(.), for X  {A, B, C, D}, are matrices functions of appropriate dimensions. The functions i(t) represent the weights of the submodels (Ai, Bi, Ci, Di) in the global model and satisfy the convex sum property:

n
i(t) = 1, t
i=1

(12.4)

In order to obtain the polytopic T­S form, first, the system (12.2) is transformed in a linear time-varying form:

x(t) = A( (t))x(t) + B( (t))u(t) y(t) = C( (t))x(t) + D( (t))u(t)

(12.5)

Note that several choices for the system (12.5) are possible (details on how to obtain (12.5) from (12.2) are detailed in [10]). The nonlinear entries of the matrices X ( (t)), with X  {A, B, C, D}, are called premise variables and denoted as j(x, u), j = 1, . . . , q.
From (12.5), a convex polytopic transformation is performed for each premise variable as follows:

j(x, u) = Fj,1(j(x, u))j,1 + Fj,2(j(x, u))j,2

(12.6)

where

j,1 = max{j(x, u)}, j,2 = min{j(x, u)}

x,u

x,u



 Fj,1(j(x, u))

=

j(x, u) - j,2 j,1 - j,2

 Fj,2(j(x, u))

=

j,1 - j(x, u) j,1 - j,2

(12.7) (12.8)

For q premise variables, n = 2q submodels are obtained. The weighting functions i(t) are defined by

i(t) = jn=1Fj,ij (j(x, u))

(12.9)

where the indexes ij (i = 1, . . . , 2q and j = 1, . . . , q) are equal to 1 or 2 and indicate which partition of the jth premise variable (Fj,1 or Fj,2) is involved in the ith submodel.

288 The inverted pendulum in control theory and robotics The relation between the submodel number i and indexes ij is given by

i = 2n-1i1 + 2n-2i2 + · · · + 20in - (21 + 22 + · · · + 2n-1)

(12.10)

The constant matrices Xi are obtained by replacing the variables j in the matrices A, B, C and D with the scalars defined in (12.7):

Xi = X (1,i1 , . . . , q,iq ), X  {A, B, C, D}

(12.11)

To sum up, the SNT decomposition enables to represent the nonlinear system (12.2) in a compact polytopic T­S model (12.3) without any approximation or loss of information. For a better understanding of the previous procedure, let us consider the following equation of motion for the inverted pendulum given by the nonlinear model (12.12):

 

x1 x2

(t (t

) )

= =

x2(t)
mlx42(t) sin(x3(t))-mg sin(x3(t)) cos(x3(t))+u M +m sin2(x3(t))



x3 x4

(t (t

) )

= =

x4(t)
-mlx42(t) sin(x3(t)) cos(x3(t))+g(m+M ) sin(x3(t))-u cos(x3(t)) l(M +m sin2(x3(t)))

(12.12)

where x1(t) denotes the cart position (m) and x3(t) the angle (radians) displacement of the pendulum from the vertical configuration. The velocities are denoted by x2(t) and x4(t).
g is the gravity constant (g = 9.81 m/s2), m and M are, respectively, the point mass attached at the end of the pendulum and the cart mass, l is the pendulum length
and u(t) is the force applied to the cart (newtons).
According to the nonlinear model, four premise variables are defined

 

1(t) 2(t)

= =

1 M +m sin2(x3(t))
sin(x3 (t )) x3 (t )

 3(t) = cos(x3(t)) 4(t) = x4(t) sin(x3(t))

(12.13)

Note that x3(t)  (-/2, /2) and x4(t)  [-, ]. The system is uncontrollable when x3(t) = ±/2. To maintain the controllability of the system model, it is assumed that x3(t)  [-88°, 88°].
The following quasi-LPV representation is chosen as follows:

x(t) = A( (t))x(t) + B( (t))u(t)

(12.14)

A survey on the polytopic Takagi­Sugeno approach 289

where A( (t)) and B( (t)) are defined as

0 1

0

A( (t))

=



0 0

0 0

-mg1(t)2(t)3(t) 0

0



ml1(t)4(t) 1

,

00

g(m+M l

)

1(t

)2

(t

)





0

B( (t)) = 

1(t) 0



-m1(t)3(t)4(t)

-

1 l

1

(t

)3(t)

The SNT is now applied for each premise variable. We have then

(12.15)

1(t) = F1,1(1(t))1,1 + F1,2(1(t))1,2

(12.16)

where 1
1,1(t) = max{1(t)} = M ,

1 1,2 = min{1(t)} = M + m sin2(88/180)

(12.17)

and





F1,1(1(t))

=

1(t) - 1,2 1,1 - 1,2



F1,2(1(t))

=

1,1 - 1(t) 1,1 - 1,2

(12.18)

The same decomposition is applied for the second premise variable 2(t), with 2,1 = 1,

2,2 = 2/ and





F2,1(2(t))

=

2(t) - 2,2 2,1 - 2,2



F2,2(2(t))

=

2,1 - 2(t) 2,1 - 2,2

(12.19)

For numerical reasons, this premise variable 2(t) is defined for an angle x3(t) = 0, if x3(t) = 0, then 2(t) is set to be equal to 1.
Following the same procedure for 3(t) = cos(x3(t)), we have

3(t) = F3,1(3(t))3,1 + F3,2(3(t))3,2

(12.20)

where

3,1(t) = max{3(t)} = 1, 3,2 = min{3(t)} = cos (88/180)

(12.21)

and

 

F3,1(3(t))

=

3(t) - 3,2 3,1 - 3,2



F3,2(3(t))

=

3,1 - 3(t) 3,1 - 3,2

(12.22)

290 The inverted pendulum in control theory and robotics

Finally, for 4(t) = x4(t) sin(x3(t)), we have

4(t) = F4,1(4(t))4,1 + F4,2(4(t))4,2

(12.23)

where

4,1(t) = max{4(t)} = , 4,2 = min{4(t)} = -

(12.24)

and

  F4,1(4(t))

=

4(t) - 4,2 4,1 - 4,2

 F4,2(4(t))

=

4,1 - 4(t) 4,1 - 4,2

(12.25)

For q = 4, premise variables, and replacing all of them by their polytopic decomposition into the system model (12.12), we obtain the following polytopic system (with 24 = 16 submodels):


x(t) = F11(1)F21(2)F31(3)F41(4) A1 + F11(1)F12(2)F31(3)F42(4) A2

1( (t))

2( (t))

+ F11(1)F11(2)F32(3)F41(4) A3 + · · · + F12(1)F22(2)F32(3)F41(4) A15

3( (t))



15( (t))

+ F12(1)F22(2)F32(3)F44(4) A16 x(t) + (1( (t))B1 + · · · + 16( (t))B16) u(t)
16( (t))
(12.26)

where x = [x1, x2, x3, x4]T is the system state and F(t) the system input. The system matrices defined as

Ai = A(1,i1 , . . . , 4,i4 ), Bi = B(1,i1 , 3,i3 )

(12.27)

where the relation between the indexes ij (i = 1, . . . , 16 and j = 1, . . . , 4) and the submodel number i is given by (12.10).
Then, the nonlinear model of the inverted pendulum may be written in a polytopic T­S form as follows:

16
x(t) = i( (t))(Aix(t) + Biu(t))
i=1

(12.28)

12.3 Stability analysis of polytopic T­S systems
Let us consider the following time-varying system: x(t) = A(t)x(t)

(12.29)

A survey on the polytopic Takagi­Sugeno approach 291

this system is asymptotically stable (quadratic stability), if there exists a Lyapunov matrix P positive symmetric P = PT > 0 such that the Lyapunov function

V (x(t)) = xT (t)Px(t) > 0

(12.30)

is positive, null for x = 0 and decreasing in time. The same reasoning is applied for the nonlinear system represented by the autonomous T­S model:

n
x(t) = i( (t))Aix(t)
i=1

(12.31)

with the weighting functions i( (t)) satisfying the convex sum property (12.4).

Lemma 12.1. The system (12.31) is globally asymptotically stable if there exists a matrix P positive symmetric P = PT > 0  Rnx×nx such that the following conditions are verified for i = 1, . . . , n [10]:

AiT P + PAi < 0

(12.32)

Proof. The proof is based on the choice of a Lyapunov function V (x(t)) = xT (t)Px(t) where P = PT > 0  Rnx×nx . The sum convex property of the weighting functions
allows to obtain n matrices inequalities (LMI s) to solve simultaneously.

Later research has focused in conceiving more efficient LMI s conditions, such as the ones in [16­18]. In fact, a key point for the T­S system study is the search for an adequate Lyapunov function. A usual approach is to call for a single quadratic Lyapunov function but a significant improvement can be obtained by considering time-varying or polytopic Lyapunov functions that incorporate the system dynamics [19­21].

12.4 Observer design for polytopic T­S models

The observability concept for a system consists on establishing the conditions under

which the state may be reconstructed from the inputs and the measurable outputs.

For the nonlinear systems, the observability problem has been widely studied in

the literature (see [22­24] for example).

For the T­S approach, a necessary condition for the observability may be given

by the observability constraint of the local systems, i.e., for each pair (Ai, Ci) of the system submodels, or at least their detectability [25,26].

Let us consider the following polytopic T­S model given by the following

equation:

  x(t) = n i( (t))(Aix(t) + Biu(t))



y(t)

=

i=1
Cx(t)

(12.33)

292 The inverted pendulum in control theory and robotics

The most common observer for these systems is a polytopic Luenberger observer [27].

It basically consists in extending the design of the popular Luenberger (proportional)

observer used in the linear system framework. It is defined by

  x^(t) = n i(^ (t))(Aix^(t) + Biu(t) + Li(y(t) - y^(t)))



y^(t)

=

i=1
Cx^(t)

(12.34)

with x^(t) and ^ (t) represent, respectively, the state x(t) and premise variables  (t) estimate.
The observer gains Li are designed such that the state estimate x^(t) asymptotically converges toward the state x(t). Then, the error dynamics stability e(t) = x(t) - x^(t) has to be ensured.
The weighting functions i( (t)) verify the following convex sum property:

r
i( (t)) = 1, 0  i( (t))  1, i = 1, . . . , M , t
i=1

(12.35)

 (t) may depend on measurable premises variables (a part of the input u(t) or the output y(t)) or unmeasurable premises variables (as the system states, UIs). The state estimation for nonlinear systems using the T­S polytopic model approach has been addressed with different methods, but most of the available works in the literature have considered models with measurable premise variables.
For simplicity reasons, it is easier to consider a system with measurable premise variables. However, in most practical cases (and realistic models), the premise variables depend on the state variables of the plant (and even sometimes unknown input dependent). In this chapter, both cases of measurable premise variables and the general case of unmeasurable premise variables are addressed; the second case brings some additional difficulties but leads to more challenging problems in the observer design [28,29].

12.4.1 Measurable premise variables

In the measurable premise variables case, the observer design is based on the availability of the premise variables. Then, the system and the polytopic observer share the same weighting (also called activation) functions. The main advantage is the possibility to factorize these functions during the estimation error dynamic study e(t) defined as x(t)-x^(t). We then have

n
e(t) = i( (t))(Ai - LiC)e(t)
i=1

(12.36)

A simple stability analysis of the system (12.36) allows us to find the desired gains Li and that may be given for example by the following theorem:

A survey on the polytopic Takagi­Sugeno approach 293

Lemma 12.2. [30] The state estimation error converges asymptotically to zero if there exists a positive symmetric matrix P = PT > 0  Rnx×nx and matrices Ki  Rnx×m such that the following conditions are satisfied for i = 1, . . . , n:

PAi + ATi P - KiC - CT KiT < 0

(12.37)

The observer gains are then given by

Li = P-1Ki

(12.38)

The same study may be carried out for the case of a polytopic output (y(t) =
n
i( (t))Cix(t)) where the conservatism introduced by a system defined by a double
i=1
sum may be reduced (see [16,31] for more details).

12.4.2 Unmeasurable premise variables

For the unmeasurable premise variables case, the estimation error dynamics cannot be easily computed directly, since in the considered case, the weighting functions depend on the unmeasurable variables  (t), whereas those of the observer depend on their estimates ^ (t). In order to overcome this difficulty, taking benefits of the convex sum property, the state derivative is rewritten as an uncertain T­S system where the uncertainties are bounded. The observer gains are then determined in a way to ensure the stability of the state estimation error dynamics as well as an L2 attenuation of the transfer from the uncertainties to the state estimation error.
The polytopic T­S model (12.33) is then rewritten as

n
x(t) =
i=1

i(^ (t))(Aix(t) + Biu(t)) + (i( (t)) - i(^ (t)))(Aix(t) + Biu(t)) (12.39)

From (12.34) and (12.39), the state estimation error dynamics is then given by

n
e(t) = i(^ (t))(Ai - LiC)e(t) + A(t)x(t) + B(t)u(t)
i=1

(12.40)

where A(t) and B(t) are considered uncertainties and defined as follows:

 

n

A(t) =

i( (t)) - i(^ (t)) Ai

i=1
= A A(t)EA



n

B(t) =

i( (t)) - i(^ (t)) Bi

i=1
= B B(t)EB

(12.41)

294 The inverted pendulum in control theory and robotics with
A = A1 . . . An , A(t) = diag (1(t)Inx , . . . , n(t)Inx ), B = B1 . . . Bn , B(t) = diag (1(t)Inu , . . . , n(t)Inu ), EA = Inx . . . Inx T, EB = Inu . . . Inu T, i(t) = i( (t)) - i(^ (t)) The observer gains are then given by the following theorem:

(12.42)

Theorem 12.1. [32] The system (12.40) is globally asymptotically stable and the
gain L2 of the transfer of the pair u(t), x(t) to the estimation error is bounded by  , if there exists two positive symmetric matrices P1  Rnx×nx and P2  Rnx×nx , matrices Ki  Rnx×m and positive scalars 1, 2 et  such that the following LMI s are
satisfied for all i, j = 1, . . . , n:

 S(P1Ai - KiC) + Inx

0

0

P1A P1B 



  

S(P2Aj) + 1EAT EA

P2Bj

0



- Inu + 2EBT EB 0





-1I

0 0 0

 < 0







0 -1I

(12.43)

where S(M ) := M + M T . The observer gains and the attenuation level  of the transfer from the
uncertainties to the state estimation error are given by

Li = P1-1Ki

(12.44)

= 

(12.45)

12.5 Polytopic T­S models stabilization
The most common strategy for the nonlinear polytopic T­S models stabilization is the so-called parallel distributed compensation (PDC). Introduced in [33,34], this command law depends on the same weighting functions used for the polytopic T­S model. These controllers may be state feedback, observer based or output feedback (static or dynamic).
In this section, the controller design for both state and output feedback is presented. Pros and cons for each method will be given and illustrated with an application to the inverted pendulum system (if applicable).

A survey on the polytopic Takagi­Sugeno approach 295

12.5.1 State feedback stabilization

12.5.1.1 Classical state feedback stabilization

Let us consider the following polytopic T­S model:

n
x(t) = i( (t))(Aix(t) + Biu(t))
i=1

(12.46)

The state feedback PDC control law is given by the following equation:

n
u(t) = - j( (t))Kjx(t)
j=1

(12.47)

The controlled system is then written as

nn

x(t) =

i( (t))j( (t))(Ai - BiKj) x(t)

i=1 j=1

(12.48)

Let us consider the Lyapunov function V (x(t)) = xT (t)Px(t), the system (12.48)
asymptotic stability is ensured if there exists a positive symmetric matrix P1  Rnx×nx and matrices Ri  Rnx×m such that the following LMI s are verified for i, j = 1, . . . , n ([10]):

P1ATi + AiP1 - RjT BiT - BiRj < 0 i, j = 1, . . . , n

(12.49)

The controller gains Kj are then given by Kj = RjP1-1 with P1 = P-1

(12.50)

The control objective of this subsection is to balance the inverted pendulum around the origin (x3 0). To illustrate this application, a PDC control is applied. In order to minimize the design effort and complexity, we will use as few rules as possible. So, we consider our model around small angle, which implies the following simplification:

cos(x3) 1, sin(x3) x3

(12.51)

The premise variables are then resumed to

1 1(t) = M + mx32(t) ,

4(t) = x4(t).x3(t)

(12.52)

The corresponding polytopic T­S model will be then represented by four submodels.

The rank of the controllability matrix is checked.

From (12.49) and (12.50), the controller gains are calculated and given by

 

K1 K2

= =

-0.6359 -1.9782 -29.1095 -7.3509 -0.6359 -1.9782 -29.1095 -7.3509

 K3 = -0.4563 -1.4258 -23.2823 -5.6007 K4 = -1.0079 -3.1316 -41.5012 -11.2301

(12.53)

The nonlinear system is simulated with the polytopic T­S controller, the obtained results are depicted in Figure 12.3.

296 The inverted pendulum in control theory and robotics

Velocity (rad/s) Angle (radians) Velocity (m/s) Cart position (m)

2

1

00

1

2

3

4

5

6

7

8

Time (s)

2

0

­2 0

1

2

3

4

5

6

7

8

Time (s)

0.5

0

­0.5

0

1

2

3

4

5

6

7

8

Time (s)

2

0

­2

0

1

2

3

4

5

6

7

8

Time (s)

Figure 12.3 State feedback controller

x1(t)

9

10

x2(t)

9

10

x3(t)

9

10

x4(t)

9

10

We can note that the state feedback controller is based on the fact that all the states are available. If it is not the case, either the observer-based state feedback stabilization or the output feedback stabilization can be used.

12.5.2 Observer-based state feedback stabilization
For the case where the system state is not fully available, a solution may be an observerbased controller. As it was done for the observer design, both cases of measurable and unmeasurable premise variables are presented.

12.5.2.1 Measurable premise variables The observer-based feedback controller for polytopic T­S models with measurable premise variables is given by

n
u(t) = - j( (t))Kjx^(t)
j=1

(12.54)

where the observer dynamics is given by

  x^(t) = n i( (t))(Aix^(t) + Biu(t) + Li(y(t) - y^(t)))



y^(t)

=

i=1
Cx^(t)

(12.55)

A survey on the polytopic Takagi­Sugeno approach 297

Combining both the controller law (12.75) and the observer (12.76) with an estimation

error defined as e(t) = x(t) - x^(t), the following equations are obtained:

  x(t) =

n

n
i( (t))j( (t)) (Ai - BiKj)x(t) + BiKje(t)

i=1 j=1

 e(t) = n

n
i( (t))j( (t)) Ai - LiCj) e(t)

i=1 j=1

(12.56)

The following augmented state system is then deduced:

nn

xa(t) =

i( (t))j( (t))Gijxa(t)

i=1 j=1

(12.57)

with

xa(t) =

x(t) e(t)

, Gij =

Ai - BiKj BiKj 0 Ai - LiCj

(12.58)

Let us consider the following Lyapunov function:

V (xa(t)) = xaT (t)Pxa(t), P = PT > 0

(12.59)

The augmented system stability (12.57) is then ensured if the following conditions are satisfied for i, j = 1, . . . , n:

GiTj P + PGij < 0 Let us choose a bloc diagonal Lyapunov function, s.t.

(12.60)

P=

P1 0 0 P2

(12.61)

Then, condition (12.60) becomes

P1Ai + ATi P1 - P1BiKj - KjT BiT P1

P1 Bi Kj



P2Ai + AiT P2 - P2LiCj - CjT LiT P2

(12.62)

where  refers to the transpose of P1BiKj. Condition (12.62) is nonlinear, a solution may be to choose P1 = I where  is
a positive scalar and proceed to a change of variable.

To summarizer, the augmented system is globally asymptotically stable if there

exists a positive symmetric matrix P2, a positive scalar  and matrices Kj and Li such

that the following LMI s admit a solution for i, j = 1, . . . , n:







Ai

+

ATi

-

BiK j

-

K

T j

BiT

BiK j



(BiK j)T

P2Ai + ATi P2 - LiCj - CjT LTi

(12.63)

the observer and controller gains are then given by Li = P2-1Li, Kj = -1K j

(12.64)

298 The inverted pendulum in control theory and robotics

12.5.2.2 Unmeasurable premise variables

For nonlinear systems represented by unmeasurable premise variable polytopic T­S

models, the state feedback PDC controller as well as the observer dynamics are given

by the following equations:

 

u(t)

=

-

n j=1

j(^ (t))Kjx^(t)

n

 x^(t) = i=1 i(^ (t))(Aix^(t) + Biu(t) + Li(y(t) - y^(t))) y^(t) = Cx^(t)

(12.65)

The augmented system xa(t) =

x^(t) e(t)

with e(t) = x(t) - x^(t) is given by [35]:

nnn

xa(t) =

i( (t))j(^ (t))k (^ (t))Gijk xa(t)

i=1 j=1 k=1

(12.66)

with

Gijk =

Rik

Bi Kk

Sijk jk + BijKk

(12.67)

Rik = Ai - BiKk , Sijk = Aij - BijKk + LjC, jk = Ai - LiCj

(12.68)

Aij = Ai - Aj, Bij = Bi - Bj

(12.69)

The augmented state (12.66) is rewritten as

nn

xa(t) =

i( (t))j(^ (t))j(^ (t))Gijjxa(t)

i=1 j=1

n
+2

i( (t))j(^ (t))k (^ (t)) Gijk

+ 2

Gikj

xa(t)

i=1 j<k

(12.70)

Let us consider the Lyapunov function V (xa(t)) = xaT (t)Pxa(t). The augmented system asymptotic stability (12.70) is ensured if the following conditions are satisfied
for i, j, k = 1, . . . , n [34,35]:

GiTjjP + PGijj

<

0

Gijk + Gikj

T
P+P

Gijk + Gikj

2

2

 0,

(12.71) i, j < k s.t. i  j  k = 

The notation i  j  k =  means that for all i, j < k excepting ijk = 0,  . Conditions (12.71) are not convex (due to i( ) = i(^ )), it is difficult to trans-
form them into LMI s in P, Ki and Li. To solve those issues, the following technique
was proposed in [35]:

Let us consider the following bloc diagonal Lyapunov function:

P = P1 0 0 P2

(12.72)

A survey on the polytopic Takagi­Sugeno approach 299

Replacing (12.72) into (12.71), it becomes

RiTj P1 + P1Rij P1BiKj + SiTjjP2



ijk

(Rik + Rij)T P1 + P1(Rik + Rij) P2(Sijk + Sikj) + (Kk + Kj)T BiT P1



ijk + ikj

<0 (12.73)
<0

with ijk = (jk + BijKk )T P2 + P2(jk + BijKk ). Since (12.73) is still in a BMI form, one way to solve the problem is the
following: Since the BMI (12.73) imply that

RiTj P1 + P1Rij

<0

(Rik + Rij)T P1 + P1(Rik + Rij) < 0

(12.74)

These last inequalities are easy to transform into LMI . Once P1 and Ki are obtained, we substitute them into (12.73) and obtain LMI conditions in P2 and Li that can be solved by a convex optimization technique such as the interior point method.

In order to illustrate the observer-based feedback controller, let us consider the

previous example with four submodels.

1000

For an output matrix C =

, the obtained observer gains are given by

0010





L1 L2

= =

 5.2254



55.7035 -5.3685

-149.9143

 5.2254



55.7036 -5.3685

-149.9146

-7.8695  -3252.51.0166885
927.3724
-7.8695  -3252.51.0166884
927.3723



L3 L4

= =

 5.2173



55.4060 -5.3184

-148.6749

 5.2236



55.7293 -5.3914

-150.2795

-7.9696  -3252.86.6376007
940.5266
-7.9102  -3252.74.5061021
935.7448

(12.75)

300 The inverted pendulum in control theory and robotics

Velocity (rad/s) Angle (radians) Velocity (m/s) Cart position (m)

6 4 2 0
0 4 2 0 ­2
0 0.4 0.2
0 ­0.2
0 2
0
­2 0

x1(t) x1(t) estimate

5

Time (s)

10

15
x2(t) x2(t) estimate

5

10

Time (s)

15
x3(t) x3(t) estimate

5

10

Time (s)

15
x4(t) x4(t) estimate

5

Time (s)

10

15

Figure 12.4 Observer-based state feedback controller

To simplify the computation (less LMI s to solve), the controller gains were set to be equal, they are given by

K = -0.2146 -0.8185 -16.8005 -3.3704

(12.76)

The nonlinear system is simulated with the polytopic T­S controller, the obtained results are depicted in Figure 12.4.
From the depicted figure, it is shown that the efficiency of the proposed observerbased feedback controller. Note that the control law u(t) is in a polytopic T­S form, and it was applied to the nonlinear model.

Remark 12.1. Another way would be to use the descriptor approach [36,37]. In fact, this approach is well known to avoid the coupling terms between the feedback gains and the Lyapunov matrices and thus facilitates the LMI s resolution. As a consequence, the number of LMI s to solve decreases, and relaxed conditions are obtained [37].
The design procedure is then summarized in the following steps:

 Deduce the augmented state dynamics xa(t) = xT (t) eT (t) uT (t) T from the system, observer and controller (12.46) and (12.65):

n
Exa(t) = i( (t))Aixa(t)
i=1

(12.77)

A survey on the polytopic Takagi­Sugeno approach 301

with





Inx 0 0 E =  0 Inx 0  ,

0 0 0nu





Ai + A(t) 0 Bi + B(t)

Ai =  A(t) Ai - LiC

B(t) 

Ki

Ki

I

(12.78)

where A(t) and B(t) are considered uncertainties and defined as in (12.41)

and (12.42).

 For positive symmetric matrices P1 and P2 and a matrix P3, the condition to

satisfy for the asymptotic stability of the augmented system (12.77) is given by



S(P1Ai + P1









A(t))

AT (t)P2 S(P2Ai - P2LiC)

KiT

P3 + P2

P1Bi + P1 B(t B(t) + KiT P3

) 

<0

(12.79)



P3 + P3T

where  refers to the transpose term and S(M ) := M + M T .  Condition (12.79) is then decomposed into the sum of a constant term and a
time-varying one, i.e.,

Q + Q(t) + QT (t) < 0

(12.80)

with





Q

=

S(P1 Ai ) 

AT (t)P2 S(P2Ai - P2LiC)

KiT

P3 + P1 KiT P3

Bi







P3 + P3T





S(P1 A(t)) AT (t)P2 P1 B(t)

Q(t) =  

0 P2 B(t)





0

(12.81) (12.82)

 Using the definition of A(t) and B(t) (as it was done in Section 12.4.2), and the following lemma:

Lemma 12.3. [38] Let us consider matrices X and Y of appropriate dimensions, a time-varying matrix (t) and a positive scalar . The following property is true:

X T T (t)Y + Y T (t)X  X T X + -1Y T Y

(12.83)

if T (t) (t)  I .

The inequality (12.79) is linearized, and the observer and controller gains deduced (by a simple change of variables).

Another interesting study case would be the uncertain polytopic T­S systems. In fact, if the model presents some uncertainties or modeling error, they have to be taken into account in the design process. A short overview of this case is given in the next subsection.

302 The inverted pendulum in control theory and robotics

12.5.2.3 State feedback stabilization for uncertain polytopic T­S systems
In practice, there exists several uncertainties sources that affect the physical systems; these uncertainties must be taken into account during the modeling.
They may be due to an imperfect knowledge of the system parameters numerical values, to some modeling approximation, unknown inputs or disturbances. All these phenomena introduce a difference between the real system behavior and the one obtained by its model simulation.
In order to avoid this difference, or at least to minimize their effect, several robust control techniques have been proposed [39­41]. In the following, the state feedback stabilization for uncertain polytopic T­S systems is presented.
Let us consider the following model:

n
x(t) = i( (t))((Ai + A(t))x(t) + (Bi + B(t))u(t))
i=1

(12.84)

where the uncertainties A(t), B(t) that affect the state and control matrices are common to all submodels and are given in the form

A(t) = A A(t)EA

(12.85)

B(t) = B B(t)EB

(12.86)

The time-varying matrices A(t) and B(t) are unknown but bounded as follows:

T A

(t

)

A(t)  I , t

(12.87)

T B

(t

)

B(t)  I , t

(12.88)

Let us consider the following control law for the system (12.84) where the premise variables are supposed to be measurable:

n
u(t) = - j( (t))Kjx(t)
j=1

(12.89)

where the controller gains Kj  Rnu×nx are to be determined. Replacing (12.89) into (12.84), we obtain

nn

x(t) =

i( (t))j( (t))(Ai - BiKj + A(t) - B(t)Kj)x(t)

i=1 j=1

(12.90)

In order to analyze the system state stability, let us consider the following Lyapunov function:

V (x(t)) = xT (t)Px(t)

(12.91)

where P  Rn is a positive symmetric matrix.

A survey on the polytopic Takagi­Sugeno approach 303

In order to ensure (12.90) global asymptotic stability, the following conditions

must be verified:



S(AiP1 - BiRj) + AAAT + BBBT P1EAT RjT EBT





-AI 0  < 0,



 -BI

i, j = 1, . . . , n (12.92)

with P1 = P-1, A, B are positive scalars and S(AiP1 - BiRj) := AiP1 - BiRj + P1ATi - RjT BiT . In this case, the controller gains Kj are given by

Kj = RjP1-1

(12.93)

for i, j = 1, . . . , n.

The presented results are given for the measurable premise variable. They may

be extended to the general case of unmeasurable premise variable as well as to the

observer-based control by applying the same idea and based on the results presented

in the previous subsection.

As it was shown, the state feedback or observer-based feedback approach is quite

interesting for the system stabilization. In other alternative, we have to achieve a

stability purpose in the case where the system state is not fully available and/or to

avoid the additional computations due to an observer design would be the output

feedback control.

12.5.3 Static output feedback stabilization

In this section, the static output feedback control is considered. Contrarily to the

observer-based or output dynamic controllers [42­44], static controllers are particu-

larly interesting to reduce real-time computational cost when implementing practical

applications since it does not need any ODE solving [2,45]. However, it is important

to highlight that the drawback of output feedback controllers is the coupling intro-

duced that makes the LMI s to be solved quite conservative and restrictive for some

cases [46].

In the following section, the descriptor approach applied to the polytopic T­S

models is also introduced. The descriptor approach consists on introducing virtual

dynamics in the outputs equations, then, a descriptor formulation can be obtained

considering an extended state vector for the closed-loop dynamics. Rewriting the

closed-loop system by the use of descriptor form allows to avoid appearance of cross-

ing terms between the state-space matrices and the controller's ones. Therefore, the

benefit of the descriptor formulation is to make easier the LMI s formulation of

nonquadratic stability conditions [36,37,47,48]. Herein, the stabilization condition for

polytopic T­S models with static output feedback is based on the descriptor approach.

For simplicity reasons, only the case of measurable premise variables is considered.

Let us consider the following polytopic T­S model:   x(t) = n j( (t))(Aix(t) + Biu(t))
i=1
 y(t) = n j( (t))(Cix(t) + Diu(t))
i=1

(12.94)

304 The inverted pendulum in control theory and robotics

and the static output feedback control defined by

n
u(t) = j( (t))Kjy(t)
j=1

(12.95)

Based on the descriptor approach and introducing a virtual dynamics in the input and

outputs equations, we can write



 0.u(t) =

n
i( (t))Kiy(t) - u(t)

i=1

 0.y(t) =

n
i( (t))(Cix(t) + Diu(t)) - y(t)

i=1

(12.96)

From (12.94) and (12.96), the augmented state vector dynamics xa(t) = xT (t) uT (t) yT (t) T is given by

n
Exa(t) = i( (t))Aisxa(t)
i=1

with



E

=



Inx 0

0 0nu





0

Ai Bi

0 , Ais =  0 -Inu

 0 Ki 

0 0 0m

Ci Di -Im

Let us consider the Lyapunov function:

V (t) = xaT (t)ET Pxa(t)

such that

ET P = PT E  0

(12.97) (12.98) (12.99) (12.100)

A possible choice of the matrix P ensuring the condition (12.100) is a block diagonal form P = diag(P1, P2, P3) with P1 = P1T > 0 and P2, P3 > 0. In this case, V (t) is a quadratic function of the state system, in fact, V (t) = xT (t)P1x(t). The time derivative of the Lyapunov function (12.99) is then given by

n
V (t) = hi( (t))xaT (t)((Ais)T P + PT Ais)xa(t)
i=1

(12.101)

From (12.98) and (12.101), in order to ensure the system (12.97) stability, i.e.,

V (t) < 0 the conditions to solve regarding P1, P2, P3 and Rj, i = 1, . . . , n are







AiT

P1

+ 

P1Ai

P1Bi -P2 - P2T

CiT Ri +

P3z DiT P3



<

0

(12.102)





-P3 - P3T

The controller gains are given by

Ki = (P2T )-1Ri

(12.103)

A survey on the polytopic Takagi­Sugeno approach 305
From the presented results, it is important to highlight that the polytopic T­S approach may be really efficient (when it is applicable). In fact, this approach does not fit to all systems, in many cases, we will have some structural constraints that make it simply impossible to be applied like for the proposed static output feedback controller and the inverted pendulum.
It is clear that the proposed controller (12.95) exists only if the (12.102) conditions are satisfied, which is not the case for the considered application. In fact, the LMI s (12.102) admit a solution only if each local system (or subsystem) is stable, i.e., real part of the eigenvalues of Ai is negative, which is not the case for the inverted pendulum.
A solution in this case would be to search for a relaxed conditions by introducing a polytopic Lyapunov function or a dynamic state feedback controller for example, such that introducing extra dynamics may be required to increase the number of degrees of freedom in the design and improve the closed-loop transient response.
Some more results regarding the structural constraints for polytopic T­S models may be found in the following articles [49­51].
12.6 Conclusion
In this chapter, a review on the polytopic T­S approach with an application to the inverted pendulum was presented. A general scope of the approach with the most common results was presented and applied to a nonlinear model of the inverted pendulum. It was shown in one hand that the polytopic T­S approach may be an effective tool with several advantages and satisfying results; however, in the other hand, that approach is subject to some structural constraints that do not make it applicable for any system.
References
[1] Orjuela R, Marx B, Maquin D, Ragot J. Design of robust H observers for nonlinear systems using a multiple model. In: 17th World Congress The International Federation of Automatic Control. Seoul, Korea; 2008.
[2] Chadli M, Maquin D, Ragot J. Static output feedback for Takagi­Sugeno systems: An LMI approach. In: 10th Mediterranean Conference on Control and Automation. Lisbon, Portugal; 2002.
[3] Guerra TM, Kruszewski A, Vermeiren L, Tirmant H. Conditions of output stabilization for nonlinear models in the Takagi­Sugeno's form. Fuzzy Sets and Systems. 2006;157(9):1248­1259.
[4] Kruszewski A, Wang R, Guerra TM. Nonquadratic stabilization conditions for a class of uncertain nonlinear discrete time TS fuzzy models: A new approach. IEEE Transactions on Automatic Control. 2008;53:606­611.
[5] Bezzaoucha S, Voos H, Darouach M. A new polytopic approach for the unknown input functional observer design. International Journal of Control. 2017 Published online February; https://dx.doi.org/10.1080/ 00207179.2017.1288299.

306 The inverted pendulum in control theory and robotics
[6] Luenberger DG.An introduction to observers. IEEETransactions onAutomatic Control. 1971;16(6):596­602.
[7] Darouach M, Zasadzinski M, Xu S. Full-order observers for linear systems with unknown inputs. IEEE Transactions on Automatic Control. 1994;39(3): 606­609.
[8] Filev D. Fuzzy modeling of complex systems. International Journal of Approximate Reasoning. 1991;5(3):281­290.
[9] Orjuela R, Marx B, Ragot J, Maquin D. Nonlinear system identification using heterogeneous multiple models. Applied Mathematics and Computer Science. 2013;23(1):103­115.
[10] Tanaka K, Wang HO. Fuzzy Control Systems Design and Analysis: A Linear Matrix Inequality Approach. John Wiley & Sons, Inc.; 2001.
[11] Kawamoto S, Tada K, Ishigame A, Taniguchi T. An approach to stability analysis of second order fuzzy systems. In: IEEE International Conference on Fuzzy Systems. San Diego, California, USA; 1992.
[12] Lofberg J. YALMIP: A toolbox for modeling and optimization in MATLAB. In: In Computer Aided Control Systems Design Conference. Taipei, Taiwan; 2004.
[13] Labit Y, Peaucelle D, Henrion D. SEDUMI Interface 1.02: a tool for solving LMI problems with SEDUMI. In: IEEE International Symposium on Computer Aided Control System Design; 2002.
[14] Takagi T, Sugeno M. Fuzzy identification of systems and its applications to modeling and control. IEEE Transactions on Systems, Man and Cybernetics. 1985;15(1):116­132.
[15] Bezzaoucha S, Marx B, Maquin D, Ragot J. Nonlinear joint state and parameter estimation. Application to a wastewater treatment plant. Control Engineering Practice. Accepted paper in May 2013. 2013;21(10):1377­1385.
[16] Sala A, Arino C. Asymptotically necessary and sufficient conditions for stability and performance in fuzzy control: Applications of Polya's theorem. Fuzzy Sets and Systems. 2007;158(24):2671­2686.
[17] Fang CH, Liu YS, Kau SW, Hong L, Lee ITFS C H. A new LMI-based approach to relaxed quadratic stabilization of T­S fuzzy control systems. IEEE Transaction on Fuzzy Systems. 2006;14:286­397.
[18] Teixeira M, Assuncao E, Avellar RITFS. On relaxed LMI-based designs for fuzzy regulators and fuzzy observers. IEEE Transaction on Fuzzy Systems. 2003;11(5):613­623.
[19] Tanaka K, Hori T, Wang HO. A multiple Lyapunov function approach to stabilization of fuzzy control systems. IEEE Transactions on Fuzzy Systems. 2003;11:582­589.
[20] Kruszewski A. Lois de commande pour une classe de modèles non linéaires sous la forme Takagi­Sugeno: Mise sous forme LMI. Université de Valenciennes et du Hainaut-Cambresis. France; 2006.
[21] Sename O, Gaspar P, Bokor J. Lecture Notes in Robust Control and Linear Parameter Varying approaches: Application to Vehicle Dynamics. Springer, editor; 2013.

A survey on the polytopic Takagi­Sugeno approach 307
[22] Besançon G. Nonlinear Observers and Applications. Springer, editor. Springer; 2007.
[23] Fossard A, Normand-Cyrot D. Systèmes non linéaires: Modélisation ­ Estimation (Tome I). Masson, editor. Masson; 1993.
[24] Diop S, Fliess M. On nonlinear observability. In: First European Control Conference. Grenoble, France; 1991.
[25] Kamidi R. Controllability and observability of polytopic linear models. Eindhoven University of Technology. The Netherlands; 2000.
[26] Angelis GZ. System analysis, modeling and control with Polytopic Linear Models. Technische Universiteit Eindhoven. Netherland; 2001.
[27] Luenberger DG.An introduction to observers. IEEETransactions onAutomatic Control. 1971;16(6):596­602.
[28] Yoneyama Y. H filtering for fuzzy systems with immeasurable premise variables: An uncertain system approach. Fuzzy Sets and Systems. 2008;39(10):1033­1040.
[29] Bergsten P, Palm R. Thau-Luenberger observers for TS fuzzy systems. In: Ninth IEEE International Conference on Fuzzy Systems. San Antonio, Texas, USA; 2000.
[30] Patton R, Chen J, Lopez-Toribio C. Fuzzy observers for nonlinear dynamic systems fault diagnosis. In: 37th IEEE Conference on Decision and Control. Tampa, Florida, USA; 1998.
[31] Tuan HD, Apkarian P, Narikiyo T, Yamamoto Y. Parameterized Linear Matrix Inequality Techniques in Fuzzy Control System Design. IEEE Transactions on Fuzzy Systems. 2001;9(2):324­332.
[32] Bezzaoucha S. Fault tolerant control for Takagi­Sugeno nonlinear systems. Lorraine University. France; 2013.
[33] Wang HO, Tanaka K, Griffin M. An approach to fuzzy control of non linear systems: Stability and design issues. IEEE Transactions on Fuzzy Systems. 1996;4(1):14­23.
[34] Tanaka K, Ikeda T, Wang H. Fuzzy regulators and fuzzy observers: Relaxed stability conditions and LMI-based design. IEEE Transactions on Fuzzy Systems. 1998;6(2):250­265.
[35] Chadli M, Maquin D, Ragot J. Observer-based controller for Takagi­Sugeno models. In: IEEE International Conference on Systems, Man and Cybernetics. vol. 5; 2002.
[36] Tanaka K, Ohtake H, Wang HO. A descriptor system approach to fuzzy control system design via fuzzy Lyapunov functions. IEEE Transactions on Fuzzy Systems. 2007;15(3):333­341.
[37] Guelton K, Bouarar T, Manamanni N. Robust dynamic output feedback fuzzy Lyapunov stabilization of Takagi­Sugeno systems ­ A descriptor redundancy approach. Fuzzy Sets and Systems. 2009;160(19): 2796­2811.
[38] Zhou K, Khargonekar PP. Robust stabilization of linear systems with norm-bounded time-varying uncertainty. Systems and Control Letters. 1988;10(1):17­20.

308 The inverted pendulum in control theory and robotics
[39] Henrion D. Stabilité des systèmes linéaires incertains à commande contrainte. Institut National des SciencesAppliquées deToulouse. Toulouse, France; 1999.
[40] Daafouz J. Robustesse en performance des systèmes linéaires incertains. Placement de pôles et coût garanti. Institut National des Sciences Appliquées. Toulouse, France; 1997.
[41] Zhou K, Doyle JC, Glover K. Robust and Optimal Control. Englenwood Cliffs, New Jersey, USA: Prentice-Hall; 1996.
[42] Li J, Wang HO, Newmann D, Tanaka K. Dynamic parallel distributed compensation For Takagi­Sugeno systems: An LMI approach. Information Sciences. 2000;123(4):201­221.
[43] Yoneyama J, Nishikawa M, Katayama H, Ichikawa A. Design of output feedback controllers for Takagi­Sugeno fuzzy systems. Fuzzy Sets and Systems. 2001;121(1):127­148.
[44] Yoneyama Y. Output feedback stabilization of fuzzy systems with unobservable premise variables. In: International Conference on System of Systems Engineering. Los Angeles, CA, USA; 2006.
[45] Huang D, Nguang SK. Robust H static output feedback control of fuzzy systems: An ILMI approach. IEEE Transactions on Systems, Man and Cybernetics. 2006;36(1):216­222.
[46] Bouarar T. Contribution à la synthèse de lois de commande pour les descripteurs de type Takagi­Sugeno incertains et perturbés. Université de Reims Champagne Ardenne. France; 2009.
[47] Lin C, Wang QG, Lee TH. H-control for Takagi­Sugeno fuzzy descriptor systems. In: International Conference on Systems, Man and Cybernetics. Tokyo, Japan; 1999.
[48] Taniguchi T, Tanaka K, Othake H, Wang HO. Model construction, rule reduction, and robust compensation for generalized form of Takagi­Sugeno fuzzy systems. Transactions on Fuzzy Systems. 2001;9(4):525­537.
[49] Bezzaoucha S, Voos H, Darouach M, Dentler J. On the unknown input functional observers design: a polytopic Takagi­Sugeno approach. In: 24th Mediterranean Conference on Control and Automation. Athens, Greece; 2016.
[50] Bezzaoucha S, Voos H, Darouach M, Dentler J. A polytopic approach for the nonlinear unknown input functional observers design: application to a quadrotor aerial robots landing. In: European Control Conference (ECC'16). Aalborg, Danemark; 2016.
[51] Bezzaoucha S, Marx B, Maquin D, Ragot J. State constrained tracking control for nonlinear systems. Journal of the Franklin Institute. 2015;352(7): 2866­2886.

Chapter 13
Robust fault-tolerant control of nonlinear inverted pendulum and cart system with simultaneous actuator and sensor faults
sliding-mode observer
Slim Dhahri1, Ali Ben Brahim1, Fayçal Ben Hmida1 and Anis Sellami1
In this chapter, we propose a robust active fault-tolerant control (AFTC) scheme for a class of uncertain nonlinear systems with simultaneous actuator and sensor faults described via Takagi­Sugeno (T­S) multiple models. First, by transforming the sensor fault into pseudoactuator fault, a novel T­S sliding-mode observer (TS-SMO) with two discontinuous terms is developed to provide separate estimates of the actuator and sensor faults for the purpose of fault compensation. The robustness of the proposed observer against uncertainties has been taken into account via H norm minimization. Second, we use obtained on-line fault estimation information to design dynamic output feedback controller (DOFC) for robustly compensating the effects of actuator and sensor faults from the system inputs and outputs and guarantee the stability of the overall closed-loop system. The stability proof with H performances and D-stability constraints is formulated as a linear matrix inequalities (LMI) optimization problem. The effectiveness of the proposed robust AFTC approach to treat simultaneous actuator and sensor faults is illustrated using a nonlinear inverted pendulum with cart system.
13.1 Introduction
Fault disturbs the normal system operations, thus causing an unacceptable deterioration of these performances or leading to wrong dangerous situations. This fault can occur in any part of the system such as actuators and sensors. Sensor fault degrades the feedback system performances and so touches the control stability. Similarly, actuator fault may lead to minimize the performances of design controllers, or even the overall
1Research Unit on Control, Monitoring and Safety of Systems, Ecole Nationale Supérieure d'Ingénieurs de Tunis (ENSIT), University of Tunis, Tunisia

310 The inverted pendulum in control theory and robotics
system execution. In order to preserve system performances and human security, fault diagnosis (FD) and fault-tolerant control (FTC) technology have caused wide attention over the past few years. A very powerful approach for FD is fault estimation (FE) in the sense that it not only detects and isolates the fault, but determines the size, location and dynamics behavior of the fault along a system trajectories. Therefore, FE is considered a major problem in the modern control theory that received a considerable amount of attention during the past few years. Fruitful results can be found in several excellent books [1­3] and survey papers [4­6].
In practical applications, most of the systems are nonlinear, so it is significant to study FD and FTC of nonlinear systems. For the case of Lipschitz nonlinear systems, LMI-based FTC designs to compensate actuator fault are proposed in [7­9]. The authors in [10,11] addresses the FTC design for Lipschitz nonlinear systems subject to matched uncertainty along with sensor faults using a sliding-mode observer (SMO). Since its excellent ability of nonlinear system description, very interesting approaches have represented these systems under Takagi­Sugeno (T­S) fuzzy form. T­S models have been introduced in [12]. The feature is to understand the overall system behavior by a set of local linear models. Each local model represents the system's operation in a particular area. The local models are then aggregated using an interpolation mechanism by premise variables satisfying the convex sum property. Taking the T­S representation, several attempts have been oriented to the FE and FTC of nonlinear systems, see for instance [13­20].
Thanks to its robustness to uncertainties, special attentions have already been made in the application of SMO design to robust FE and FTC schemes for T­S systems subject to actuator and/or sensor faults [21­27]. In the context of actuator FE, constructing diagnosis model in order to estimate faults is not possible if sensor faults occur simultaneously. The same difficulty is present when trying to estimate sensor faults. Several design methods have been developed in a precise and effective way when actuator and sensor faults estimation is divided on two steps:
Step 1: Actuator FE is proven without considering sensor faults [28­40]. Step 2: Sensor FE is solved without considering actuator faults [41­48].
Nevertheless, in practical systems, it is often the case when actuator and sensor faults occur simultaneously. In this framework, simultaneous FE is highly important. So far, in [49,50], the authors propose simultaneously estimating actuator and sensor faults study for Lipschitz nonlinear systems. Two subsystems are constructed where each one contains a particular class of faults. In [51,52], the problem of simultaneous actuator and sensor FE is considered for linear parameter varying systems. The idea of this work is based on the transformation of sensor fault in order to obtain an augmented actuator fault vector.
The information issued from actuator and sensor FE scheme are used by the FTC module to reconfigure the control law in order to compensate the faults and ensure acceptable system performances. FTC for various forms of T­S model has received considerably increasing attention both in modern research theory and application domains even in faulty situations. Wonderful results can be obtained by [18,53­57].

Robust fault-tolerant control of nonlinear inverted pendulum 311
These studies guarantee the stability of systems with various faults. In addition, the problem of fault-tolerant tracking control is discussed in [58].
Based on the above works, the objective of this chapter is to develop robust AFTC based on FE of simultaneous actuator and sensor faults for T­S fuzzy systems. The main contributions of this chapter are two aspects:
 First, robust TS-SMO with two discontinuous terms is designed for simultaneous actuator and sensor FE.The stability conditions of the proposed observer is studied with Lyapunov theories and LMI convex optimization.
 Second, using the obtained FE, a dynamic output feedback controller (DOFC)based FTC is designed to guarantee the system stability in the presence of actuator and sensor faults.
The remainder of this chapter is organized as follows: In Section 13.2, we introduce nonlinear and T­S model structures of an inverted pendulum from the literature [59]. In Section 13.3, we describe the LMI-based design of the proposed robust T­S fuzzy SMO for both the actuator and sensor fault cases. Section 13.4 presents the design of T­S DOFC scheme to compensate the effect of simultaneous actuator and sensor faults. Simulation example is given in Section 13.5 illustrating the effectiveness of the proposed methods. Finally, Section 13.6 presents some concluding remarks.
13.2 Problem formulation
13.2.1 Motivation
Simultaneous actuator and sensor faults represent a common challenge for AFTC methods. This motivates the proposal of a strategy to ensure system robustness against this challenging and practically probable scenario of simultaneous faults via an estimation and compensation approach. Hence, the objective of this chapter is to develop an AFTC strategy for regulator problems based on robust FE and compensation of simultaneous actuator faults and sensor faults. The compensation process requires two steps. The first is to design a robust TS-SMO with two discontinuous terms able to provide separate estimates of the actuator and/or sensor faults despite the presence of uncertainties. Second, based on the faults estimation, a T­S DOFC is used in order to maintain the performance and stability of the nominal control system during both faulty and fault-free cases. The schematic diagram of this approach is shown in Figure 13.1.
13.2.2 Inverted-pendulum modeling
13.2.2.1 Mathematical model The inverted-pendulum benchmark, in particular, the cart version illustrated in Figure 13.2, has been considered in many references to solve the problem of nonlinear control [59]. The cart with inverted pendulum consists of a moveable carriage with one degree of freedom on which a pendulum is mounted and freely rotatable in driving

312 The inverted pendulum in control theory and robotics

fa(t)

(t)

fs(t)

u(t)

+

+

+

y(t)

Nonlinear system

+

Robust T­S sliding -mode observer

2eq(t) 1eq(t)

T­S sensor fault estimator

f^s(t)

+ ­

­

f^a(t)

+

T­S actuator fault estimator

T­S dynamic output feedback
controller

ycorr(t)

Figure 13.1 Proposed FTC architecture



y

0

x

l

V ­H

mg

H

l

u ­V

Figure 13.2 Nonlinear inverted pendulum and cart system [59]

Robust fault-tolerant control of nonlinear inverted pendulum 313 Table 13.1 Numerical values of parameters of cart with inverted pendulum

Symbol
m M l b  g L

Description
Point mass of the pendulum Mass of the cart Distance from the joint to the mass point m Viscous friction of the joint Cart friction coefficient Gravitational constant Total length of rail

Value
0.2 0.8 0.5 0.06 0.05 9.81 2

Unit
kg kg m N s/rad N s/m ms-2 m

direction. The carriage is driven by a motor that exerts a force F through a belt-drive

transmission.

The process can be described by the following state-space model



 x2 (t)

=

x1 (t) = x2 (t)

g

sin(x1(t))-m l

a

x22 (t )

sin(2x1
2

(t))

-ba

cos(x1

(t))

x4 (t )-a

cos(x1 (t ))(F

-fc

)

4l 3

-m

l

a

cos (x1(t))2



x3 (t) = x4 (t)

x (t) = -m g

a

sin(2x1
2

(t))

+

4mla 3

x22 (t )

sin(x1 (t ))-b

a x4(t)+

4a 3

(F

-fc

)

4

4 3

-m

a

cos (x1(t))2

(13.1)

where x1(t) =  (t), x2(t) = (t), x3(t) = x(t) and x4(t) = x(t) represent angular position of the pendulum, angular velocity of the pendulum, cart position and the cart

velocity, respectively, with a = 1/(m + M ), fc =  sign (x4 (t)) denotes the friction force between the cart and the track, and g denotes the gravitational acceleration. The

external force F is the input u := F and is limited to |F|  Fmax. The parameters and variables of the inverted pendulum on the cart are recorded in Table 13.1.

13.2.2.2 T­S model

In order to prepare for the SMO design, a T­S model is derived using the local

approximation approach [60]. First, we rewrite (13.1) in the form







x1 x2 x3

(t) (t) (t)



=



x4 (t)

x2 (t)

g sin(x1(t))+ba cos(x1(t)) x4(t)

4l 3

-m

l

a

cos (x1(t))2

x4 (t)

-m

g

a

sin(2x1 (t ))
2

-b

a

x4 (t )

4 3

-m

a

cos (x1(t))2

  + 

0

-a cos(x1(t))

4l 3

-m

l

a

cos (x1(t))2

0

4a

3

4 3

-m

a

cos (x1(t))2

 

x(t) A(x(t))

B(x(t))





× u (t) -fc + m l x22 (t) sin (x1 (t))
 (t)
The system is linearized around x1(t) = 0 and x1(t) = ±/4.

(13.2)

314 The inverted pendulum in control theory and robotics

When x1(t) is near zero, the nonlinear equations can be simplified as







x1 x2 x3

(t) (t) (t)



=



x2 (t)

g x1(t)+b a x4(t)

4l 3

-m

l

a

x4 (t)

 0 

 + 

-a

4l 3

-m

l

a

0



(u (t) +  (t))

x4 (t)

-m g a x1(t)-b a x4(t)

4 3

-m

a

4a

3

4 3

-m

a

(13.3)

When x1(t) is near ±/4, the nonlinear equations can be simplified as



x1 (t)



x2 x3

(t) (t)



=

 



g

22 

4l 3

-

ml 2

a

x2 (t) 

x1 (t) +

ba

2 2

4l 3

-

m

l 2

a

x4 (t)

 x4 (t)  + 

0 

-a

2 2

4l 3

-

m

l 2

a

0

 

(u (t) +  (t))

x4 (t)

-m

g

a

2 

4 3

-

ma 2

x1

(t)

-

ba

4 3

-

ma 2

x4 (t)

4a

3

4 3

-

ma 2

(13.4)

Note that (13.3) and (13.4) are now linear systems. We arrive at the following fuzzy model based on the linear subsystems:

Rule1: IF x1(t) is about 0

THEN x(t) = A1x(t) + B1(u(t) +  (t))

Rule2: IF x1(t) is about ± 4

THEN x(t) = A2x(t) + B2(u(t) +  (t))

The matrices Ai and Bi of the local model i = 1, 2 corresponding to rules are





0 10 0

A1

= 

g

4l 3

-m

l

a

0

00 00

ba

4l 3

-m

1

l

a



,

-m g a

4 3

-m

a

00

-b a

4 3

-m

a

0

B1

= 

-a

4l 3

-m

l

a

0



4a

3

4 3

-m

a

(13.5)

 0 10 0 





A2

= 

g

22 

4l 3

-

m

l 2

a

0

00 00

ba

2 2

4l 3

-

m

l 2

a

1

 ,

0 0 - -m

g

a

2 

4 3

-

ma 2

ba

4 3

-

ma 2

0



B2

= 

-a

2 2

4l 3

-

ml 2

a

0



4a

3

4 3

-

ma 2

Membership functions for rules 1 and 2 can be simply defined as

(13.6)

1( (t))

=

1

-

1

1+exp(-14(x1

-

 8

))

1

+

exp(-14(x1

+

 8

))

1( (t)) = 1 - 1( (t))

(13.7) (13.8)

Robust fault-tolerant control of nonlinear inverted pendulum 315

1

0.9 1

0.8

2

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

­0.8 ­0.6 ­0.4 ­0.2

0

x1

0.2 0.4

0.6 0.8

Figure 13.3 Membership functions of two-rule model

and shown in Figure 13.3. The state-space model (13.1) can thus be transformed into

the T­S form



 x(t) = 2 i( (t)) [Aix(t) + Bi(u(t) +  (t))]



y(t)

=

i=1
Cx(t)

(13.9)

The system (13.9) was driven by the control input u = 10 sin (3t). Figure 13.4 shows the response of the real system and its fuzzy approximation.

13.3 Fault reconstruction by sliding-mode observation

13.3.1 System description

We consider the general case where the uncertain T­S model structure is affected by

additive actuator faults fa(t) and sensor faults fs(t)



 x(t) = k i( (t)) [Aix(t) + Biu(t) + Mifa(t) + Di (t)]



y(t)

=

i=1
Cx(t)

+

N

fs(t)

(13.10)

where x(t)  Rn, u(t)  Rm and y(t)  Rp denote, respectively, the state vector, the control inputs and the output vector. Ai  Rn×n, Bi  Rn×m, Mi  Rn×q, Di  Rn×l,

316 The inverted pendulum in control theory and robotics

Angular position of the pendulum (t)

0 -0.1 -0.2 -0.3 -0.4 -0.5 -0.6 -0.7
0 (a)

Angular velocity of the pendulum d/dt

Real system
Fuzzy approximation

0 -0.2 -0.4

-0.6

-0.8

-1

-1.2

-1.4

5

10

Time (s)

-1.6

15

0

(b)

Real system
Fuzzy approximation

5

10

15

Time (s)

Cart position x(t)

60 50 40 30 20 10 0 -10
0 (c)

7

6

Cart velocity

5

4

3

2

Real system

Fuzzy approximation

1

5

10

Time (s)

0

15

0

(d)

Real system
Fuzzy approximation

5

10

15

Time ( s)

Figure 13.4 Comparison between the real (solid) and the fuzzy (dashed) system: (a) trajectory of x1, (b) trajectory of x2, (c) trajectory of x3 and (d) trajectory of x4

C  Rp×n and N  Rp×h are the matrices describing the so-called ith submodel. It
is supposed that rank(C) = p, rank(N ) = h where n > p  q~ (q~ = q + h), the pairs (Ai, Bi) are controllable, and the pairs (Ai, Ci) are observable. fa(t)  Rq represents the vector of actuator faults, and fs(t)  Rh represents the vector of sensor faults. The integer k represents the number of submodels. The weighing functions i are nonlinear and depend on the premise variable  (t) is supposed to be measurable.

Remark 13.1. The T­S model (13.9) of inverted pendulum with cart is a special case of (13.10), while assuming that the uncertainties and actuator fault affect the system in the same direction as the control input; therefore, Di = Bi and Mi = Bi.

Remark 13.2. The common C and N in (13.10) are only a small restriction, since many applications [17,19,20] comprise outputs that are linear in the system states and sensor faults.

The weighting functions satisfy the following convex sum property:

i( (t))  0, i = 1, . . . , k,

k
i( (t)) = 1
i=1

(13.11)

Robust fault-tolerant control of nonlinear inverted pendulum 317

for any  (t). Before starting the main results of this chapter, the following assumptions are made:

Assumption 13.1. The actuator fault distribution matrix Mi in (13.10) satisfies:

rank(CMi) = rank(Mi) = q

(13.12)

Assumption 13.2. All invariant zeros of (Ai, Mi, C) must lie in the open left half of the complex plane, that is

rank

sIn - Ai Mi C0

=n+q

(13.13)

holds for all complex number s with Re(s)  0.

Assumption 13.3. The actuator fault fa(t) and sensor fault fs(t), and the uncertainty vector  (t) satisfy the following norm bounded constraints:

fa(t)  a, fs(t)  s,  (t)  0 where a, s and 0 are three known positive constants.

(13.14)

In order to transform the sensor faults into a fictitious actuator faults, we assume that there exists an orthogonal matrix TR  Rp×p, obtained by the QR transformation of
sensor faults matrix N , such that

TRy(t) :=

y1(t) = C1x(t) y2(t) = C2x(t) + N1fs(t)

(13.15)

where y2(t)  Rh and N1  Rh×h are invertible. To avoid the direct multiplication of the sensor and/or noise by the observer gain,
an augmented system state with output filter states is constructed. The filtered output is given as follows:

w (t) = -Af w(t) + Af y2(t)

= -Af w(t) + Af C2x(t) + Af N1fs(t)

(13.16)

where -Af  Rh×h is any design matrix with stable eigenvalues.

Based on (13.10) and (13.16), an augmented T­S fuzzy system can be formulated

of order (n + h) as



 x¯(t) = k i( (t)) A¯ ix¯(t) + B¯ iu(t) + M¯ ifa(t) + D¯ i (t) + N¯ fs(t)



y¯(t)

=

i=1
C¯ x(t)

(13.17)

where

x¯(t) =

x(t) w(t)

,

y¯(t) =

y1(t) w(t)

,

A¯ i =

Ai 0 Af C2 -Af

,

B¯ i =

Bi 0

,

M¯ i =

Mi 0

,

N¯ =

0 Af N1 ,

D¯ i =

Di 0

,

C¯ =

C1 0 0 Ih

(13.18)

318 The inverted pendulum in control theory and robotics

In order to simultaneously estimate the actuator and sensor faults, we construct the

following TS-SMO:



 x¯^(t) = k i( (t))



y^¯(t)

=

i=1
Cx^¯(t)

A¯ ix^¯(t) + B¯ iu(t) + G¯ l,ie¯y(t) + G¯ n,i1(t)

+ N¯ 2(t) (13.19)

where x¯^(t) is the observer state, y^¯(t) is the observer output and e¯y(t) = y¯(t) - y¯^(t) is the output estimation error. 1(t) and 2(t) are discontinuous switching term necessary to maintain a sliding motion. G¯ l,i and G¯ n,i are appropriate gain matrices. Defining A¯ 0,i = A¯ i - G¯ l,iC¯ and the state estimation error as e¯(t) = x¯(t) - x^¯(t). From
(13.10) and (13.19), the following error system can be obtained:

k
e¯(t) = i( (t)) A¯ 0,ie(t) + M¯ ifa(t) - G¯ n,i1(t) +D¯ i (x, u, t)
i=1
+ N¯ (fs(t) - 2(t))

(13.20)

13.3.2 Existence conditions
For a stable TS-SMO to exist, the following existence conditions in Lemma 13.1 have to be fulfilled.

Lemma 13.1.

1. The observer matching condition for augmented system (13.17)

rank C¯ M¯ i N¯ = rank M¯ i N¯

(13.21)

holds if and only if Assumptions 13.1 holds. 2. Each local model for the system (13.17) is minimum phase, i.e.,

rank

sIn+h - A¯ i M¯ i N¯ C¯ 0 0

= n + q~

(13.22)

holds for all complex number s with Re(s)  0 if and only if Assumption 13.2 holds.

Proof.

1. From the matrices partition of (13.18), it is easy to see that i  [1, . . . , k]

C¯

M¯ i N¯

=

C1Mi 0 0 Af N1

(13.23)

Premultiply C¯ M¯ i N¯

in (13.23) with a nonsingular matrix

Ip-h 0 0 Af-1

, we

obtain

C1Mi 0 0 N1

(13.24)

Robust fault-tolerant control of nonlinear inverted pendulum 319

It follows that

rank C¯ M¯ i N¯ = rank(C1Mi) + rank(N1)

(13.25)

Since N1  Rh×h is full rank, the condition (13.25) will be satisfied if and only if

rank [C1Mi] = rank [CMi] = q

(13.26)

2. Expressing (13.22) in terms of the partitioned matrices of (13.18), it follows that

 i  [1, . . . , k]





sIn - Ai Mi 0

rank  -Af C2 0 Af N1  = n + q + h

(13.27)

C1 0 0

Premultiplying the matrix in (13.27) by the following nonsingular matrix





In 0 0 TR-1

In 0 0  0 0 Ip-h  ,
0 A-f 1 0

(13.28)

we have

rank

sIn - Ai Mi 0 C 0N

=n+q+h

(13.29)

Since N is full rank, we obtain

rank

sIn - Ai Mi C0

= n + rank(Mi)

(13.30)

which must be verified for the original T­S fuzzy system (13.10), s  C such that Re(s)  0.

13.3.3 T­S model in canonical form

The design of a TS-SMO for simultaneous actuator and sensor faults reconstruction for the class of T­S systems (13.17) is carried out in a special canonical form. Consider a nonlinear change of coordinates obtained by combining linear coordinate transformations for each linear system of the T­S fuzzy model (13.17).

x¯1(t) x¯2(t)

k
= T ( )x¯(t) where T ( ) = i( )Ti
i=1

(13.31)

The linear coordinate transformations are obtained from a series of transformations

Ti = T1,iT0. Under conditions (13.21) and (13.22), there always exists a T0 and

T1,i such that the transformed system matrices in (13.18) have the following block

structures:

 A¯ 11,i TiA¯ iTi-1 =  A¯ 211,i
A¯ 221,i

A¯ 12,i  A¯ 22,i  ,

TiB¯ i =

B¯ 1,i B¯ 2,i

Ti M¯ i N¯

=

00 M¯ 2,i N¯ 2 ,

TiD¯ i =

D¯ 1,i D¯ 2,i

(13.32)

320 The inverted pendulum in control theory and robotics

where A¯ 11,i  R(n+h-p)×(n+h-p), D¯ 1,i  R(n+h-p)×l , M¯ 2,i  Rp×q and N¯ 2  Rp×h. Define A¯ 221,i as the top p - (q + h) rows of A¯ 21, the subblocks M¯ 2,i and N¯ 2 when
partitioned have the following structures:

M¯ 2,i =

0 M¯ 22,i

,

N¯ 2 =

0 N¯ 22

(13.33)

where M¯ 22,i  R(q+h)×q and N¯ 2  R(q+h)×h. The output distribution matrix, in the new coordinates, has the following
structure:

C¯ = CTi-1 = 0 C¯ 2 where C¯ 2  Rp×p is nonsingular.

(13.34)

Lemma 13.2. [28] The pair (A¯ 11,i, A¯ 211,i) is detectable if and only if the invariant zeros of (A¯ i, M¯ i N¯ , C¯ ) are stable.

We define the Lyapunov matrix P¯ as

P¯ =

P¯ 1 P¯ 2 P¯ 2T P¯ 3

> 0 where P¯ 2 :=

P¯ 21 0

with P¯ 1  R(n+h-p)×(n+h-p) and P¯ 21  R(n+h-p)×(p-q-h). Then, the error system (13.20) can be partitioned as

(13.35)

k
e¯1(t) = i( (t)) A¯ 11,ie¯1(t) + (A¯ 12,i - G¯ l1,i)e¯2(t) + G¯ n1,i1(t)
i=1
+ D¯ 1,i (t)

(13.36)

k
e¯2(t) = i( (t)) A¯ 21,ie¯1(t) + (A¯ 22,i - G¯ l2,i)e¯2(t) + M¯ 2,ifa(t) + G¯ n2,i1(t)

i=1

+ D¯ 2,i (t) + N¯ 2(fs(t) - 2(t))

(13.37)

where

e¯1(t) e¯2(t)

= T ( )e¯(t),

G¯ l1,i G¯ l2,i

= T ( )G¯ l,i and

G¯ n1,i G¯ n2,i

= T ( )G¯ n,i

(13.38)

In the coordinates of (13.32), let

G¯ n1,i G¯ n2,i

=

-L¯ iC¯ 2-1 C¯ 2-1

and L¯ i = L¯ 1,i 0

(13.39)

where C¯ 2 is obtained in (13.34), and appropriate L¯ 1,i can be obtained using LMIs as discussed later in this section.

Robust fault-tolerant control of nonlinear inverted pendulum 321

In order to identify the sliding motion, it is performing to apply a further change of coordinates according to

TL,i =

In+h-p 0p×(n-p)

L¯ 1,i 0(n-p)×q~ C¯ 2

(13.40)

Then, in the new coordinate system, it is straightforward to see that the transformed system matrices have the form

A~ i =

A~ 11,i A~ 12,i A~ 21,i A~ 22,i

,

M~ i N~

=

00 M~ 2,i N~ 2

D~ i =

D~ 1,i D~ 2,i

,

C~ = 0 Ip

(13.41)

where A~ 11,i = A¯ 11,i + L¯ 1,iA¯ 211,i, M~ 2,i = C¯ 2M¯ 2,i, N~ 2 = C¯ 2N¯ 2 and D~ 2,i = C¯ 2D¯ 2,i. The nonlinear gain matrix will have the form

G~ n1,i G~ n2,i

= TL( )

G¯ n1,i G¯ n2,i

=

0 Ip

(13.42)

and the Lyapunov matrix will be

P~ = (TLT,i)-1P¯ TL-,i1 =

P~ 1 0 0 P~ 0

(13.43)

where P~ 0 = -P¯ 2T P¯ 1-T P¯ 2 + P¯ 3. The error system from (13.36) and (13.37) in the new coordinate system is

k
e~1(t) = i( (t)) A~ 11,ie1(t) + (A~ 12,i - G~ l1,i)ey(t) + D~ 1,i (t)
i=1
k
ey(t) = i( (t)) A~ 21,ie1(t) + (A~ 22,i - G~ l2,i)ey(t) + D~ 2,i (t)
i=1
+ M~ 2,ifa(t) - 1(t) + N~ 2(fs(t) - 2(t))

(13.44) (13.45)

where

e~1(t) ey (t )

= TL( )

e¯1(t) e¯2(t)

and

G~ l1,i G~ l2,i

= TL( )

G¯ l1,i G¯ l2,i

A choice of observer gain G~ l,i from (13.47) is then

G~ l,i =

G~ l1,i G~ l2,i

=

A~ 12,i A~ 22,i - A~ 2s2

(13.46) (13.47) (13.48)

322 The inverted pendulum in control theory and robotics

where A~ s22 is stable design matrix. Substituting (13.48) into (13.44) and (13.45) yields

k
e~1(t) = i( (t)) A~ 11,ie1(t) + D~ 1,i (t)
i=1

(13.49)

k
ey(t) = i( (t)) A~ 21,ie1(t) + A~ 2s2ey(t) + D~ 2,i (t) + M~ 2,ifa(t) - 1(t)
i=1

+ N~ 2(fs(t) - 2(t))

(13.50)

The discontinuous output error injection terms 1(t) and 2(t) are defined by

1(t) :=

 P~ 0ey(t)
a P~ 0ey(t)
0

if ey(t) = 0 otherwise

(13.51)

2(t) :=

 P~ 0ey(t)
s P~ 0ey(t)
0

if e¯y(t) = 0 otherwise

(13.52)

where a and s are positive scalars which will be determined formally later, but loosely speaking, they must be respectively an upper bound on the magnitude of the actuator and sensor fault signal.
The objective now is to present robust SMO with two discontinuous terms for reconstruct both actuator and sensor faults, as well as the T­S fuzzy system states. It will be shown that the sufficient conditions for the stability with H performances of the observer error (13.49) and (13.50) are established by using Lyapunov stability and LMI techniques.
For simplicity, we introduce the following notations

k

k

i = i( (t)), A~ 11() = i( (t))A~ 11,i, A~ 21() = i( (t))A~ 21,i,

i=1

i=1

(13.53)

k

k

M~ 2() = i( (t))M~ 2,i, D~ 1() = i( (t))D~ 1,i,

i=1

i=1

k
D~ 2() = i( (t))D~ 2,i
i=1

Then, the error system from (13.49) and (13.50) can be rewritten as

e~1(t) = A~ 11()e1(t) + D~ 1() (t) ey(t) = A~ 21()e1(t) + A~ s22ey(t) + D~ 2() (t) + M~ 2()fa(t) - 1(t)
+ N~ 2(fs(t) - 2(t))

(13.54) (13.55) (13.56)

Robust fault-tolerant control of nonlinear inverted pendulum 323

Define the controlled estimation error r as

r(t) = H e~(t) = H

e~1(t) ey (t )

(13.57)

where H is a prespecified weight matrix and assumed to have full rank

H :=

H1 0 0 H2

(13.58)

Consider the following worst case performance measure:

H  := sup
 2 =0

r

2 2



2 2

(13.59)

We now present Theorem 13.1 which establishes the sufficient conditions for the

existence of the proposed TS-SMO with a prescribed H performance H   ,

where  function

is a small positive constant. In from the system uncertainty  (t

other words, the ) to the estimation

H  gain of the error r is bounded

tbryansfer.

13.3.4 Sliding motion stability

Theorem 13.1. Under Assumptions 13.1­13.3, the estimation error asymptotically stable with the prescribed H tracking performance r

22dynamicsar22e,

if there exist matrices P~ 1 = P~ 1T > 0, P~ 0 = P~ 0T > 0, and positive scalar  such that

 

1 + H1T H1  

A¯ T21,iC¯ 2T P~ 0 2 + H2T H2
0

P~ 1D¯ 1,i 0
-I

W¯ iD¯ 2,i 

P~ 0C¯ 2D¯ 2,i 0



<

0

(13.60)





0 -I

where 1 = P~ 1A¯ 11,i + A¯ 1T1,iP~ 1 + W¯ iA¯ 21,i + A¯ 2T1,iW¯ iT 2 = A~ s2T2 P~ 0 + P~ 0A~ s22
Once the LMI (13.60) is solved, L¯ i can be obtained from L¯ i = P~ 1-1W¯ i.

(13.61) (13.62)

Proof. Consider the Lyapunov function as

V (t) = e~T (t)P~ e~(t)

(13.63)

It is worth noting that P~ in the new coordinate (13.41) has the quadratic form (13.43). Therefore, the Lyapunov function can be rewritten as

V (t) = V1(t) + V2(t) = e~1T (t)P~ 1e~1(t) + eyT (t)P~ 0ey(t)

(13.64)

324 The inverted pendulum in control theory and robotics
The time derivative of V1(t) along the trajectories of system (13.55) can be shown to be equal to

V1(t) = e~1T (t)P~ 1e~1(t) + e~1T (t)P~ 1e~1(t) = e~1T (t)(A~ T11()P~ 1 + P~ 1A~ 11())e~1(t) + 2e~1T P~ 1D~ 1 (t)

(13.65)

Similarly, we can obtain the time derivative of V2(t) as

V2(t) = eyT (t)(A~ s2T2 P~ 0 + P~ 0A~ 2s2)ey(t) + 2eyT (t)P~ 0A~ 21()e~1(t)

+ 2eyT (t)P~ 0D~ 2() (t) + 2eyT (t)P~ 0M~ 2()fa(t) - 2eyT (t)P~ 01(t)

+ 2eyT (t)P~ 0N~ 2(fs(t) - 2(t))

(13.66)

From the definition of 1(t) in (13.51) and the bound on fa(t), we can obtain

2eyT (t)P~ 0M~ 2()fa(t) - 2eyT (t)P~ 01(t)
k
= i( (t)) 2eyT (t)P~ 0M~ 2,ifa(t) - 2eyT (t)P~ 01(t)
i=1
k
 i( (t)) 2 P~ 0ey(t) i - 2a
i=1

(13.67)

with i := M~ 2,i a. Due to the convexity condition of the T­S membership functions

k

k

i( (t)) = 1 , it holds that i( (t))i  max := M~ 2 a. It thus follows

i=1

i=1

max

from (13.67) that

2eyT (t)P~ 0M~ 2()fa(t) - 2eyT (t)P~ 01(t)  2 P~ 0ey(t) (max - a) = -21 P~ 0ey(t) < 0

(13.68)

where the positive scalar 1 satisfies 1 < a - max. Similarly, from the definition of 2(t) in (13.52) and the bound on fs(t), we can obtain

2eyT (t)P~ 0N~ 2(fs(t) - 2(t))  2 P~ 0ey(t) N~ 2 (s - s)  -22 P~ 0ey(t) N~ 2 < 0

(13.69)

where the positive scalar 2 satisfies s > s + 2.

Robust fault-tolerant control of nonlinear inverted pendulum 325

From (13.68) and (13.69), we can obtain V (t) as

V (t) = V1(t) + V2(t)

 e~1T (t)(A~ T11()P~ 1 + P~ 1A~ 11())e~1(t) + eyT (t)(A~ s2T2 P~ 0 + P~ 0A~ 2s2)ey(t)

+ 2eyT (t)P~ 0A~ 21()e~1(t) + 2e~1T (t)P~ 1D~ 1() (x, u, t)

+ 2eyT (t)P~ 0D~ 2() (t)

= e~1T (t) 1e~1(t) + eyT (t) 2ey(t) + 2eyT (t)P~ 0A~ 21()e~1(t)

+ 2e~1T (t)P~ 1D~ 1() (t) + 2eyT (t)P~ 0D~ 2() (t)

(13.70)

when  (x, u, t) = 0, it follows that

V (t) 

e~1(t) T ey (t )

1 A~ T21()P~ 0

P~ 0A~ 21()

2

e~1(t) ey (t )

(13.71)

If there exists a feasible solution to (13.60), then we can conclude that < 0, thus V (t) < 0. This implies that e~(t)  0 as t  . Therefore, the error dynamics is asymptotically stable when  (x, u, t) = 0.
When  (x, u, t) = 0, to attain the robustness of the proposed TS-SMO to the uncertainties  (x, u, t) in L2 sense, we define

V0(t) = V (t) + rT (t)r(t) -  T (t) (t)

(13.72)

If condition (13.60) is satisfied, it follows that

  

e~1(t)

e~1(t)

V0(t)   ey(t)   ey(t)  < 0

 (t)

 (t)

(13.73)

Then, under zero initial conditions, we obtain the following:







r 2 -   2 dt =

r 2 -   2 + V dt - V dt

0

0

0



=

r 2 -   2 + V dt - V () + V (0)

0



 V (0)dt < 0

(13.74)

0

which implies that

T

T

rT r dt    T  dt

0

0

namely

r

2 2







2 2

This completes the proof.

(13.75) (13.76)

326 The inverted pendulum in control theory and robotics

The state estimation error e~(t) := col(e~1(t), ey(t)) is stable on the sliding mode surface (13.78), then e~1(t) is bounded a long T­S fuzzy system trajectories (13.17). Thus, it has written, as a positive scalar , sup e~1(t)  .
0t
Remark 13.3. The effect of the system uncertainties  (t) on the estimation errors (13.55) and (13.56) is decided by the value of . The accuracy of FE increases with smaller value of . The minimization of  can be found by solving the following LMI optimization problem:
minimize() subject to P~ 1 = P~ 1T > 0, P~ 0 = P~ 0T > 0 and (13.60) (13.77)
The objective now is to determine the constant gain a in (13.51) and s in (13.52) such that the error systems can be driven to the sliding surface S which is defined as

S = e~1(t), ey(t) e~y(t) = 0 in finite time and maintain on it thereafter.

(13.78)

13.3.5 Sliding motion reachability

Theorem 13.2. Given T­S system (13.17) with existence conditions (13.21) and (13.22) and the proposed TS-SMO (13.19). Then, the error dynamics (13.55) and (13.56) can be driven to the sliding surface given by (13.78) in finite time and remain on it if the LMI optimization problem formulated in (13.60) is solvable and the gains a and s satisfy

a + s N~ 2  max + 3

(13.79)

where max := A~ 21,i

+ D~ 2,i 0 + M~ 2,i a + N~ 2 s and 3 is a pos-

max

max

max

itive scalar.

Proof. Consider the Lyapunov function Vs(t) = e~yT (t)P~ 0ey(t). The time derivative of Vs(t) can be obtained as
Vs(t) = eyT (t)(A~ 2sT2 P~ 0 + P2A~ s22)ey(t) + 2eyT (t)P~ 0A~ 21()e~1(t)

+ 2eyT (t)P~ 0D~ 2() (t) + 2eyT (t)P~ 0M~ 2()fa(t) - 2eyT (t)P~ 01(t)

+ 2eyT (t)P~ 0N~ 2(fs(t) - 2(t))

(13.80)

Since A~ 2s2 is a stable matrix by design, therefore, A~ s2T2 P2 + P2A~ 2s2 < 0. Then, (13.80) becomes

Vs(t)  2eyT (t)P~ 0A~ 21()e~1(t) + 2eyT (t)P~ 0D~ 2() (t) + 2eyT (t)P~ 0M~ 2()fa(t)

- 2eyT (t)P~ 01(t) + 2eyT (t)P~ 0N~ 2 (fs(t) - 2(t))

k
= i( (t)) 2eyT (t)P~ 0 A~ 21,ie~1(t) + D~ 2,i (t) + M~ 2,ifa(t) - 1(t)
i=1

+ 2eyT (t)P~ 0N~ 2 (fs(t) - 2(t))

(13.81)

Robust fault-tolerant control of nonlinear inverted pendulum 327

Using Assumptions (13.1)­(13.3) for the T­S fuzzy system (13.10) and the argument above e~1(t)  , the following relations are readily obtained:

2eyT (t)P~ 0A~ 21,ie~1(t)  2 A~ 21,i P~ 0ey(t) 2eyT (t)P~ 0D~ 2,i (t)  2 D~ 2,i P~ 0ey(t) 0 2eyT (t)P~ 0M~ 2,ifa(t)  2 M~ 2,i P~ 0ey(t) a 2eyT (t)P~ 0N~ 2fs(t)  2 N~ 2 Pey(t) s

(13.82) (13.83) (13.84) (13.85)

Applying relations (13.82)­(13.85), the following estimate for Vs(t) holds:

k
Vs(t)  i( (t)) 2 P~ 0ey(t) i - 2eyT (t)P~ 01(t) - 2eyT (t)P~ 0N~ 22(t)
i=1

(13.86)

with i := A~ 21,i + D~ 2,i 0 + M~ 2,i a + N~ 2 s. Due to the convexity

k

condition of the T­S membership functions

i( (t)) = 1 , it holds that

i=1

k

i( (t))i  max := A~ 21,i

+ D~ 2,i 0 + M~ 2,i a + N~ 2 s. It

i=1

max

max

max

thus follows from (13.86) that

Vs(t)  2 P~ 0ey(t) max - 2a P~ 0ey(t) - 2s N~ 2 P~ 0ey(t)

(13.87)

If the condition (13.79) holds, then

Vs(t)  -23 P~ 0ey(t)  -23 min(P~ 0)Vs1/2

(13.88)

where min(P~ 0) is the smallest eigenvalue of P~ 0. This shows that the reachability condition [61] is satisfied. As a consequence, an ideal sliding motion is achieved and maintained after some finite time.
This completes the proof.

Finally, the observer gains in the original coordinates (13.19) are given

G¯ l,i = TL,iTi -1

A~ 12,i A~ 22,i - A~ 2s2

G¯ n,i = TL,iTi -1

0(n+h-p)×p Ip

(13.89) (13.90)

328 The inverted pendulum in control theory and robotics

13.3.6 Simultaneous actuator and sensor faults estimation

Assume the robust TS-SMO in the form of (13.19) has been designed, the objective now is to simultaneously estimate actuator and sensor faults for T­S fuzzy system (13.17). From Theorem 13.2, we know that an ideal sliding motion (13.78) will take place after some finite time if the condition (13.79) is satisfied. During the sliding motion, (13.56) becomes

0 = A~ 21()e~1(t) + D~ 2() (t) + M~ 2()fa(t) - 1eq(t) + N~ 2fs(t) - 2eq(t)

k
= i( (t)) A~ 21,ie~1(t) + D~ 2,i (t) + M~ 2,ifa(t) - 1eq(t)
i=1
+ N~ 2fs(t) - 2eq(t)

(13.91)

where 1eq(t) and 2eq(t) denote the equivalent output error injection signals which are required to maintain a sliding motion. It can be approximated to any degree of accuracy by replacing (13.51) and (13.52) with

1eq = a

P~ 0ey(t) P~ 0ey(t) + 1

(13.92)

and

2eq = s

P~ 0ey(t) P~ 0ey(t) + 2

(13.93)

where 1 and 2 are two small positive scalars to reduce the chattering effect. Let

k
(e~1, x, u) = i( (t)) A~ 21,ie~1(t) + D~ 2,i (t)
i=1

(13.94)

From (13.94), it follows that

k
(e~1, x, u) 2  i( (t))i
i=1

(13.95)

with i := A~ 21,i

+ D~ 2,i 0.

2

2

Due to the convexity condition of the T­S membership functions

k

k

i( (t)) = 1 , it holds that i( (t))i  max := A~ 21

+ D~ 2 0

i=1

i=1

max

max

where . max denotes the maximum of each matrix norm for some i. It thus follows

from (13.95) that

(e~1, x, u)  max Thus, approximately, for a small max,
M~ 2()fa(t) - 1eq(t) + N~ 2 fs(t) - 2eq(t)  0, (t  )

(13.96) (13.97)

Robust fault-tolerant control of nonlinear inverted pendulum 329

k
where M~ 2() := i( )M~ 2,i.
i=1
Note that M~ 2,i N~ 2 is of full column rank, and hence, it can be concluded
that [62]

M~ 2,ifa(t) - 1eq(t)  0, (t  ) fs(t) - 2eq(t)  0, (t  )

(13.98) (13.99)

The analysis above shows that the actuator faults can be estimated from

f^a(t) 

k

+

i( (t))M~ 2,i 1eq(t)

i=1

(13.100)

The sensor faults can be estimated as

f^s(t)  N~ 2+2eq(t) where ()+ denotes a left pseudoinverse.

(13.101)

13.4 Fault-tolerant controller design for T­S fuzzy systems

The goal of this section is to design an AFTC strategy based on robust FE of simultaneous actuator and sensor faults. The proposed strategy is able to guarantee stability and ensure the robustness of the overall closed-loop system. A sufficient condition is formulated via LMI to govern the performance of controller by assigning their eigenvalues in specific LMI region of the complex plan. The proposed strategy uses the T­S DOFC scheme [63,64] to compensate the effects of actuator and sensor faults from the system inputs and outputs and to ensure the robustness against uncertainties. Our controller is delivered by the corrected output which obtained by subtracting the reconstructed sensor faults from the (faulty) outputs (see Figure 13.1).

ycorr(t) = Cx(t) + N fs(t) - N f^s(t) = Cx(t) + N fs(t) - f^s(t)

(13.102)

where the quality of the fault compensation is determined by the quality of the FE, i.e., whether the difference fs(t) - f^s(t) is close to zero. The T­S fuzzy model given in
(13.10) becomes

x(t) = A()x(t) + B()u(t) + M ()fa(t) + D() (t) ycorr(t) = Cx(t) + Nefs(t)

(13.103)

where efs (t) = fs(t) - f^s(t) is the sensor FE error and the system matrices

k

k

k

k

A() = iAi, B() = iBi, M () = iMi and D() = iDi.

i=1

i=1

i=1

i=1

330 The inverted pendulum in control theory and robotics

Based on on-line FE, the T­S DOFC for T­S fuzzy models (13.10) is constructed as follows:

xK (t) = AK (, )xK (t) + BK ()ycorr(t) u(t) = CK ()xK (t) + DK ()ycorr(t) - K ()f^a(t)

(13.104)

where xK (t)  Rn×n is the controller state and f^a(t) is defined in (13.100). AK (, )  Rn×n, BK ()  Rn×p, CK ()  Rm×n and DK ()  Rm×p are the T-SDOFTC matrices
to be designed, and

kk

k

AK (, ) =

ijAK,ij, BK () = iBK,i

i=1 j=1

i=1

(13.105)

k

k

CK () = iCK,i, DK () = iDK,i

i=1

i=1

(13.106)

Substituting (13.103) into (13.104), we obtain the dynamic of the closed-loop system

xK (t) = AK (, )xK (t) + BK ()Cx(t) + BK ()N efs(t) u(t) = CK ()xK (t) + DK ()Cx(t) + DK ()N efs(t) - K()f^a(t)

(13.107)

Combining u(t) in (13.107) with (13.103), we obtain

x(t) = A()x(t) + B()CK ()xK (t) + B()DK ()Cx(t) + B()DK ()N efs(t) + B()K()f^a(t) - M ()fa(t)

+ D() (t)

(13.108)

The gain K() is designed so that the effect of f^a(t) is either completely decoupled from the closed-loop system. In [65], the authors have shown that if Im (M ())  Im (B()), then the decoupling is achieved by selecting K() = B+()M () where B+() is the pseudoinverse of B(). Hence, K() is considered a known gain in the
derivation of the LMI-based FTC design.
We further obtain

x(t) = A()x(t) + B()CK ()xK (t) + B()DK ()Cx(t)

+ B()DK ()N efs(t) + M ()efa(t) + D() (t)

= (A() + B()DK ()C) x(t) + B()CK ()xK (t)

+ B()DK ()N efs(t) + M ()efa(t) + D() (t)

(13.109)

where efa (t) = fa(t) - f^a(t) is the actuator FE error. From (13.103) and (13.107), the following form is obtained

xa(t) = Aa(, )xa(t) + Ea(, )a(t) ycorr(t) = Caxa(t) + Daa(t)

(13.110)

where

Aa(, ) =

A() + B()DK ()C B()CK ()

BK ()C

AK (, )

(13.111)

Robust fault-tolerant control of nonlinear inverted pendulum 331

Ea(, ) =

M () B()DK ()N D() 0 BK ()N 0

(13.112)

Ca =

C 0 , Da =

0 N 0 , xa(t) =

x(t) xK (t)

 efa(t)
, a(t) = efs(t) (13.113)  (t)

Here, we give an FTC design method in which the performances of the controller are
specified by a regional pole assignment and an H performance index. The fuzzy H performance index is formulated as follows: given a scalar K , determine an output feedback fuzzy controller in the form of (13.104) such that

 The closed-loop system described by (13.110) is asymptotically stable when a(t) = 0.
 Under zero-initial condition, the controlled output ycorr(t) satisfies ycorr(t) 2 < K a(t) 2, a(t)  L2 [0, ), a(t) = 0.

Theorem 13.3. The eigenvalues of Aa(, ) are located in the disc region of the negative complex plane characterized by radius(), center() and the closed-loop
system (13.110) is stable with guaranteed H performance and with an attenuation level K , if there exist symmetric positive definite matrices X , Y  Rn×n and matrices A^ Kij  Rn×n, B^ Ki  Rn×p, C^ Ki  Rm×n, D^ Ki  Rm×p (i, j = 1, . . . , k) such that the
following inequalities hold

minimize(K ) subject to





ii < 0, i = 1, . . . , k, ij + ji < 0, 1  i < j  k,



ii < 0, i = 1, . . . , k, ij + ji < 0, 1  i < j  k

(13.114)

with

 -X

-I

AiX + BiC^ Kj + X

Ai + BiD^ KjC + I 

ij

=



-I 

-Y 

A^ Kij + I -X

Y Ai

+

B^ KiC -I

+

Y



<

0

(13.115)



-I

-Y

and



11

ij = 

   

12 Mi BiD^ KiN Di

22 Y Mi B^ KiN Y Di

 -K Iq 0

0

  -K Ih 0



 -K Il

X CT CT 0 NT 0

  < 0

 



 -K Ip

(13.116)

332 The inverted pendulum in control theory and robotics

11 = AiX + XAiT + BiC^ Kj + C^ KTjBiT 12 = A^ TKij + Ai + BiD^ KijC 22 = Y Ai + AiT Y T + B^ KiC + CT B^ KTi

(13.117) (13.118) (13.119)

The controller gain matrices are calculated by

DKi = D^ Ki

(13.120)

CKi = (C^ Ki - DKiCX )Q-T

(13.121)

BKi = S-1(B^ i - Y BiDK i)

(13.122)

AKij = S-1(A^ Kij - Y (Ai + BiD^ KiC)X )Q-T - S-1Y BiCKj - BKiCX Q-T

(13.123)

where Q,S  Rn×n satisfy QST = I - XY .

Proof. Consider the following candidate Lyapunov function:

V3(t) = eaT (t)Paea(t)

(13.124)

where Pa is a symmetric positive definite matrix. Its derivative with respect to time is
V3(t) = x~aT (t) ATa (, )Pa + PaAa(, ) + 2eaT (t)PaEa(, )a(t) (13.125)
The robustness of the controller against the augmented input a(t) can then be represented by minimizing the mathematical objective given below:



J=

y2 a 2



K

=

1 K

ycTorr

(t

)ycorr

(t)

-

K

aT

(t

)a(t)

dt  0

0

(13.126)

It can be shown that



J

V 3 (t )

+

1 K

ycTorr (t )ycorr (t )

-

K aT (t)a(t)

dt

0

(13.127)

Subsequently, a sufficient condition for (13.126) is

V 3 (t )

+

1 K

ycTorr (t )ycorr (t )

-

K aT (t)a(t)

<

0

(13.128)

Robust fault-tolerant control of nonlinear inverted pendulum 333

Substituting (13.125) into (13.128), one obtains

V 3 (t )

+

1 K

ycTorr (t )ycorr (t )

-

K aT (t)a(t)

= xaT (t) AaT (, )Pa + PaAa(, ) xa(t) + 2xaT (t)PaEa(, )a(t)

+

1 K

yT

(t)y(t)

-

K

aT

(t)a(t)

= xaT (t) ATa (, )Pa + PaAa(, ) xa(t) + 2xaT (t)PaEa(, )a(t)

+

1 K

xaT (t)CaT Caxa(t)

+

2 K

xaT (t)CaT Da()a(t)

+

1 K

aT

(t)DaT

()Da()a(t)

-

K

aT

(t)a(t)

=  T (t) T < 0

(13.129)

where

(t) =

xa(t) a(t)

and

=

11 12
 22

(13.130)

with

11

=

PaAa(,

)

+

ATa (,

)Pa

+

1 K

CaT Ca

12

=

PaEa(,

)

+

1 K

CaT Da()

22

=

1 K

DaT ()Da()

-

K I

Using the Schur complement, < 0 is equivalent to







PaAa(,

)

+ 

ATa

(,

)Pa

PaEa(, ) -K I

CaT DaT ()



<

0





-K I

(13.131) (13.132) (13.133)
(13.134)

Let us define the symmetric positive definite matrix Pa and its inverse matrix Pa-1

Pa =

YS ST W

and Pa-1 =

XQ QT Z

(13.135)

Due to PaPa-1 = I2n, one gets

Pa

X QT

=

In 0

and Pa

X In QT 0

=

In Y 0 ST

(13.136)

We will also define the matrices

1=

XI QT 0

,

2 = Pa

1=

IY 0 ST

(13.137)

334 The inverted pendulum in control theory and robotics

Pre- and postmultiplying (13.134) by diag

T 1

,

I

,

I

and its transpose in the above

inequality, we get





T 1

PaAa(, ) + ATa (, )PaT







1+

T 1

PaEa

(,

)

-K I

T 1

CaT

DaT



<

0



-K I

(13.138)

we have

T 1

PaAa(,

)

1=

A()X + B() DK ()CX + CK ()QT Y A() + B()DK ()C X + YB()CK ()QT + SAK (, )QT

A() + B()DK ()C YA() + YB()DK () + SBK () C

(13.139)

T 1

PaEa(,

)

=

M ()

B()DK ()N

D()

YM () YB()DK () + SBK () N YD()

(13.140)

T 1

CaT

=

X CT CT

Let the variable change
A^ K (, ) = Y A() + B()DK ()C X + YB()CK ()QT + SBK ()CX + SAK (, )QT
B^ K () = YB()DK () + SBK () C^ K () = CK ()QT + DK ()CX D^ K () = DK ()

Substituting them into (13.138) yields



11

= 

   



12 M () B()D^ K ()N

D()

 X CT

22 YM ()  -K Iq  

B^ K ()N 0
-K Ih 

YD() 0 0
-K Il

CT 0 NT 0

 < 0





 -K Ip

where
11 = A()X + X AT () + B()C^ K () + C^ KT ()BT () 12 = A^ KT (, ) + A() + B()D^ K ()C 22 = YA() + AT ()Y T + B^ K ()C + CT B^ KT ()

(13.141)
(13.142) (13.143) (13.144) (13.145)
(13.146)
(13.147) (13.148) (13.149)

Robust fault-tolerant control of nonlinear inverted pendulum 335 Therefore, < 0 can be rewritten as

kk

=

i( )j( ) ij

i=1 j=1

k

kk

= i2( ) ii +

i( )j( )

i=1

i=1 i<j

ij + ji < 0

(13.150)

Then, (13.116) can be obtained easily. To prove LMI (13.115), we first need the following lemma from [66].

Lemma 13.3. The matrix A is D-stable if and only if there exists a symmetric matrix X such that

-X X + XA X + (XA)T -X

< 0, X > 0

(13.151)

By using (13.151) of Lemma 13.3 and the variable change A = AK (, ), X = Pa, one has

-Pa

Pa + PaAa(, )

Pa + (PaAa(, ))T

-Pa

<0

(13.152)

Then, by pre- and postmultiplying by diagonal diag(

T 1

,

T 1

)

and

its

transpose,

respectively, and then using the definition A^ K (, ), B^ K (), C^ K () and D^ K (), one

gets





-X -I 11 12

:=



-I 

-Y 

13 -X

14 -I



<0

(13.153)

  -I -Y

where
11 = A()X + B()C^ K () + X 12 = A() + B()D^ K ()C + I 13 = A^ K (, ) + I 14 = YA() + B^ K ()C + Y

(13.154) (13.155) (13.156) (13.157)

which can be rewritten as

kk

=

i( )j( ) ij

i=1 j=1

k

kk

= i2( ) ii +

i( )j( )

i=1

i=1 i<j

ij + ji < 0

(13.158)

336 The inverted pendulum in control theory and robotics
So if (13.115) and (13.116) hold, then the DOFC (13.107) makes the T­S fuzzy system (13.103) asymptotically stable with H performance bound K . Thus, the proof is complete.

13.5 Simulation results

To illustrate the proposedAFTC strategy encompassing the possibility of simultaneous

actuator and sensor faults, consider the inverted pendulum and cart system presented

in Section 13.2.2. The submodel matrices Ai, Bi(i = 1, 2) are given by





0 10 0

A1

=



17.3118 0

0 0

0 0

0.0882 1

 ,

-1.7312 0 0 -0.0441





0

B1

=



-1.7647 0



1.1765

(13.159)





0 10 0

A2

=



14.3223 0

0 0

0 0

0.0573 1

 ,

-1.0127 0 0 -0.0405





0

B2

=



-1.1467 0



1.0811

(13.160)





1000

C =0 1 0 0

0011

(13.161)

In order to point up the proposed approach, additional actuator and sensor faults are used and are injected to the T­S model as



 x(t) = 2 i( (t)) (Aix(t) + Bi(u(t) +  (t)) + Mifa(t))



y(t)

=

i=1
Cx(t)

+

N

fs(t)

(13.162)

It is assumed here that the actuator fault affects the system in the same direction as

the control input; therefore, Mi = Bi. Also, an additive cart position sensor fault has been introduced and

 0
N =1

(13.163)

0

It can be easily shown that  i  [1, 2], (Ai, Mi, C) is minimum phase and rank(CMi) = rank(Mi). It deserves to note that n > p  q~, so the TS-SMO method presented in Section 13.3.4 can be used for this system to achieve simultaneous actuator and sensor
faults estimation.

Robust fault-tolerant control of nonlinear inverted pendulum 337

13.5.1 TS-SMO design

Suitable choice of the matrix TR from (13.15) can be shown to be





0 01

TR =  -1 0 0

0 -1 0

where we have N1 = -1

0 011 C1 = -1 0 0 0

(13.164) (13.165)

C2 = 0 0 -1 0

The design parameters were chosen as Af = 1, A~ s22 = diag(-3, -5, -7), H1 = I2×2 and H2 = I3×3. By solving the LMI conditions given in Theorem 13.1, we find that

 = 0.8619,

L1 =

1.2064 0 0 4.2188 0 0

,

L2 =

0.4117 0 0 0.6566 0 0

(13.166)

The T­S fuzzy SMO gains are given by





-0.0015 -0.7086 0

Gl,1

=

103

×



-0.0044 0.0010 0.0030

-3.5684 1.5126 -1.8724

0 0 0



0

-0.3782 0.0060

(13.167)





0

-1

0

Gn,1

=



-1.5000 0 1

-703.5529 378.1567 -378.1567

0 0 0



0

0

1

(13.168)





-1.0607 -5.0000 0

Gl,2

=



-3.1246 1.0000 2.9595

-14.3223 0 1.0127

0 0 0



,

0

0

6





0

-1 0

Gn,2

=



-1.0607 0 1

0 0 0

0 0 0



0

01

(13.169)

First, it is assumed that actuator and sensor faults are created, respectively, as

fa(t) =

0

t<2

0.5 sin((t - 2)) t  2

(13.170)

fs(t) =

0 1

t<5 t5

(13.171)

338 The inverted pendulum in control theory and robotics

Actuator fault (N) Sensor fault (m)

0.6 0.4 0.2
0 -0.2 -0.4 -0.6 -0.8
0 (a)

1.2

1

0.8

0.6

0.4

0.2

Real actuator fault Estimated actuator

0

fault

-0.2

5

10

15

0

Time (s)

(b)

Real sensor fault Estimated sensor
fault

5

10

15

Time (s)

Figure 13.5 Simultaneously actuator and sensor faults estimation: (a) actuator fault estimation and (b) sensor fault estimation

Simulations are performed with



initial

conditions

x10

=

 20

,

x20

=

0,

x30

=

1

and

x40

=

0,

 uncertainties are assumed to be  (x, u, t) = mlx22 sin(x1) - csign(x4) where c

is the cart friction coefficient.

 a = 10, s = 7, a = 0.1, s = 0.01.

13.5.2 Simultaneous faults estimation design
Figure 13.5(a) is concerned with the actuator FE. It shows that the proposed TS-SMO can reject the effects of system uncertainties successfully and accurately estimate the actuator fault. Additive cart position sensor fault has been introduced to show the ability of the proposed strategy to handle simultaneous faults. The sensor FE is shown in Figure 13.5(b). It can be seen that despite the presence of uncertainties, the proposed method could still track the sensor fault fs(t).

13.5.3 TS-DOFC design

Solving the LMI conditions in Theorem 13.3 with the circle region D(3, 3) gives





6.4317 -20.1433 1.2865 -5.6488

X

=



-20.1433 1.2865

64.0667 -3.3509

-3.3509 4.9831

15.6849 -5.4158



,

(13.172)

-5.6488 15.6849 -5.4158 11.5707





0.0461 -0.0072 -0.0101 -0.0098

Y

=

105

×



-0.0072 -0.0101

0.0013 0.0018

0.0018 0.0017 584.0238 0.0024

 ,

-0.0098 0.0017 0.0024 0.0022

(13.173)

Robust fault-tolerant control of nonlinear inverted pendulum 339





-75.1259 0.0334 0 0

Q

=

106

×



195.6623 -291.0231

-0.1127 -0.0562

0 0

0 0



,

316.2868 0.0260 0 0

(13.174)





0.0216 -96.4039 26.5362 1.4535

S

=

10-2

×



-0.0035 100

15.9460 0.0224

62.1326 0

-76.7155 0



-0.0047 21.2605 73.7250 64.1297

(13.175)

The minimum attenuation value is K = 3.1005. The method of Theorem 13.3 provides the following fuzzy DOFC:

22

2

xK (t) =

i( )j( )AKijxK (t) + i( )BKiy(t)

i=1 j=1

i=1

2
u(t) = i( ) CKixK (t) + DKiy(t) - Kif^a(t)
i=1

where





-0.9997 -1.3840 -5.4200 -2.1335

AK 11

=

AK 12

=



0.0014 0

-7.2931 0.0214

-11.8617 -4.1859

-25.9868 0.3172



0

0

-0.0004 -4.6543





-0.9999 -0.6025 -1.9098 -88.6122

AK 21

=

AK 22

=



0.0006 0

-4.0112 0.0559

0.9529 -4.1308

-266.5920 -27.4326



0

0

0.0003 -4.5991





0.0570 0.0006 -584.0401

BK 1

=

105

×



0.2641 -0.0017

0.0030 0

-0.2144 0



0

0

0





0

-0.0006 -584.0336

BK 2

=

105

×



0.0245 -0.0042

-0.0026 0

-0.1873 0.0003



0

0

0

(13.176) (13.177) (13.178) (13.179) (13.180) (13.181)

CK1 = CK2 = 10-3 × 0.0022 -9.6078 -37.5980 -121.7464 ,

DK1 = DK2 = 74.1897 0.4200 -7.7610

(13.182)

Figure 13.6(a)­(c) illustrates a comparison between the outputs of the fault-free model (i.e., without any fault), the outputs of the faulty system without FTC and finally the

340 The inverted pendulum in control theory and robotics

Output y1(t) Output y2(t)

0.2 0.15 0.1 0.05
0 -0.05 -0.1 -0.15 -0.2 -0.25
0 (a)

1.4

Free faults

With fault without AFTC

1.2

With fault with AFTC 1

0.8

0.6

0.4

0.2

0

-0.2

-0.4

5

10

15

0

Time (s)

(b)

Free faults With fault without AFTC With fault with AFTC

5

10

15

Time (s)

Output y3(t)

2.5 2
1.5 1
0.5 0
-0.5 -1 0
(c)

Free faults With fault without AFTC With fault with AFTC

5

10

15

Time (s)

Figure 13.6 Outputs of the closed-loop system with the proposed FT control: nominal output, output without AFTC and output with AFTC: (a) output y1(t), (b) output y2(t) and (c) output y3(t)

outputs with our proposed FTC. It can be noticed that the outputs without FTC do not converge to the fault-free dynamic: it underlines that the system is perturbed by both actuator and sensor faults, and it is not robust against such faults. The proposed T­S fuzzy SMO under the FTC (13.107) makes the system robust against actuator and sensor faults, since the outputs' trajectories of the system with FTC reach the outputs of nominal model.
13.6 Conclusion
This chapter proposes a FTC scheme for a class of uncertain nonlinear systems described by Takagi­Sugeno (TS) fuzzy representation. The aim of this FTC focuses on the compensation of simultaneous actuator and sensor faults effects by using a robust SMO technique. We present robust H faults reconstruction scheme for T­S fuzzy system subject both to actuator, sensor faults and disturbances. An augmented system has been constructed by assuming the sensor faults as an auxiliary

Robust fault-tolerant control of nonlinear inverted pendulum 341
actuator faults. So that, the proposed TS-SMO with two discontinuous terms has been performed by the search of suitable Lyapunov matrices in order to decouple the simultaneous faults. The LMIs conditions have been formulated by using convex optimization technique for minimizing the disturbance attenuation level. Finally, simulation results are presented to verify the effectiveness of the proposed method in this design framework. The extension of our work to FTC of T­S systems is under study. The effectiveness of the proposed FTC approach to treat simultaneous faults is illustrated by considering a parametric change position sensor and linear time-varying fault frequencies on the cart actuator.
References
[1] Isermann R., Fault-Diagnosis Applications: Model-Based Condition Monitoring: Actuators, Drives, Machinery, Plants, Sensors, and Fault-Tolerant Systems, Springer Science and Business Media, 2011.
[2] Chen J., Patton R.J., Robust Model-Based Fault Diagnosis for Dynamic Systems, Springer Science and Business Media, 2012.
[3] Alwi H., Edwards C., Tan C.P., Fault Detection and Fault-Tolerant Control Using Sliding Modes, Springer Science and Business Media, 2011.
[4] Gao Z., Cecati C., Ding S.X., A survey of fault diagnosis and faulttolerant techniques ­ Part I: fault diagnosis with model-based and signal-based approaches, IEEE Transactions on Industrial Electronics, 2015, 62, (6), pp. 3757­3767.
[5] Ding S.X., Integrated design of feedback controllers and fault detectors, Annual Reviews in Control, 2009, 33, pp. 124­135.
[6] Wang J., H fault-tolerant controller design for networked control systems with time-varying actuator faults, International Journal of Innovative Computing, Information and Control, 2015, 11, pp. 1471­1481.
[7] Khosrowjerdi M.J., Barzegary S., Fault tolerant control using virtual actuator for continuous-time Lipschitz nonlinear systems, International Journal of Robust and Nonlinear Control, 2014, 24, (16), pp. 2597­2607.
[8] Yang J., Zhu F., Wang X., Bu X., Robust sliding-mode observer-based sensor fault estimation, actuator fault detection and isolation for uncertain nonlinear systems, International Journal of Control, Automation and Systems, 2015, 13, (5), pp. 1037­1046.
[9] Assidi M., Ben Brahim A., Dhahri S., Ben Hmida F., Simultaneous Actuator and Sensor faults tolerant control for uncertain linear Systems, IEEE Conference on Control, Automation and Diagnosis, 2017.
[10] Zhang J., Swain A.K., Nguang S.K., Robust sensor fault estimation and faulttolerant control for uncertain Lipschitz nonlinear systems, Proceedings of the American Control Conference, 2014, pp. 5515­5520.
[11] Assidi M., Ben Brahim A., Dhahri S., Ben Hmida F., Sensor fault tolerant control for uncertain linear systems, IEEE International Conference on Sciences and Techniques of Automatic Control Engineering, 2016.

342 The inverted pendulum in control theory and robotics
[12] Takagi T., Sugeno M., Fuzzy identification of systems and its applications to modeling and control, IEEE Transactions on Systems, Man and Cybernetics, 1985, 15, (1), pp. 116­132.
[13] Aouaouda S., Chadli M., Cocquempot V., Tarek Khadir M., Multi-objective H-/H fault detection observer design for Takagi­Sugeno fuzzy systems with unmeasurable premise variables: descriptor approach, International Journal of Adaptive Control and Signal Processing, 2013, 27, (12), pp. 1031­1047.
[14] Wu H.-N., Zhang H.-Y., Reliable mixed L2/H fuzzy static output feedback control for nonlinear systems with sensor faults, Automatica, 2005, 41, (11), pp. 1925­1932.
[15] Yang G.-H., Wang H., Fault detection and isolation for a class of uncertain state-feedback fuzzy control systems, IEEE Transactions on Fuzzy Systems, 2015, 23, (1), pp. 139­151.
[16] Wang H., Ye D., Yang G.-H., Actuator fault diagnosis for uncertain T­S fuzzy systems with local nonlinear models, Nonlinear Dynamics, 2014, 76, (4), pp. 1977­1988.
[17] Ichalal D., Marx B., Ragot J., Maquin D., Fault detection, isolation and estimation for Takagi­Sugeno nonlinear systems, Journal of the Franklin Institute, 2014, 351, (7), pp. 3651­3676.
[18] Zhang K., Jiang B., Dynamic output feedback fault tolerant controller design for Takagi­Sugeno fuzzy systems with actuator faults, IEEE Transactions on Fuzzy Systems, 2010, 18, (1), pp. 194­201.
[19] Gao Z.F., Jiang B., Shi P., Xu Y.F., Fault accommodation for near space vehicle attitude dynamics via T-S fuzzy models, International Journal of Innovative Computing, Information and Control, 2010, 6, (11), pp. 4843­ 4856.
[20] Zhao Y., Lam J., Gao H., Fault detection for fuzzy systems with intermittent measurements, Fuzzy Systems IEEE Transactions, 2009, 17, (2), pp. 398­410.
[21] Akhenak A., Chadli M., Ragot J., Design of a sliding mode fuzzy observer for uncertain Takagi­Sugeno fuzzy model: application to automatic steering of vehicles, International Journal Vehicle Autonomous Systems, 2007, (5), pp. 288­305.
[22] Akhenak A., Chadli M., Ragot J., Maquin D., Fault detection and isolation using sliding mode observer for uncertain Takagi­Sugeno fuzzy model, IEEE Mediterranean Conference on Control and Automation, Ajaccio, 2008, pp. 286­291.
[23] Xu D., Jiang B., Shi P., Nonlinear actuator fault estimation observer: an inverse system aproach via a T­S fuzzy model, International Journal of Applied Mathematics and Computational Science, 2012, 22, (1), pp. 183­196.
[24] Ichalal D., Marx B., Ragot J., Maquin D., Simultaneous state and unknown inputs estimation with PI and PMI observers for Takagi Sugeno model with unmeasurable premise variables, IEEE Mediterranean Conference on Control and Automation, 2009, pp. 353­358.

Robust fault-tolerant control of nonlinear inverted pendulum 343
[25] Ichalal D., Marx B., Ragot J., Maquin D., State estimation of nonlinear systems using multiple model approach, American Control Conference, ACC 2009, Jun 2009, St Louis, Missouri, United States, pp. 4636­4641.
[26] Hamdi H., Rodrigues M., Mechmeche C., Belhadjbraiek N., Robust fault detection and estimation for descriptor systems based on multi-models concept, International Journal of Control, Automation, and Systems, 2012, 10, (6), pp. 1260­1266.
[27] Ghorbel H., Souissi M., Chaabane M., Hajjaji A., Observer design for fault diagnosis for the Takagi­Sugeno model with unmeasurable premise variables, IEEE Mediterranean Conference on Control and Automation, 2012, pp. 303­308.
[28] Edwards C., Spurgeon S. K., Patton R. J., Sliding mode observers for fault detection and isolation, Automatica, 2000, 36, pp. 541­553.
[29] Ng K.Y., Tan C.P., Edwards C., Kuang Y.C., New results in robust actuator fault reconstruction for linear uncertain systems using sliding mode observers, International Journal of Robust and Nonlinear Control, 2007, 17, pp. 1294­ 1319.
[30] Dhahri S., Sellami A., Benhmida F., Fault detection and reconstruction via both full-order and reduced-order sliding mode observers for uncertain nonlinear systems, IEEE Conference on Modelling, Identification and Control, 2015, DOI: 10.1109/ICMIC.2015.7409425.
[31] Dhahri S., Sellami A., Benhmida F., Robust H sliding mode observer design for fault estimation in a class of uncertain nonlinear systems with LMI optimization approach, International Journal of Control, Automation and Systems, 2012, 10, (5), pp. 1032­1041.
[32] Dhahri S., Sellami A., Benhmida F., Robust H sliding mode observer design for fault estimation in a class of uncertain nonlinear systems with LMI optimization approach, IEEE Mediterranean Electrotechnical Conference, 2012, pp. 450­454.
[33] Dhahri S., Sellami A., Benhmida F., Robust sliding mode observer-based fault reconstruction for uncertain linear systems, American Journal of Applied Sciences, 2011, 8, (10), pp. 1032­1040.
[34] Raoufi R., Marquez H.J., Zinober A.S.I., H sliding mode observers for uncertain nonlinear Lipschitz systems with fault estimation synthesis, International Journal of Robust and Nonlinear Control, 2010, 20, pp. 1785­1801.
[35] Xing G.Y., Edwards C., Nonlinear robust fault reconstruction and estimation using a sliding mode observer, Automatica, 2007, 40, pp. 1605­1614.
[36] JunqiY., State and unknown information estimation for non-linear systems with both input uncertainty and output disturbance, IMA Journal of Mathematical Control and Information, 2016, 33, (2), pp. 427­439.
[37] Junqi Y., Fanglai Z., Xiaojie S., State estimation and simultaneous unknown input and measurement noise reconstruction based on associated observers, International Journal of Adaptive Control and Signal Processing, 2013, 27, pp. 846­858.

344 The inverted pendulum in control theory and robotics
[38] Dong J.L., Youngjin P., Youn-sik P., Robust sliding mode descriptor observer for fault and output disturbance estimation of uncertain systems, IEEE Transactions on Automatic and Control, 2012, 57, (11), pp. 2928­2934.
[39] Veluvolu K.C., Soh Y.C., Fault reconstruction and state estimation with sliding mode observers for Lipschitz non-linear systems, IET Control Theory and Applications, 2010, 5, (11), pp. 1255­1263.
[40] Corless M., Tu J., State and input estimation for a class of uncertain systems, Automatica, 1998, 34, pp. 757­764.
[41] Tan C.P., Edwards C., Sliding mode observers for detection and reconstruction of sensor faults, Automatica, 2002, 38, pp. 1815­1821.
[42] Alwi H., Edwards C., Tan C.P., Sliding mode estimation schemes for incipient sensor faults, Automatica, 2009, 45, pp. 1679­1685.
[43] Xing G.Y., Edwards C., Sensor fault detection and isolation for nonlinear systems based on a sliding mode observer, International Journal of Adaptive Control and Signal Processing, 2007, 21, pp. 657­673.
[44] Zhang J., Swain A.K., Nguang S.K., Detection and isolation of incipient sensor faults for a class of uncertain non-linear systems, IET Control Theory and Applications, 2012, 6, (12), pp. 1870­1880.
[45] Zhang J., Akshya K.S., Nguang S.K., Robust sensor fault estimation scheme for satellite attitude control systems, Journal of the Franklin Institute, 2013, 350, (9), pp. 2581­2604.
[46] Zhang K., Jiang B., Peng S., Observer-Based Fault Estimation and Accommodation for Dynamic Systems, Springer Heidelberg, New York, Dordrecht, London, 2013.
[47] Khosrowjerdi M.J., Robust sensor fault reconstruction for Lipschitz nonlinear systems, Mathematical Problems in Engineering, 2011, 2011, doi:10.1155/2011/146038.
[48] Michael D., Kalyana C.V., Jagat J.R., Mohamed D., Adaptive sensor and actuator fault estimation for a classof uncertain Lipschitz nonlinear systems, International Journal of Adaptive Control and Signal Processing, 2016, 30, pp. 271­283.
[49] Zhang J., Akshya K.S., Nguang S.K., Simultaneous robust actuator and sensor fault estimation for uncertain non-linear Lipschitz systems, IET ControlTheory and Applications, 2014, 8, (14), pp. 1364­1374.
[50] Ben Brahim A., Dhahri S., Ben Hmida F., Sellami A., Simultaneous actuator and sensor faults reconstruction for Lipschitz nonlinear systems, IEEE Conference on Systems and Control, 2015, pp. 97­103. DOI: 10.1109/ICoSC. 2015.7153276.
[51] Li X., Zhu F., Simultaneous time-varying actuator and sensor fault reconstruction based on PI observer for LPV systems, International Journal of Adaptive Control and Signal Processing, 2014, 29, (9), pp. 1086­1098.
[52] Ben Brahim A., Dhahri S., Ben Hmida F., Sellami A., Simultaneous actuator and sensor faults reconstruction using polytopic sliding mode observer for linear parameter varying systems, IEEE Conference on Sciences and Techniques

Robust fault-tolerant control of nonlinear inverted pendulum 345
of Automatic Control and Computer Engineering, 2013, pp. 480­486. DOI: 10.1109/STA.2013.6783175. [53] Zhang K., Jiang B., Shi P., A new approach to observer-based fault-tolerant controller design for Takagi­Sugeno fuzzy systems with state delay, Circuits, Systems and Signal Processing, 2009, 28, (5), pp. 679­697. [54] Han J., Zhang H., Wang Y., Liu Y., Disturbance observer based fault estimation and dynamic output feedback fault tolerant control for fuzzy systems with local nonlinear models, ISA Transactions, 2009, 59, pp. 114­124. [55] Dong J., Yang G.-H., Reliable state feedback control of T­S fuzzy systems with sensor faults, IEEE Transactions on Fuzzy Systems, 2015, 23 (2), pp. 421­433. [56] Ben Brahim A., Dhahri S., Ben Hmida F., Sellami A., Simultaneous actuator and sensor faults reconstruction based on robust sliding mode observer for a class of nonlinear systems, Asian Journal of Control, 2017, 19, (1), pp. 1­10. [57] Ben Brahim A., Dhahri S., Ben Hmida F., Sellami A., H sliding mode observer for Takagi­Sugeno nonlinear systems with simultaneous actuator and sensor faults, International Journal of Applied Mathematics and Computer Sciences, 2015, 25, (3), pp. 547­559. [58] Aouaouda S., Chadli M., Khadir M.T., Bouarar T., Robust fault tolerant tracking controller design for unknown inputs T­S models with unmeasurable premise variables, Journal of Process Control, 2012, 22, (5), pp. 861­872. [59] Ogata K., Modern Control Engineering, 3rd ed. Englewood Cliffs, NJ: Prentice-Hall, 1997. [60] Teixeira M.C.M., Zak S.H., Stabilizing controller design for uncertain nonlinear systems using fuzzy models, IEEE Transaction on Fuzzy Systems, 7 (2), pp. 133­142, 1999. [61] Utkin V.I., Sliding Modes in Control Optimization, 1992, Springer, Berlin. [62] Chen W., Saif, M., Observer-based strategies for actuator fault detection, isolation and estimation for certain class of uncertain nonlinear systems, IET Control Theory & Applications, 2007, 1(6), pp. 1672­1680. [63] Dong J., Yang G.H., Dynamic output feedback H control synthesis for discretetime T­S fuzzy systems via switching fuzzy controllers, Fuzzy Sets and Systems, 2009, 160(4), pp. 482­499. [64] Li J., Wang H.O., Niemann D., Tanaka K., Dynamic parallel distributed compensation for Takagi­Sugeno fuzzy systems: an LMI approach, Information Sciences, 2000, 123(3­4), pp. 201­221. [65] Gao Z., Antsaklis P. J., Reconfigurable control system design via perfect model following, International Journal of Control, 1992, 56, pp. 783­798. [66] Chilali M., Gahinet P., H design with pole placement constraints: an LMI approach, IEEE Transactions Automatic Control, 1996, 41, (3), pp. 358­367.

Chapter 14
LMI-based control design for balancing and attitude stabilization of inverted pendulums
Magdi S. Mahmoud1
Abstract
This chapter explores the dynamic modeling and feedback stabilization of different types of inverted pendulums (IPs). It contains a theoretical analysis of the system dynamics and control methods, as well as a summary of MATLAB®/Simulink® simulation results. There are two primary objectives of this chapter: 1. To provide technical results pertaining to robust control-design approaches
using convex optimization methods over linear-matrix inequalities. The design approaches include linear quadratic regulator (LQR), linear quadratic regulator with integral gain (LQRI), model-predictive control, H2 control, H control and multiobjective state feedback. 2. To demonstrate the application of these approaches to the balancing and attitude stabilization of IP systems including pendulums on cart, double and triple link systems on pivot, rotational double IP and IP-type assistant robot.
14.1 Introduction
Over the past decades, inverted pendulum (IP) has been the subject of numerous studies in control systems. An IP is a pendulum which has its links rotating above its pivot point. The IP is a typical representative of a class of high-order nonlinear and nonminimum phase systems. It is often implemented either  with the pivot point connected with a base arm that can rotate horizontally, as
described in [1] or  mounted on a cart that can move in a fixed horizontal line as introduced in [2]. The links of the pendulum are usually limited to one degree of freedom by affixing the links to an axis of rotation. It is obvious that an IP is inherently unstable and must
1Systems Engineering Department, King Fahd University of Petroleum and Minerals, Saudi Arabia

348 The inverted pendulum in control theory and robotics
be actively balanced in order to remain upright, while a normal pendulum is stable when hanging downwards. This can be done by applying a torque at the pivot point for a rotational IP as considered in this thesis or moving the pivot point horizontally for the case of an IP on a cart. A simple demonstration of moving the pivot point to control the pendulum is achieved by balancing an upturned broomstick on the end of one's finger.
The uniqueness and wide application of technology derived from this unstable system have drawn interest of many researchers [3­7]. In recent years, researchers have applied the idea of a mobile IP model to various applications including the design of walking gaits for humanoid robots, robotic wheelchairs and personal transport systems.
Controlling the IP is a classic problem in dynamics and system theory and is used to verify the performance and demonstrating the effectiveness of control algorithms. An IP without attached springs is essentially unstable, and it is hence obvious that feedback of the state of the pendulum is needed to stabilize the pendulum. The IP problem resembles the control systems that exist in robotic arms. The dynamics of IP simulates the dynamics of robotic arm in the condition when the center of pressure lies below the center of gravity (CoG) for the arm so that the system is also unstable. Robotic arm behaves very much like IP under this condition.
The most familiar types of IP are the rotational single-arm pendulum [8], the cart IP [9] and the double inverted pendulum (DIP) [10]. The less common versions are the rotational two-link pendulum [11], the parallel-type dual IP [12], the triple inverted pendulum (TIP) [13], the quadruple IP [14] and the 3D or spherical pendulum [15]. An excellent survey is presented in [16].
In [17], a linearized model of two-wheeled mobile robot for balancing control design was presented. A nonlinear model of same system was studied in [18]. By developing a nonlinear observer to handle the nonlinear disturbance, recent results were reported in [19]. Through an experimental verification, both linearized and nonlinear models were treated in [20]. Employing an model-predictive control (MPC) controller in [21], a design scheme was considered to guarantee balancing the robot.
The uncertainty plays a crucial role in robotic systems. Sources of uncertainty include
 Parametric due to changes in system elements such as friction, inertia or mass,  Environmental as a result of recording the robot output variable using sensor,  External due to variations in working loads.
The major task is how to handle these uncertainties without degrading the stability and performance of the robot. This can be approached by generating proper and resilient controllers.
A recently identified technique for overcoming the complications inherent in wheeled inverted pendulum (WIP) systems is conveniently presented in [22,23]. Control problems involving different configurations of IPs have been considered by many researchers. A comprehensive literature review of the topic is given in [24­32]. In applications, two-wheeled robots (TWR) have two coaxial wheels mounted on either

LMI-based control design for balancing and attitude stabilization 349
side of an intermediate body, with a center of mass above the wheel axles and therefore must actively stabilize themselves to prevent toppling. TWR have a number of advantages over other mobile robots. Although they are more difficult to control than statically stable wheeled robots, TWRs are still much easier to control than legged robots. This wheel configuration makes them highly maneuverable, because of their ability to turn on the spot, similar to differential drive robots [33­44].
On a parallel development, the rotational double inverted pendulum (RDIP) takes the classic rotational single pendulum problem to the next level of complexity. The RDIP is composed of a rotary arm that attaches to a servo system which provides a torque to the base arm to control the whole system, a short bottom rod connected to the arm and a top long rod. It is an underactuated in the sense that it has fewer inputs that degrees of freedom and extremely nonlinear unstable system due to the gravitational forces and the coupling arising from the Coriolis and centripetal forces. Since the RDIP presents considerable control-design challenges, it is an attractive tool utilized for developing different control techniques and testing their performances. Related applications include stabilizing the takeoff of a multistage rocket, as well as modeling the human posture system [45­50].
Nearly, all works on pendulum control concentrate on two problems: stabilization of the IPs and pendulums swing-up control design. The first topic is concerned with the controller design to maintain the pendulum in the upright position. In the RDIP case, controllers are designed to balance two vertical rods by manipulating the angle of the base arm. The second one refers to an adequate algorithm to swing up the pendulum from its stable equilibrium [51], the downward position to the upright position.
In this chapter, we develop and establish complete control design results based on several distinct approaches. We investigate issues regarding robust stability and robust performance of control design for IPs. The controller design is based on an approximate continuous-time linear model of the pendulum system subject to external disturbance. The contributions of our work are summarized below:
1. The analytical results are derived in systematic and unique way, thereby leading to improved techniques over the techniques in the literature.
2. All the design procedures are conveniently cast into the format of feasibility problem over linear-matrix inequalities (LMI). By this way, effective computational methods are established yielding guaranteed quality solution.
3. Simulation studies using Matlab/Simulink environment are performed for all the approaches yielding good performance results.
The chapter is organized into two parts: The first part concerns dynamic model development and occupies Sections 14.2­14.6. The second part composed of Sections 14.7 and 14.8 and focuses on the control design methods. Section 14.2 discusses basics of dynamic modeling to characterize the behavior of the multilink system. In Section 14.3, modeling issues pertaining to single and double pendulums on cart are presented. DIP on pivot and TIP on pivot are provided in Section 14.4. The case of RDIP is examined in Section 14.5. Finally, Inverted PENdulum Type Assistant Robot (I-PENTAR) as a humanoid-type robot is the subject of Section 14.6. Turning to the

350 The inverted pendulum in control theory and robotics
control side, linear control design methods are formulated in Section 14.7 as convex optimization problems over LMIs. In Section 14.8, multiobjective state feedback is treated. The chapter is concluded in Section 14.9 which summarizes the simulation studies.
Notations: In the sequel, the Euclidean norm is used for vectors. We use W t and W -1 to denote, respectively, the transpose and the inverse of any square matrix W . We use W < 0 (0) to denote a symmetric negative definite (negative semidefinite) matrix W . Opq, Ipq denote the p × q null and identity matrices, respectively. Let Tr[.] denote the trace operator. Matrices, if their dimensions are not explicitly stated, are assumed to be compatible for algebraic operations. In symmetric block matrices or complex matrix expressions, we use the symbol · to represent a term that is induced by symmetry.

14.2 Dynamic modeling

In this chapter, we visualize IP as a system of n rods that are isotropic, homogeneous and conveniently connected. Such arrangement can be classified into two groups:

(a) A nonlinear mechanical system of n IPs on a cart can be obtained by mounting the IP on a stable and moving base. The n + 1 outputs are the cart position (m) and pendulum angles (rad), and the system input is the force acting upon the cart.
(b) Employing ball bearings, we obtain a nonlinear mechanical system of n IPs where the n outputs are the pendulum angles (rad), and the system inputs are the input voltages at the motors at each joint.

The purpose of dynamic modeling is to characterize the behavior of the multilink system. In the literature, there are two basic approaches to dynamic modeling:

1. Using Euler­Lagrangian energy relations and 2. Applying Newton's second law and third law on every part of the system.

In this chapter, we focus on the first approach which suits control and systems applications. It has been pointed out that using the Lagrangian approach eventually leads to effective formulation of multilink system dynamics. The mathematical models for different types of IPs [25] are frequently derived via Lagrange equations:

dq dt

L  q j

-

L  qj

+

 D(t )  qj

=

Q(t)

(14.1)

where

 qj stands for a particular generalized coordinates,  T and V represent the system kinetic and potential energy, respectively,
 L = T - V is the Lagrange function,  Q(t) is the vector of generalized external forces acting upon the system and  D(t) (Rayleigh, dissipation function) expresses the viscous (friction) forces.

Y Y

LMI-based control design for balancing and attitude stabilization 351

l1 1

0

J1

m0

F

m1g

X

2 J2

l2

l1 1

m2g

0

J1

m0

F

m1g

X

Figure 14.1 Inverted pendulum schematic: (left) single and (right) double

The use of Lagrange mechanics therefore transforms the process of deriving the motion equations of the IPs system into the determination of kinetic, potential and dissipation energies related to the cart and all pendulums. Using well-known formulas, general relations that describe the energetic balances of the cart and jth pendulum in an IP systems were derived and can be found in [31].
In what follows, we deal with IPs without friction forces, that is, D(t)  0.

14.3 Pendulums on cart

In this section, we begin looking at the dynamic models that belong to the first group.

14.3.1 Single pendulum on cart
By setting n = 1, we obtain the single inverted pendulum (SIP) system (Figure 14.1, left), which encompasses two subsystems:

S1: The cart subsystem:

(m0

+

m1)¨0(t)

+

00(t)

+

1 2 m1

1(¨1(t) cos 1(t) - 12(t) sin 1(t)) = F(t)

(14.2)

S2: The pendulum subsystem:

J1¨1(t)

+

11(t)

+

1 2 m1

1(¨0(t) cos 1(t) -

1 2 m1g

1 sin 1(t)) = 0

(14.3)

where m0 is the cart mass, m1 is the pendulum mass, 1 is the pendulum length, 0

is the friction coefficient of the cart against the surface, 1 is the damping constant

of the pendulum, F(t) is the applied force and J1

=

1 3

m1

2 1

is the single pendulum's

moment of inertia with respect to the pivot.

352 The inverted pendulum in control theory and robotics

14.3.2 Double pendulums on cart

The case of n = 2 yields the mathematical model of the DIP system (Figure 14.1, left), which consists of three subsystems as follows:

S1: The cart subsystem:

(m0 + m1 + m2)¨0(t) + 00(t) +

1 2 m1

1

+

1 2 m2

1

(¨1(t) cos 1(t)

-

12(t)

sin

1(t)

+

1 2 m2

1(¨2(t) cos 2(t) - 22(t) sin 2(t)) = F(t)

(14.4)

S2: The lower pendulum subsystem:

(J1 + m2

2 1

)¨1(t

)

+

(1

+

2)1(t)

-

22(t)

+

1

1

2 m1 1 + 2 m2 1

¨0(t) cos 1(t)

+

1 2

m2

1

2(¨2(t) cos(1(t) - 2(t)) + 12(t) sin(1(t) - 2(t)))

-

1 2

(m1

+

m2)g

1 sin(1(t)) = 0

(14.5)

S3: The upper pendulum subsystem:

J2¨2(t) + 2(1(t) - 2(t)) +

1 2 m2

2¨0(t) cos 2(t)

+

1 2

m2

1

2(¨1(t) cos(1(t) - 2(t)) - 12(t) sin(1(t) - 2(t)))

1 - 2 (m1 + m2)g 2 sin(2(t)) = 0

(14.6)

14.3.3 State-space representation

It is readily evident that, based on Lagrange's formulation, a set of nonlinear differential equations describing the IP system dynamics can be obtained. With appropriate definitions, a nonlinear state-space model of the form can be produced:

x(t) = Ax(t) + Bu(t) + g(x(t), u(t), w(t))

(14.7)

y(t) = Cx(t)

(14.8)

Seeking to design balancing and/or attitude controllers, a linearized model about a stable pendulum position is used. For sufficiently small angles and angular velocities, an effective quasilinearization procedure gives the following model:

x(t) = A x(t) + Bu(t) + w(t)

(14.9)

y(t) = C x(t)

(14.10)

where x(t)  Rn, u(t)  Rm, y(t)  Rp, w(t)  Rq are the state, the control input, the measured output and the external disturbance, respectively.

LMI-based control design for balancing and attitude stabilization 353
In what follows, we examine the linearized continuous-time dynamic models of IPs without cart in terms of generalized relative coordinates.

14.4 Inverted pendulum on pivot

In this section, we examine two cases: DIP on pivot and TIP on pivot. In both cases, we present representative values for the purpose of computer simulation.

14.4.1 DIP on pivot

Reference is made to the nomenclature explained in Table 14.1 and the schematic

diagram in Figure 14.2(left). Using the approach in [13,32], the following relation

for the DIP is derived:

M~

¨1 ¨2

+ N~

1 2

+ P~

1 2

+ M~

¨1 ¨2

u1 =

O11 O11

M~ =

I1 + m1a21 + m2

2 1

+

Ip1

1m2a2 - Ip1

·

I2 + m2a22 + Ip1

N~ =

C1 + C2 + cp1 -C2 - cp1

·

C2 + cp1

,

P~ =

m1a1 + m2 1 O11

·

m2a2g

,

H~ =

G1 -G1

(14.11)

The nomenclature are explained in Figure 14.2(left) and Table 14.1. Defining the state vector xd = [1, 2 - 1, 1, 2 - 1]T and the output vector yd = [1, 2 - 1, 1], we cast system (14.11) into the form (14.9) and (14.10) with

A=

O22

I22

-W~ M~ -1P~ W~ -1 -W~ M~ -1N~ W~ -1

,

B=

O21 -W~ M~ -1H~

,

W~ =

10 -1 1

(14.12)

Table 14.1 Nomenclature of IP on pivot

uj

Input voltage from computer to jth driving motor

j

Length of jth arm

aj

Center of gravity of jth arm

mj

Mass of jth arm

Ij

Moment of inertia of jth arm around the center of gravity

Cj

Viscous friction coefficient of jth hinge

j

Angle of jth arm from the vertical line

Gj

Static gain of jth motor/gearbox

cpj

Viscous friction coefficient of jth motor/gearbox

Ipj

Moment of inertia of jth motor/gearbox reflected at the output shaft of the gearbox

g

Acceleration of gravity (9.81 m/s2)

354 The inverted pendulum in control theory and robotics

a2

2

m2, I2

l1 a1

T1 1 m1, I1

l2 a2

a3 3
T2 2 m2, I2

m3, I3

l1 a1

T1 1 m1, I1

Figure 14.2 Inverted pendulum schematics: (left) double and (right) triple

Table 14.2 Parameter of double inverted pendulum

Link 1
1 = 0.174 m m1 = 0.787 kg I1 = 4.3 × 10-3 kg m2 a1 = 0.129 m C1 = 2.69 × 10-2 N ms

Link 2
2 = 0.174 m m2 = 0.507 kg I2 = 3.05 × 10-3 kg m2 a2 = 0.217 m C2 = 4.04 × 10-2 N ms

where the control input u is the input voltage to the motor, and the subscript d stands for double. In terms of the parameter values in Table 14.2, the corresponding model matrices in (14.12) are given by



0

01

A

=



0 31.475

00 3.023 -0.411



0

1 96.738

 ,

-13.692 9.495 0.335 -165.042





1000

C = 0 1 0 0

0010





0

B

=



0 -24.899



,

42.480

(14.13)

14.4.2 TIP on pivot
Stabilization of a TIP is developed along similar lines to the double pendulum. A schematic diagram for the triple pendulum is shown in Figure 14.2(right). Two direct current (DC) motor/gearboxes are used to provide torques to the upper and middle pendulum hinges, while the lower hinge is free to rotate. In this case, we only consider attitude control of the middle link, while the upper link is kept in alignment with the middle one. This alignment is achieved by proportional position feedback applied to

LMI-based control design for balancing and attitude stabilization 355 Table 14.3 Parameter of triple inverted pendulum

Link 1
1 = 0.174 m m1 = 0.867 kg I1 = 2.824 × 10-3 kg m2 a1 = 0.124 m C1 = 2.69 × 10-2 N ms

Link 2
2 = 0.171 m m2 = 0.836 kg I2 = 3.078 × 10-3 kg m2 a2 = 0.217 m C2 = 4.04 × 10-2 N ms

Link 3
3 = 0.171 m m3 = 0.506 kg I3 = 2.91 × 10-3 kg m2 a3 = 0.222 m C2 = 3.65 × 10-2 N ms

the upper motor. The control system for the middle motor includes integral action and
optimal state feedback.
The nomenclature is explained in Figure 14.2(right) and Table 14.3. The state equation in terms of the relative angles xt = [1, 2 - 1, 3 - 2, 1, 2 - 1, 3 - 2]T is given by

xt(t) =

O33 I33 A21 A22

+

O32 B2

,

A21 = -W^ M^ -1P^ W^ -1, A22 = -W^ M^ -1N^ W^ -1, B2 = -W^ M^ -1H^

(14.14)
(14.15) (14.16)

where













1 00

M1g 0 0

G1 0

W^ =  -1 1 0  , P^ =  0 M2g 0  , H^ =  -G1 G2 

0 -1 1 
J1 + Ip1 1M2 - Ip1 M^ =  · J2 + Ip1 + Ip2

0 0 M3g 
1M3 2M3 - Ip2  ,

0 -G2

·

·

J3 + Ip2





C1 + C2 + cp1

-C2 - cp1

0

N^ = 

·

C2 + C3 + cp1 + cp2 -C3 - cp2 

·

·

C3 + cp2

M1 = m1a1 + (m2 + m3) 1, M2 = m2a2 + m3 2, M3 = m3a3

J1

=

I1 + m1a12 + (m2 + m3)

2 1

,

J2 = I2 + m2a22,

J3 = I3 + m3a23

(14.17)
(14.18) (14.19) (14.20)

Remark 14.1. It must be observed in both double and triple pendulums that the parameters mj, j are measured directly, whereas aj, Ij are determined analytically. The arms are swung freely, from the periods and the damping factor of their responses, the parameters are then determined. The remaining parameters Ipj, cpj, Gj are calculated from values given in technical data of the motor/gearboxes.

356 The inverted pendulum in control theory and robotics
14.5 Rotational double inverted pendulum
The RDIP takes the classic rotational single pendulum problem to the next level of complexity [1]. The RDIP is composed of a rotary arm that attaches to a servo system which provides a torque to the base arm to control the whole system, a short bottom rod connected to the arm and a top long rod. It is an underactuated (that is, it has fewer inputs that degrees of freedom) and extremely nonlinear unstable system due to the gravitational forces and the coupling arising from the Coriolis and centripetal forces. Since the RDIP presents considerable control-design challenges, it is an attractive tool utilized for developing different control techniques and testing their performances. Related applications include stabilizing the takeoff of a multistage rocket, as well as modeling the human posture system [26,27].
A simple mathematical model has been presented in [45], which assumes that the acceleration of the base arm is able to be manipulated directly and therefore chosen as the system control input. In this dissertation, a more practical assumption is taken under which the torque of the motor to the base arm is the control signal. Moreover, the pivoting friction factors will be taken care for the goal to build a more precise model and simulate the real system we have in the lab.
We will use some additional basic assumptions of the system attributes similar with [45]:
A1 All the link angles and the angular velocities are accessible at each time step, since we know that we can access these data with the help of the encoders on the links, and high rate of data acquisition is possible for our experiment platform.
A2 The viscous frictions of the arm and the two pendulums are considered, while the static friction, backlash and plane slackness are ignored.
A3 The apparatus is light weight and has low inertia resulting in a structure with low stiffness and a tendency to vibrate.
A4 System dynamics is slow enough to be controlled.
Figure 14.3 shows the basic configurations of the RDIP. The arrows on the arcs show the positive direction for the rotary movement of the links. The straight dash lines denote the origin of the displacement of the link angles. For example, when the horizontal Link 1 is centered, and the vertical Links 2 and 3 are in the upright position, all of the position variables are zero. The state variables and related parameters of the links are listed in Table 14.4.
The Euler­Lagrange (E­L) method, introduced in details in [28], is applied in the derivation of the equations of motion for the RDIP dynamics, since the Newtonian approach of applying Newton's laws of motion is highly complicated in this case. The solutions to the E­L equation for the action of a system are capable of describing the evolution of a physical system according to the Hamilton's principle of stationary action in Lagrangian mechanics. In classical mechanics, it is equivalent to Newton's laws of motion, but it has the advantage that it takes the same form in any system of generalized coordinates, and it is better suited to generalizations.
For the purpose of modeling, the RDIP works as follows. The movement of the arm on the base, Link 1, is constrained to the x­o­z plane and rotating around

LMI-based control design for balancing and attitude stabilization 357

y z

Pc3 m3 3

l3 P3

L2 P1

Pc2 m2 l2 L1

2
P2 1

Motor

x

Base

y

RL RR

RPR P RPL

x

Figure 14.3 Rotational inverted pendulum: (left) schematic, (right) angle of rotation [27]

Table 14.4 Parameters of T-WIP robot

Parameter Meaning

1

Angle of Link 1 in the horizontal plane

1

Velocity of Link 1 in the horizontal plane

¨1

Acceleration of Link 1

2

Angle of Link 2 in the horizontal plane

2

Velocity of Link 1 in the horizontal plane

¨2

Acceleration of Link 2

3

Angle of Link 3 in the horizontal plane

3

Velocity of Link 3 in the horizontal plane

¨3

Acceleration of Link 3

J1

Moment of inertia of Link 1 about its pivot

J2

Moment of inertia of Link 2 about its center of mass Pc2

J3

Moment of inertia of Link 3 about its center of mass Pc3

1

Distance from the center of rotation of Link 1 to its center of mass

2

Distance from the center of rotation of Link 2 to its center of mass

3

Distance from the center of rotation of Link 3 to its center of mass

mj

Mass of link j, j = 1, 2, 3

Lj

Length of link j, j = 1, 2, 3

bj

Viscous damping coefficient of the bearing on which Link j rotates j, j = 1, 2, 3

g

Gravity with the value g =9:81 m/s2 toward the center of the earth

the y-axis. The movements of the other two links are constrained to a vertical plane perpendicular to Link 1. Link 1 is driven by a DC motor, which generates a torque to control the system and is described in [29]. Here, we will not discuss the servo system. Therefore, the control input of the RDIP is the torque applied to Link 1. The control objective is to maintain the pendulums Link 2 and 3 in the upright position with Link 1 in the origin position.

358 The inverted pendulum in control theory and robotics
Application of (14.1) to the RDIP with D(t)  0, we readily obtain the following parametrized model:

h1¨1(t) + h2 cos 2(t)¨2(t) + h3 cos 3(t)¨3(t) + b11(t) - h212(t) sin 2(t)

- h332(t) sin 3(t) =  (t) - h2 cos 2(t)¨1(t) - h4¨2(t) - h5 cos(2(t) - 3(t))¨3(t) - b22(t) - h5 sin (2(t) - 3(t))32(t) + h7 sin 2(t) = 0 - h3 cos 3(t)¨1(t) - h5 cos (2(t) - 3(t))¨2(t) - h6¨3(t) - b33(t) + h5 sin (2(t) - 3(t))22(t)

+ h8 sin 3(t) = 0

(14.21)

where

h1 = J1 + L21(m2 + m3), h2 = L1(m2 2 + m3L2), h3 = L1m3 3 h4 = J2 + L22m3 + m2 22, h5 = L2m3 3, h6 = J3 + m3 2

(14.22) (14.23)

h7 = (m2 2 + m3L2)g, h8 = m3 3g

(14.24)

In terms of the state vector x = [1, 2, 3, 1, 2, 3]T and the control input u =  , we quasilinearize system (14.21) about the origin x(0) = 0 and u = 0 to obtain the matrices A and B in (14.10) of the form:

A=1 T

O33 I33 EF

,

B= 1 T

O31 J

,

(14.25)









0 (h3h5 - h2h6)h7 (h2h5 - h3h4)h8

h4h6 - h25

E =  0 (h32 - h1h6)h7 (h1h5 - h2h3)h8  , J =  h2h6 - h3h5  ,

0 (h1h5 - h2h3)h7 

(h22 - h1h4)h8

h3h4 - h2h5 

F

=



(h4h6 - h52)b1 (h2h6 - h3h5)b1

(h2h6 - h3h5)b2 (h1h6 - h32)b2

(h3h4 - h2h5)b3 (h3h4 - h2h5)b3  ,

(h3h4 - h2h5)b1 (h2h3 - h1h5)b2 (h1h4 - h22)b3

T = h6h22 - 2h2h3h5 + h4h32 + h1h52 - h1h4h6

(14.26) (14.27)

14.6 Inverted pendulum-type assistant robot
Referring to Figure 14.4, the I-PENTAR is constructed to exhibit human motion. It consists of a body with a waist joint, arms designed for safety and a WIP mobile platform. It is capable to perform heavy tasks [36,37]. From a control systems standpoint, I-PENTAR is depicted as a three-dimensional robot; with controls of inclination angle, horizontal position and steering angle to achieve high mobile capability. Generally speaking, the robot dynamics is derived considering the nonholonomic constraint of the two-wheeled mobile robot. As such I-PENTAR is unstable, thus achieving the closed-loop stability is crucial for controller design.

LMI-based control design for balancing and attitude stabilization 359

31.88 [kg]

2DOF arm

Mg



Iyy

lg

0.8 [m]

Mobile base

Waist
Roller Gyro sensor

xc

rw

b

w

XW

Figure 14.4 (Left) I-PENTAR robot (right) two DOF model

ZW W

Balancing robot was reported in [33] using a linearized model and in [38] based on nonlinear model. Accommodation of the nonlinear disturbance based on a nonlinear observer was presented in [39]. In [40], a particular robot with movable two wheels was constructed and evaluated. A model-predictive controller was reported in [21] to balance the robot. A fuzzy control approach in [41,42] dealt with parametric uncertainties. A robust controller was proposed by [43] using a model-based sliding mode theory. For motion tracking in [44], a reference model for the yaw and tilt angle was constructed using the LQR optimization. Trajectory tracking control was treated in [47] using uncertain model. A backstepping-based adaptive control is designed in [48] to achieve output tracking for the WIP and similarly an adaptive integral backstepping controller is developed in [?] to stabilize the body angle. Design aspects for WIP platforms were examined in [50] to investigate the effect of design choices on balancing the performance.
Figure 14.4 shows a schematic of I-PENTAR. It has two arms with one elbow for each arm, two gyro sensors specified to define the acceleration and the inclination angle relative to the flat surface of the earth and two wheels are for movements in two degree of freedom.
Defining the state variables as
 xv is the linear position of the vehicle (m),   is the inclination angle of CoG in (rad),   is the steering angle of the vehicle in (rad),  xv is the linear velocity of the vehicle (m/s),   is the inclination angular velocity of CoG in (rad/s),   is the steering angular velocity of the vehicle in (rad/s)

360 The inverted pendulum in control theory and robotics

Reference to model (14.10), the matrices A , B, C are given by

A=

0 I33 A1 A2

,

B=

O32 B1

,

C = I22 O24













0 0 a43

a44 a45 a46

b1 b2

A1 =  0 0 0  , A2 =  a54 a55 a56  , B1 =  b3 b4 

0 0 a63

a64 a65 a66

b5 b6

where

a43

=

Mg2

2 g

rw2

G

,

V1

a44

=

w1c1 , V1

a55

=

-b2c1 V2

a45

=

w1c1 , V1

a46

=

-rww1c1 , V1

a54

=

-bc2 , V2

a56

=

brww1c2 , V2

a64

=

-w2c1 , rw V1

a65

=

-bw2c2 , rw V1

a63

=

(Mgrw2 + 2mwrw2 + 2(Iwa +  Ira))MgIgG V1

b1

=

b2

=

-rww1 , V1

b3

=

-b4

=

-rw b V2

b5

=

b6

=

w2 , V1

a66

=

-w2c1 , V1

V1 = Izzrw2 + 2(Iwd + Ird ) + 2mwR2wb2 + 2(Iwa +  2Ira)b2,

w1

= Mg

2 g

+

Iyy

+

Mg

g rw

w2 = Mg grw + Mgrw2 + 2mwrw2 + 2(Iwa +  2Ira)

The numerical values of the parameters are presented in Table 14.5.

(14.28)
(14.29)
(14.30) (14.31) (14.32) (14.33) (14.34) (14.35) (14.36) (14.37) (14.38)

14.7 LMI-based control-design methods
In this section, we develop linear control methods and formulate the design as convex optimization problems over LMIs. The common design objective is to stabilize system (14.10). All the subsequent analytical treatment are inspired by the results of [53]­[56]. The methods established hereafter are categorized into five problems:
 Linear quadratic control (LQR) design, where the objective is to determine a state-feedback gain in the nominal case (without the disturbance input). This is termed as Problem I.
 Linear quadratic integral control (LQRI) design, in which, we expand the state model by including the integral of the deviation of the output in the absence of disturbance. This is termed as Problem II.

LMI-based control design for balancing and attitude stabilization 361 Table 14.5 Numerical data for I-PENTAR

Parameter
Mg mg
g
b rw Ig Iwa Iwd Ira Ird  cr c G

Value
25.26 kg 125 kg 0.4005 m 0.16 m 0.1 m 1.408 kg m2 0.01475 kg m2 0.0073 kg m2 0 0 1 0.1 N ms/rad 0.1 N ms/rad 9.81

 Linear quadratic control with disturbance rejection (LQR+) in which we penalize the impact of disturbance by adding an extra term in the cost functional. This is termed as Problem III.
 Linear quadratic integral control with disturbance rejection (LQRI+), in which, we expand the state model and add extra cost term. This is termed as Problem IV.
 MPC is termed as Problem V.
In control system terminology, the problem under consideration is that of determining feedback controller that makes system (14.10) stable over a wide range of operation while achieving a prescribed performance measure. Next, we provide design techniques to achieve this goal.

14.7.1 LQR: proportional gain

With focus on the LQR design, we look at LMI-based formulation. The associated cost function is


J = [yT (t)Qy(t) + uT (t)Ru(t)]dt
0

(14.39)

where 0 < Q, 0 < R are output error and control weighting matrices. In what follows, we proceed to determine a linear optimal state-feedback control u = Lx that derives system (14.10) with  0 while minimizing the quadratic cost (14.39). Assume that
a Lyapunov functional V (x) has the properties:

 V (x) = xT Mx, M > 0,  There exists + > 0 such that xoT Mxo  +  V (x)  -[xT C T QC x + uT Ru]

362 The inverted pendulum in control theory and robotics

Then, the linear system controlled by u is asymptotically stable and J  V (xo). With u = Lx, the inequality of the derivative of the Lyapunov functional becomes

xT [M (A + BL) + (A + BL)T M T ]x  -xT [C T QC + LT RL]x (14.40)

Inequality (14.40) is satisfied for all x = 0, if there exists L and M such that

M (A + BL) + (A + BL)T M T + [CT QC + LT RL]  0

(14.41)

Proceeding to minimize the upper bound on the cost xoT Mxo, the under consideration for given + can be cast into

min
+ ,K ,L

+

subject to (14.41)

(14.42)

To convexify the above problem, we first express (14.41) as

= M (A + BL) + (A + BL)T M T





C T Q LT R

=  · -Q 0   0

· · -R

(14.43)

Pre- and postmultiply (14.43) by diag{Y , I , I } and using Y = M -1, S = LK-1,

it follows that (14.43) is equivalent to





(A Y + BS) + (A Y + BS)T Y C T Q YLT R



·

-Q 0   0

(14.44)

·

· -R

Additionally, inequality bound of the Lyapunov functional can be expressed as

+ xoT · M -1

 0 

+ xoT ·Y

0

(14.45)

The convex minimization problem (14.44) is cast into the form

Problem I

min
+,Y ,S

+

subject to (14.44) - (14.45)

(14.46)

When a feasible solution of problem (14.46) is attained, we get L = SY -1, M = Y -1.

14.7.2 LQRI: proportional-integral gain

Next, a modified formulation of the LQR (14.46) is considered with an additional

cost-term representing the integral of the deviation of the output from its initial state

z(t) =

t 0

y(

)d

.

The

modified

cost

expression

becomes


J = (y( )T y( ) + u( )T u( ) +  z( )T z( ))d
0

(14.47)

LMI-based control design for balancing and attitude stabilization 363

This formulation is referred to as the LQRI. Treating z = C x as additional state variable, we define  = x z T . The augmented system dynamics becomes

 =

A0 C0

+

B 0

u = A  + Bu

(14.48)

and hence we can rewrite (14.47) as


J = (T ( )Q~ ( ) + u( )T R~ u( ))d ,
0

Q~ =

CTC 0 0 I

,

R~ = I

(14.49) (14.50)

To ensure closed-loop system stability, we define the Lyapunov functional, V (x) having the properties:
 V (x) = T M¯ , M¯ > 0,  There exists + > 0 such that oT M¯ o  +  V ()  -[T Q~  + uT R~ u]
Then, the linear system controlled by u is asymptotically stable and J  V~ (xo). With u = L and following parallel development to the previous section, we arrive at the convex problem

Problem II

min
+,Y ,S

+

subject to

 (A Y¯ + BS¯ ) + (A Y¯ + BS¯ )T Y¯ Q~ Y¯ LT R~ 



·

-Q~ 0   0,

·

· -R~

+ oT · Y¯

0

(14.51)

When a feasible solution of problem (14.51) is attained, we get the desired gains L = S¯ Y¯ -1, M¯ = Y¯ -1.

14.7.3 LQR+: proportional gain with disturbance rejection

Considering system (14.10) and to penalize the effect of the disturbance, we include an extra term to the cost (14.39) to yield


J = [y( )T y( ) + u( )T u( ) - 2d( )T d( )]dt
0

(14.52)

This new formulation will be referred to as LQR+. Letting ( ) = u( ) d( ) , we get


J = [y(t)T Qy(t) + (t)T R+(t)]dt
0

(14.53)

364 The inverted pendulum in control theory and robotics

R+ = diag[ -2] is a control weighting matrix. To ensure closed-loop system stability, we define the Lyapunov functional, V(x) having the properties:
 V(x) = xT Px, V(x) > 0,  There exists  > 0 such that xoT Pxo  +  V(x)  -[xT Qx + T R+]
Then, the linear system controlled by u is asymptotically stable and J  V(xo). With  = Fx, the derivative of the Lyapunov functional satisfies

xT [P(A + GF) + (A + GF)T PT ]x  -xT [Q + FT R+F]x

(14.54)

which holds if there exist F and P such that

P(A + GF) + (A + GF)T PT + [Q + FT R+F]  0 where G = [B ], the minimization problem is expressed as

(14.55)

min
 ,P,F

+

subject to (14.55)

(14.56)

Proceeding like the foregoing sections, problem (14.56 ) can cast into

Problem III

min
+ ,Z ,V

+

subject to





(A Z + BV ) + (A Z + BV )T ZCT Q ZFT R



·

-Q 0   0,

·

· -R+

+ oT ·Z

0

(14.57)

when a feasible solution is attained to (14.57), we get F = VZ-1, P = Z-1.

14.7.4 LQRI+: proportional-integral gain with disturbance rejection

Finally, we modify cost (14.52) by incorporating the integral of the output, z(t) =

t 0

y( )d

to

arrive

at

the

formulation:


J = [y( )T y( ) + u( )T u( ) +  z( )T z( ) - 2 ( )T ( )]d (14.58)
0

This new formulation will be referred to as LQRI+. Introducing ( ) = u( ) d( ) and ( ) = x( ) z( ) . The augmented system dynamics becomes

 =

A0 C0

+

B 0

u+

0

d

= A  + Bu + d

(14.59)

LMI-based control design for balancing and attitude stabilization 365

and hence we can rewrite (14.58) as

J= Q~  =


( T ( )Q~  ( ) + ( )T R~ ( ))d
0

CTC 0 0 I

,

R~  =

I 0 0 -2I

(14.60) (14.61)

To guarantee the closed-loop system stability, we define the Lyapunov functional, V~(x) with the properties:

 V~( ) =  T P , V~( ) > 0,  There exists  > 0 such that oT Po  +  V~( )  -[ T Q~  + T R~ ]

Then, the linear system controlled by  is asymptotically stable and J  V~(xo). With  = F, the derivative of the Lyapunov functional  = 0 satisfies

P(A + GF~ ) + (A + GF~ )T PT + [Q + FT RF]  0

(14.62)

where G = [B ]. The minimization problem has the form

min + subject to (14.62)
 ,P,F

(14.63)

Convex analysis converts problem (14.63) to

Problem IV

min + subject to

+ ,Z ,V





(A Z + BV ) + (A Z + GV )T ZQ ZFT R



·

-Q 0   0

·

· -R

+ oT ·Z

0

(14.64)

a feasible solution of which gives F = V Z~ -1, P = Z-1.

14.7.5 Model-predictive control

The model-predictive controller performs an optimization of the discrete-time system:

x(k + 1) = Acx(k) + Bcu(k) y(k) = Ccx(k)

(14.65)

using the cost function

np -1
J = xT (k + np)Sx(k + np) + x(k + i)T Qx(k + i) + u(k + i)T Ru(k + i) (14.66)
i=0

366 The inverted pendulum in control theory and robotics

where xk  Rn, uk  Rm, yk  Rp , Ac  Rn×n, Bc  Rn×m and Cc  q×n. Note that system (14.65) is an appropriate discretized model of (14.10) using zero-order hold (ZOH) and prescribed sampling period Ts. It is desired to synthesize the controller:

xc(k + 1) = Acx(k) + Bcu(k) yc(k) = Ccxc(k)

(14.67) (14.68)

that stabilizes the closed-loop system. The closed-loop system can be represented as

 (k + 1) = A¯  (k) + B¯ u(k) u(k) = K (k), y(k) = C¯  (k)

(14.69) (14.70)

where

=

x(k ) xc (k )

,

A¯ =

Ac 0 Bc Ac

,

B¯ =

Bc 0

C¯ = Cc 0 , K¯ = 0 Cc

We now consider infinite-time horizon formulation of (14.66):


J =  (k + i)T Q¯  (k + i) + u(k + i)T R¯ u(k + i)
i=0

Q¯ =

Q0 00

Q  0,

R>0

(14.71) (14.72)
(14.73) (14.74)

Again, we define the quadratic Lyapunov function, V (x) as

V (x) =  T P+ , P+ > 0

(14.75)

V (x(k + i + 1)) - V (x(k + i)) < - (k + i)T Q¯  (k + i) - u(k + i)T Ru(k + i)

(14.76)

The problem under consideration can be cast into the LMI form:

Problem V

max +-1

subject to

YI IX

-  -1 > 0

 



-1um2 axI ·

0 Y

 L I  > 0,





Y ·

I X

AcT CcT (AcX + AcCcL)T



>

0

· ·X 

·· 

 -1ym2 axI

YI Z 0 0



· · · ·

X · · ·

Ac
· ·

X ·

0
0 LT R-1

0
0 XQ1/2
0



>

0

·· · · · 0

(14.77) (14.78)
(14.79)

LMI-based control design for balancing and attitude stabilization 367

w

z

P(s)

z2

u

x

K

Figure 14.5 Multiobjective state feedback

where  = Y Ac + FCc, = AcX + BcL, = Y - Q, = I - QX . When a feasible solution is obtained, then

V = (I - YX )(U T )-1, Cc = L(U T )-1, Bc = V -1F, Ac = V -1Z (U T )-1

(14.80)

14.8 Multiobjective state feedback

Reference is made to Figure 14.5 where P(s), K designate the linearized plant and the state-feedback gain, respectively. Denoting by T(s) and T2(s) the closed-loop transfer functions from w  z and from w  z2, respectively, our goal is to design a state-feedback control law that meets one of the following objectives:

 H2 control design, in which, it is required to maintain the H2-norm of T2(s) below some prescribed value  > 0,
 H control design, it is required to maintain the H-norm of T(s) below some prescribed value  > 0,
 Mixed control design, in which, it is required to minimize an H2/H trade-off criterion of the form ||T(s)|| 2 + ||T2(s)||22.
In the sequel, we conveniently imbed the linearized model (14.10) into the form:

x(t) = A x(t) + Bu(t) + w(t) z(t) = G x(t) + S u(t) + w(t) z2(t) = C x(t) + D u(t) + w(t)

(14.81) (14.82) (14.83)

with z(t)  Rq. z2(t)  Rq as the performance outputs. We focus on the stabilization problem under state feedback u = Kx where the closed-loop system is given by

xs(t) = Asxs(t) + w(t) z(t) = Gsx(t) + w(t) z2(t) = Csx(t) + w(t)

(14.84) (14.85) (14.86)

368 The inverted pendulum in control theory and robotics

where

As = A + BK, Gs = G + S K,

(14.87)

Cs = C + D K

(14.88)

Treated separately, our three design objectives have the following LMI formulations.

14.8.1 H2 performance

Here, the closed-loop H2-norm of T2(s) does not exceed some prescribed value  > 0, if there exist two symmetric matrices 0 < X2 and Q such that
Trace[Q] < 2

AsX2 + X2Ast

·

-I

< 0,

Q Cs · -X2

< 0,

(14.89)

Denoting the optimal solution by (X, Q, ), the corresponding state-feedback

gain is given by K = Q(X)-1.

14.8.2 H performance

Here, we consider minimizing the closed-loop RMS norm from w  z X2 and Q

does

not exceed 



,

if

and

only

if

there exists 

a

symmetric

matrix

0

<

X

such

that

AsX + XAst

XGts



·

-I

<0

(14.90)

·

· - 2I

Denoting the optimal solution by (X, Y,  ), the corresponding state-feedback gain is given by K = Y(X)-1.

14.8.3 Mixed H2/H performance
Finally, we consider minimizing a trade-off criterion of the form ||T(s)||2 + ||T2(s)||22. This leads to the convex optimization problem

( 2 +  Trace[Q])X,Y,Q, 2

AsX2 + X2Ast

·

-I

< 0,

Q Cs · -X2

< 0,







AsX

+ ·

XAst

-I

XGst  < 0

·

· - 2I

Trace[Q] < 02,  2 < 02

(14.91)

LMI-based control design for balancing and attitude stabilization 369

Cart position [m] Pole angle [deg]

Car postiton analysis-single inverted pendulum 1.4

1.2

1

Cart position: Group1

0.8

Cart position: Group2

0.6 0.4

0.2

0
­0.2 0

5

10

15

20

Simulation time [s]

Pole angle analysis-single inverted pendulum

0

Pole angle: Group1

­50

Pole angle: Group2

­100

­150 ­200

­250

­300 0 2 4 6 8 10 12 14 16 18 20
Simulation time [s]

Figure 14.6 Impulse response of SIP on a cart: (left) cart position and (right) pendulum angle

Denoting the optimal solution by (X, Y, Q,  ), the corresponding statefeedback gain is given by K = Y(X)-1, and this gain guarantees the worst case
performances:

||T||   , ||T2||2  Trace[Q]

(14.92)

Note that K does not yield the globally optimal trade-off in general due to the conservatism assuming a single Lyapunov matrix [54].

14.9 Simulation results
In this section, we aim to provide representative and meaningful simulation results of applying the different feedback control algorithms to different pendulum configurations. In computer implementation, we made use of [52].
14.9.1 SIP­DIP open-loop response
The analysis of the open-loop dynamical behavior of both the SIP and DIP systems is presented. The dynamics of SIP system is analyzed for two groups of parameters at once:
[Group I:] m0 = 0.3 kg, m1 = 0.275 kg, 1 = 0.5 m, 0 = 0.3 kg s-1, 1 = 0.01148 kg m2 s-1
[Group II:] m0 = 0.1 kg, m1 = 1.0 kg, 1 = 0.8 m, 0 = 0.3 kg s-1, 1 = 0.1 kg m2 s-1
For the DIP system, the parameters are m0 = 0.3 kg, m1 = 0.275 kg, m2 = 0.275 kg, 1 = 0.5 m, 2 = 0.5 m, 0 = 0.3 kg s-1, 1 = 0.1 kg m2 s-1, 2 = 0.1 kg m2 s-1 The impulse response of both SIP and DIP systems are displayed in Figures 14.6 and 14.7.

370 The inverted pendulum in control theory and robotics

Cart position [m]

Car postiton analysis-double inverted pendulum 1.4

1.2 Cart position
1

0.8

0.6

0.4 0.2

0

0

5

10

15

20

Simulation time [s]

Pole angle [deg]

50 0 ­50 ­100 ­150 ­200 ­250 ­300 0

Pole angle analysis-single inverted pendulum
Pole angle [lower] Pole angle [upper]

5

10

15

20

Simulation time [s]

Figure 14.7 Impulse response of DIP on a cart: (left) cart position and (right) upper and lower pendulum angles

Cart position [m]

Cart postition-reference trajectroy (pole placement)

0.3

Cart postition

0.28

Cart postition [m]

0.2

0.18

0.1

0.08

0

0 02

4 6 8 10 12 14 16 18 20 Simulation time [s]

Pole angle [deg]

Polt angle stabalization-pole placement

4

Pole angle []

3

Pole angle [m]

2

1

0

­1

­2

­3 0 2 4 6 8 10 12 14 16 18 20 Simulation time [s]

Figure 14.8 Tracking response of SIP on a cart: (left) cart position and (right) pendulum angle

14.9.2 SIP LQR response
Figures 14.8 and 14.9 document the dynamic behavior for both the cart position and the pendulum angle of the SIP system under control where the objective is to maintain the desired cart position while keeping the pendulum upright without disturbance input.
Remark 14.2. We observe from Figures 14.6 and 14.7 that each pendulum of the system passes through oscillatory transient state until the system reaches the stable equilibrium point in which all pendulums are pointing downward. The backward impact of the pendulum/pendulums on the cart, which increases with the weight of the load, is also visible. The simulation results confirm the generally known empirical observations of pendulum behavior. The simulation results in Figures 14.8 and 14.9 reveal that both tracking control and LQR algorithms perform reasonably well. The ability to control the SIP system with respect to the all requirements was demonstrated

LMI-based control design for balancing and attitude stabilization 371

Cart position [m] Pole angle [deg]

Cart position-reference trajectroy (LQR + Pole placement)

0.3

Cart position []

0.25

Cart position []

0.2

0.15 0.1

0.05

0

­0.05 0 1 2 3 4 5 6 7 8 9 10
Simulation time [s]

Pole angle stablization LQR + Pole placement 5

4

Pole angle []

Pole angle [] 3

2

1 0

­1

­2

­3

­4
­5 0 1 2 3 4 5 6 7 8 9 10 Simulation time [s]

Figure 14.9 LQR response of SIP on a cart: (left) cart position and (right) pendulum angle

for both methods of feedback gain design, although LQR control produces slightly better results.

14.9.3 DIP on cart

Considering Figure 14.1 and using the following data m0 = 1.5 kg, m1 =

0.5 kg, m2 = 0.75 g, 1 = 0.5 m,

A=

O33 I33 E O33

,





-0.607

F =  1.498 

B=

2 = 0.75 m, the state-space matrices are given by





O31 F

,

0 -7.492 0.799 E =  0 74.927 -33.715 ,
0 -59.937 52.121

(14.93)

-0.284

We perform a MATLAB simulation based on the result of Problem I with Q = diag [5, 50, 50, 20, 700, 700], R = 1. The ensuing results for a relatively small deflections from the equilibrium are plotted in Figure 14.10. For larger deflections toward the same direction, the state trajectories are depicted in Figure 14.11.
Turning to the application of MPC, using ZOH with sampling period Ts = 0.002 s, we obtain the discrete-time model of the type (14.65). The simulation results based on the solution of Problem V are displayed in Figures 14.12 and 14.13 for the cases of small and large deflections, respectively.

Remark 14.3. Looking at Figures 14.10 and 14.11, it can be readily seen that the system can be balanced, although the cart is stabilized far from the point 0, to which it returns to with a very low pace. From Figures 14.12 and 14.13, we observe that the lower pendulum has for a time period a large angular velocity.

372 The inverted pendulum in control theory and robotics

Cart position 0.4

Lower pendulum angle 10

Upper pendulum angle 5

0.2

5

0

0

0

­0.2 ­5
­0.4

­0.6

­10

­5

­0.8

­15

­1

­20

­10

01234567 01234567 01234567

Cart velocity 3

Lower pendulum angle velocity

Upper pendulum angle velocity

100

40

2

30 0

20 1

­100

10

0 0

­1

­200

­10

­2

­300

­20

01234567 01234567 01234567

Figure 14.10 Simulation of DIP on cart based on LQR solution with small deflection

1.5 1
0.5 0
­0.5 0

Cart position 2468

30 20 10 0 ­10 10 0

Lower pendulum angle 20
15
10
5
0
­5
­10 2 4 6 8 10 0

Upper pendulum angle 2 4 6 8 10

2.5 2
1.5 1
0.5 0
­0.5 ­1 0

Cart velocity 2468

Lower pendulum angle velocity

Upper pendulum angle velocity

100

10

0

50

­10

­20 0
­30

­50

­40

­50

­100

­60

10 0 2 4 6 8 10 0 2 4 6 8 10

Figure 14.11 Simulation of DIP on cart based on LQR solution with large deflection

LMI-based control design for balancing and attitude stabilization 373

Cart position 0.3

Lower pendulum position 10

Upper pendulum position 5

0.2

5

0.1

0

0

0

­5

­0.1

­10

­10

01234567 01234567 01234567

Cart velocity 0.8

Lower pendulum angular velocity Upper pendulum angular velocity

40

20

0.6

20

10

0.4

0.2

0

0

0

­20

­10

­0.2

­40

­20

­0.4

­0.6

­60

­30

01234567 01234567 01234567

Figure 14.12 Simulation of DIP on cart based on MPC solution with small deflection

0.4 0.2
0 ­0.2 ­0.4 ­0.6 ­0.8
­1 0
4
2
0
­2
­4 0

Cart position 2468

Lower pendulum angle 30 20 10 0 ­10 ­20 ­30 ­40 10 0 2 4 6 8

Upper pendulum angle 20
10
0
­10
­20 10 0 2 4 6 8 10

Cart velocity 2468

Lower pendulum angle velocity

Upper pendulum angle velocity

200

100

100

80

0

60

40 ­100
20

­200

0

­300

­20

­400

­40

10 0 2 4 6 8 10 0 2 4 6 8 10

Figure 14.13 Simulation of DIP on cart based on MPC solution with large deflection

374 The inverted pendulum in control theory and robotics

0.05 0.04 0.03 0.02 0.01
0 ­0.01 ­0.02 ­0.03
0

Pendulum angles (rad): state-feedback simulation
Lower pendulum Middle pendulum Upper pendulum

Angular velocities (rad/s): state-feedback simulation

0.3

Lower pendulum

Middle pendulum

0.2

Upper pendulum

0.1

0

­0.1

­0.2 1 2 3 4 5 6 7 9 9 10 0 1 2 3 4 5 6 7 9 9 10

Seconds

Seconds

Figure 14.14 Triple IP state trajectories: (left) displacements and (right) velocities

Control signals (volts): state-feedback simulation 7
6
5
4
3
2
1
0 ­1
0 1 2 3 4 5 6 7 8 9 10 Seconds

Figure 14.15 Triple IP control signal

14.9.4 Triple IP
The pendulum links are made of 50-mm-diameter plastic tube which is relatively rigid, cheap, easy to cut and weighs 0.343 kg/m. At both ends of each link, aluminum components (3 mm in thickness) are attached to provide the structures for mounting sensors and actuators. The lower hinge consists of a steel shaft mounted on ball bearings. At one end of the shaft, a potentiometer is mounted to measure the angle of the lower link, while at the other end, a small DC tacho is used to measure angular velocity. The hinges for the middle and upper links are split into two independent (suitably aligned) sections. One section is a short steel shaft mounted on ball bearings and attached to a potentiometer which measures the relative angle between adjacent links. The second section is the output shaft of a DC motor/gearbox. Planetary gearboxes with a rated continuous load capacity of 4.5 Nm were chosen.

LMI-based control design for balancing and attitude stabilization 375

Angles (deg) Angles (deg)

LQR results 250

LQR results 250

1

1

200

2

200

2

3

3

150

150

100

100

50

50

0

0

­50

­50

­100

­100

0 1 2 3 4 5 6 7 8 9 10

0 1 2 3 4 5 6 7 8 9 10

Time t (s)

Time t (s)

Figure 14.16 Simulation of RDIP based on LQR designs: initial (left) and tuned (right)

In Figures 14.14 and 14.15, the ensuing simulation results of TIP displacements, velocity and the corresponding feedback control based on Problem I are plotted.
14.9.5 RDIP simulation
The RDIP experiment platform used for simulation consists of a horizontal base arm (denoted as Link 1) driven by a servo motor and two vertical pendulums (denoted as Links 2 and 3) that move freely in the plane perpendicular to Link 1, as shown in Figure 14.3. Since we will focus on the stabilization of the pendulums, it is convenient to set the coordinate system as in Figure 14.3. In this chapter, the mathematical model of the RDIP will be developed by the use of the E­L function. A simple mathematical model was presented in [45], which assumes that the acceleration of the base arm is able to be manipulated directly and therefore chosen as the system control input. The RDIP simulation results using LQR and its tuned version are depicted in Figures 14.16 and 14.17.
14.9.6 I-PENTAR simulation
For the purpose of simulation and with reference to Figure 14.4, I-PENTAR adopts convenient set of a double motor method for mobile actuation. The robot body composed of two parts (lower and upper), a waist joint and a rate gyro sensor. In addition, a wheel-type roller adheres to the tip of the arm. In Figure 14.18, the internal signal flow of I-PENTAR is depicted. The control and sensor signals between each part and CPU board are interfaced via a field-programmable gate array (FPGA) board in 1-ms sampling time. The two angular velocity values, analog and digital, from the rate gyro sensor are merged and integrated to be used for an inclination angle of the lower body.
In order to evaluate using the stabilization methods of LQR, LQRI, H2 and H, balancing experiments, which are considered one of the fundamental mobile motions of a WIP mobile robot, are conducted with I-PENTAR. In the experiments, I-PENTAR takes an upright-standing posture stretching its waist and extending its arms toward the ground. The position of CoG of the whole body, which is used for

376 The inverted pendulum in control theory and robotics

LQR results

2

LQR

1.5

Tuned LQR

1

0.5

Torque (N.m)

0

­0.5

­1

­1.5

­2

0

1

2

3

4

5

6

7

8

9 10

Time t (s)

Figure 14.17 Control signals for RDIP generated by different design methods

I-PWNTAR

W left Wheel H

E

E L

right Wheel

Encoder DC Motor

B upper body Encoder

O

Gyro digital

Angular Velocity A
D

D

sensor analog

C

Y lower body DC Motor

Angle

CPU board Pentium3 550MHZ

Serial FPGA SCI

Bamp, Time[ms] ARTLinux
merge state Feedback Controller

Counter

left arm A R M right arm

Encoder DC Motor

MOTOR voltage DRIVER duty

PWM

Figure 14.18 Experimental setup of I-PENTAR

The robot inclined angle (rad)

The robot forward movement (m)

0.8 0.6 0.4 0.2
0 -0.2
0
0.8 0.6 0.4 0.2
0 -0.2
0

System response with LQR controller
1 2 3 4 5 6 7 8 9 10 Time (s)
System response with LQR controller
1 2 3 4 5 6 7 8 9 10 Time (s)

The robot inclined angle (rad)

The robot forward movement (m)

System response with LQRI 0.6 0.5 0.4 0.3 0.2 0.1
0 -0.1 -0.2
0 1 2 3 4 5 6 7 8 9 10
Time (s)
System response with LQRI 0.8 0.6 0.4 0.2
0 -0.2 -0.4 -0.2
0 1 2 3 4 5 6 7 8 9 10
Time (s)

Figure 14.19 I-PENTAR closed-loop simulation: (left) LQR response and (right) LQRI response

The robot forward movement (m)

System response with H2 controller 1.2
1 0.8 0.6 0.4 0.2
0 -0.2
0 1 2 3 4 5 6 7 8 9 10 Time (s)

1

System response with H2 controller

0.8

0.6

0.4

0.2

0

-0.2

-0.4 0 1 2 3 4 5 6 7 8 9 10

Time (s)

The robot inclined angle (rad)

The robot forward movement (m)

System response with H infinity controller 1 0.8 0.6 0.4 0.2 0
0 1 2 3 4 5 6 7 8 9 10 Time (s)
System response with H infinity controller 0.8 0.6 0.4 0.2
0 -0.2
0 1 2 3 4 5 6 7 8 9 10 Time (s)

The robot inclined angle (rad)

Figure 14.20 I-PENTAR closed-loop simulation: (left) H2 response and (right) H response

The robot forward movement (m)

LMI-based control design for balancing and attitude stabilization 379

1.2

LQR

1

Hinf

H2/Hinf

0.8

LQRI

H2

0.6

0.4

0.2

0

­0.2

0

1

2

3

4

5

6

7

8

9 10

Time (s)

0.8 0.6 0.4 0.2
0 ­0.2 ­0.4 ­0.6
0

LQR
Hinf H2/Hinf LQRI H2

1

2

3

4

5

6

7

8

9 10

Time (s)

Figure 14.21 Comparison of output trajectories

The robot inclined angle (rad)

defining the robot's inclination angle, is calculated by a geometrical method based on the parameter values of each part.
The ensuing results are depicted in Figures 14.19 and 14.20 for the two output variables: the robot forward movement and the robot inclined angle. In Figure 14.21, a comparison among the design methods is presented.
From the simulation results, we can arrive at the following points:
 Smooth behavior are clearly demonstrated for the patterns of the output variables,  The LQR design determines one gain matrix for the feedback control, while the
LQRI design determines two gain matrices: one for the control and the other for the integral state.

380 The inverted pendulum in control theory and robotics
14.10 Conclusions
In this chapter, we have provided complete analytical results pertaining to dynamic modeling, control design and computer simulation of IP systems. The dynamic modeling covers different cases span from SIP to rotational and WIPs. The control design focused on the development of convex optimization over linear-LMI to yield linear controllers based on various criteria. Finally, MATLAB simulation experiments are performed to demonstrate the effectiveness of the developed methods.
Acknowledgment
This research work is supported by the deanship of scientific research (DSR) at KFUPM through research project no. IN 141048.
References
[1] V. Sukonatanakarn, M. Parnichkun, "Real-time optimal control for rotary inverted pendulum," Am. J. Appl. Sci., vol. 6, no. 6, pp. 1106­1115, 2009.
[2] J. J. Craig, Introduction to robotics: Mechanics & control, Prentice-Hall, Upper Saddle River, NJ, 2005.
[3] J. Akesson, A. Blomdell, R. Braun, "Design and control of YAIP-an inverted pendulum on two wheels robot," IEEE Int. Conf. Control Appl., vol. 2, pp. 2178­2183, 2006.
[4] M. Askari, H. A. F. Mohamed, M. Moghavvemi, S. S. Yang, "Model predictive control of an inverted pendulum," Int. Conf. Tech. Postgraduates, TECHPOS, pp. 1­4, 2009.
[5] R. Balan, V. Maties, O. Hancu, S. Stan, "A predictive control approach for the inverse pendulum on a cart problem," IEEE Int. Conf. Mechatron. Autom., vol. 20, pp. 2026­2031, 2005.
[6] A. M. Almeshal, K. M. Goherb, M. O. Tokhi, "Dynamic modelling and stabilization of a new configuration of two-wheeled machines," Rob. Autom. Syst., vol. 61, pp. 443­472, 2013.
[7] R. P. M. Chan, K. A. Stol, C. R. Halkyard, "Review of modelling and control of two-wheeled robots," Annu. Rev. Control, vol. 37, pp. 89­103, 2013.
[8] K. J. Astrom, K. Furuta, "Swinging up a pendulum by energy control," Automatica, vol. 36, no. 2, pp. 287­295, 2000.
[9] K. Yoshida, "Swing-up control of an inverted pendulum by energy-based methods," Proc. the American Control Conf., San Diego, pp. 4045­4047, 1999.
[10] K. Furuta, T. Okutani, H. Sone, "Computer control of a double inverted pendulum," Comput. Electr. Eng., vol. 5, pp. 67­84, 1978.
[11] S. A. Bortoff, "Robust swing control for a rotational double pendulum," Proc. the 13th IFAC World Conf., San Francisco, pp. 413­419, 1996.

LMI-based control design for balancing and attitude stabilization 381
[12] M. Tsai, B. H. Shen, "Synchronization control of a parallel dual inverted pendulum driven by linear servomotors," IET Control Theory Appl., vol. 1, no. 1, pp. 320­327, 2007.
[13] G. A. Medrano-Cedra, E. E. Eldukhri, M. Cetin, "Balancing and attitude control of double and triple inverted pendulums," Trans. Inst. Meas. Control, vol. 17, no. 3, pp. 143­154, 1995.
[14] H. Li, Z. Miao, J. Wang, "Variable universe adaptive fuzzy control on the quadruple inverted pendulum," Sci. Chin., Ser. E: Technol. Sci., vol. 45, no. 2, pp. 213­224, 2002.
[15] J. Shen, A. K. Sanyal, N. A. Chaturvedi, D. Bernstein, H. McClamroch, "Dynamics and control of a 3D pendulum," Proc. the 43rd IEEE Conf. Decision and Control, Nassau, vol. 1, pp. 323­328, 2004.
[16] O. Boubaker, "The inverted pendulum benchmark in nonlinear control theory: A survey," Int. J. Adv. Rob. Syst., vol. 10, pp. 233­241, 2013.
[17] S. Jeong, T. Takahashi, "Wheeled inverted pendulum type assistant robot: design concept and mobile control," Intell. Serv. Rob., vol. 1, no. 4, pp. 313­ 320, 2008.
[18] A. Sinha, P. Prasoon, P. K. Bharadwaj, A. C. Ranasinghe, "Nonlinear autonomous control of a two-wheeled inverted pendulum mobile robot based on sliding mode," Int. Conf. Comput. Intell. Networks (CINE), vol. 2015, pp. 52­57, 2015.
[19] J. Huang, S. Ri, L. Liu, Y. Wang, J. Kim, G. Pak, "Nonlinear disturbance observer-based dynamic surface control of mobile wheeled inverted pendulum," IEEE Trans. Control Syst. Technol., vol. 23, no. 6, pp. 2400­2407, 2015.
[20] M. A. H. Garzn, W. O. C. Hernndez, A. P. G. Reyes, O. E. C. Quintero, "Two-wheeled inverted pendulum robot NXT Lego Mindstorms: mathematical modeling and real robot comparisons," Rev. Politcnica, vol. 36, no. 1, pp. 1­7, 2015.
[21] M. M. Azimi, H. R. Koofigar, "Model predictive control for a two wheeled self balancing robot," First RSI/ISM Int. Conf. Robotics and Mechatronics (ICRoM), pp. 152­157, 13­15 Feb. 2013.
[22] Z. Li, C. G. Yang, L. Fan (Editors), Advanced control of wheeled inverted pendulum systems, Springer, London, 2013, ISBN: 978-1-4471-2962-2.
[23] Z. Li, C. G. Yang, L. Fan (Editors), Advanced control of wheeled inverted pendulum systems, Springer, London, 2013, ISBN: 978-1-4471-2962-2.
[24] M. G. Calkin, Lagrangian and Hamiltonian mechanics, World Scientific, Singapore, 1996.
[25] P. J. Larcombe, "On the control of a two-dimensional multi-link inverted pendulum: The form of the dynamic equations from choice of co-ordinate system," Int. J. Syst. Sci., vol. 23, pp. 2265­2289, 1992.
[26] J. Driver, D. Thorpe, "Design, build and control of a single/ double rotational inverted pendulum," Technical Report, School of Mechanical Engineering, The University of Adelaide, 2004.

382 The inverted pendulum in control theory and robotics
[27] V. Casanova, J. Salt, R. Piza, A. Cuenca, "Controlling the double rotary inverted pendulum with multiple feedback delays," Int. J. Comput. Commun. Control, vol. 7, pp. 20­38, 2012.
[28] C. Fox, An introduction to the calculus of variations, Dover Publications, New York, NY, 2010.
[29] J. R. Movellan, "DC motors," http://mplab.ucsd.edu/tutorials/DC.pdf, March 2010.
[30] Y. Wang, "Rotation double inverted pendulum," Technical Report, School of Electrical and Computer Engineering, The University of Dayton, April 2012.
[31] M. Demirci, "Design of feedback controllers for a linear system with applications to control of a double-inverted pendulum," Int. J. Comput. Cogn., vol. 2, no. 1, pp. 65­84, 2004.
[32] K. Furuta, T. Ochiai, N. Ono, "Attitude control of a triple inverted pendulum," Int. J. Control, vol. 39, pp. 1351­1365, 1984.
[33] S. Jeong, T. Takahashi, "Wheeled inverted pendulum type assistant robot: design concept and mobile control," Intell. Serv. Rob., vol. 1, no. 4, pp. 313­ 320, May 2008.
[34] A. Salerno, J. Angeles, "Nonlinear controllability of quasi-holonomic mobile robot," Proc. IEEE ICRA, Taiwan, 2003.
[35] F. Grasser, A. D'Arrigo, S. Comlombi, A. Rufer, "Joe: A mobile inverted pendulum," IEEE Trans. Electron., vol. 49, no. 1, pp. 107­114, 2002.
[36] A. Salerno, J. Angeles, "A new family of two wheeled mobile robot: modeling and controllability," IEEE Trans. Rob., vol. 23. no. 1, pp. 169­173, 2007.
[37] E. Koyanagi, S. Lida, S.Yuta, "A wheeled inverse pendulum type self-contained mobile robot and its two-dimensional trajectory control," Proc. ISMCR92, pp. 891­898, 1992.
[38] A. Sinha, P. Prasoon, P. K. Bharadwaj, A. C. Ranasinghe, "Nonlinear autonomous control of a two-wheeled inverted pendulum mobile robot based on sliding mode," Int. Conf. Comput. Intell. Networks (CINE), vol. 1, pp. 52­57, 2015.
[39] J. Huang, S. Ri, L. Liu, Y. Wang, J. Kim, G. Pak, "Nonlinear disturbance observer-based dynamic surface control of mobile wheeled inverted pendulum," IEEE Trans. Control Syst. Technol., vol. 23, no. 6, pp. 2400­2407, 2015.
[40] A. N. K. Nasir, M. A. Ahmad, R. M. T. Raja Ismail, "The control of a highly nonlinear two-wheel balancing robot: A comparative assessment between LQR and PID-PID control schemes", World Academy of Science, Engineering and Technology, vol. 4, pp. 176­181, 2010.
[41] Z. Li, C. Xu, "Adaptive fuzzy logic control of dynamic balance and motion for wheeled inverted pendulums," Fuzzy Sets Syst., vol. 160, no. 12, pp. 1787­ 1803, Jun. 2009.
[42] S. Jung, S. S. Kim, "Control experiment of a wheel-driven mobile inverted pendulum using neural network," IEEE Trans. Control Syst. Technol., vol. 16, no. 2, pp. 297­303, Mar. 2008.

LMI-based control design for balancing and attitude stabilization 383
[43] J. Huang, Z. H. Guan, T. Matsuno, T. Fukuda, K. Sekiyama, "Sliding-mode velocity control of mobile-wheeled inverted-pendulum systems," IEEE Trans. Rob., vol. 26, no. 4, pp. 750­758, Aug. 2010.
[44] C. G.Yang, Z. Li, J. Li, "Trajectory planning and optimized adaptive control for a class of wheeled inverted pendulum vehicle models," IEEE Trans. Cybern., vol. 43, no. 1, pp. 24­36, 2013.
[45] R. W. Brockett, H. Li, "A light weight rotary double pendulum: Maximizing the domain of attraction," Proc. IEEE Decision and Control Conf., (Maui, Hawaii), pp. 3299­3304, Dec. 2003.
[46] K. Pathak, J. Franch, S. K. Agrawal, "Velocity and position control of a wheeled inverted pendulum by partial feedback linearization," IEEE Trans. Rob., vol. 21, no. 3, pp. 505­512, 2005.
[47] J. M. Valenzuelaa, C. A. Avelara, S. P. Guzmnb, V. Santibezc, "Two adaptive control strategies for trajectory tracking of the inertia wheel pendulum: neural networks vis à vis model regressor," Intell. Autom. Soft Comput., 2016, http://dx.doi.org/10.1080/10798587.2015.1121618.
[48] R. Cui, J. Guo, Z. Mao, "Adaptive backstepping control of wheeled inverted pendulums models," Nonlinear Dyn., vol. 79, no. 1, pp. 501­511, 2015.
[49] Y. Maruki, K. Kawano, H. Suemitsu, T. Matsuo, "Adaptive backstepping control of wheeled inverted pendulum with velocity estimator," Int. J. Control Autom. Syst., vol. 12, no. 5, pp 1040­1048, Oct. 2014.
[50] H. Vasudevan, A. M. Dollar, J. B. Morrell, Y. Xia, "Design for control of wheeled inverted pendulum platforms," Trans. ASME, J. Mech. Rob., vol. 7, Nov. 2015, paper 041005.
[51] S. Jeong, T. Takahashi, "Wheeled inverted pendulum type assistant robot: inverted mobile, standing, and sitting motions," IEEE/RSJ Int. Conf. Intell. Rob. Syst., vol. 2007, pp. 1932­1937, 2007.
[52] "Matlab Documents," MPC guide, Mathworks, MPC-HC vol. 1.0.8.0, 2014, USA.
[53] B. D. O. Anderson, J. B. Moore, linear optimal control, Prentice-Hall, Inc., Englewood Cliffs, NJ, 1971.
[54] M. S. Mahmoud, Y. Xia, Applied control systems design: State-space methods, Springer-Verlag, UK, 2012.
[55] K. Zhou, J. C. Doyle, Essentials of robust control, Prentice-Hall, New Jersey, 1998.
[56] M. S. Mahmoud, Resilient control of uncertain dynamical systems, Springer, Heidelberg, 2004.

Index

accuracy analysis 72, 88­90 acrobat 8 active fault-tolerant control (AFTC)
scheme 309 inverted-pendulum modeling 311
mathematical model 311­13 T­S model 313­15 motivation 311 simulation results 336 simultaneous faults estimation
design 338 T­S dynamic output feedback
controller (TS-DOFC) design 338­40 T­S sliding-mode observer (TS-SMO) design 337­8 sliding-mode observation, fault reconstruction by 315 existence conditions 318­19 simultaneous actuator and sensor faults estimation 328­9 sliding motion reachability 326­7 sliding motion stability 323­6 system description 315­18 T­S model in canonical form 319­23 Takagi­Sugeno (T­S) fuzzy systems, fault-tolerant controller design for 329­36 adaptive factor 103 adding power integrator (API) technique 167 advances in control theory 14 challenging control problems 16­18 emerging control problems 14­16 affine switched ULTIS (ASULTIS) 157

alpha-beta filter 131 angular momentum pendulum model
19 arbitrary order controllers design
77­8 arbitrary order dynamic system 76 Ardence RTX 122
B2 19, 194 bachelor's thesis 4 Back Propogation (BP) algorithm 271 ball and beam benchmark 5 bicycle benchmark 6 bifurcation 18 bipedal-double-pendulum walking robot
control 263 impact 266­7 neural network controller 270­1 proposed neural network 267­9 results 271­6 walking 266 bipedal robot 263 parameters of 271 schematic configuration of 265
CaPaMan (Cassino Parallel Manipulator) 227, 246­51
cart-inverted pendulum system 9, 95 dynamic modeling 97­8 system presentation 95­6
cart­pendulum system 78 linear model 81­2 mathematical model 79 equilibrium points 80 nonlinear model 79 stability analysis 80­1

386 The inverted pendulum in control theory and robotics

modelling of 227­31 realization 83­7 cart­pole system 166, 182­7 cart system, nonlinear inverted
pendulum with 309, 312 cart velocity estimation 56, 64 center of mass, stabilizing 3 chaos analysis 18 Chetaev's instability theorem 80 collocated partial linearization 169 commercial devices 12­13 continuous finite-time observers 44 continuous higher order sliding-mode
controllers 75, 83 arbitrary order controllers design
77­8 continuous integral sliding-mode
control 76­7 integral sliding-mode control 76 relative degree four SMC 87 relative degree one SMC 86 relative degree three SMC 87 relative degree two SMC 86 continuous integral sliding-mode
control 76­7 control analysis 232
linear control analysis 232­3 non-linear control analysis 233­7 ControlDesk 13 controllability and observability
analysis 81­2 controllable canonical form 82 control law 123 controlled estimation error 323 control problems, challenging 16­18 control theory, advances in 14
challenging control problems 16­18 emerging control problems 14­16 cyclic reference trajectories generation
125­6
decoupled MM 284 degrees of freedom 165­6 double inverted pendulum (DIP) system
9, 348, 352­4, 371­4

double-link inverted pendulum and cart system diagram 230
dSPACE software 13 D-stable matrix 335 dual model-free controller 125­8 dynamic modeling 167­73, 350­1
and problem statement 138­41 dynamic surface control (DSC) 194 dynamic surface controller with a
nonlinear disturbance observer (DSCNDO) 193, 205, 210­12 simulation of, for MWIP 219­21
Educational Control Products 13 electromotive force (EFM) constant
97 emerging control problems 14­16 Engineer's thesis 4 Euler­Lagrange equations 167­8 Euler­Lagrange method 356 Euler's method 236 event-triggered control 17 experimental laboratories 12
commercial devices 12­13 universities platforms 13 virtual models 13 exponential convergence controller
77
fault diagnosis (FD) technology 17, 310
fault estimation (FE) 310 fault-tolerant control (FTC) technology
17, 310, 312 fault-tolerant controller design for T­S
fuzzy systems 329­36 Feedback Instruments Digital Inverted
Pendulum 239 feedback instruments digital pendulum
242 field-programmable gate array (FPGA)
375 finite-time algorithm 61­3 finite-time convergence 44 finite-time convergence controller 78

Index 387

finite-time stabilization of underactuated mechanical systems: see underactuated mechanical systems, finite-time stabilization of
finite-time velocity observers 141 first-order sliding-modes (FOSM)
output injections 43 fitness function 104 five-link planar bipedal robot 264­5 fixed-time convergence 44, 48, 53 fixed-time observer 51­4 fractional controller 100­2 fractional order calculus 100­1 fractional-order control 17
tuning parameters of 102 fractional-order controller 17
tuning parameters of 102­4 fractional order PID (FOPID) controller
94, 101­2 friction, defined 18 friction coefficients 43, 45 Furuta pendulum 12, 45 fuzzification process 286
globally asymptotically stable system 291, 294
GoogolTechnology Linear single inverted pendulum 95­6
Googol Technology products 13 Grunwald­Letnikov (GL) fractional
calculus 94 Gyro Boy 243 Gyro sensor 245­6
Hamiltonian equation 227 higher order sliding-mode (HOSM)
stabilization of inverted cart­pendulum 71 cart­pendulum system 78 linear model 81­2 mathematical model 79­81 realization 72 results 88 accuracy analysis 88­90

singular LQ sliding variable design 72
MATLAB® function 75 see also continuous higher order
sliding-mode controllers high-order sliding-mode (HOSM)
observers 43­5, 48 experimental results 54­7 fixed-time observer 51­4 super-twisting observer 49­51 homogeneous algorithm 59­60 horizontal force 3 humanoid robots using LIPM principles
19
identification theory 44 inertial wheel pendulum (IWP) 152,
155­8, 160­2 inertia wheel inverted pendulum
119­20 control PC and software, description
of 122 dynamic parameters of 129 electronic part of the system,
description of 121­2 inertia wheel inverted pendulum
system, application 128 dynamic modeling of the system
128­9 mechanical part of 120­1 numerical simulations 129­31 principle schematic view of 128 real-time experiments 131
external disturbance rejection 132­4
nominal case, control in 132 testbed of 121 underactuated systems, proposed
control solution for 122 basic principle of the proposed
control scheme 124­5 cyclic reference trajectories
generation 125­6 dual model-free controller 126­8 model-free control strategy 122­3

388 The inverted pendulum in control theory and robotics

inertia wheel pendulum 8, 137­40, 166 inertia wheel pendulum reference model
normal form transformation of 147­8
INTECO cart­pendulum system 84 INTECO inverted pendulum 13 integral discontinuous control (IDC)
76, 86 integral sliding-mode control (ISMC)
76, 166 integral sliding modes (ISM) 152
switched ISMs 158­60 inverted-pendulum benchmarks 5­11
on a cart 10 on a pivot 7 varieties of 7 inverted-pendulum modeling 4, 311 mathematical model 311­13 Takagi­Sugeno (T­S) model 313­15 inverted pendulum on pivot 353 DIP on pivot 353­4 TIP on pivot 354­5 inverted pendulum-type assistant robot
358­60 Inverted PENdulum Type Assistant
Robot (I-PENTAR) simulation 19, 349, 375­9 i-PID (intelligent PID) 122­3
JOE 19, 194
Kajita cart-table model 19 Kalman filters 45, 94
Lagrange equations 350 Lagrange­Euler formulation 5 Lagrange formulation 128 Lagrange's equations 226, 228, 230 Lagrangian approach 227­8, 236 Lagrangian formalism 167­73 least squares (LS) methods 44 LEGO EV3-based inverted pendulum
239­40 construction of 243­5

controller design and Simulink model 245­6
experimental results 246 LEGO Mindstorms EV3 240­3 rotary inverted pendulum using
244 single inverted pendulum on cart
using 244­5 LEGO Gyroboy 243 LEGO products 12 Legway 194 linear control analysis 232­3 linear-matrix inequalities (LMI)-based
control design 347 double inverted pendulum (DIP) on
cart 371­4 dynamic modeling 350­1 inverted pendulum on pivot 353
DIP on pivot 353­4 TIP on pivot 354­5 inverted pendulum-type assistant
robot 358­60 Inverted PENdulum Type Assistant
Robot (I-PENTAR) simulation 375­9 linear quadratic control with disturbance rejection (LQR+) 363­4 linear quadratic integral control with disturbance rejection (LQRI+) 364­5 linear quadratic regulator (LQR) 361­2 linear quadratic regulator with integral gain (LQRI) 362­3 model-predictive control 365­7 multiobjective state feedback 367­9 pendulums on cart 351 double pendulums on cart 352 single pendulum on cart 351 state-space representation 352­3 rotational double inverted pendulum (RDIP) simulation 356­8, 375

Index 389

single inverted pendulum (SIP) SIP­double inverted pendulum (DIP) open-loop response 369­70 SIP linear quadratic regulator (LQR) response 370­1
triple IP 374­5 linear matrix inequalities (LMI)
optimization problem 309 linear quadratic control (LQR) design
360 linear quadratic control with disturbance
rejection (LQR+) 363­4 linear quadratic integral control (LQRI)
design 360 linear quadratic integral control with
disturbance rejection (LQRI+) 364­5 linear quadratic regulator (LQR) 232, 264, 359, 361­2 LQR controller 217, 220 linear quadratic regulator with integral gain (LQRI) 362­3 Lipschitz function 76 Lipschitz nonlinear systems 310 LIRMM Laboratory of Informatics, Robotics and Microelectronics (France) 13 locus of perturbed relay system (LPRS) 151, 154 Luenberger observer 292 Lyapunov function 143, 291, 295, 297­8, 302, 304­5, 323, 326, 362­5 Lyapunov matrix 291, 320­1 Lyapunov stability analysis 285
MAGMA driver 121 major accomplishments in robotics 18
modeling and controlling under-actuated mechanical systems 18­19
modeling and controlling walking pattern generation 19

self-balanced mobile-wheeled robots 19
MATLAB 13, 75, 254 MATLAB Simulink platform 13, 54,
129 Maxon EC-powermax 30 DC motor
121 measurable premise variables 286,
292­3, 296­7 The Mechanical Seal 4 membership functions of two-rule
model 314­15 mobile robots 19 mobile wheeled inverted pendulum
(MWIP), robust control of 193 controller design 207­17 modeling
analysis of equilibriums 197­8 dynamic model, derivation of
195­7 nonlinear disturbance observer
design for 205­7 simulation of DSCNDO for 219­21 simulation of SMC for 217
type-I SMC controller 217­18 type-II SMC controller 218­19 sliding mode controller design for
198 type-I sliding mode controller
198­202 type-II sliding mode controller
202­5 model-free control strategy 120, 122
control law 123 nonlinear dynamics 122­3 model-predictive control 348, 365­7 modified particle swarm optimization
94­5, 103­4 MPSO-FOPID 107, 109, 111 multiobjective state feedback 367­9 multiple models (MMs) 283­4
Nbot 194 neural network (NN) controller 268­71 Newton­Euler formulation 5

390 The inverted pendulum in control theory and robotics

Newton's laws of motion 356 Newton's second law 227­8 noise filtering 131 nominal linear time-invariant system
(NLTIS) 153 non-linear control analysis 233­7 non-linear control theory of inverted
pendulum 225 cart­pendulum systems, modelling of
227­31 LEGO EV3-based inverted pendulum
239 construction of 243­5 controller design and Simulink
model 245­6 experimental results 246 LEGO Mindstorms EV3 240­3 linear control analysis 232­3 non-linear control analysis 233­7 parallel kinematic manipulator
246­53 single and double pendulum control,
simulations for 237­9 solving and implementing control
solutions using MATLAB 254 non-linear control of a single
pendulum and cart system 254­9 nonlinear disturbance observer (NDO) 194­5, 205 nonlinear dynamics 122­3 normal form 169
observer-based controller 4, 15, 17 observer-based control problem 15 observer-based feedback controller
296, 299 observer-based state feedback
stabilization, polytopic T­S models 296 measurable premise variables 296­7 uncertain polytopic T­S systems 302­3 unmeasurable premise variables 298­301

observer gains 292­4 open source inverted-pendulum virtual
models 13 orbital stabilization of pendulum
systems 18 orbital stabilization problems 137 output feedback control 15, 17, 166,
303 output feedback second-order
sliding-mode tracking control 137 control synthesis 142­5 dynamic model and problem statement 138­41 numerical results 145­6 observer design 141
parallel distributed compensation (PDC) 294
parallel kinematic manipulator 246­53 particle swarm optimization (PSO) 94,
102­3 modified particle swarm optimization
(MPSO) 103­4 pendubot 8 pendulum­cart system 43
high-order sliding-mode observers 48
experimental results 54­7 fixed-time observer 51­4 super-twisting observer 49­51 parameter identification algorithms
58 experimental results 63­6 finite-time algorithm 61­3 homogeneous algorithm 59­60 preliminaries 47­8 problem statement 45­7 pendulums on cart 349, 351 double pendulums on cart 352 single pendulum on cart 351 state-space representation 352­3 pendulum systems 2 cart-inverted: see cart-inverted
pendulum system

Index 391

cart­pendulum system 78­82, 227­37
inverted-pendulum system 3­4, 13­14, 16, 18
Planar Vertical Take Off and Landing (PVTOL) aircraft 122
PMP 19 Poincaré­Andronov­Hopf bifurcation
18 Poincaré map 151, 166 polytopic Takagi­Sugeno (T­S)
approach: see Takagi­Sugeno (T­S) polytopic approach p-parameterized periodic trajectories 120, 134 premise variables 286­8 measurable 292­3, 296­7 unmeasurable 293­4, 298­301 proportional derivative (PD) controller 263 proportional integral derivative (PID) controller 94 proposed control solution 120, 123 basic principle of 124­5 cyclic reference trajectories generation 125­6 dual model-free controller 126­8 pseudolinearization 166 PSO-FOPID controller 107, 109 pulse-width-modulation (PWM) voltage signal 46 PVTOL (PlanarVerticalTakeoff and Landing) 165
quadratic infinite-time cost function 232
quadruple-inverted pendulum 11 Quanser linear servo cart 239, 241 Quanser products 12­13 Quanser rotary inverted pendulum 239,
242
real pendulum­cart system 54, 63 Rex Controls Furuta pendulum 13 Riccati equation 77, 226, 232, 236­7

robust active fault-tolerant control scheme: see active fault-tolerant control (AFTC) scheme
robust controller design for underactuated systems 221
robust fault-tolerant control 17 Robustified Fourth-Order Hong
Controller 87 Robustified LQR controller 87­8 Robustified second-order Hong's
controller 85­6, 89 Robustified third-order Hong controller
86­7 robustness-based sliding mode
techniques 16 robustness-based T­S fuzzy models 17 robust output feedback tracking control
problem 137 root mean square (RMS) value 55 root mean square errors (RMSEs) 275 rotational double inverted pendulum
(RDIP) 349, 356­8, 375 RTWT (real-time windows target)
MathWorks Toolbox 84 Runge­Kutta method 236­7, 246, 253
Schur complement 333 Scopus bibliographic database 4 second-order sliding-mode observer
99, 138 sector-nonlinearity transformation
(SNT) 283, 285­6, 289 Segway 19 selective compliance assembly robot
arm (SCARA) 194, 263 self-balanced mobile-wheeled robots
19 self-oscillation (SO) 138, 151
generation and stabilization of 18 preliminaries and problem
formulation 153 motivational example 155­7 problem statement 157­8 two-relay controller 153­5 uncertain system 153

392 The inverted pendulum in control theory and robotics

simulation example 161­2 switched integral sliding modes 158
controller design 159­61 sliding variable design 158­9 SimMechanics 13 Simulink model for control subsystem
248 single and double pendulum control,
simulations for 237­9 single inverted pendulum (SIP) 227,
236, 245, 351 physical parameters of 246 SIP­double inverted pendulum (DIP)
open-loop response 369­70 SIP linear quadratic regulator (LQR)
response 370­1 single pendulum and cart system
non-linear control of 254­9 singular LQ sliding variable design
72­5 sliding-mode-based auxiliary controller
76 sliding-mode-control methods 71,
193­5 simulation of, for MWIP 217­19 sliding mode controller design for
MWIP 198 type-I SMC controller 198­202 type-II SMC controller 202­5 sliding-mode observation, fault
reconstruction by 315 existence conditions 318­19 simultaneous actuator and sensor
faults estimation 328­9 sliding motion reachability 326­7 sliding motion stability 323­6 system description 315­18 T­S model in canonical form 319­23 sliding-mode observer (SMO) 16, 310,
322 high-order: see high-order
sliding-mode (HOSM) observers sliding-mode techniques 43

pendulum­cart system: see pendulum­cart system
sliding surface 71, 83, 198, 326 spherical pendulum 9 spring-loaded inverted pendulum 19 SSLQ 75 stabilization and tracking control of
inverted pendulum 93 cart-inverted pendulum system 95
dynamic modeling 97­8 system presentation 95­6 control system 99 fractional controller 100 super-twisting observer 99­100 tuning parameters of
fractional-order controller 102 simulation results 104­11 stabilization problem around the upright
position 14­15 stabilizing controller 125, 129, 134 stance foot 266 state estimation error 293­4, 326 state-estimation problem 43, 94 state feedback stabilization
classical 295­6 for uncertain polytopic T­S systems
302­3 state-space representation 352­3 static output feedback stabilization,
polytopic T­S models 303­5 Strong Inertial Coupling 125 super-twisting algorithm (STA) 44, 75,
86 super-twisting observer 49­51, 56, 95,
99­100, 111 swing foot 266­7 swing up control 93­4 swing-up problem 14 switched ISM (SISM) 152, 158­62
Takagi­Sugeno (T­S) model 313­15 in canonical form 319­23 fault-tolerant controller design for 329­36

Index 393

T­S dynamic output feedback controller (TS-DOFC) design 338­40
T­S sliding-mode observer (TS-SMO) design 337­8
Takagi­Sugeno (T­S) polytopic approach 283
observer-based state feedback stabilization 296
measurable premise variables 296­7
state feedback stabilization for uncertain polytopic T­S systems 302­3
unmeasurable premise variables 298­301
observer design for 291 measurable premise variables 292­3 unmeasurable premise variables 293­4
stability analysis of 290­1 state feedback stabilization 295
classical 295­6 static output feedback stabilization
303­5 systematic transformation of a
nonlinear system into 285­90 Taylor series 81, 235 3D linear inverted-pendulum models (LIPM) 19 time-delayed control 17­18 TORA benchmark 6 tracking control 54, 94 tracking controller 126­7, 132, 134,
137­8 tracking control problem 137 tracking problem 4, 15, 137 translational oscillator with a rotational
actuator (TORA) 6 triple inverted pendulum (TIP) 10,
354­5 triple IP 374­5 twin-inverted pendulum on a cart 10

two-relay controller (TRC) 137­8, 141, 152
two-wheeled robots (TWR) 348­9 type-I sliding mode controller for
MWIP 198­202 simulation study for 217­18 type-II sliding mode controller for
MWIP 202­5 simulation study for 218­19
uncertain linear time-invariant system (ULTIS) 153
uncertain polytopic T­S systems, state feedback stabilization for 302­3
underactuated mechanical systems 10­11, 165
modeling and controlling 18­19 underactuated mechanical systems,
finite-time stabilization of 165 cart­pole system 182­7 control problem formulation 173­4 Lagrangian formalism 167­73 preliminaries 174 proposed control design 174­82 underactuated mechanical systems,
proposed control solution for 122 model-free control strategy 122 control law 123 nonlinear dynamics 122­3 proposed control solution 123 basic principle of 124­5 cyclic reference trajectories generation 125­6 dual model-free controller 126­8 universities platforms 13 unmeasurable premise variables 293­4, 298­301 UW-Car 19, 194
variable impedance LIPM 19 vertical take-off and landing (VTOL)
aircraft 6 Virgo inverted pendulum 45, 94

394 The inverted pendulum in control theory and robotics

virtual models 13 virtual sliding variable 77 VTOL Aircraft benchmark 6
walking pattern generation modeling and controlling 19
weighting functions 284, 292 wheeled inverted pendulum (WIP)
systems 11­12, 19, 45, 348

wheeled robots 19 wheel velocity error 142
Young's inequality 215
Zubov's theorem 62

