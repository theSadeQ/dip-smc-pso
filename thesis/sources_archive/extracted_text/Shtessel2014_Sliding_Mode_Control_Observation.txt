Control Engineering
Yuri Shtessel Christopher Edwards Leonid Fridman Arie Levant
Sliding Mode Control and Observation

Control Engineering
Series Editor
William S. Levine Department of Electrical and Computer Engineering University of Maryland College Park, MD USA

Editorial Advisory Board
Okko Bosgra Delft University The Netherlands
Graham Goodwin University of Newcastle Australia
Iori Hashimoto Kyoto University Japan
Petar Kokotovic´ University of California Santa Barbara, CA USA

Manfred Morari ETH Zu¨ rich Switzerland
William Powers Ford Motor Company (retired) Detroit, MI USA
Mark Spong University of Illinois Urbana-Champaign USA

For further volumes: http://www.springer.com/series/4988

Yuri Shtessel · Christopher Edwards Leonid Fridman · Arie Levant
Sliding Mode Control and Observation

Y. Shtessel Department of Electrical and Computer
Engineering University of Alabama in Huntsville Huntsville, AL, USA

C. Edwards College of Engineering, Mathematics
and Physical Science University of Exeter Exeter, UK

L. Fridman Department of Control Division of Electrical Engineering Faculty of Engineering National Autonomous University of Mexico Mexico

A. Levant Department of Applied Mathematics School of Mathematical Sciences Tel-Aviv University Israel

ISBN 978-0-8176-4892-3

ISBN 978-0-8176-4893-0 (eBook)

DOI 10.1007/978-0-8176-4893-0

Springer New York Heidelberg Dordrecht London

Library of Congress Control Number: 2013934106

Mathematics Subject Classifications (2010): 93B12, 93C10, 93B05, 93B07, 93B51, 93B52, 93D25

© Springer Science+Business Media New York 2014 This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part of the material is concerned, specifically the rights of translation, reprinting, reuse of illustrations, recitation, broadcasting, reproduction on microfilms or in any other physical way, and transmission or information storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology now known or hereafter developed. Exempted from this legal reservation are brief excerpts in connection with reviews or scholarly analysis or material supplied specifically for the purpose of being entered and executed on a computer system, for exclusive use by the purchaser of the work. Duplication of this publication or parts thereof is permitted only under the provisions of the Copyright Law of the Publisher's location, in its current version, and permission for use must always be obtained from Springer. Permissions for use may be obtained through RightsLink at the Copyright Clearance Center. Violations are liable to prosecution under the respective Copyright Law. The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication does not imply, even in the absence of a specific statement, that such names are exempt from the relevant protective laws and regulations and therefore free for general use. While the advice and information in this book are believed to be true and accurate at the date of publication, neither the authors nor the editors nor the publisher can accept any legal responsibility for any errors or omissions that may be made. The publisher makes no warranty, express or implied, with respect to the material contained herein.

Printed on acid-free paper

Springer is part of Springer Science+Business Media (www.birkhauser-science.com)

We dedicate this book with love and gratitude to
Yuri's wife Nina, Chris' parents Shirley and Cyril, Leonid's wife Millie, Arie's wife Irena.

Preface
Control in the presence of uncertainty is one of the main topics of modern control theory. In the formulation of any control problem there is always a discrepancy between the actual plant dynamics and its mathematical model used for the controller design. These discrepancies (or mismatches) mostly come from external disturbances, unknown plant parameters, and parasitic dynamics. Designing control laws that provide the desired closed-loop system performance in the presence of these disturbances/uncertainties is a very challenging task for a control engineer. This has led to intense interest in the development of the so-called robust control methods, which are supposed to solve this problem. In spite of the extensive and successful development of robust adaptive control [159], H1 control [48], and backstepping [121] techniques, sliding mode control (SMC) remains, probably, the most successful approach in handling bounded uncertainties/disturbances and parasitic dynamics [67, 182, 186].
Historically sliding modes were discovered as a special mode in variable structure systems (VSS). These systems comprise a variety of structures, with rules for switching between structures in real time to achieve suitable system performance, whereas using a single fixed structure could be unstable. The result is VSS, which may be regarded as a combination of subsystems where each subsystem has a fixed control structure and is valid for specified regions of system behavior. It appeared that the closed-loop system may be designed to possess new properties not present in any of the constituent substructures alone. Furthermore, in a special mode, named a sliding mode, these properties include insensitivity to certain (so-called matched) external disturbances and model uncertainties as well as robustness to parasitic dynamics. Achieving reduced-order dynamics of the compensated system in a sliding mode (termed partial dynamical collapse) is also a very important useful property of sliding modes. One of the first books in English to be published on this subject is [85]. The development of these novel ideas began in the Soviet Union in the late 1950s.
The idea of SMC is based on the introduction of a "custom-designed" function, named the sliding variable. As soon as the properly designed sliding variable becomes equal to zero, it defines the sliding manifold (or the sliding surface). The
vii

viii

Preface

proper design of the sliding variable yields suitable closed-loop system performance while the system trajectories belong to the sliding manifold. The idea of SMC is to steer the trajectory of the system to the properly chosen sliding manifold and then maintain motion on the manifold thereafter by means of control, thus exploiting the main features of the sliding mode: its insensitivity to external and internal disturbances matched by the control, ultimate accuracy, and finite-time convergence of the sliding variables to zero.
The first well-cited text in English on SMC was by Itkis and published in 1976 [113]. By 1980, the main contributions in SMC theory had been completed and subsequently reported in Utkin's 1981 monograph (in Russian) and its subsequent English version [182]. A comprehensive review was published by DeCarlo et al. in [56]. In these publications (see also the advanced results presented in the later works [186] and [67]), the two-step procedure for SMC design was clearly stated.
The first step involves the design of a switching function so that the system motion on the sliding manifold (termed the sliding motion) satisfies the design specifications. The second step is concerned with the selection of a control law, which will make the sliding manifold attractive to the system state in the presence of external and internal disturbances/uncertainties. Note that this control law is not necessarily discontinuous.
SMC-based observers allow estimation of the systemstates in the presence of unknown external disturbances, which can also be explicitly reconstructed online by an observer.
Control chattering still remained a problem impeding SMC implementation. Addressing control chattering was the main motivation for the emerging so-called second-order sliding. Thus, the already matured conventional SMC theory received a significant boost in the middle of the 1980s: when new "second-order" ideas appeared [132] and then, in the beginning of 2000s, when "higher-order" [124] concepts were introduced. The introduction of these new paradigms was dictated by the following reasons:
1. The conventional sliding mode design approach requires the system relative degree to be equal to one with respect to the sliding variable. This can seriously constrain the choice of the sliding variable.
2. Also, very often, a sliding mode controller yields high-frequency switching control action that leads to the so-called chattering effect, which is difficult to avoid or attenuate.
These intrinsic difficulties of conventional SMC are mitigated by higher-order sliding mode (HOSM) controllers that are able to drive to zero not only the sliding variable but also its k 1 successive derivatives (kth-order sliding mode). The novel approach is effective for arbitrary relative degrees, and the well-known chattering effect is significantly reduced, since the high-frequency control switching is "hidden" in the higher derivative of the sliding variable.
When implemented in discrete time, HOSM provides sliding accuracy proportional to the kth power of the sampling time, which makes HOSM an enhancedaccuracy robust control technique. Since only the kth derivative of the sliding manifold is proportional to the high-frequency switching control signal, the switch-

Preface

ix

ing amplitude is well attenuated at the sliding manifold level, which significantly reduces chattering.
The unique power of the approach is revealed by the development of practical arbitrary-order real-time robust exact differentiators, whose performance is proved to be asymptotically optimal in the presence of Lebesgue-measurable input noises. The HOSM differentiators are used in advanced HOSM-based observers for the estimation of the system state in the presence of unknown external disturbances, which are also reconstructed online by the observers. In addition HOSM-based parameter observers have been developed as well.
The combination of a HOSM controller with the above-mentioned HOSM-based differentiator produces a robust and exact output-feedback controller. No detailed mathematical models of the plant are needed. SMC of arbitrary smoothness can be achieved by artificially increasing the relative degree of the system, significantly attenuating the chattering effect. For instance, the continuous control function can be obtained if virtual control in terms of the control derivative is designed in terms of SMC. In this case, the control function will be continuous, since it is equal to the integral of the high-frequency switching function. In the case of parasitic/unmodeled dynamics the SMC function will switch with lower frequency (the control chattering). Designing the SMC in terms of the derivative of the control function yields chattering attenuation.
The practicality of conventional SMC and HOSM control and observation techniques is demonstrated by a large variety of applications that include DC/DC and AC/DC power converters, control of AC and DC motors and generators, aircraft and missile guidance and control, and robot control.
SMC is a mature theory. This textbook is mostly based on the class notes for the graduate-level courses on SMC and Nonlinear Control that have been taught at the Department of Electrical and Computer Engineering, the University of Alabama in Huntsville; at the Department of Engineering, the University of Leicester; at the Department of Control Engineering and Robotics, the Engineering Faculty, the National Autonomous University of Mexico and at the Department of Applied Mathematics, the Tel Aviv University for the last 10­15 years. The course notes have been constantly updated during these years to include newly developed HOSM control and observation techniques.
This textbook provides the reader with a broad range of material from first principles up to the current state of the art in the area of SMC and observation presented in a pedagogical fashion. As such it is appropriate for graduate students with a basic knowledge of classical control theory and some knowledge of state-space methods and nonlinear systems. The resulting design procedures are emphasized using Matlab/Simulink software.
Fully worked out design examples are an additional feature. Practical case studies, which present the results of real sliding mode controller implementations, are used to illustrate the successful practical application of the theory. Each chapter is equipped with exercises for homework assignments.

x

Preface

The textbook is structured as follows. In Chap. 1 we "intuitively" introduce the main concepts of SMC for regulation and tracking problems, as well as state and input observation using only basic control system theory. The sliding variable and SMC design techniques are demonstrated on tutorial examples and graphical expositions. The reaching and sliding phases of the compensated system dynamics are identified. Advanced concepts associated with conventional sliding modes, including sliding mode observers/differentiators and second-order sliding mode controllers, are studied on a tutorial level. Robust output tracking controller design based on a relative degree approach is studied. The design framework comprises conventional and secondorder sliding modes as well as sliding mode observers. The main advantages of SMC and HOSM control, including robustness, finite-time convergence, and reducedorder compensated dynamics, are demonstrated through numerous examples and simulation plots. In Chap. 2 we formulate and rigorously study the conventional multivariable SMC problem using linear algebra and Lyapunov function techniques. The interpretation of the sliding surface design problem as a straightforward linear statefeedback problem for a particular subsystem is emphasized. A variety of methods for sliding surface design, including linear quadratic minimization and eigenvalue placement algorithms, are presented. Possible control design strategies to enforce a sliding motion, including the unit-vector control structure, are described, and the problem of smoothing undesirable discontinuous signals is addressed. The outputfeedback SMC techniques that do not require measurement of the system states are presented. Integral sliding modes (ISM) that are a special type of conventional SMC are discussed in detail. The ability of ISM to be initiated without a reaching phase is emphasized. The specific property of ISM that consists of retaining the order of the compensated system is studied. The use of ISM for disturbance compensation is discussed together with a linear quadratic regulation (LQR) problem, "robustified" via ISM. Several examples illustrate the ISM concept. In Chap. 3 a detailed coverage of conventional sliding mode observers (CSMOs) for state estimation and unknown input reconstruction in dynamic systems is presented. The design techniques for a variety of CSMOs are rigorously studied using linear algebra and Lyapunov function techniques. The robustness properties of CSMO are discussed. Several examples illustrate the CSMO design and demonstrate their performance via simulations. The chapter ends with a list of exercises for homework assignments. In Chap. 4 second-order sliding mode (2-sliding mode or 2-SM) control is studied as a new generation of conventional SMC. The main definitions, properties and design frameworks for 2-SM control, and associated observers/differentiators are rigorously presented. The essential properties of 2-SM control, including finitetime convergence to zero of the sliding variable and its derivative in the presence of disturbances/uncertainties as well as the ability of computer-implemented 2SM control to provide enhanced stabilization accuracy that is proportional to the square of the time increment, are emphasized. Several particular types of 2-SM control algorithms, including twisting and super-twisting controllers, the suboptimal

Preface

xi

control algorithm, the control algorithm with prescribed convergence law, and the quasi-continuous control algorithm, are introduced. A special case of 2-SM, supertwisting SMC with variable gains, is also studied analytically and experimentally. An output regulation problem solution is described in terms of the above-mentioned 2-SM controllers. In particular the chattering attenuation capabilities of 2-SM controllers are emphasized. Numerous examples illustrate the advantages in terms of performance of 2-SM controllers. The chapter culminates with a list of exercises for homework assignments.
In Chap. 5 we study a very important robustness property of conventional SMC and 2-SM-based controllers to parasitic dynamics using frequency-domain techniques.The describing function technique is used to estimate both amplitude and frequency of the switching control oscillation as soon as the transient response is over. The robustness of conventional SMC to first- and second-order parasitic dynamics is described. The analysis of oscillations with finite amplitude and frequency in 2-SM controllers, including the twisting and super-twisting controllers and the quasi-optimal controller, in the presence of first- and second-order parasitic dynamics, is performed. Numerous examples illustrate the performances of conventional SMC and 2-SM-based controllers. Exercises for homework assignment are presented at the end of the chapter.
In Chap. 6 the concept of 2-SM control is generalized by introducing HOSM control that is a new generation of SMC. The ability of HOSM control to drive the sliding variable and its k 1 successive derivatives (a so-called kth-order sliding mode) to zero in finite time is rigorously derived and discussed. Two families of HOSM control algorithms, a nested SMC algorithm and a quasi-continuous control algorithm, are introduced. Homogeneity and contractivity-based techniques that are used for HOSM control analysis and design are described. The efficacy of HOSM control for systems with arbitrary relative degree with respect to the sliding variable is identified. Significant attenuation of the well-known chattering effect via HOSM control is described. The HOSM-based arbitrary-order online robust exact differentiator is introduced and discussed. Several examples are presented to illustrate the performance of HOSM controllers and differentiators. The application of the HOSM controllers and differentiators to blood glucose regulation, using an insulin pump in feedback, illustrates the HOSM algorithms. A list of exercises for homework assignments completes the chapter.
In Chap. 7 we revisit the state observation and identification problem, previously studied in Chap. 3. In this chapter state observation, identification, and input reconstruction are discussed using algorithms based on HOSM exact differentiators. HOSM observers for nonlinear systems are described. Parameter identification algorithms using HOSM techniques are presented and discussed. Several examples, including pendulum and satellite dynamics estimation and identification, are presented to illustrate the performance of the HOSM observation and identification algorithms. The exercises for homework assignments are presented at the end of the chapter.
In Chap. 8 we describe output regulation and tracking problems addressed by conventional SMC and HOSM controllers driven by sliding mode disturbance

xii

Preface

observers (SMC­SMDO). The particular features of the application of SMC/HOSM observers to the above-mentioned output regulation/tracking problems, including the necessity to differentiate the measured output in order to implement the SMC or HOSM controller, as well as the possibility of reconstructing unknown external disturbances via SMC/HOSM observers with the possibility to compensate for them within a traditional continuous controller, are emphasized. The continuous SMC­SMDO design techniques are illustrated with two case studies: launch vehicle attitude control and satellite formation control. A variety of exercises are presented at the end of this chapter to facilitate homework assignments.
The contribution of the authors to this textbook is as follows: Dr. Shtessel has written the Preface and Chaps. 1 and 8 and has contributed to Chap. 5 by writing Sect. 5.2 and Chap. 6 by writing Sect. 6.11. Dr. Edwards has written Chaps. 2 and 3. He has also carried out the bulk of the editorial work. Dr. Fridman has written Chaps. 5 and 7 and has contributed to Chap. 2 by writing Sect. 2.7 and to Chaps. 4 and 6 by writing Sects. 4.7, 4.8, and 6.11. Dr. Levant has written Chaps. 4 and 6.
The authors would also like to acknowledge the graduate and postdoctoral students of the Department of Automatic Control, the National Autonomous University of Mexico, Francisco Bejarano, Jorge Davila, Lizet Fraguela, Ana Gabriela Gallardo, Tenoch Gonzalez, Antonio Rosales, and Carlos Vazquez, for their invaluable help in preparing examples and exercises. We would also like to thank our colleagues, Professors Igor Boiko, Leonid Freidovich, Elio Usai, and Vadim Utkin for their careful reading of early drafts of the manuscript and for their constructive criticisms and suggestions for improvement.

Huntsville, USA Exeter, UK Mexico, Mexico Tel Aviv, Israel

Y. Shtessel C. Edwards L. Fridman
A. Levant

Contents
1 Introduction: Intuitive Theory of Sliding Mode Control .. . . . . . . . . . . . . . . 1 1.1 Main Concepts of Sliding Mode Control . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 3 1.2 Chattering Avoidance: Attenuation and Elimination .. . . . . . . . . . . . . . . . 9 1.2.1 Chattering Elimination: Quasi-Sliding Mode.. . . . . . . . . . . . . . 9 1.2.2 Chattering Attenuation: Asymptotic Sliding Mode . . . . . . . . 11 1.3 Concept of Equivalent Control .. . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 17 1.4 Sliding Mode Equations .. . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 18 1.5 The Matching Condition and Insensitivity Properties . . . . . . . . . . . . . . . 19 1.6 Sliding Mode Observer/Differentiator .. . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 20 1.7 Second-Order Sliding Mode . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 23 1.8 Output Tracking: Relative Degree Approach .. . . .. . . . . . . . . . . . . . . . . . . . 27 1.8.1 Conventional Sliding Mode Controller Design .. . . . . . . . . . . . 28 1.8.2 Integral Sliding Mode Controller Design . . . . . . . . . . . . . . . . . . . 30 1.8.3 Super-Twisting Controller Design . . . . . .. . . . . . . . . . . . . . . . . . . . 33 1.8.4 Prescribed Convergence Law Controller Design . . . . . . . . . . . 36 1.9 Notes and References.. . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 40 1.10 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 41
2 Conventional Sliding Modes . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 43 2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 43 2.1.1 Filippov Solution .. . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 44 2.1.2 Concept of Equivalent Control . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 47 2.2 State-Feedback Sliding Surface Design . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 50 2.2.1 Regular Form .. . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 53 2.2.2 Eigenvalue Placement.. . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 55 2.2.3 Quadratic Minimization . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 58 2.3 State-Feedback Relay Control Law Design . . . . . .. . . . . . . . . . . . . . . . . . . . 61 2.3.1 Single-Input Nominal Systems . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 61 2.3.2 Single-Input Perturbed Systems . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 62 2.3.3 Relay Control for Multi-input Systems .. . . . . . . . . . . . . . . . . . . . 67
xiii

xiv

Contents

2.4 State-Feedback Unit-Vector Control .. . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 68 2.4.1 Design in the Presence of Matched Uncertainty .. . . . . . . . . . . 68 2.4.2 Design in the Presence of Unmatched Uncertainty.. . . . . . . . 71
2.5 Output Tracking with Integral Action . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 75 2.6 Output-Based Hyperplane Design . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 77
2.6.1 Static Output-Feedback Hyperplane Design . . . . . . . . . . . . . . . 78 2.6.2 Static Output-Feedback Control Law Development.. . . . . . . 83 2.6.3 Dynamic Output-Feedback Hyperplane Design . . . . . . . . . . . 85 2.6.4 Dynamic Output-Feedback Control Law Development .. . . 87 2.6.5 Case Study: Vehicle Stability in a Split-Mu Maneuver . . . . 88 2.7 Integral Sliding Mode Control . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 89 2.7.1 Problem Formulation . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 90 2.7.2 Control Design Objective .. . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 91 2.7.3 Linear Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 91 2.7.4 ISM Compensation of Unmatched Disturbances . . . . . . . . . . 94 2.8 Notes and References.. . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 96 2.9 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 99
3 Conventional Sliding Mode Observers . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 105 3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 105 3.2 A Simple Sliding Mode Observer . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 106 3.3 Robustness Properties of Sliding Mode Observers .. . . . . . . . . . . . . . . . . 111 3.4 A Generic Conventional Sliding Mode Observer . . . . . . . . . . . . . . . . . . . 121 3.5 A Sliding Mode Observer for Nonlinear Systems . . . . . . . . . . . . . . . . . . . 128 3.6 Fault Detection: A Simulation Example .. . . . . . . . .. . . . . . . . . . . . . . . . . . . . 133 3.7 Notes and References.. . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 136 3.8 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 137
4 Second-Order Sliding Mode Controllers and Differentiators.. . . . . . . . . . 143 4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 143 4.2 2-Sliding Mode Controllers . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 147 4.2.1 Twisting Controller . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 148 4.2.2 Suboptimal Algorithm . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 151 4.2.3 Control Algorithm with Prescribed Convergence Law . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 152 4.2.4 Quasi-Continuous Control Algorithm . .. . . . . . . . . . . . . . . . . . . . 153 4.2.5 Accuracy of 2-Sliding Mode Controllers . . . . . . . . . . . . . . . . . . . 155 4.3 Control of Relative Degree One Systems. . . . . . . . .. . . . . . . . . . . . . . . . . . . . 155 4.3.1 Super-Twisting Controller . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 155 4.3.2 First-Order Differentiator .. . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 159 4.4 Differentiator-Based Output-Feedback 2-SM Control .. . . . . . . . . . . . . . 161 4.5 Chattering Attenuation . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 163 4.6 Case Study: Pendulum Control . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 166 4.6.1 Discontinuous Control .. . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 167 4.6.2 Chattering Attenuation.. . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 169

Contents

xv

4.7 Variable-Gain Super-Twisting Control . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 170 4.7.1 Problem Statement .. . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 171 4.7.2 The Variable-Gain Super-Twisting Algorithm .. . . . . . . . . . . . . 172
4.8 Case Study: The Mass­Spring­Damper System .. . . . . . . . . . . . . . . . . . . . 176 4.8.1 Model Description . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 176 4.8.2 Problem Statement .. . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 177 4.8.3 Control Design . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 178 4.8.4 Experimental Results . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 179
4.9 Notes and References.. . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 179 4.10 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 182
5 Analysis of Sliding Mode Controllers in the Frequency Domain . . . . . . . 183 5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 183 5.2 Conventional SMC Algorithm: DF Analysis . . . . .. . . . . . . . . . . . . . . . . . . . 184 5.3 Twisting Algorithm: DF Analysis . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 193 5.4 Super-Twisting Algorithm: DF Analysis . . . . . . . .. . . . . . . . . . . . . . . . . . . . 196 5.4.1 DF of Super-Twisting Algorithm .. . . . . . .. . . . . . . . . . . . . . . . . . . . 196 5.4.2 Existence of the Periodic Solutions . . . .. . . . . . . . . . . . . . . . . . . . 198 5.4.3 Stability of Periodic Solution . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 200 5.5 Prescribed Convergence Control Law: DF Analysis . . . . . . . . . . . . . . . . 201 5.6 Suboptimal Algorithm: DF Analysis . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 203 5.7 Comparisons of 2-Sliding Mode Control Algorithms . . . . . . . . . . . . . . . 205 5.8 Notes and References.. . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 208 5.9 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 208
6 Higher-Order Sliding Mode Controllers and Differentiators .. . . . . . . . . . 213 6.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 214 6.2 Single-Input Single-Output Regulation Problem.. . . . . . . . . . . . . . . . . . . . 216 6.3 Homogeneity, Finite-Time Stability, and Accuracy .. . . . . . . . . . . . . . . . . 217 6.4 Homogeneous Sliding Modes .. . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 222 6.5 Accuracy of Homogeneous 2-Sliding Modes . . . .. . . . . . . . . . . . . . . . . . . . 223 6.6 Arbitrary-Order Sliding Mode Controllers . . . . . . .. . . . . . . . . . . . . . . . . . . . 225 6.6.1 Nested Sliding Controllers . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 225 6.6.2 Quasi-continuous Sliding Controllers .. .. . . . . . . . . . . . . . . . . . . . 227 6.7 Arbitrary-Order Robust Exact Differentiation . . .. . . . . . . . . . . . . . . . . . . . 228 6.8 Output-Feedback Control . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 230 6.9 Tuning of the Controllers .. . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 233 6.9.1 Control Magnitude Tuning . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 233 6.9.2 Parametric Tuning.. . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 233 6.10 Case Study: Car Steering Control .. . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 234 6.11 Case Study: Blood Glucose Regulation . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 237 6.11.1 Introduction to Diabetes . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 237 6.11.2 Insulin­Glucose Regulation Dynamical Model . . . . . . . . . . . . 240 6.11.3 Higher-Order Sliding Mode Controller Design.. . . . . . . . . . . . 241 6.11.4 Simulation .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 244

xvi

Contents

6.12 Notes and References.. . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 247 6.13 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 248
7 Observation and Identification via HOSM Observers . . . . . . . . . . . . . . . . . . 251 7.1 Observation/Identification of Mechanical Systems . . . . . . . . . . . . . . . . . . 252 7.1.1 Super-Twisting Observer . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 253 7.1.2 Equivalent Output Injection Analysis . . .. . . . . . . . . . . . . . . . . . . . 255 7.1.3 Parameter Identification . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 259 7.2 Observation in Single-Output Linear Systems . . .. . . . . . . . . . . . . . . . . . . . 265 7.2.1 Non-perturbed Case . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 265 7.2.2 Perturbed Case . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 266 7.2.3 Design of the Observer for Strongly Observable Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 268 7.3 Observers for Single-Output Nonlinear Systems. . . . . . . . . . . . . . . . . . . . . 274 7.3.1 Differentiator-Based Observer . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 275 7.3.2 Disturbance Identification . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 278 7.4 Regulation and Tracking Controllers Driven by SM Observers .. . . . 280 7.4.1 Motivation .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 280 7.4.2 Problem Statement .. . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 281 7.4.3 Theoretically Exact Output-Feedback Stabilization (EOFS) .. . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 282 7.4.4 Output Integral Sliding Mode Control . .. . . . . . . . . . . . . . . . . . . . 283 7.4.5 Precision of the Observation and Identification Processes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 284 7.5 Notes and References.. . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 286 7.6 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 286
8 Disturbance Observer Based Control: Aerospace Applications . . . . . . . . 291 8.1 Problem Formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 291 8.1.1 Asymptotic Compensated Dynamics . . .. . . . . . . . . . . . . . . . . . . . 292 8.1.2 Finite-Time-Convergent Compensated Dynamics.. . . . . . . . . 293 8.1.3 Sliding Variable Disturbed Dynamics.. .. . . . . . . . . . . . . . . . . . . . 294 8.1.4 Output Tracking Error Disturbed Dynamics .. . . . . . . . . . . . . . . 294 8.2 Perturbation Term Reconstruction via a Disturbance Observer . . . . . 295 8.2.1 SMDO Based on Conventional SMC . . .. . . . . . . . . . . . . . . . . . . . 295 8.2.2 SMDO Based on Super-Twisting Control . . . . . . . . . . . . . . . . . . 296 8.2.3 Design of the SMC Driven by the SMDO . . . . . . . . . . . . . . . . . . 297 8.3 Case Study: Reusable Launch Vehicle Control . .. . . . . . . . . . . . . . . . . . . . 298 8.3.1 Mathematical Model of Reusable Launch Vehicle . . . . . . . . . 298 8.3.2 Reusable Launch Vehicle Control Problem Formulation . . 300 8.3.3 Multiple-Loop Asymptotic SMC/SMDO Design . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 301 8.3.4 Flight Simulation Results and Analysis .. . . . . . . . . . . . . . . . . . . . 305

Contents

xvii

8.4 Case Study: Satellite Formation Control . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 309 8.4.1 Satellite Formation Mathematical Model . . . . . . . . . . . . . . . . . . 310 8.4.2 Satellite Formation Control in SMC/SMDO . . . . . . . . . . . . . . . 313
8.5 Simulation Study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 314 8.6 Notes and References.. . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 316 8.7 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 318

A Mathematical Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 321 A.1 Linear Algebra .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 321 A.1.1 Rank and Determinant . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 321 A.1.2 Eigenvalues and Eigenvectors . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 322 A.1.3 QR Decomposition.. . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 323 A.1.4 Norms.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 323 A.1.5 Quadratic Forms . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 324
B Describing Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 327 B.1 Describing Function Fundamentals .. . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 327 B.1.1 Low-Pass Filter Hypothesis and Describing Function . . . . . 328 B.1.2 Limit Cycle Analysis Using Describing Functions.. . . . . . . . 328 B.1.3 Stability Analysis of the Limit Cycle . . .. . . . . . . . . . . . . . . . . . . . 329
C Linear Systems Theory .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 331 C.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 331 C.1.1 Linear Time-Invariant Systems . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 331 C.1.2 Controllability and Observability . . . . . . .. . . . . . . . . . . . . . . . . . . . 332 C.1.3 Invariant Zeros . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 333 C.1.4 State Feedback Control . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 334 C.1.5 Static Output Feedback Control .. . . . . . . .. . . . . . . . . . . . . . . . . . . . 335
D Lyapunov Stability .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 337 D.1 Local Results. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 338 D.2 Global Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 338 D.2.1 Quadratic Stability . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 339
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 343
Index . . . . . . . . .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . 353

Chapter 1
Introduction: Intuitive Theory of Sliding Mode Control

In the formulation of any practical control problem, there will always be a

discrepancy between the actual plant and its mathematical model used for the

controller design. These discrepancies (or mismatches) arise from unknown exter-

nal disturbances, plant parameters, and parasitic/unmodeled dynamics. Designing

control laws that provide the desired performance to the closed-loop system in the

presence of these disturbances/uncertainties is a very challenging task for a control

engineer. This has led to intense interest in the development of the so-called robust

control methods which are supposed to solve this problem. One particular approach

to robust controller design is the so-called sliding mode control technique.

In Chap. 1, the main concepts of sliding mode control will be introduced

in an intuitive fashion, requiring only a basic knowledge of control systems.

The sliding mode control design techniques are demonstrated on tutorial examples

and via graphical exposition. Advanced sliding mode concepts, including sliding

mode observers/differentiators and second-order sliding mode control, are studied

at a tutorial level. The main advantages of sliding mode control, including ro-

bustness, finite-time convergence, and reduced-order compensated dynamics, are

demonstrated on numerous examples and simulation plots.

For illustration purposes, the single-dimensional motion of a unit mass (Fig. 1.1)

is considered. A state-variable description is easily obtained by introducing vari-

ables for the position and the velocity x1 D x; x2 D xP1 so that

( xP1 D x2 xP2 D u C f .x1; x2; t /

x1.0/ D x10 x2.0/ D x20;

(1.1)

where u is the control force, and the disturbance term f .x1; x2; t/, which may comprise dry and viscous friction as well as any other unknown resistance forces, is assumed to be bounded, i.e., jf .x1; x2; t/j Ä L > 0. The problem is to design a feedback control law u D u.x1; x2/ that drives the mass to the origin asymptotically. In other words, the control u D u.x1; x2/ is supposed to drive the state variables to

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

1

DOI 10.1007/978-0-8176-4893-0 1, © Springer Science+Business Media New York 2014

2

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.1 Single-dimensional motion of a unit mass

Fig. 1.2 Asymptotic convergence for f .x1; x2; t / Á 0

zero:

i.e.,

t

lim
!1

x1;

x2

D

0.

This

apparently

simple

control

problem

is

a

challenging

one, since asymptotic convergence is to be achieved in the presence of the unknown

bounded disturbance f .x1; x2; t/. For instance, a linear state-feedback control law

u D k1x1 k2x2; k1 > 0; k2 > 0

(1.2)

provides asymptotic stability of the origin only for f .x1; x2; t/ Á 0 and typically only drives the states to a bounded domain .k1; k2; L/ for jf .x1; x2; t/j Ä L > 0.
Example 1.1. The results of the simulation of the system in Eqs. (1.1), (1.2) with x1.0/ D 1; x2.0/ D 2; k1 D 3; k2 D 4, and f .x1; x2; t/ D sin.2t/, which illustrate this statement, are presented in Figs. 1.2 and 1.3.

1.1 Main Concepts of Sliding Mode Control

3

Fig. 1.3 Convergence to the domain for f .x1; x2; t / D sin.2t /
The question is whether the formulated control problem can be addressed using only knowledge of the bounds on the unknown disturbance.

1.1 Main Concepts of Sliding Mode Control

Let us introduce desired compensated dynamics for system (1.1). A good candidate for these dynamics is the homogeneous linear time-invariant differential equation:

xP1 C cx1 D 0; c > 0

(1.3)

Since x2.t/ D xP1.t/, a general solution of Eq. (1.3) and its derivative is given by

x1.t/ D x1.0/ exp. ct/ x2.t/ D xP1.t/ D cx1.0/ exp. ct/

(1.4)

both x1.t/ and x2.t/ converge to zero asymptotically. Note, no effect of the disturbance f .x1; x2; t/ on the state compensated dynamics is observed. How could these compensated dynamics be achieved? First, we introduce a new variable in the state space of the system in Eq. (1.1):

D .x1; x2/ D x2 C cx1; c > 0

(1.5)

In order to achieve asymptotic convergence of the state variables x1; x2 to zero, i.e.,

t

lim
!1

x1

;

x2

D

0,

with

a

given

convergence rate

as

in

Eq. (1.4),

in

the

presence

of

the bounded disturbance f .x1; x2; t/, we have to drive the variable in Eq. (1.5) to

zero in finite time by means of the control u. This task can be achieved by applying

4

1 Introduction: Intuitive Theory of Sliding Mode Control

Lyapunov function techniques to the -dynamics that are derived using Eqs. (1.1) and (1.5):

P D cx2 C f .x1; x2; t/ C u; .0/ D 0

(1.6)

For the -dynamics (1.6) a candidate Lyapunov function (see Appendix D) is introduced taking the form

V D1 2

(1.7)

2

In order to provide the asymptotic stability of Eq. (1.6) about the equilibrium point D 0, the following conditions must be satisfied:

(a) VP < 0 for ¤ 0 (b) lim V D 1
j j!1

Condition (b) is obviously satisfied by V in Eq. (1.7). In order to achieve finite-time convergence (global finite-time stability), condition (a) can be modified to be

VP Ä V 1=2;  > 0

(1.8)

Indeed, separating variables and integrating inequality (1.8) over the time interval 0 Ä Ä t, we obtain

V 1=2.t / Ä 1  t C V 1=2.0/ 2

(1.9)

Consequently, V .t/ reaches zero in a finite time tr that is bounded by

tr

Ä

2V

1=2.0/ :


(1.10)

Therefore, a control u that is computed to satisfy Eq. (1.8) will drive the variable to zero in finite time and will keep it at zero thereafter. The derivative of V is computed as

VP D P D .cx2 C f .x1; x2; t/ C u/

(1.11)

Assuming u D cx2 C v and substituting it into Eq. (1.11) we obtain VP D .f .x1; x2; t/ C v/ D f .x1; x2; t/ C v Ä j j L C v

(1.12)

Selecting v D

sign. / where
( 1
sign.x/ D 1

if x > 0 if x < 0

(1.13)

and

sign.0/ 2 1; 1

(1.14)

1.1 Main Concepts of Sliding Mode Control

5

with > 0 and substituting it into Eq. (1.12) we obtain VP Ä j j L j j D j j . L/
Taking into account Eq. (1.7), condition (1.8) can be rewritten as VP Ä V 1=2 D p j j ;  > 0 2
Combining Eqs. (1.15) and (1.16) we obtain VP Ä j j . L/ D p j j 2
Finally, the control gain is computed as D L C p 2
Consequently a control law u that drives to zero in finite time (1.10) is u D cx2 sign. /

(1.15) (1.16) (1.17) (1.18) (1.19)

Remark 1.1. It is obvious that P must be a function of control u in order to successfully design the controller in Eq. (1.8) or (1.19). This observation must be taken into account while designing the variable given in Eq. (1.5).

Remark 1.2. The first component of the control gain Eq. (1.18) is designed to

compensate

for

the

bounded

disturbance

f .x1; x2; t /

while

the

second

term

p 2

is

responsible for determining the sliding surface reaching time given by Eq. (1.10).

The larger , the shorter reaching time.

Now it is time to make definitions that interpret the variable (1.5), the desired compensated dynamics (1.3), and the control function (1.19) in a new paradigm.

Definition 1.1. The variable (1.5) is called a sliding variable

Definition 1.2. Equations (1.3) and (1.5) rewritten in a form

D x2 C cx1 D 0; c > 0

(1.20)

correspond to a straight line in the state space of the system (1.1) and are referred to as a sliding surface.

Condition (1.8) is equivalent to

P Ä p j j 2

(1.21)

6

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.4 Sliding variable
and is often termed the reachability condition. Meeting the reachability or existence condition (1.21) means that the trajectory of the system in Eq. (1.1) is driven towards the sliding surface (1.20) and remains on it thereafter.
Definition 1.3. The control u D u.x1; x2/ in Eq. (1.19) that drives the state variables x1; x2 to the sliding surface (1.20) in finite time tr , and keeps them on the surface thereafter in the presence of the bounded disturbance f .x1; x2; t/, is called a sliding mode controller and an ideal sliding mode is said to be taking place in the system (1.1) for all t > tr .
Example 1.2. The results of the simulation of system (1.1) with the sliding mode control law (1.5), (1.19), the initial conditions x1.0/ D 1; x2.0/ D 2, the control gain D 2, the parameter c D 1:5, and the disturbance f .x1; x2; t/ D sin.2t/ (which is used for simulation purposes only) are presented in Figs. 1.4­1.9.
Figure 1.4 illustrates finite-time convergence of the sliding variable to zero. Asymptotic convergence of the state variables x1; x2 to zero in the presence of the external bounded disturbance f .x1; x2; t/ D sin.2t/ is shown in Fig. 1.5. The phase portrait, which is given in Fig. 1.6, demonstrates such phenomena as a reaching phase (when the state trajectory is driven towards the sliding surface) and a sliding phase (when the state trajectory is moving towards the origin along the sliding surface).
A zoomed portion of the phase portrait (Fig. 1.7) illustrates the "zigzag" motion of small amplitude and high frequency that the state variables exhibit while in the sliding mode. Sliding mode control, which is presented in Figs. 1.8 and 1.9, is a

1.1 Main Concepts of Sliding Mode Control

7

Fig. 1.5 Asymptotic convergence for f .x1; x2; t / D sin.2t /
Fig. 1.6 Phase portrait
high frequency switching control with a switching frequency inversely proportional to the time increment 10 4 s used in the simulation. Apparently, this high-frequency switching control causes the "Zigzag" motion in the sliding mode (Fig. 1.7). In an ideal sliding mode the switching frequency is supposed to approach infinity and the amplitude of the "zigzag" motion tends to zero.

8

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.7 Phase portrait (zoom)

Fig. 1.8 Sliding mode control
As we see in Figs. 1.7 and 1.9, the imperfection in the sign-function implementation yields a finite amplitude and finite frequency "zigzag" motion in the sliding mode due to the discrete-time nature of the computer simulation. This effect is called chattering.

1.2 Chattering Avoidance: Attenuation and Elimination

9

Fig. 1.9 Sliding mode control (zoom)
1.2 Chattering Avoidance: Attenuation and Elimination
In many practical control systems, including DC motors and aircraft control, it is important to avoid control chattering by providing continuous/smooth control signals: for instance, aircraft aerodynamic surfaces cannot move back and forth with high frequency, but at the same time it is desirable to retain the robustness/insensitivity of the control system to bounded model uncertainties and external disturbances.

1.2.1 Chattering Elimination: Quasi-Sliding Mode

One obvious solution to make the control function (1.19) continuous/smooth is to approximate the discontinuous function v. / D sign. / by some continuous/smooth function. For instance, it could be replaced by a "sigmoid function"

sign. / j j C " where " is a small positive scalar. It can be observed that point-wise

(1.22)

lim "!0 j

D sign. jC"

/

10

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.10 Sigmoid function

for ¤ 0. The value of " should be selected to trade off the requirement to maintain an ideal performance with that of ensuring a smooth control action. The sigmoid function (1.22) is shown in Fig. 1.10.

Example 1.3. The results of the simulation of system (1.1) with the pseudo-sliding mode control

u D cx2 j j C "

(1.23)

using the same parameters as those in Example 1.2 are presented in Figs. 1.11­1.14.

The smooth control function (Fig. 1.11) cannot provide finite-time convergence of the sliding variable to zero in the presence of the external disturbance f .x1; x2; t/ (see Fig. 1.12). Furthermore, the sliding variable and the state variables do not converge to zero at all, but instead converge to domains in a vicinity of the origin (Figs. 1.12­1.14) due to the effect of the disturbance f .x1; x2; t/ D sin.2t/. The price we pay for obtaining a smooth control function is a loss of robustness and, as a result, a loss of accuracy. The designed smooth control (1.23) is technically not a sliding mode control and there is no ideal sliding mode in the system (1.1), since the sliding variable has not been driven to zero in a finite time. However, the system's performance under the smooth control law in Eq. (1.23) is close to the system's performance under the discontinuous sliding mode control (1.19). This gives us grounds for calling the smooth control law in Eq. (1.23) a quasi-sliding mode control and the system's motion, when the sliding surface converges to a close vicinity of the origin, a quasi-sliding mode.

1.2 Chattering Avoidance: Attenuation and Elimination

11

Fig. 1.11 Smooth control
Fig. 1.12 Sliding variable
1.2.2 Chattering Attenuation: Asymptotic Sliding Mode
In this section we consider another approach to designing continuous control that is robust to bounded disturbances. The idea is to design an SMC in terms of the control function derivative. In this case the actual control, which is the integral of the

12

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.13 Time history of the state variables
Fig. 1.14 Zoomed Time history of the state variables
high-frequency switching function, is continuous. This approach is called chattering attenuation, since some periodic residual is observed in the sliding mode control after the integration of the high-frequency switching function.
To proceed, the system in Eq. (1.1) is rewritten as

1.2 Chattering Avoidance: Attenuation and Elimination

8 < xP1 D x2

:

xP2 D u C f .x1; x2; t / uP D v

x1.0/ D x10 x2.0/ D x20 u.0/ D 0:

13
(1.24)

We know that if the sliding variable (1.5) is constrained to zero in finite time t D tr , then the state variables converge to zero asymptotically in accordance with Eq. (1.4)

for all t tr . with bounded

dHeerriveawtiveeasfsPu.mx1e;

jf x2

;.xt /1;

x2; t/j Ä LN .

Ä

L

and

in

addition

that

it

is

smooth

In order to achieve chattering attenuation the following auxiliary sliding variable

s D P C cN

(1.25)

is introduced. If we design a control law v that provides finite-time convergence of s ! 0, then the ideal sliding mode occurs in the sliding surface

s D P C cN D 0

(1.26)

and ; P ! 0 together with x1; x2 ! 0, as time increases, even in the presence of the bounded disturbance f .x1; x2; t/. However, we will not have an ideal sliding mode, but instead an asymptotic sliding mode will occur in system (1.24) since the original sliding variable converges to zero only asymptotically. This is the price we are going to pay for the chattering attenuation. Using Eq. (1.21) for designing the SMC in terms of v, we obtain
ssP D s.v C ccNx2 C .c C cN/u C .c C cN/f .x1; x2; t/ C fP.x1; x2; t// (1.27)
Choosing v D ccNx2 .c C cN/ u C v1 and substituting it into Eq. (1.27), we obtain
ssP D s.v1 C.c CcN/f .x1; x2; t/CfP.x1; x2; t// Ä sv1 Cjsj.LN C.c CcN/L/ (1.28)

Selecting v1 D that

sign.s/ with > 0, and substituting it into Eq. (1.28) it follows

ssP Ä jsj. C LN C .c C cN/L/ D p jsj: 2

(1.29)

Finally, if the control gain is computed as

D

LN

C

.c

C

cN/

L

C

 p

2

p

then the control law v that drives s to zero in finite time tr Ä

2js.0/j 

is

(1.30)

v D ccNx2 .c C cN/ u sign.s/

(1.31)

Example 1.4. The results of the simulation of system (1.24) with the sliding mode control (1.25), (1.31), the initial conditions x1.0/ D 1; x2.0/ D 2, the control gain

14

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.15 Control v
R Fig. 1.16 Control u D vdt
D 30, the parameters c D 1:5; cN D 10, and the disturbance f .x1; x2; t/ D sin.2t/ (which, again, is only used for simulation purposes) are presented in Figs. 1.15­1.20.
The control law (1.31) contains the high-frequency switching term sign.s/ that yields chattering (Fig. 1.15); however, chattering is attenuated in the physical

1.2 Chattering Avoidance: Attenuation and Elimination

15

Fig. 1.17 Sliding variables

Fig. 1.18 State variables
R control u D vdt (Fig. 1.16). It can be observed from Fig. 1.17 that the auxiliary sliding variable s converges to zero in finite time and the original sliding variable converges to zero asymptotically. Therefore, the achieved sliding mode is called an asymptotic sliding mode with respect to the original sliding variable .

16

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.19 Equivalent control estimation

Fig. 1.20 The disturbance estimation
The state variables exhibit convergence to zero as time increases (see Fig. 1.18) in a similar way to the results from Fig. 1.5 that were achieved via the highfrequency switching sliding mode control u given by Eq. (1R.19). Also, in order to implement the continuous sliding mode control u D vdt, with v given by Eqs. (1.25) and (1.31), it is necessary to differentiate . In the example, P was computed numerically; however, it can be done using the sliding mode observers/differentiators that will be discussed later on.

1.3 Concept of Equivalent Control

17

1.3 Concept of Equivalent Control

Suppose that at time tr the sliding surface D x2 C cx1 D 0 is reached and the trajectory x1.t/; x2.t/ remains on the sliding surface thereafter by means of the SMC given by Eqs. (1.5), (1.19). This means that D P D 0 for all t tr . The condition P D 0 yields

P D cx2 C f .x1; x2; t/ C u D 0; .tr / D 0

(1.32)

A control function that satisfies Eq. (1.32) can be easily computed as

ueq D cx2 f .x1; x2; t /

(1.33)

Definition 1.4. The control function (1.33), which needs to be applied to system (1.1) after reaching the sliding surface D 0, to ensure that the system trajectory stays on the surface thereafter, is called the equivalent control.
The following properties of the equivalent control can be established:
· The control function (1.33) is not the actual control that is applied to system (1.1) as soon as the sliding surface is reached. Furthermore, control (1.33) usually cannot be implemented, since the bounded disturbance f .x1; x2; t/ is not known and appears explicitly in Eq. (1.33). The equivalent control action describes the "average" effect of the high-frequency switching control (1.19) on system (1.1). The average can be achieved via low-pass filtering (LPF) of the high-frequency switching term sign. / in the control law (1.19). Therefore, the equivalent control can be estimated (online) as follows:

uOeq D cx2 LPF . sign. // ; t tr

(1.34)

For instance, the LPF can be implemented as a first-order differential equation

zP D z C sign. / uOeq D cx2 z

(1.35)

where is a small positive scalar representing the time constant of the filter.

The signal ueq can be estimated very accurately by uOeq by making as small as possible, but larger than the sampling time of the computer-implemented LPF.

· Comparing Eqs. (1.33) and (1.34) the disturbance term can be easily estimated:

fO.x1; x2; t/ D LPF . sign. // ; t tr

(1.36)

Example 1.5. The system (1.1) with the sliding mode control (1.5), (1.19), the initial conditions x1.0/ D 1; x2.0/ D 2, the control gain D 2, the parameter c D 1:5, and the disturbance f .x1; x2; t/ D sin.2t/, which is used for simulations purposes only, has been simulated. The equivalent control and the disturbance can

18

1 Introduction: Intuitive Theory of Sliding Mode Control

be estimated using Eqs. (1.35) and (1.36) with D 0:01. For comparison, the ideal equivalent control is plotted in accordance with Eq. (1.34). The results of the simulation are presented in Figs. 1.19 and 1.20.
Based on Figs. 1.19 and 1.20 we observe a high level of accuracy in terms of the estimation of the equivalent control and the disturbance.

1.4 Sliding Mode Equations

It was discussed earlier that system (1.1) with the SMC given by Eqs. (1.5), (1.19) exhibits a two-phase motion (Fig. 1.6), namely, the reaching phase (when the system trajectory moves towards the sliding surface) and the sliding phase (when the system trajectory moves along the sliding surface). The sliding variable (1.5) is supposed to be designed in order to provide a desired motion in the sliding mode. This design problem can be reduced to two tasks.
Task 1 is to find the system's equation in the sliding mode for all t tr ; and task 2 is to parameterize the sliding variable (1.5) in order to ensure the desired/given compensated dynamics.
Substituting the SMC in Eqs. (1.5), (1.19) into Eq. (1.1) yields

( xP1 D x2 xP2 D cx2

x1.tr / D x1r sign.x2 C cx1/ C f .x1; x2; t / x2.tr / D cx1r

(1.37)

Equation (1.37) is not suitable for the sliding mode analysis, since the right-hand side of the system is a discontinuous high-frequency switching function, which loses its continuity in each point on the sliding surface D x2 C cx1 D 0. However, from Sect. 1.3, we know that the system's (1.1) dynamics in the sliding mode (when
D x2 C cx1 D 0) are driven by the equivalent control (1.33). Therefore, in order to obtain the equations of system's compensated dynamics in the sliding mode, we substitute the equivalent control into Eq. (1.1). Bearing in mind that in the sliding mode x2 D cx1 we obtain

8 <^ xP1 D x2 ^: xP2 D .,, cx2

f,.x1; x2; t /.../ Cf .x1; x2; t /
ueq

( ) xP1 D x2
xP2 D cx2

( ) xP1 D cx1
xP2 D cx2 (1.38)

Finally the system's (1.1) compensated dynamics in the sliding mode are reduced

to the form

xP1 D x2 D

cx1 cx1

; x1.tr / D x1r

(1.39)

1.5 The Matching Condition and Insensitivity Properties

19

for all t tr . A solution of Eq. (1.39) for all t tr can be written as

x1.t / D x1r exp OE c.t tr / x2.t / D cx1r exp OE c.t tr /

(1.40)

It is clear that the parameter c > 0 can be selected to give a desired rate of convergence of x1; x2 to zero.
The following properties are exhibited by the system's dynamics in the sliding mode:
· The SMC controller design is reduced to two tasks. The first task consists of the design of the first-order sliding surface in Eq. (1.20). The second task is to design the control u to drive the sliding variable (1.5) to zero. Again, the first-order sliding variable dynamics given by Eq. (1.6) are employed.
· The original system's dynamics are of second-order while its compensated dynamics in the sliding mode (1.39) are of order equal to one. The reduction in order is due to the fact that Eq. (1.39) describes the "slow" motion only. The "fast" motion that is due to the high-frequency switching control (see Figs. 1.7 and 1.9) is of very small amplitude and is disregarded in Eq. (1.39).
· The system's dynamics in the sliding mode (1.39) do not depend on the bounded disturbance f .x1; x2; t/; however, its upper limit is taken into account in the SMC design [see Eqs. (1.16) and (1.17)].

1.5 The Matching Condition and Insensitivity Properties

It was discussed in Sect. 1.4 that the system's dynamics in the sliding mode do not depend on the bounded disturbance f .x1; x2; t/. We need to bear in mind that the disturbance f .x1; x2; t/ enters only the second equation of the system (1.1). The question is whether this insensitivity property of the system's dynamics in the sliding mode to the bounded disturbances/uncertainties can be extended to bounded disturbances/uncertainties entering the first equation of the system (1.1).
In order to address this issue consider the system

xP1 D x2 C '.x1; x2; t / x1.0/ D x10 xP2 D u C f .x1; x2; t / x2.0/ D x20

(1.41)

where jf .x1; x2; t/j Ä L; j'.x1; x2; t/j Ä P . Assume that an SMC u is designed to drive the trajectories of system (1.41) to the sliding surface D x2 C cx1 D 0 in finite time t Ä tr and to maintain motion on the surface thereafter. The dynamics of system in the sliding mode can be easily derived using the equivalent control
approach presented in Sect. 1.5. In this example the reduced-order motion is
described by

xP1 D x2 C '.x1; x2; t / x2 D cx1

x1.tr / D x1r

(1.42)

20

1 Introduction: Intuitive Theory of Sliding Mode Control

It can be observed from Eqs. (1.41)­(1.42) that the disturbance f .x1; x2; t/ does not affect the system's dynamics in the sliding mode while the disturbance '.x1; x2; t/ that enters the first equation (where the control is absent) can prevent the state variable from converging to zero in the sliding mode (1.41). The disturbance f .x1; x2; t/ is called a disturbance matched by the control, and the disturbance '.x1; x2; t/ is called an unmatched one.
Note that such a criterion for detecting matched and unmatched disturbances is valid only for SISO systems with the control u entering in only one equation. The matching condition will be generalized later on for nonlinear systems of an arbitrary order.

1.6 Sliding Mode Observer/Differentiator

So far, we have assumed that both state variables x1.t/ and x2.t/ are measured (available). In many cases only x1 (a position) is measured, but x2 (a velocity) must be estimated.
In order to estimate x2 (assuming a bound on jx2j is known) the following observation algorithm is proposed:

xPO1 D v

(1.43)

where v is an observer injection term that is to be designed so that the estimates xO1; xO2 ! x1; x2.
Let us introduce an estimation error (an auxiliary sliding variable)

z1 D xO1 x1

(1.44)

Subtracting the first equation in Eq. (1.1) from Eq. (1.43) we obtain

zP1 D x2 C v:

(1.45)

Let us design the injection term v that drives z1 D xO1 x1 ! 0 in finite time. In this case xO1 will converge to x1 in finite time. The following choice of injection term

v D sign.z1/; > jx2j C ;  > 0

(1.46)

yields

z1zP1 D z1. x2 sign.z1// Ä jz1j.jx2j / Ä jz1j

(1.47)

Inequality (1.47) mimics Eq. (1.21), which means that in a finite time tr

Ä

jz1 .0/j 

,

z1 ! 0 or xO1 ! x1. Therefore, a sliding mode exists in the observer (1.43) for

t tr . The sliding mode dynamics in Eq. (1.45) are computed using the concept of

equivalent control studied in Sect. 1.4:

zP1 D x2 C veq D 0

(1.48)

1.6 Sliding Mode Observer/Differentiator

21

Fig. 1.21 Estimating x2

What about estimating x2? It is clear from (1.48) that the state variable x2 can be exactly estimated as

x2 D veq ; t tr :

(1.49)

The equivalent injection veq can be estimated by LPF of the high-frequency switching control (1.46) as

vPOeq D vOeq sign.z1/

(1.50)

where is a small positive constant, and finally

x2 xO2 D vOeq ; t tr

(1.51)

Remark 1.3. The sliding mode observer given by Eqs. (1.43), (1.46), (1.50), and (1.51) also could be treated as a differentiator, since the variable it estimates is a derivative of the measured variable.
Example 1.6. The system (1.1) with the sliding mode control (1.5), (1.19), the initial conditions x1.0/ D 1; x2.0/ D 2, the control gain D 2, the parameter c D 1:5, and the disturbance f .x1; x2; t/ D sin.2t/, which is used for simulation purposes only, is simulated. The variable x1 is measured, and the variable x2 is estimated using the sliding mode observer (1.43), (1.46), (1.50), and (1.51) with
D 10 and D 0:01. The results of the simulations are shown in Figs. 1.21­1.24.
The sliding mode observer given by Eqs. (1.43), (1.46), (1.50), and (1.51) estimates x2 very quickly and very accurately (Figs. 1.21 and 1.23). The sliding

22

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.22 State variables
Fig. 1.23 Sliding variable z1
variable (1.5) with x2 replaced by its estimate xO2, D xO2 C 1:5x1, converges to zero in finite time tr 1 s. Furthermore the state variables x1; x2 ! 0 as time increases (see Fig. 1.22) despite the presence of the bounded disturbance f .x1; x2; t/ D sin.2t/.

1.7 Second-Order Sliding Mode

23

Fig. 1.24 Sliding variable

1.7 Second-Order Sliding Mode

As mentioned in Sect. 1.5, the compensated dynamics of system (1.1) in the sliding mode (1.39) are of the order one, while the system's uncompensated dynamics are of second order. This reduction of order is called a partial dynamical collapse. Let us consider if a complete dynamical collapse is possible, which means that the second-order uncompensated dynamics in Eq. (1.1) are reduced to algebraic equations (x1 D x2 D 0) in finite time. Addressing this question is very important especially in cascade control systems, where dynamical collapse means elimination of inner loop dynamics and/or any parasitic dynamics if properly compensated by SMC.
The first problem is the sliding variable design. Let us try the following nonlinear sliding variable:

D .x1; x2/ D x2 C c jx1j1=2 sign.x1/; c > 0

(1.52)

Remark 1.4. The sliding manifold (it is not a straight line anymore due to its nonlinearity) that corresponds to the sliding variable (1.52)

x2 C c jx1j1=2 sign.x1/ D 0; c > 0

(1.53)

is continuous (see Fig. 1.25).

24

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.25 Sliding manifold

The second problem is to design the control u that drives the sliding variable (1.52) to zero in finite time t Ä tr . We will address the second problem rigorously later on in Chap. 4. Assume that this control is already available.
The sliding mode equations of the systems (1.1), (1.52) are defined for all t tr as

xP1 D x2 x2 D c jx1j1=2 sign.x1/

x1.tr / D x1r

(1.54)

Equation (1.54) can be rewritten as one nonlinear differential equation:

xP1 D c jx1j1=2 sign.x1/; x1.tr / D x1r

(1.55)

Integrating Eq. (1.55) we obtain

jx1.t /j1=2

jx1r j1=2 D

c .t
2

tr /

(1.56)

We wish to identify a time instant t D tNr so that x1.tNr / D x2.tNr / D 0. This is

tNr

D

2 c

jx1r j1=2 tr

(1.57)

This result means that the state variables x1; x2 ! 0 in finite time equal to tNr tr while the system (1.1) is in the sliding mode, with dynamics described by
Eq. (1.54). Obviously, the overall reaching time from the initial condition x1.0/ D x10; x2.0/ D x20 to zero will be t Ä tNr , since t Ä tr is required to reach the sliding manifold (1.53) and it will take time t D tNr for the state variables to reach zero while

1.7 Second-Order Sliding Mode

25

Fig. 1.26 Controlled output x1 and its derivative xP1

constrained to the nonlinear sliding manifold (1.53). This is a new phenomenon, since the variables in Eq. (1.1) reach zero asymptotically in the sliding mode (1.39) associated with a linear sliding surface (1.20).
The controller u design that drives the sliding variable (1.52) to zero in finite time t Ä tr will be considered rigorously in Chap. 4. In this subsection we will design the controller in a similar fashion to the one given by Eq. (1.19):

u D sign. / ) u D sign x2 C cjx1j1=2sign.x1/

(1.58)

where the positive gain is sufficiently large. The control law in Eq. (1.58) is called the control with prescribed convergence law.

Definition 1.5. The control u D u.x1; x2/ in Eq. (1.58) with a nonlinear sliding manifold (1.53) that drives the controlled output x1 and its derivative xP1 D x2 to zero in finite time t Ä tNr and keeps them there thereafter in the presence of a bounded disturbance f .x1; x2; t/ is called second-order sliding mode (2-SM) control and an ideal 2-SM is said to be taking place in system (1.1) for all t > tNr .
The entire theory of second-order sliding mode control will be rigorously presented together with a variety of 2-SM controllers in Chap. 4 and more generalized higher-order sliding mode control will be discussed in Chap. 6.

Example 1.7. The results of the simulation of system (1.1) with the 2-SM control (1.58), the initial conditions x1.0/ D 1; x2.0/ D 2, the control gain D 2, the parameter c D 1:5, and the disturbance f .x1; x2; t/ D sin.2t/, which is used for simulation purposes only, which illustrate the second-order sliding mode control
concepts, are presented in Figs. 1.26­1.28.

26

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.27 Sliding variable

Fig. 1.28 Second-order sliding mode control

Discussion. The sliding variable reaches zero in finite time tr

0:5 s

(see Fig. 1.27). It confirms the existence of the sliding mode in system (1.1) for

all t > 0:5 s. The controlled output x1 and its derivative xP1 D x2 reach zero in finite time tNr 1:2 s (Fig. 1.26). This confirms the existence of a second-order sliding

mode in system (1.1) for all t > 1:2 s. Dynamical collapse of system (1.1) is

achieved in the second-order sliding mode, since the system's dynamics are reduced

to the algebraic equations x1.t/ D x2.t/ D 0 for all t > 1:2 s.

1.8 Output Tracking: Relative Degree Approach

27

1.8 Output Tracking: Relative Degree Approach

The output tracking (servomechanism) control problem is a very common practical task. For instance, an aircraft flight control system makes the aircraft attitude (Euler) angles follow reference profiles, often generated in real time, by means of controlled deflection of the aerodynamic surfaces, while the state vector associated with the aircraft dynamics contains a number of other variables, which are the subject of control. Another example concerns controlling DC-to-DC electric power converters. The electric energy conversion is performed by means of high-frequency switching control of power transistor while maintaining the output voltage at a given level.
Let us revisit system (1.1):

8 < xP1 D x2

:

xP2 D u C f .x1; x2; t / y D x1

x1.0/ D x10 x2.0/ D x20

(1.59)

where x1; x2 are position and velocity of the unit mass, y is a controlled output, u is a control force, and the disturbance term f .x1; x2; t/, which may comprise dry

and viscous friction as well as any other unknown resistance forces, is assumed to

be bounded, i.e., jf .x1; x2; t/j Ä L > 0. The problem to be addressed now is to design an SMC control law u D

u.x1; x2; t/ that makes the output y (the position of the unit mass) follow asymp-

totically a reference profile yc.t/ given in current time. In other words, the

control u D u.x1; x2/ is supposed to drive the output tracking error to zero:

t

lim
!1

.yc

.t

/

y.t// D 0 in the presence of the bounded disturbance f .x1; x2; t/.

The proposed control design technique employs the concepts of input­output

dynamics and relative degree.

Definition 1.6. Consider a SISO dynamic system with output y 2 R, state vector

x2

Rn, and the control input u 2 R. If y.i/ is independent of u for all i D

1; 2; : : : ; k 1, but y.k/ is proportional to u with the coefficient of proportionality not

equal to zero in a reasonable domain

Rn, then k is called the well-defined

relative degree.

For the system (1.59) the input­output dynamics have relative degree k D 2 since

y.2/ D u C f .y; yP; t /

(1.60)

Remark 1.5. The relative degree of the system in Eq. (1.59) is equal to the system's order, which means that the system (1.59) does not have any internal dynamics.

28

1 Introduction: Intuitive Theory of Sliding Mode Control

1.8.1 Conventional Sliding Mode Controller Design

The desired input­output tracking error compensated dynamics for the system (1.59) or (1.60) can be defined as a linear differential equation of order equal to k 1 with respect to the output tracking error e D yc.t/ y.t/. Specifically, we define

D eP C ce; c > 0

(1.61)

Now we have to design a conventional SMC u that drives ! 0 in finite time and keeps it at zero thereafter, bearing in mind that as soon as the sliding variable reaches zero the sliding mode starts and the output tracking error e in the sliding mode will obey the desired reduced (first)-order differential equation

D eP C ce D 0 c > 0

(1.62)

that yields convergence to zero as time increases. The sliding variable dynamics are derived as

P D ,,yRc C cyPc f,.y; yP; t/ c...yP u ) P D '.y; yP; t/ u
'.y;yP;t /

(1.63)

where yc, yPc, and yRc are known in current time. The cumulative disturbance term '.y; yP; t/ is assumed bounded, i.e., j'.y; yP; t/j Ä M .
Conventional SMC u can be designed by using the sliding mode existence condition (1.21) rewritten in a form

P Ä N j j ; N D p 2

(1.64)

Consequently

P D .'.y; yP; t/ u/ Ä j j M u

(1.65)

and selecting

u D sign. /

(1.66)

and substituting it into Eq. (1.66) we obtain

P Ä j j .M / D N j j

(1.67)

The control gain is computed as

D M C N

(1.68)

Example 1.8. The results of the simulation of system (1.59) with a conventional
SMC control (1.61), (1.66), (1.68), the initial conditions x1.0/ D 1; x2.0/ D 2, the control gain D 6, the parameter c D 1:5, the output reference profile yc D 2 cos.t/, and the disturbance f .x1; x2; t/ D sin.2t/, (which is used for simulation

1.8 Output Tracking: Relative Degree Approach

29

Fig. 1.29 Sliding variable

Fig. 1.30 The reference profile tracking

purposes only), illustrating the output tracking SMC concepts, are presented in

Figs. 1.29­1.31. The component eP of the sliding variable in Eq. (1.61) is computed

using simple numerical differentiation during the simulation. In particular, the error

e is fed to the input of the transfer function

s sC1

with

D 0:01, whose output gives

an approximate eP.

30

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.31 Traditional sliding mode control
Remark 1.6. The more sophisticated sliding mode differentiator based on the 2-SM technique studied in Sect. 1.7 can also be employed to generate eP.
Discussion. The sliding variable given by Eq. (1.61) reaches zero in finite time tr 0:45 s (Fig. 1.29). It confirms the existence of the sliding mode in system (1.59) for all t > 0:45 s. The controlled output y.t/ accurately follows the reference profile yc.t/: y.t/ ! yc.t/ in the sliding mode (Fig. 1.30) as time increases, despite the presence of the bounded-disturbance f .x1; x2; t/ D sin.2t/. High-frequency switching SMC u is shown in Fig. 1.31.

1.8.2 Integral Sliding Mode Controller Design

An alternative sliding mode controller design for output tracking in system (1.59) is studied in this subsection. Assuming that the initial conditions in system (1.59) are known, asymptotic output tracking in this system can be achieved by splitting the control function u into two parts:

and then:

u D u1 C u2

(1.69)

· Designing the auxiliary sliding mode control law u1 to compensate for the bounded disturbance '.y; yP; t/ in Eq. (1.63) in the auxiliary sliding mode such
that sliding starts right away (i.e., without a reaching phase)

1.8 Output Tracking: Relative Degree Approach

31

· Designing the control u2 to drive the sliding variable (1.61) to zero as time increases, bearing in mind that the sliding variable dynamics (1.63) are not perturbed anymore
Control u1 Design. The auxiliary sliding variable is designed as

sD z zP D u2
The auxiliary sliding variable dynamics are given by

(1.70)

sP D P zP D '.y; yP; t/ .u1 C u2/ . u2/ D '.y; yP; t/ u1

(1.71)

Sliding mode control u1 that drives the auxiliary sliding variable s to zero in finite time is designed as in Eq (1.66)

u1 D 1 sign.s/

(1.72)

and thus the s-dynamics collapse in the auxiliary sliding mode. The original sliding variable dynamics (1.63) compensated by control u1 given by Eq. (1.72) are

P D '.y; yP; t/ u1 u2; sP D '.y; yP; t/ u1; u1 D 1 sign.s/

(1.73)

In order to describe the -dynamics in the auxiliary sliding mode (s D 0) we have to find the equivalent control u1eq that satisfies the condition sP D 0 and substitute it to Eq. (1.73). It is easy to see that

sP D '.y; yP; t/ u1eq D 0 ) u1eq D '.y; yP; t/ ) P D '.y; yP; t/ ,,'.y;,yP; t.../ u2 ) P D u2
u1eq

(1.74)

Therefore, the original sliding variable dynamics (1.74) do not depend on the disturbance '.y; yP; t/ in the auxiliary sliding mode.
Now we will address the issue of starting the auxiliary sliding mode from the very beginning without any reaching phase. In order to achieve it we have to enforce the initial condition s.0/ D 0 in Eq. (1.73). From Eq. (1.70) we obtain

s.0/ D .0/ z.0/ D 0 ) z.0/ D .0/ ) z.0/ D yPc.0/ C cyc.0/ x2.0/ cy.0/

(1.75)

Therefore, the initial conditions for the variable z are identified from Eq. (1.70) that makes s.0/ D 0.

32

1 Introduction: Intuitive Theory of Sliding Mode Control

The following properties of the auxiliary sliding mode control u1 can be observed:
· The sliding mode control u1 provides compensation for the disturbance '.y; yP; t/ from the very beginning without any reaching phase.
· It was argued earlier that the use of sliding mode control reduces the system's order in the sliding mode. On the other hand the original sliding variable dynamics in Eq. (1.63) retain their order after being compensated by the auxiliary sliding mode control u1 as in Eq. (1.74). So, a very specific type of sliding mode control has been designed.
Definition 1.7. Sliding mode control that retains the order of the compensated system's dynamics in the sliding mode is called integral sliding mode control.
In order to complete the controller design that drives the sliding variable (1.61), select the control function u2 in Eq. (1.74) as

u2 D k ; k > 0

(1.76)

The -dynamics compensated by the control (1.69), (1.72), (1.76) become

P D k ; .0/ D 0

(1.77)

and the desired convergence rate can be easily achieved by choosing the gain k > 0.

Example 1.9. The results of the simulation of system (1.59) with the integral

SMC control (1.69), (1.70) (1.72), (1.75), (1.76), the initial conditions x1.0/ D
1; x2.0/ D 2, z.0/ D yPc.0/ C cyc.0/ x2.0/ cy.0/, the control gains
1 D 8; k D 6, the parameter c D 1:5, the output reference profile yc D 2 cos.t/, and the disturbance f .x1; x2; t/ D sin.2t/ (which is used for simulation

purposes only), which illustrate the output tracking Integral SMC concepts, are

presented in Figs. 1.32­1.34. During the simulation, the component eP of the sliding

variable (1.61) is computed using a simple numerical differentiation. In particular,

the error e is fed to the input of the transfer function

s sC1

with

D 0:01, which

gives an approximation of eP.

Discussion. The auxiliary sliding variable s given by Eq. (1.62) is equal to zero from the very beginning [due to the selection of z.0/ D 3:5 using Eq. (1.75)] and is kept at zero thereafter (Fig. 1.32) by means of integral sliding mode control (1.72). The disturbance f .x1; x2; t/ D sin.2t/ is compensated completely for all t 0. The sliding variable converges to zero (Fig. 1.32) in accordance with Eq. (1.77) and the output y.t/ accurately follows the reference profile yc.t/: y.t/ ! yc.t/ as time increases (Fig. 1.33). High-frequency switching SMC Eq. (1.69) is shown in Fig. 1.34.

1.8 Output Tracking: Relative Degree Approach

33

Fig. 1.32 Sliding variables and s

Fig. 1.33 The reference profile tracking
1.8.3 Super-Twisting Controller Design
In Sects. 1.8.1 and 1.8.2 the discontinuous high-frequency switching sliding mode controllers are designed to drive the sliding variable (1.61) to zero, which yields the solution to the output tracking problem, i.e., y.t/ ! yc.t/ as time increases,

34

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.34 Integral sliding mode control

despite the presence of the bounded disturbance '.y; yP; t/. In many cases highfrequency switching control is impractical, and continuous control is a necessity.
In order to drive the sliding variable (1.61) to zero in finite time we try the following continuous control:

u D c j j1=2 sign. /; c > 0

(1.78)

Assuming '.y; yP; t/ D 0 in the sliding variable dynamics equation (1.63), the compensated sliding variable dynamics (1.63) become

P D c j j1=2 sign. /; .0/ D 0

(1.79)

Integrating Eq. (1.79) we obtain

j .t /j1=2

j 0j1=2 D

c t
2

(1.80)

We wish to identify a time instant t D tr so that .tr / D 0. This is given by

tr

D

2 c

j

0j1=2

(1.81)

So the control (1.78) drives the sliding variable to zero in finite time (1.81). However, in the case of '.y; yP; t/ ¤ 0, the compensated -dynamics become

P D '.y; yP; t/ c j j1=2 sign. /; .0/ D 0

(1.82)

and convergence to zero does not occur.

1.8 Output Tracking: Relative Degree Approach

35

If we could add a term to the control function (1.78) so that it will start following the disturbance '.y; yP; t/ ¤ 0 in finite time, then the disturbance will be compensated for completely. As soon as the disturbance is canceled the sliding variable dynamics will coincide with Eq. (1.79) and ! 0 also in finite time.
Assuming j'P .y; yP; t/j Ä C the following control

uDcj

j1=2 sign.

/Cw

p c D 1:5 C I b D 1:1C

wP D b sign. /

(1.83)

makes the compensated -dynamics become

P C c j j1=2 sign. / C w D '.y; yP; t/; wP D b sign. /

(1.84)

The control (1.83) meets our expectation, and the term w becomes equal to '.y; yP; t/ in finite time, and therefore Eq. (1.84) becomes Eq. (1.79). Consequently ! 0 in finite time as well.
The control (1.83) is called super-twisting control and will be studied rigorously in Chap. 4.
The following properties are exhibited by the super-twisting control formulation:
· The super-twisting control (1.83) is a second-order sliding mode control, since it drives both ; P ! 0 in finite time.
· The super-twistRing control (1.83) is continuous since both c j j1=2 sign. / and the term w D b sign . / dt are continuous. Now, the high-frequency switching term sign . / is "hidden" under the integral.
Example 1.10. The results of the simulation of the system (1.59) with the supertwisting control (1.61), (1.83), initial conditions x1.0/ D 1; x2.0/ D 2, the control gains c D 13:5; b D 88, the parameter C D 80, the output reference profile yc D 2 cos.t/; and the disturbance f .x1; x2; t/ D sin.2t/, which is used for simulation purposes only, which illustrate the super-twisting control concept for output tracking, are presented in Figs. 1.35­1.38. During the simulation, the component eP of the sliding variable (1.61) is computed using simple numerical differentiation, although the sliding mode differentiator studied in Sect. 1.6 could also be employed.
Discussion. The sliding variable is driven to zero in finite time (Fig. 1.35) by the continuous super-twisting control (Fig. 1.37). The high accuracy asymptotic output tracking (Fig. 1.36), which is achieved, is similar to that obtained with conventional SMC (Fig. 1.30) and integral SMC (Fig. 1.33), but is obtained by means of continuous control (Fig. 1.37) rather than high-frequency switching (Figs. 1.31 and 1.34). Including the attenuated (by integration) high frequency switching term sign . / (Fig. 1.38) in the super-twisting control (1.83) is mandatory--it compensates for the disturbance while retaining a continuity of the control function (Fig. 1.37).

36

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.35 Sliding variable

Fig. 1.36 The reference profile tracking
1.8.4 Prescribed Convergence Law Controller Design
Let us summarize the results on output tracking sliding mode control studied in the previous subsections:

1.8 Output Tracking: Relative Degree Approach

37

Fig. 1.37 Super-twisting control

Fig. 1.38 Time history of sign . /

Sliding mode controller
Traditional Integral Super-twisting

Sliding variable convergence
Finite time Asymptotic Finite time

Output tracking convergence
Asymptotic Asymptotic Asymptotic

Type
Discontinuous Discontinuous Continuous

38

1 Introduction: Intuitive Theory of Sliding Mode Control

Notice that the integral sliding mode controller is able to compensate for the bounded disturbance right away without any reaching phase, thus reducing the output tracking problem to one without any disturbances.
Unlike the conventional, integral, and super-twisting sliding mode controllers, in this subsection we will design a 2-SM controller that ensures a full dynamical collapse of the output tracking error dynamics.
The uncompensated dynamics of the output tracking error are derived based on the input­output dynamics given by Eq. (1.60), namely

e.2/ D ,,yRc f.y,; yP; t.../ u ) e.2/ D '.y; yP; t/ u )
'.y;yP;t /

eP1 D e2 eP2 D '.y; yP; t/ u
(1.85)

where e1 D e; e2 D eP. The first problem is the sliding variable design, which is introduced in a format given by Eq. (1.52):

D .e1; e2/ D e2 C c je1j1=2 sign.e1/; c > 0

(1.86)

As soon as the trajectory of system (1.85) reaches the sliding manifold

D .e1; e2/ D e2 C c je1j1=2 sign.e1/ D 0

(1.87)

in finite time t Ä tr its dynamics coincide with Eq. (1.54) and are finite-time convergent, i.e.,

eP1 D e2 e2 D c je1j1=2 sign.e1/

e1.tr / D e1r

(1.88)

Therefore (as studied in Sect. 1.8) e1; e2 (or the output tracking error and its derivative) converge to zero in finite time.

The 2-SM controller with the prescribed convergence law that drives the sliding

variable (1.86) to zero in finite time is designed by analogy with Eq. (1.58):

Á u D sign. / ) u D sign e2 C c je1j1=2 sign.e1/

(1.89)

where the positive gain is large enough and c > 0.
Example 1.11. The results of the simulation of system (1.59) with prescribed convergence law control (1.89), which illustrate the prescribed convergence law control concepts for output tracking, are presented in Figs. 1.39­1.42. During the simulation, the component e2 D eP of the sliding variable in Eq. (1.86) is computed using simple numerical differentiation.

1.8 Output Tracking: Relative Degree Approach

39

Fig. 1.39 Sliding variable
Fig. 1.40 The reference profile tracking
Discussion. The sliding variable is driven to zero in finite time (Fig. 1.39) by the prescribed convergence law (Fig. 1.42). The finite-time convergence of the output tracking error and its derivative to zero (or dynamical collapse) is achieved in the presence of the bounded disturbance '.y; yP; t/ (Figs. 1.40 and 1.41).

40

1 Introduction: Intuitive Theory of Sliding Mode Control

Fig. 1.41 The output tracking error and it derivative

Fig. 1.42 The control function
1.9 Notes and References
The objective of this chapter is to provide an intuitive overview of conventional (first-order) and second-order sliding modes. The definitions and concepts are consequently taken from a wide range of sources and will be rigorously referred

1.10 Exercises

41

to and discussed in the subsequent chapters. The main terminology and techniques are taken from the established monographs and papers [57,61,64,67,74,91,92,113, 123, 132, 146, 147, 182, 183, 186, 195]. For an account of the early developments in VSS and SMC and the people involved, see the review in [184].

1.10 Exercises

Exercise 1.1. A simplified m longitudinal motion of an underwater vehicle can be described by

mxR C kxP jxP j D u

(1.90)

where x is position of the vehicle, u is the control input (a force that is provided by a
propeller), m is the mass of the vehicle, and k > 0 is the drag coefficient. Assuming the value of m is known exactly, the drag coefficient is bounded k1 Ä k Ä k2 and the position and its derivative (velocity) x; xP are measured:

(a) Obtain a state system model of the vehicle using x1 D x; x2 D xP as the state

variables.

(b) Design a conventional sliding mode control law u that drives x1; x2 ! 0 as

time increases.

(c) Simulate the control systemh forix1.0/ D 2 m; x2.0/ D 0:5 m=s; m D 4 kg;

and k D 1:5 C 0:4 sin.2t/

kg ms

. Plot the time histories of the sliding variable,

the control function u, the position x1; and the velocity x2. (d) Identify the quantities that reach zero in finite time and the ones that approach

zero asymptotically.

Hint: The function kxP jxP j can be bounded as jkxP jxP jj Ä k2xP 2 D 1:9xP 2:

Exercise 1.2. Repeat Exercise 1.1 approximating the sign function in the control

law by the sigmoid function sign. / j jC" and separately by the saturation

function

8

< 1 if > "

sign. / : " if j j Ä " 1 if < "

for " D 0:01. Compare the results of the simulations.

Exercise 1.3. Repeat Exercise 1.1 designing a conventional sliding mode control law in terms of v D uP that drives to zero an auxiliary sliding variable s D P C C1 . The derivative of the original sliding variable may be obtained by using a sliding mode differentiator. Do you expect the original sliding variable to reach zero in finite time? Please explain why the original control function is continuous.

Exercise 1.4. Repeat Exercise 1.1 designing u D u.x/ using the super-twisting control law.

42

1 Introduction: Intuitive Theory of Sliding Mode Control

Exercise 1.5. Repeat Exercise 1.1 designing a second-order sliding mode control law with v D uP using the prescribed convergence law technique.
Exercise 1.6. For the DC motor modeled by

d!

J dt

D kmi

di L

D

iR

dt

TL kb! C u

(1.91) (1.92)

where J is the moment of inertia, i is the armature current, L and R are the armature inductance and resistance respectfully, ! is the motor angular speed, kb is a constant of back electromotive force, km is a motor torque constant, TL is an unknown load torque which is bounded and has bounded derivative, and u is a control function defined by the armature voltage, design a sliding mode control u, steering the angular speed ! to zero assuming both i and ! are measurable and all parameters are known. Simulate the control system with R D 1 Ohm, L D 0:5 H, km D 5 10 2 N m/A , kb D km, J D 10 3 N m s2/rad, TL D 0:1 sin.t/ N m, !.0/ D 1 rad/s, and i.0/ D 0. Plot the time histories of the sliding variable, the control function u, the current i , and the angular speed !.

Exercise 1.7. Repeat Exercise 1.6 assuming that only !.t/ is measured. Design a sliding mode observer for estimating {O.t/ ! i.t/. Simulate the control system. Plot the time histories of the sliding variable, the control function u, the angular speed !, the current i and its estimate {O.

Exercise 1.8. Repeat Exercise 1.6 and design a second-order sliding mode control law u in the form of super-twisting control. Simulate the control system. Plot the time histories of the sliding variable, the control function u, the angular speed !, and the current i .

Exercise 1.9. For the DC motor given in Exercise 1.6 design a conventional sliding mode control u that provides asymptotic output tracking !.t/ ! !c.t/, where !c.t/ is an angular speed command given in current time. Simulate the control system with !c.t/ D 0:2 sin.2t/ rad/s. Plot the time histories of the sliding variable, the control function u, the angular speed !, the current i , and the output tracking error e! D !c.t/ !.t/. The torque load profile TL D 0:1 sin.t/ N m is given for simulation purposes only and must be considered unknown when designing the controller.

Exercise 1.10. Repeat Exercise 1.9 using integral sliding mode control to compensate for the unknown external disturbance. Simulate the control system with !c.t/ D 0:2 sin.2t/ rad/s. Plot the time histories of the sliding variable, the control function u, the angular speed !, the current i , and the output tracking error e! D !c.t/ !.t/.

Exercise 1.11. Repeat Exercise 1.9 and design the second-order sliding mode control law u as a super-twisting control.

Chapter 2
Conventional Sliding Modes

This chapter considers the development of conventional sliding mode methods. The chapter describes the early work to define the notion of the solution of differential equations with discontinuous right-hand sides and the concept of "equivalent control" as a means to describe the reduced-order dynamics while a sliding motion is taking place. The main focus of the chapter is on the development of sliding mode design techniques for uncertain linear systems--specifically systems which can be thought of as predominantly linear in a characteristic, or nonlinear systems which can be modeled well (at least locally) by a linear system. For such systems, sliding surfaces formed from linear combinations of the states are considered (i.e., hyperplanes in the state space). In this chapter we consider different explicit design methods which can be used to synthesize hyperplanes which give appropriate closed-loop dynamics when a sliding motion is induced. Different classes of control law are then developed to guarantee the existence of a sliding motion in finite time and to ensure the sliding motion can be maintained in the face of uncertainty. The majority of the chapter is based on the assumption that state information is available for use in the control law. This is convenient and indeed mirrors the development of the ideas since their inception. However, the assumption that all the state, are available is somewhat impractical from an engineering perspective, and in the later sections we consider the case when only output information is available. The impact of this is studied both in terms of the constraints this imposes on the choice of sliding surfaces and the associated control laws.

2.1 Introduction

This chapter will discuss "conventional" sliding modes--or to be more precise first-

order sliding modes when viewed in the context of higher-order sliding. Consider a

general state-space system

xP D f .x; u; d /

(2.1)

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

43

DOI 10.1007/978-0-8176-4893-0 2, © Springer Science+Business Media New York 2014

44

2 Conventional Sliding Modes

where x 2 Rn is a vector which represents the state and u 2 Rm is the control

input. It is assumed that f . / is differentiable with respect to x and absolutely

continuous with respect to time. The quantity d 2 Rq represents external bounded

disturbances/uncertainties within the system. Consider a surface in the state space

given by

S D fx W .x/ D 0g

(2.2)

A formal definition of an ideal sliding mode will now be given generalizing Definition 1.3 from Chap. 1.

Definition 2.1. An ideal sliding mode is said to take place on Eq. (2.2) if the states x.t/ evolve with time such that .x.tr // D 0 for some finite tr 2 RC and .x.t// D 0 for all t > tr .
During a sliding mode, .t/ D 0 for all t > tr : Intuitively this dynamical collapse implies the motion of the system when confined to S will be of reduced dynamical order. From a control systems perspective the capacity to analyze the dynamics of the reduced-order motion is important.
If the control action in u D u.x/ Eq. (2.1) is discontinuous, the differential equation describing the resulting closed-loop system written as

xP .t/ D f c.x/

(2.3)

is such that the function f c W R Rn ! 7 Rn is discontinuous with respect to the state vector. The classical theory of differential equations is now not applicable since Lipschitz assumptions are usually employed to guarantee the existence of a unique solution. The solution concept proposed by Filippov for differential equations with discontinuous right-hand sides constructs a solution as the "average" of the solutions obtained from approaching the point of discontinuity from different directions.

2.1.1 Filippov Solution

Consider initially the case when the system has a single input and W Rn 7! R. Suppose x0 is a point of discontinuity on S and define f c.x0/ and fCc .x0/ as the limits of f c.x/ as the point x0 is approached from opposite sides of the tangent to S at x0. The solution proposed by Filippov is given by

xP .t/ D .1 /f c.x/ C fCc .x/

(2.4)

where the scalar 0 <  < 1. The scalar  is chosen so that

fac WD .1 /f c C fCc

is tangential to S (see Fig. 2.1).

2.1 Introduction

45

S

f+c

f-c

fac

Fig. 2.1 A schematic of the Filippov construction

Remark 2.1. From the discussion above, it is clear the Filippov solution is an average solution of the two "velocity" vectors at the point x0.

Equation (2.4) can be thought of as a differential equation whose right-hand side is defined as the convex set

° F .x/ D .1

/f c C fCc W for all  2

0

« 1

and thus

xP .t/ 2 F .x/

The values of  which ensure P .t/ D 0 can be computed explicitly from Eq. (2.4). For simplicity further suppose D S x where S T 2 Rn. Then explicitly

P D S xP D .1 /Sf c C SfCc

In order to maintain D 0, the scalar  must satisfy

.1 /Sf c C SfCc D 0

and consequently (and uniquely)

Sf c

D Sf c

SfCc

so that

xP .t/

D

Sf cfCc Sf c

SfCc f c SfCc

46

2 Conventional Sliding Modes

A formal definition for the generic case of multi-input systems is:

Definition 2.2. A differential inclusion xP 2 F .x/; x 2 Rn, is called a Filippov differential inclusion if the vector set F .x/ is nonempty, closed, convex, locally bounded, and upper-semi-continuous. The latter condition means that the maximal distance of the points of F .x/ from the set F .y/ vanishes when x ! y. Solutions are defined as absolutely continuous functions of time satisfying the inclusion almost everywhere.

Recall in this context that a function is absolutely continuous if and only if it can be represented as a Lebesgue integral of some integrable function.1 Thus, such a function is almost everywhere differentiable. Solutions of Filippov differential inclusions always exist and have most of the well-known standard properties except the uniqueness.

Definition 2.3. It is said that a differential equation xP D f .x/ with a locally bounded Lebesgue-measurable right-hand side is understood in the Filippov sense, if it is replaced by a special Filippov differential inclusion xP 2 F .x/, where

\\

F .x/ D

cof .Oi.x/nN /

i>0 N D0

(2.5)

Here is the Lebesgue measure, Oi.x/ is the i-vicinity of x, and coM denotes the convex closure of M .
Note that any surface or curve has zero Lebesgue measure. Thus, values on any such set do not affect the Filippov solutions. In the most usual case, when f is continuous almost everywhere, the procedure is to take F .x/ being the convex closure of the set of all possible limit values of f at a given point x, obtained when its continuity point y tends to x. In the general case approximate-continuity points y are taken (one of the equivalent definitions by Filippov).2 A solution of xP D f .x/ is defined as a solution of xP 2 F .x/. Obviously, values of f on any set of measure 0 do not influence the Filippov solutions. Note that with continuous f the standard definition is obtained. The nonautonomous case is reduced to the considered one introducing the fictitious equation tP D 1 .
In order to better understand the definition, consider the case when the number of limit values f1; : : : ; fn at the point x is finite. Then any possible Filippov velocity has the form xP D 1f1 C C nfn; 1 C C n D 1; i 0, and can be considered as a mean value of the velocity taking on the values fi during the fraction of time i t of the current infinitesimal time interval t.

1For details see [158]. 2For details see [158].

2.1 Introduction

47

2.1.2 Concept of Equivalent Control

One way to undertake this analysis is by the so-called equivalent control method attributed to Utkin. This defines the equivalent control as the control action necessary to maintain an ideal sliding motion on S. The idea is to exploit the fact that in conventional sliding modes both D P D 0. The constraint on the derivative of can be written as

P D @ dx D @ f .x; u; d / D 0 @x dt @x

This represents an algebraic equation in x, u, and d , and by definition, the equivalent

control signal ueq.t/, which is the continuous control function required to maintain

sliding, is the solution to

@

@x f .x; ueq ; d / D 0

(2.6)

For example, consider the affine system

xP D f .x/ C g.x/u C d

(2.7)

The specific structure which has been imposed here ensures that for a given x the control input appears linearly. Consequently Eq. (2.6) simplifies to

@ f .x/
@x

C

@ @x g.x/ueq

C

@ @x

d

D

0

(2.8)

and

so,

provided

@ @x

g.x/

is

nonsingular,

from

Eq.

(2.6)

Â @

Ã 1@

Â @

Ã 1@

ueq D

g.x/ @x

f .x/ @x

g.x/ @x

d @x

(2.9)

The closed-loop response is given by substituting the expression in Eq. (2.9) into Eq. (2.7) to yield

xP D I

Â @
g.x/

Ã g.x/

1@

! f .x/ C

I

Â @

Ã 1@ !

g.x/

d (2.10)

@x

@x

@x

@x

Example 2.1. Consider a system where the state vector is given by x D OEx1; x2T with the structure of (2.7) so that

Ä

Ä

Ä

f .x/ D x2 ; g.x/ D 0 ; d D

0

0

1

.x1; x2; t /

(2.11)

48

2 Conventional Sliding Modes

The scalar disturbance term .x1; x2; t/ comprises dry and viscous friction as well as any other unknown resistance forces, and it is assumed to be bounded, i.e., j .x1; x2; t/j Ä L. Now considering the surface D x2 C cx1, it implies

Ä

@

D

@@ ;

D OEc; 1

@x @x1 @x2

and consequently the equivalent control is given by Eq. (2.9), i.e.,

ueq D cx2 .x1; x2; t /

Example 2.2. Consider the following multi-input multi-output (MIMO) linear system:
xP1 D x1 C x2 C x3 C u2 xP2 D x2 C 3x3 C u1 u2 xP3 D x1 C x3 u1
and the corresponding outputs surfaces
1 D x1 C 10x3 2 D x3 C x2
Applying the concept of equivalent control we need to find the dynamic of sliding modes in the intersection of the output surfaces 1 and 2, i.e.,

P 1 D 9x1 x2 C 9x3 10u1 C u2 P 2 D x1 C x2 C 4x3 u2
From the invariance conditions P 1 D 0, 1 D 0, and P 2 D 0, 2 D 0 we obtain:
u1eq D x1 2x2 4x3 u2eq D x1 C 1:3x3

and the reduced dynamics of the original system is given by

x1 D 10x3 x2 D x3 xP3 D 0:3x3

Remark 2.2. There are several points to note from the analysis given above:
· The expression for the equivalent control ueq in Eq. (2.9) comes from formally solving Eq. (2.6), considered as an algebraic equation. It is therefore quite independent of the control signal which is actually applied. The control signal which is physically applied to the plant can be discontinuous in nature. However, the solution to Eq. (2.9) will always be smooth.

2.1 Introduction

49

· The equivalent control ueq in Eq. (2.9) depends on the disturbance d.t/ which will generally be unknown. Consequently Eq. (2.9) will not be physically implementable.
· The control signal in Eq. (2.9) is best thought of as an abstract concept to facilitate the creation of an expression for the reduced-order system in Eq. (2.10), hence establishing a differential equation from which the stability of the closed-loop system can be studied.
Another crucial property of sliding mode control systems can now be demonstrated, namely its robustness--or more precisely, its invariance to a certain class of uncertainty. Suppose the disturbance d acts in the channels of the inputs so that

d.t/ D g.x/ .t/

(2.12)

for some (unknown) signal .t/. Then it is easy to see that in Eq. (2.10)

Â @

Ã 1@ !

Â @

Ã 1@ !

I g.x/ g.x/

d D I g.x/ g.x/

g.x/

@x

@x

@x

@x

D g.x/ g.x/

D0

and so Eq. (2.10) collapses to xP D I

Â @

Ã 1@ !

g.x/ g.x/

f .x/

@x

@x

(2.13)

The closed-loop (reduced-order) system given in Eq. (2.13) is completely independent of . This invariance property has motivated research in sliding mode control.
Clearly from Eq. (2.10) the choice of the surface affects the dynamics of the reduced-order motion. In terms of control system design, the selection of the surface is one of the key design choices. Later in this chapter an alternative viewpoint and design framework will be given which is more amenable from the perspective of synthesizing choices for S.
Example 2.3. Consider a second-order system representing a DC motor:

ÂP .t/ D w.t/ wP .t/ D F .t/ C Kt u.t/
JJ

(2.14) (2.15)

where Â represents the shaft position and w is the angular rotation speed. The scalar J represents the inertia of the shaft, F .t/ represents the effects of dynamic friction and Kt represents the motor constant. Assume all the coefficients are

50

2 Conventional Sliding Modes

unknown but bounded so that 0 < J Ä J Ä JN, jF .t/j Ä FN and the motor constant Kt Ä Kt Ä KNt .
Suppose a switching function is defined as

D w C mÂ

(2.16)

where m is a positive design scalar. During the sliding motion if combining Eqs. (2.14) and (2.16) gives
ÂP .t/ D w.t/ D mÂ.t/

Á 0, then

and a first-order system is obtained which is independent of the uncertainty associated with F .t/, J , and Kt . The closed-loop solution is given by

Â .t / D Â 0e m.t ts/

(2.17)

where Â 0 represents the value of Â. / at the time instant ts at which sliding is

achieved. Clearly in Eq. (2.17) the effect of the uncertainty has been totally rejected

and robust closed-loop performance has been achieved.

Figures 2.2­2.4 are associated with simulations where

Kt J

D 0:45 and m

D 1.

The controller regulates the shaft position back to zero from an initial displacement

of 1 rad.

The next section focuses on linear (in fact uncertain linear) system representations which have been more well studied in the literature and yield systematic tractable methods for the design of S.

2.2 State-Feedback Sliding Surface Design

Consider the nth-order linear time-invariant system with m inputs given by

xP .t/ D Ax.t/ C Bu.t/

(2.18)

where A 2 Rn n and B 2 Rn m with 1 Ä m Ä n. Without loss of generality it can

be assumed that the input distribution matrix B has full rank. Define a switching

function W R ! Rm to be

.x/ D S x.t/

(2.19)

where S 2 Rm n is of full rank and let S be the hyperplane defined by

S D fx 2 Rn W S x D 0g

(2.20)

2.2 State-Feedback Sliding Surface Design

51

Shaft Position

1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1
0 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 Time Fig. 2.2 Evolution of shaft position

2

1.5

Switching Function

1

0.5

0

-0.5 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 Time
Fig. 2.3 Evolution of switching function

52

2 Conventional Sliding Modes

shaft velocity

0 -0.05
-0.1 -0.15
-0.2 -0.25
-0.3 -0.35
-0.4 -0.45
-0.5 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 shaft position Fig. 2.4 Phase portrait

This implies the switching function .x/ is a linear combination of the states. Also from Eq. (2.20) it follows that the sliding motion is associated with the null space of the matrix S . Also note that the number of rows of the matrix S corresponds to the number of columns of the input distribution matrix B and consequently the matrix SB is square.
Suppose u represents a sliding mode control law where the changes in control strategy depend on the value of the switching function .x/. It is natural to explore the possibility of choosing the control action and selecting the switching strategy so that an ideal sliding motion takes place on the hyperplane, i.e., there exists a time tr such that

.x/ D S x.t/ D 0 for all t > tr

(2.21)

Suppose at time t D tr the system states lie on the surface S and an ideal sliding motion takes place. This can be expressed mathematically as S x.t/ D 0 and P .t/ D S xP .t/ D 0 for all t tr . Substituting for xP .t/ from Eq. (2.18) gives

S xP .t/ D SAx.t/ C SBu.t/ D 0 for all t tr

(2.22)

Suppose the matrix S is designed so that the square matrix SB is nonsingular (in practice this is easily accomplished since B is full rank and S is a free parameter).

2.2 State-Feedback Sliding Surface Design

53

The equivalent control, written as ueq, as argued above, is the unique solution to the algebraic equation (2.22), namely

ueq.t/ D .SB/ 1SAx.t/

(2.23)

This represents the control action which is required to maintain the states on the switching surface. Substituting the expression for the equivalent control into Eq. (2.18) results in a free motion

xP .t/ D In B.SB/ 1S Ax.t/ for all t tr and S x.tr / D 0 (2.24)

It can be seen from Eq. (2.24) that the sliding motion is a control independent free motion which depends on the choice of sliding surface.
Now suppose the system (2.18) is uncertain:

xP .t/ D Ax.t/ C Bu.t/ C B .t; x; u/

(2.25)

where W R Rn Rm 7! Rm is unknown but bounded and encapsulates any nonlinearities or uncertainties in the system. Uncertainty which acts in the channel of the inputs is often referred to as matched uncertainty. Suppose a control law can be found for the system in Eq. (2.25) which induces a sliding motion on Eq. (2.20). Arguing as before, the equivalent control is in this case given by

ueq.t/ D .SB/ 1SAx.t/ .t; x; u/

(2.26)

The closed-loop sliding motion is given by substituting Eq. (2.26) in Eq. (2.25) and yields

xP .t/ D In B.SB/ 1S Ax.t/

(2.27)

This motion is completely independent of the uncertainty. Although the sliding motion is clearly dependent on the matrix S , how to select S to achieve a specific design goal is not transparent. One way to see the effect is to first transform the system into a suitable regular form.

2.2.1 Regular Form

In this section a coordinate transformation is introduced to create a special structure
in the input distribution matrix. Since by assumption rank.B/ D m there exists an orthogonal matrix Tr 2 Rn n such that

Ä

Tr B D

0 B2

(2.28)

54

2 Conventional Sliding Modes

where B2 2 Rm m and is nonsingular. The matrix Tr can be obtained via so-called QR factorization.3 This means a design algorithm can be created to deliver a change
of coordinates in which a specific structure is imposed on the input distribution
matrix.

Remark 2.3. This is not the only way to achieve the partition in Eq. (2.28). In principle, any nonsingular matrix which partitions the input distribution matrix can be employed--indeed later in the chapter a different approach based on orthogonal complements will be used. One advantage of the method of QR factorization is that the method generates an orthogonal matrix Tr . Consequently the associated coordinate transformation is orthogonal which means it has good numerical conditioning and also Euclidean distance is preserved.

Let z D Tr x and partition the new coordinates so that Ä
z D z1 z2

(2.29)

where z1 2 Rn m and z2 2 Rm. The system matrices .A; B/ in the original coordinates become A $ Tr ATrT and B $ Tr B in the "z" coordinates. Now the linear system (2.18) can be written as

zP1.t / D A11z1.t / C A12z2.t / zP2.t / D A21z1.t / C A22z2.t / C B2u.t /

(2.30) (2.31)

in which

Ä

Tr ATrT D

A11 A12 A21 A22

The representation in Eqs. (2.30) and (2.31) is referred to as regular form. Suppose the matrix defining the switching function in the new coordinate system is compatibly partitioned as

S TrT D S1 S2

(2.32)

where S1 2 Rm .n m/ and S2 2 Rm m. Since SB D S2B2 it follows that a necessary and sufficient condition for the matrix SB to be nonsingular is that det.S2/ ¤ 0 since det.SB/ D det.S2B2/ D det.S2/ det.B2/ and therefore

det.SB/ ¤ 0 , det.S2/ ¤ 0

since det.B2/ ¤ 0 by construction. By design assume this to be the case. During an ideal sliding motion

S1z1.t/ C S2z2.t/ D 0 for all t > ts

(2.33)

3For details of QR factorization methods see [177].

2.2 State-Feedback Sliding Surface Design

55

and therefore exploiting the non-singularity of S2, the relationship in Eq. (2.33), can be rewritten as

z2.t/ D M z1.t/

(2.34)

where M D S2 1S1. Substituting in Eq. (2.30) gives

zP1.t / D .A11 A12M / z1.t /

(2.35)

This equation is a straightforward expression describing the reduced-order dynamics in terms of the design freedom associated with the sliding surface.
If Eq. (2.30) is considered in isolation with z1 thought of as the state vector and z2 as a "virtual" control input, then Eq. (2.34) can be thought of as a state-feedback control law for Eq. (2.30). Consequently the dynamics describing the sliding motion in Eq. (2.35) can be thought of as the closed-loop system applying the feedback control law (2.34)­(2.30). It can be seen from Eq. (2.35) that S2 has no direct effect on the dynamics of the sliding motion and acts only as a scaling factor for the switching function. A common choice for S2, however, which stems from the socalled hierarchical design procedure, is to let S2 D B2 1 for some diagonal design matrix  2 Rm m which implies SB D . By selecting M and S2 the switching function in Eq. (2.32) is completely determined.
Remark 2.4. The matrix S of the switching function .x/ D S x.x/ has the form:

S D S2 M Im m Tr :

(2.36)

There exist two major techniques for the design of the matrix M ; these are
· Eigenvalue placement method · Linear-quadratic minimization

2.2.2 Eigenvalue Placement

Single-input systems represented by the pair .A; B/ where B 2 Rn can be written in the so-called controllability canonical form4

2 0

A D 6666646

::: :::
0

a1

1 0 :::
01 ::: ::: 0
a2 : : : : : :

3 0

:::
0 1

7777577

an

23 0

B

D 6466666

::: :::
0

7777577

1

(2.37)

4See for example [47].

56

2 Conventional Sliding Modes

where the scalars ai are the coefficients of the characteristic equation of the A matrix:
n C an n 1 C C a2 C a1 D 0
For this general system an appropriate switching function is

.x/ D s1x1 C s2x2 C : : : C sn 1xn 1 C xn

(2.38)

where the scalars si are to be chosen. Partition the state space associated with Eq. (2.37) into the first n 1, and the last equation, so that

2 6666664

xP1
xP2 ::: :::

3

2 0

7775777 D 46666666

::: ::: :::

1 0

0
1 :::

:::
::: 0

0 32

::: 0 1

77757777 6646666

x1
x2 ::: :::

32 3 0

7757777 C 6646666

::: :::
0

7777577 xn

xPn 1

0 ::: ::: ::: 0

xn 1

1

During the sliding motion .x/ D 0 and so from Eq. (2.38) the last coordinate can be expressed as
xn D s1x1 s2x2 : : : sn 1xn 1

Now substituting for xn in Eq. (2.2.2) yields a description of the sliding motion as

2 6466666

xP1
xP2 ::: :::

32 7777757 D 66666664

0 ::: ::: :::

1 0 :::
01 ::: :::
0

xPn 1

s1 : : : : : : : : :

0 :::
0
1

32

3

77777757 4666666

x1
x2 ::: :::

7777757

sn 1

xn 1

Therefore the characteristic equation of the sliding motion is

n 1 C sn 1 n 2 C : : : C s2 C s1 D 0

The scalars s1; : : : sn should therefore be chosen to make the polynomial above Hurwitz. More generally for multi-input systems, the regular form from Eqs. (2.30) and (2.31) must be relied upon. For a hyperplane parameterized as in Eq. (2.36) the sliding motion is governed by the system matrix .A11 A12M / in Eq. (2.35) where the matrices A11 and A12 are associated with the regular form in Eqs. (2.30) and (2.31). In the context of designing a regulatory system, the matrix .A11 A12M / must have stable eigenvalues. The switching surface design problem can therefore be considered to be one of choosing a state-feedback matrix M to stabilize the

2.2 State-Feedback Sliding Surface Design

57

reduced-order system associated with the pair .A11; A12/. Because of the special structure of the regular form, it can be shown that the pair .A11; A12/ is controllable if and only if .A; B/ is controllable.5 Consequently if the original pair .A; B/ is controllable then the problem of synthesizing the matrix S associated with the switching function can always be solved to ensure the associated hyperplane S yields a stable sliding motion. This is important; otherwise, the method would lack credibility. Any eigenvalue pole placement methods can be employed. The eigenvalue placement algorithm is demonstrated on the following example.

Example 2.4. Consider the linear system:

2

32

111

0

xP D Ax C Bu D 40 1 35 x C 4 1

101

1

1 3Ä 15 u1 0 u2

Apply the transformation z D Tr x, where Tr is obtained by QR factorization, such

that

BN

D

Tr B

D

2 4

1 3 1 3

p p3
6

p

1 3

p3

1
6p

6

3116ppp3653 B

D

2 0
4p0

3

p0

1 2

p6

5

0

1 2

2

1 2

2

2

1 2

2

to create the equivalent system:

Ä zP1 zP2

Ä D AN z1
z2

C

BN

u

D

ÄAN11 AN21

AN12 AN22

Ä z1 z2

C Ä 0N B2

Ä u1 u2

where AN D Tr ATrT and Tr TrT D In n. After some computations,

h AN11 D OE3; AN12 D

1 6

p 18

1 2

pi 6

;

"#

AN21 D

1 3

p0 6

;

" AN22 D

1
1522p12

1 4

p# 12

1

2

"Now setting z2 D M z1 where M D OEM11 M12T , the dynamics for z1 are given

by:

zP1 D .AN11

A12M /z1

D

.3

C

1p 6 18M11

C

1p 2 6M12/z1

p

p

Provided

the

eigenvalue 

D

3C

1 6

18M11

C

1 2

6M12 < 0, stability of z1 is

ensured. For example setting  D 1, implies M D OE p18 p2 T . Finally with

18

6

S2 D Im m D 1, the matrix S is given by:

S D S2OEM Im mTr D 3:1162 1:409 2:8233 "

5See, for example, Sect. 3.4 in [67].

58

2 Conventional Sliding Modes

2.2.3 Quadratic Minimization

Consider the problem of minimizing the quadratic performance index

J

D

1

Z

1
x.t/T Qx.t/ dt

2 ts

(2.39)

where Q is both symmetric and positive definite, and ts is the time at which the

sliding motion commences. The objective is to minimize Eq. (2.39) subject to the

system equation (2.18) under the assumption that sliding takes place. Notice this

is quite different from the "classical" LQR problem formulation which includes

a penalty weighting on the control effort. Here no penalty cost on the control is

imposed, and this represents a so-called cost-free control problem.

It is assumed that the state of the system at time ts, given by x.ts/, is a known initial condition, and the closed-loop system is stable such that x.t/ ! 0 as t ! 1.

To solve this problem, the matrix Q from Eq. (2.39) is transformed and partitioned

compatibly with the z coordinates from Eq. (2.29) so that

Ä

Tr QTrT D

Q11 Q12 Q1T2 Q22

(2.40)

In the "z" coordinates, the cost J in Eq. (2.39) can be written as

J

D

1 2

Z1 z1.t /T Q11z1.t / C 2z1.t /T Q12z2.t /
ts

C z2.t /T Q22z2.t /

dt

(2.41)

If the component z1 is considered to be the state vector and z2 the "virtual control"
input then this expression represents a "traditional" mixed cost LQR problem associated with the state-space representation in Eq. (2.30) since the term z1T Q12z2 involves a mix of the state vector and the virtual control. To avoid this complication,

a trick can be employed to "eliminate" the cross term. Define a new "virtual control"

input as

v WD z2 C Q221Q1T2z1

(2.42)

After algebraic manipulation, Eq. (2.41) may then be written as

J

D

1 2

Z1 z1T QO z1
ts

C vT Q22v dt

(2.43)

where

QO WD Q11 Q12Q221Q1T2

(2.44)

Note that QO represents part of the Schur complement of Eq. (2.40). Recall the

constraint equation (the null-space dynamics associated with the regular form) may

be written as

zP1.t / D A11z1.t / C A12z2.t /

(2.45)

2.2 State-Feedback Sliding Surface Design

59

Eliminating the z2 contribution from Eq. (2.45) and using Eq. (2.42), after writing the differential equations in terms of the virtual control, the modified constraint

equation becomes

zP1.t/ D AOz1.t/ C A12v.t/

(2.46)

where

AO D A11 A12Q221Q1T2

(2.47)

The positive definiteness of Q ensures from Schur complement arguments that Q22 > 0, so that Q221 exists, and also that QO > 0. Furthermore, the controllability of the original .A; B/ pair ensures the pair .AO; A12/ is controllable. Consequently,
the problem becomes one of minimizing the functional (2.43) subject to the system
(2.46). This can be interpreted as a standard LQR optimal state-regulator problem.
A necessary condition to ensure a solution to the LQR problem is that the pair .AO; QO 1=2/ is detectable6 and then after solving the Riccati equation

PO AOT C AOPO C QO PO A12Q22 1AT12PO D 0 the matrix parameterizing the hyperplane is

(2.48)

M D Q221Q1T2 C Q22 1AT12PO

(2.49)

Robustness of the LQR Sliding Surface Design An advantage of this approach compared to pole placement is that the LQR
optimization method inherits robustness. Suppose in fact unmatched uncertainty is present in the system so that Eq. (2.30) becomes

zP1.t / D A11.I C 1/z1.t / C A12.I C 1/z2.t /

(2.50)

where 1 and 2 represent (unknown) multiplicative perturbations. Suppose Q is chosen so that Q12 D 0 and Q22 D qIm where q is a positive scalar. If a sliding mode is enforced, the reduced-order sliding motion will be given by

Â zP1.t / D A11.I C 1/

Ã

1 q

A12.I

C

2/AT12P1

z1.t /

(2.51)

where P1 is the symmetric positive definite solution to

P1AT11 C A11P1 C Q11

1 q

P1

A12 A1T2 P1

D

0

(2.52)

6A more detailed description of this approach is given in Sect. 4.2.2 in [67] and details about LQR methods appear in Appendix C.

60

2 Conventional Sliding Modes

Under some conditions on the perturbations it will be shown that Eq. (2.50) is stable. Assume 1 is sufficiently small that

P11 C 1T P1 < Q11

(2.53)

and consider V1 D z1T P1z1 as a candidate Lyapunov function. Then

VP

Ä

zT1

1 q

P1 A12 A1T2 P1

P1A12.I C 2/AT12P1

P1A12.I C 2T /A1T2P1 z1

D

z1T

1 q P1A12

2 C T2 C I

AT12 P1 z1

(2.54)

after substituting from the Riccati equation from Eq. (2.52) and the bound on the 1 inequality from Eq. (2.53). Consequently if the uncertainty 2 satisfies

2 C 2T C I > 0

(2.55)

then VP < 0 for z1 ¤ 0 and the sliding motion remains stable. Some special cases can be considered:

· Unstructured Perturbations: Consider the expression

,

WD

2.2

C

1 I /T 2

.2

C

1 I/
2

Clearly , 0 for all 2. Expanding the right hand side it follows

22T 2

C

2

C

2T

C

1 I
2

0

which implies

2 C T2 C I

2T2 2

C

1 I
2

D

1 2.
4

T2 2/

(2.56)

for all 2. However if k2k

<

1 2

,

the

right

hand

side

of

(2.56)

is

positive

and

2 C 2T C I > 0.

· Structured Perturbations: Suppose the uncertainty is structured and has the

special form  D diag.i1; : : : im/ where the ii are scalars. Then Eq. (2.55) is

equivalent to

2ii C 1 > 0 for i D 1 : : : m

and stability is ensured if ii >

1 2

for

i

D

1 : : : m.

The analysis confirms the robustness of the LQR sliding surface design.

Example 2.5. Consider Example 2.4, now we will design the sliding surface with

LQ minimization. Consider the matrix

2

3

100

Q D 40 2 05

003

2.3 State-Feedback Relay Control Law Design

61

After transformation we have 2
Tr QTrT D 4

p2

1 6

p18

1 6

6

p

1 6

18

3

p2

1 12

12

p

1
6p

6

1 12

12

3 5

5

2

the elements of the new matrix Q are given by

Q11 Q21

D D

ÄOE2

;

Qp12 D

1 6

p18

1 6

6

p

p

1 6

18 Ä

1 6 3

6

; Q22 D

2p

1 12

12

;p

1 12

12

5

2

and after direct computations we have AO D 2 and QO D 1:6364. Now we can use the lqr command of MATLAB in order to obtain the matrix M :

M D 2:032 2:3464

Finally we obtain the matrix S :

S D 2:032 2:3464 1 Tr D 3:089 0:492 0:922

2.3 State-Feedback Relay Control Law Design
In this section, although previously multi-input systems were considered at the outset, here the development of control laws for single-input systems will be considered first before multi-input generalizations are considered.

2.3.1 Single-Input Nominal Systems

Using the nomenclature developed in the previous section, suppose m D 1, i.e., the system is single input in nature. Assume that the switching function .x/ D S x has already been defined. In this situation the matrix S is a row vector of the same order as the states. The objective is to force ! 0 in finite time and to ensure Á 0 for all subsequent time. From the nominal representation in Eq. (2.18) it follows

P .t/ D S xP .t/ D SAx.t/ C SBu.t/

(2.57)

The objective is, through feedback control, to turn the equation above into the

differential equation

P .t/ D Ásign. .t//

(2.58)

62

2 Conventional Sliding Modes

or equivalently

P .t/ D Áj .t/j

(2.59)

For .0/ ¤ 0 the solution to the equation above becomes zero in finite time. This

can eapsily be seen by the change of variable V

D

1 2

2. Clearly VP

D

P and

j j D 2V . Consequently the equation above becomes

VP D

p 2ÁV 1=2

This implies

p V 1=2.t / D V 1=2.0/ 2Át

p

and therefore at time tr D V 1=2.0/=. 2Á/, it follows V 1=2.tr / D 0. Notice that

V

D

1 2

2 can be viewed as a Lyapunov function for the system (2.59) because

VP D P D Á sign. / D Áj j < 0

when ¤ 0. Comparing Eqs. (2.57) and (2.59) it is clear that choosing

u.t/ D ,,.SB/1,SAx.t.../ Á.SB/ 1sign. /
ueq .t /

(2.60)

as the control law in Eq. (2.57) creates in closed loop the system in (2.59). The simple control law in Eq. (2.60) thus ensures is driven to zero in finite time--in fact in j .0/j=Á units of time.

2.3.2 Single-Input Perturbed Systems

This can be easily extended to the case of systems with bounded matched uncertainty. Now consider the uncertain linear system

xP .t/ D Ax.t/ C Bu.t/ C B .t; x/

(2.61)

where the (unknown) function W RC Rn 7! Rm represents matched uncertainty. With the same choice of switching function

P .t/ D S xP .t/ D SAx.t/ C SB .t; x/ C SBu.t/

(2.62)

In this situation consider the control law u.t/ D .SB/ 1SAx.t/ .Á C .t; x/jSBj/.SB/ 1sign. .t//

(2.63)

2.3 State-Feedback Relay Control Law Design

63

where the scalar function .t; x/ represents a known upper bound on the (unknown) uncertainty .t; x/. Substituting for Eq. (2.60) in Eq. (2.62) gives

P .t/ D SAx.t/ C SB .t; x/ C SBu.t/

D SAx.t/ C SB .t; x/ SAx.t/ .Á C .t; x/jSBj/sign. /

D SB .t; x/ Ásign. / .t; x/jSBjsign. /

(2.64)

However since

SB .t; x/ Ä jSB .t; x/j D jSBjj .t; x/j Ä jSBj .t; x/

it follows from Eq. (2.64) that

P .t/ D SB .t; x/ Á sign. / .t; x/jSBj sign. / Ä j jjSBj .t; x/ Áj j .t; x/jSBjj j D Áj j

(2.65)

and once again is driven to zero in less than j .0/j=Á units of time.

Consider next a system with what might be described as multiplicative uncer-

tainty:

xP .t/ D Ax.t/ C B.1 C i/u.t/ C B .t; x/

(2.66)

where i 2 . i0; i1/ with known scalars 0 < i0 < 1 and i1 > 0. Compared to Eq. (2.61) it is clear there is now uncertainty associated with the control signal. Note the limitation that i0 < 1 prevents a "change of polarity" with respect to the control. Proceeding as before

P .t/ D S xP .t/ D SAx.t/ C SB .t; x/ C SBiu.t/ C SBu.t/

(2.67)

Consider the control law

u.t/ D ul .t/ C un.t/;

(2.68)

where as before the linear term ul .t/ D .SB/ 1SAx.t/ and the nonlinear term (with a new modulation function) is un.t/ D .SB/ 1 N .t; x/sign. .t// where

N .t/ D .Á C jSBj. .t; x/ C i1jul.t/j//.1 i0/ 1

(2.69)

As before the scalar function .t; x/ represents a known upper bound on the (unknown) uncertainty .t; x/. Note that the modulation function in the nonlinear term also depends on i0. Substituting for Eq. (2.68) in Eq. (2.62) gives

P .t/ D SAx.t/ C SB .t; x/ C SBu.t/ D SB .t; x/ C SB.1 C i/un.t/ C SBiul .t/

(2.70)

64

2 Conventional Sliding Modes

Consequently

P .t/ D SB .t; x/ C SB.1 C i/un.t/ C SBiul .t/ Ä j jjSBjj .t; x/j .1 C i/ N .t; x/sign. / C j jjSBjjijjul.t/j Ä j jjSBjj .t; x/j .1 C i/ N .t; x/j j C j jjSBji1jul.t/j Ä j jjSBjj .t; x/j .1 i0/ N .t; x/j j C j jjSBji1jul.t/j (2.71)
Substituting for N .t; x/ from Eq. (2.69) yields

P .t/ Ä Áj j

(2.72)

and a sliding mode is guaranteed to be achieved in finite time, and subsequently maintained.
Example 2.6. Consider the state-space model

xP .t/ D Ax.t/ C bu.t/

(2.73)

where

2

3

010

23 0

AD4 0 2 1 5 bD4 0 5

001

10

These represent the equations of motion of a hot-air balloon where the control input is the fuel flow into the burner and the first component represents the altitude of the balloon.7 The open-loop poles are f0; 1; 2g.
The aim is to select a switching function defined by

S D s1 s2 1

or equivalently

.x/ D s1x1 C s2x2 C x3

to ensure the reduced-order sliding motion confined to S is stable, and meets any

design specifications. While sliding, when D 0,

x3 D

Ä

s1 s2

x1 x2

(2.74)

Because of the special form of the state space

Ä

Ä

Ä

Ä

xP1 D 0 1

xP2

02

x1 x2

C

0 1

x3

Ä

x3 D

s1 s2

x1 x2

(2.75) (2.76)

7Taken from [86].

2.3 State-Feedback Relay Control Law Design

65

Simplifying Eqs. (2.74) and (2.75)

Ä xP1 xP2

Ä D0
s1

1 2 s2

Ä x1 x2

(2.77)

Equations (2.75) and (2.74) represent a second-order system in which x3 has the role of the control variable and OE s1 s2  is a full state-feedback matrix. The characteristic equation of Eq. (2.77) is

Ä det
s1

1

D0

C 2 C s2

in other words

2 C .2 C s2/ C s1 D 0

(2.78)

Choosing the required sliding mode poles to be f 1  j g gives a desired characteristic equation
2C2 C2D0

Comparing coefficients with Eq. (2.78) gives s1 D 2 and s2 D 0 and the resulting switching function

.x/ D 2x1 C x3

(2.79)

A control law must be developed such that the reachability condition (2.59) is satisfied. It follows (in this case) that

P D 2xP1 C xP3

Now substituting from the original equations

P D 2 ,,x,2 ... C ,,x3C,10...u

xP1

xP3

Now choose

1

1

u D 5 x2 C 10 x3

where Á is a positive scalar. It follows that

Á sign. /
10

(2.80)

P D Á sign. / ) P D Áj j

Hence Eq. (2.80) is an appropriate variable structure controller which induces a sliding motion. The plot of the switching function is shown in Fig. 2.5.

66

2 Conventional Sliding Modes

Switching Function

1 0.8 0.6 0.4 0.2
0 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 Time, sec
Fig. 2.5 Switching function

0.5

0

States

-0.5

-1 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 Time, sec
Fig. 2.6 States time history
Note that in finite time--approximately 0.1 s--the switching function has become zero. Furthermore once zero (at which point the hyperplane has been reached) the states are forced to remain on the surface. The state's evolution is presented in Fig. 2.6. It is clear from Fig. 2.6 that x1 and x2 approach zero as time increases in the sliding mode.

2.3 State-Feedback Relay Control Law Design

67

2.3.3 Relay Control for Multi-input Systems

In this subsection these ideas are extended to multi-input systems. Many different multivariable control structures exist and fundamentally the key thing that must be achieved is a multivariable version of the sign function.
In the multi-input case, once again

P .t/ D S xP .t/ D SAx.t/ C SBu.t/

(2.81)

The "complication" now is the fact that SB is a square matrix and not a scalar. A simple way to circumvent this is to enforce a structure on SB through choice of S while at the same time ensuring appropriate properties for the reduced-order sliding motion. It will be argued that in fact S can always be chosen so that SB D Im while simultaneously ensuring appropriate dynamics for the sliding mode.
Recall from Eq. (2.32) that the sliding surface hyperplane matrix can be parameterized as

S D S1 S2 Tr

(2.82)

where the matrices S2 and S1 were linked via the parameter M D S2 1S1 and Tr was the orthogonal matrix used as the basis of the coordinate transformation to achieve
regular form. Equivalently Eq. (2.82) above can be written as

S D S2 M Im Tr

(2.83)

In the above, for a given pair .A; B/, the matrix Tr is established from QR reduction based in B. Furthermore the dynamics of the reduced-order motion depend solely on the choice of matrix M which may be viewed as a state-feedback gain for the null-space system in (2.30). Clearly the choice of S2 does not affect the dynamics of the sliding motion and it is this design freedom which is exploited to ensure that SB D Im. For a given .A; B/ and design parameter M , it follows

SB D S1 S2 Tr B

Ä

D S1 S2

0 B2

D S2B2

from Eq. (2.28)

(2.84)

Consequently choosing S2 D B2 1 ensures the sliding motion dynamics are specified as .A11 A12M / and simultaneously SB D Im.
Now the multi-input structure in Eq. (2.81) can be decomposed into m indepen-
dent equations. Specifically exploiting the fact that SB D Im, Eq. (2.81) can be
written componentwise as

P i .t/ D .SA/i x.t/ C ui .t/

(2.85)

68

2 Conventional Sliding Modes

where .SA/i is the i th row of the m n matrix SA and ui and i are the i th components of the vectors u and , respectively. Now as discussed in the previous section, m independent single-input controllers can be designed for each of the components ui .

2.4 State-Feedback Unit-Vector Control

Of the many different multivariable sliding mode control structures which exist, the

one that will be considered here is the unit-vector approach. This has the advantage

of being an inherently multi-input approach. Consider an uncertain system of the

form

xP .t/ D Ax.t/ C Bu.t/ C f .t; x; u/

(2.86)

where the function f W R Rn Rm ! Rm, which represents the uncertainties or nonlinearities, satisfies the so-called matching condition, i.e.,

f .t; x; u/ D B .t; x; u/

(2.87)

where W R Rn Rm ! Rm and is unknown but satisfies

k .t; x; u/k Ä k1kuk C .t; x/;

(2.88)

where 1 > k1 0 is a known constant and . / is a known function.

2.4.1 Design in the Presence of Matched Uncertainty

The proposed control law comprises two components: a linear component to stabilize the nominal linear system and a discontinuous component. Specifically

u.t/ D ul .t/ C un.t/

(2.89)

where the linear component is given by

ul .t/ D  1 .SA ^S / x.t/

(2.90)

where ^ 2 Rm m is any stable design matrix and  D SB. The nonlinear component is defined to be

un.t/ D

.t; x/

1 P2 kP2

.t .t

/ /k

;

(2.91)

2.4 State-Feedback Unit-Vector Control

69

where P2 2 Rm m is a symmetric positive definite matrix satisfying the Lyapunov

equation

P2^ C ^T P2 D I

(2.92)

and the scalar function .t; x/, which depends only on the magnitude of the uncertainty, is any function satisfying

.t; x/ .kk.k1kul k C .t; x// C / =.1 k1kkk 1k/

(2.93)

where > 0 is a design parameter. In this equation it is assumed that the scaling parameter S2 has been chosen so that  D SB has the property that

k1kkk 1k < 1

(2.94)

A necessary condition for Eq. (2.94) to hold is that k1 < 1 because kkk 1k > 1 for all choices of S .
Before demonstrating that the above controller induces a sliding motion, it will first be established that any scalar modulation function satisfying Eq. (2.93) bounds the uncertain term .t; x; u/.
Rearranging Eq. (2.93) gives

.t; x/

kk.k1kul k C .t; x// C C k1kkk 1k .t; x/ kk.k1k 1k .t; x/ C k1kul k C .t; x// C kk.k1kuk C .t; x// C kkk .t; x; u/k C

(2.95)

In obtaining the third inequality the fact that

u D ul

.t; x/ 1 P2 kP2 k

)

kuk < kul k C .t; x/k

1k

is used. Inequality (2.95) demonstrates .t; x/ is greater in magnitude than the matched uncertainty occurring in Eq. (2.87). Substituting for the control law in Eq. (2.86) yields

P D SAx.t/ C u C  .t; x; u/

D^

.t; x/ P2 C  .t; x; u/

kP2 k

(2.96)

It will now be shown that V . / D T P2 guarantees quadratic stability for the switching states , and in particular

VP D Ä D Ä

T .P2^ C ^T P2/ 2 kP2 k C 2 T P2 T .P2^ C ^T P2/ 2 kP2 k C 2kP2 kkkk k
T 2kP2 k. .t; x/ kkk k/ T 2 kP2 k

(2.97)

70

2 Conventional Sliding Modes

Assuming that the closed-loop system has no finite-escape time during the reaching phase, then this control law guarantees that the switching surface is reached in finite time despite the disturbance or uncertainty. Once the sliding motion is attained, it is completely independent of the uncertainty.
Example 2.7. Consider the satellite dynamics given by

I1!P 1 D .I2 I3/!2!3 C u1 I2!P 2 D .I3 I1/!3!1 C u2 I3!P 3 D .I1 I2/!1!2 C u3

(2.98)

where I1, I2, and I3 represent the moments of inertia around the principal axes of the body. The variables !1, !2, and !3 are the angular velocities, which are measurable. The variables u1, u2, and u3 are the control input torques. Defining x1 D !1, x2 D !2, x3 D !3, and x D OEx1; x2; x3T , the system in (2.98) has the representation:

2
1

xP D Bu C B

.x/

D

46

I1
0

0
1 I2

0 0

3 75

23 u1
4u25

C

2 46

1 I1
0

0
1 I2

0 0

3 57

2 .I2
4.I3

3 I3/x2x3 I1/x3x15

0

0

1 I3

u3

0

0

1 I3

.I1 I2/x1x2

D Sx

where is the sliding output and .x/ represents the nonlinearities which satisfy the matching condition. Furthermore .x/ satisfies jj .x/jj Ä .x/ Ä c in a domain x 2 R3 that includes the origin, where c is a known constant. Then the problem is to stabilize the equilibrium point x D 0 of the satellite in finite time. Based on
Eq. (2.89), the proposed control law is:

u D .SB/ 1.^S /x

.x/.SB/ 1 P2 jjP2 jj

Choosing S D diag.l1; l2; l3/ it follows SB D I3 3. If ^ D

1 2

I3

3, P2

D I3

3 is

the solution of the Lyapunov equation:

P2^ C ^T P2 D I Now choosing the Lyapunov function V D T P2 we have
VP Ä jj jj2 2 jjP2 jj < 2 jj jj < 0

(2.99)

and finally

VP <

1
2 V2

where D c > 0. For simulation purposes we consider D 3. Therefore the proposed control law guarantees that the sliding surface is reached in finite time,

2.4 State-Feedback Unit-Vector Control

71

1/sec N-m

2 1.5
1 0.5
0 -0.5
-1 0

States

5

1

2

4

3

3

2

1

0

-1

123 time (s)

-2

4

0

Sliding surface

3

1

2

2

3

1

0

-1

-2

-3

-4

-5

123 time (s)

-6

4

0

Signal control u1 u2 u3
1234 time (s)

Fig. 2.7 Stabilization of the equilibrium point of the satellite

which in this case means that x equals zero in finite time. The system in Eq. (2.98)

has been simulated with the control law (2.89) using the initial conditions x.0/ D OE0:5; 1; 2T and the parameters I1 D 1 kgm2, I2 D 0:8 kgm2, and I3 D 0:4 kgm2.

The results obtained with the proposed control law are presented in Fig. 2.7. In

order to attenuate chattering the discontinuous portion of the control signal is

approximated by

P2 jjP2

jj

P2 jjP2 jjC

, with

1.

2.4.2 Design in the Presence of Unmatched Uncertainty

If the uncertainty does not meet the matching requirements, after transformation into regular form, in the "z" coordinates, a system of the form

zP1.t / D A11z1.t / C A12z2.t / C fu.t; z1; z2/ zP2.t / D A21z1.t / C A22z2.t / C B2u.t / C fm.t; z1; z2/

(2.100) (2.101)

is obtained where fm.t; z1; z2/ and fu.t; z1; z2/ represent the matched and unmatched components of the uncertainty, respectively. As argued in the earlier sections, the effects of the matched uncertainty fm.t; z1; z2/ can be canceled. This section considers the null-space dynamics in Eq. (2.100). If a sliding motion can be induced on S, then z2 D M z1 and the reduced-order motion is governed by

zP1.t / D .A11 A12M /z1.t / C fu.t; z1; M z1/

(2.102)

72

2 Conventional Sliding Modes

Because of the presence of the term fu.t; z1; M z1/, stability of the system in Eq. (2.102) is not guaranteed. However, if the linear component is dominant, then bounds on fu.t; z1; M z1/ can be obtained to guarantee that stability is maintained. Many different approaches and assumptions can be made: here a Lyapunov approach will be adopted. Specifically it will be assumed that

kfu.t; z1; z2/k Ä kzk
where is a positive scalar. Since, by choice of the sliding surface, the matrix .A11
exists a symmetric positive definite matrix P1 such that

(2.103) A12M / is stable, there

P1.A11 A12M / C .A11 A12M /T P1 D In m

It can be shown that if

p .1 C kM k2 < 1=.2kP1k/

(2.104)

then Eq. (2.102) is stable while sliding. To establish this, first the constraint in Eq. (2.103) will be written in terms of kz1k. Since during the sliding motion z2 D M z1 it follows

Ä kzk2 D z1
z2

2
Ä kz1k2 C kz2k2 Ä kz1k2 C kM z1k2 Ä .kM k2 C 1/z21

and consequently

p kzk Ä .kM k2 C 1/kz1k

Create from the symmetric positive definite matrix P1 a candidate Lyapunov function V .z1/ D zT1 P1z1. It follows

VP D zT1 P1zP1 C zP1T P1z1 D zT1 P1.A11 A12M / C .A11 A12M /T P1 z1 C 2z1T P1fu.t; z1; Ä zT1 z1 C 2kz1kkP1kkfu.t; z1; M z1/k Ä z1T z1 C 2kz1kkP1k kzk p Ä z1T z1 C 2kz1kkP1k .kM k2 C 1/kz1k p Ä kz1k2.2 kP1k .kM k2 C 1/ 1/

M z1/ (2.105)

If the inequality in Eq. (2.104) holds then p
VP Ä kz1k2.2kP1k .kM k2 C 1/ 1/ < 0

(2.106)

and so the reduced-order motion is stable.

2.4 State-Feedback Unit-Vector Control

73

Fig. 2.8 Chua's circuit

Some modifications need to be made to the control law gain (2.93) to ensure a sliding motion can be achieved and maintained. Now

P .t/ D SA.t/ C SBu.t/ C Sf .t; x/

(2.107)

It can be shown using similar arguments to those deployed earlier that

.t; x/

kS2k .kM k kx.t//kkul .t/k C .t; x// C .1 k3kkk 1kkB2 1k/

(2.108)

guarantees the existence of a sliding motion.

Example 2.8. Chua's circuit consists of one inductor, two capacitors, and one

piecewise-linear nonlinear resistor; see Fig. 2.8. The normalized dynamic equations of the circuit are:

xP1 D .x2 x1 f .x1// xP2 D x1 x2 C x3 xP3 D x2 C u

(2.109)

where x1 D v1, x2 D v2, and x3 is the current through the inductor;  and  are

known parameters and f .x1/ is a function that depends on the nonlinear resistor;

this function represents the unmatched uncertainty. We consider the nonlinear

function f .x1/ D

1 5

x1.1

x12/. Here it is assumed that jx1j < 1, which implies

jf .x1/j

Ä

1 5

jx1j

C

1 5

jx12j

Ä

2 5

jx1j;

then

inequality

(2.103)

is

satisfied

with

D

2 5

.

The goal of this example is to stabilize the equilibrium point x D OE0; 0; 0T of

Chua's circuit. First define z1 D OEx1; x2T and z2 D x3; then Chua's circuit has the

following representation:

Ä

Ä

zP1 D A11

zP2

A21

A12

Ä z1

C Ä0N

u

A22 z2

1

ÄfN.z1/ 0N

74

2 Conventional Sliding Modes

with the following definitions:

Ä

A11 D

 1

Ä

 1

;

A12 D

0 1

;

A21 D

0

Ä

;

A22 D 0;

fN.z1/ D

f .x1/ 0

Setting the sliding output 1 D z2 C M z1 the reduced-order dynamic is given by:
zP1 D .A11 A12M /z1 fN.z1/:
Because of the term fN.z1/, stability is not guaranteed. However since by choice of the sliding surface, the matrix .A11 A12M / is stable, there exists a symmetric positive matrix P1 such that

P1.A11 A12M / C .A11 A12M /T P1 D I2 2

Now the candidate Lyapunov function V D zT1 P1z1 is proposed. It follows:

VP Ä jjz1jj2.2jjP1jj

p jjM jj2 C 1

1/

p Then if the inequality .2jjP1jj jjM jj2 C 1 1/ < 0 is satisfied the reducedorder dynamic is stable. Typical system parameters are chosen to be  D 9:1=7 and

 D 8=7. For M D OE2; 2 we obtain

Ä

P1 D

0:3553 0:0293

0:0293 0:1764

;

.2jjP1jj

p jjM jj2 C 1

1/ D

0:1854

and inequality (2.104) is satisfied. Now with the control law

u D .A21 A22M /z1 M.A11 A12M /z1

and the candidate Lyapunov function V

D

1 2

2 1

,

we

have

VP Ä . .z/ jjM jjjjzjj/jj 1jj

.z/ 1 jj 1jj

If the inequality .z/ > jjM jjjjzjj is satisfied, finite time convergence is ensured,

provided during the reaching phase jx1.t/j < 1. For simulation purposes D 4 > jjM jjjjzjj D 1:14. Using the initial conditions x1.0/ D 0:4, x2.0/ D 0:2, and
x3.0/ D 0:5, simulations were performed with the proposed control law and the

results are presented in Fig. 2.8. In order to attenuate chattering the discontinuous

portion of the control signal is approximated by

.z/ jj

1
1 jj

.z/ jj

1
1 jjC

, with

1

(Fig. 2.9).

In engineering situations, tracking problems are often encountered whereby (usually) the output of the system is required to follow a predefined reference signal. In the following section an integral action based method is considered for output tracking.

2.5 Output Tracking with Integral Action

75

0.5 0
-0.5 -1
-1.5 0

States

Sliding surface

1.8

x1-V



x2-V x3-A

1.6

1.4

Control signal 2
u-V
1

1.2

0

1 -1
0.8

0.6

-2

0.4 -3
0.2

5

10

time (s)

0

-4

15

012345

0

time (s)

5

10 15

time (s)

Fig. 2.9 Stabilization of the equilibrium point of Chua's circuit

2.5 Output Tracking with Integral Action

Consider the development of a tracking control law for the nominal linear system

xP .t/ D Ax.t/ C Bu.t/ y.t/ D C x.t/

(2.110) (2.111)

which is assumed to be square, i.e., it has the same number of inputs and outputs. In addition, for convenience, assume the matrix pair .A; B/ is in regular form. The control law described here utilizes an integral action methodology. Consider the introduction of additional states xr 2 Rm satisfying

xPr .t/ D r.t/ y.t/

(2.112)

where the differentiable signal r.t/ satisfies

rP.t/ D .r.t/ R/

(2.113)

with  2 Rm m a stable design matrix and R a constant demand vector. Augment the states with the integral action states and define

Ä xQ D xr
x

(2.114)

76

2 Conventional Sliding Modes

The associated system and input distribution matrices for the augmented system are

Ä AQ D 0 C
0A

Ä

and

BQ D 0

B

(2.115)

assuming the pair .A; B/ is in regular form, the pair .AQ; BQ / is in regular form. The proposed controller seeks to induce a sliding motion on the surface

S D fxQ 2 RnCm W S xQ D Sr rg

(2.116)

where S 2 Rm .nCp/ and Sr 2 Rm m are design parameters which govern the reduced-order motion. Partition the hyperplane system matrix as

SD

$n $m S1 S2

(2.117)

and the system matrix as

AQ D

Ä

$n
AQ11 AQ21

$m
AQ12 AQ22

ln lm

(2.118)

and assume  D S BQ is nonsingular. If a controller exists which induces an ideal sliding motion on S and the augmented states are partitioned as

Ä xQ D x1
x2

(2.119)

where x1 2 Rn and x2 2 Rm, then the ideal sliding motion is given by

xP1.t / D .AQ11 AQ12M /x1.t / C AQ12S2 1Sr C Br r.t /

(2.120)

where M D S2 1S1 and Br D Im 0n m T . In order for the design methods described earlier to be valid, it is necessary for the matrix pair .AQ11; AQ12/ to be completely controllable.
Remark 2.5. Necessary conditions on the original system are that .A; B; C / is completely controllable and has no invariant zeros at the origin.8
The development that follows mirrors the approach in Sect. 2.3.3 where ^ is any stable design matrix. The overall control law is then given by

8For details see Sect. 4.4.2 in [67] and Appendix C.

2.6 Output-Based Hyperplane Design

77

u D ul .xQ ; r/ C un.xQ ; r/

(2.121)

where the continuous control

ul .xQ ; r/ D  1 .SA ^S / xQ .t/

(2.122)

and the discontinuous control vector

un. ; r/ D

c .ul ; y/

1 P2.S xQ kP2.S xQ

Sr r/ Sr r/k

where P2 is a symmetric positive definite matrix satisfying

P2^ C ^T P2 D I

(2.123) (2.124)

The positive scalar function which multiplies the unit-vector component can be obtained from arguments similar to those in Sect. 2.3. It follows that, in terms of the original coordinates,

un.xQ ; r/ D LxQ C Lr r C LrPrP

(2.125)

with the gains defined as
L D  1.S AQ ^S / Lr D  1 .^Sr C S1Br / LrP D  1Sr

(2.126) (2.127) (2.128)

The parameter Sr can take any value and does not affect the stability of the closedloop system. One common choice is to let Sr D 0 for simplicity. Another option, which has been found to give good results with practical applications, is to choose Sr so that at steady state the integral action states are zero in the absence of any uncertainty.
Up to this point it has been assumed that all the states are available for use in the control law. This hypothesis will be dropped in the remaining sections of Chap 2.

2.6 Output-Based Hyperplane Design

Consider the linear system in Eq. (2.18) and suppose that only the measured outputs

xP .t/ D Ax.t/ C Bu.t/ y.t/ D C x.t/

(2.129) (2.130)

78

2 Conventional Sliding Modes

where C 2 Rp n are available. The methods described earlier in this chapter are now no longer directly applicable since the state vector is not directly available. One approach is to use an observer (this will be discussed in later chapters) to estimate the states and then to use the estimate in place of the real states. This is conceptually straightforward but has potential pitfalls--particularly if linear observers are used. It is well understood that in linear systems (with linear control laws and linear observers), the robustness associated with the feedback law can be destroyed by the introduction of an observer as part of the feedback loop. Also the introduction of an observer will add significant computational costs in terms of implementation. Instead let us consider the possibility of introducing controllers in the spirit of Sect. 2.5 subject to the constraint that only output information is available.

2.6.1 Static Output-Feedback Hyperplane Design
The state-feedback control strategies described earlier are not immediately employable here. Firstly, it is intuitively likely that since the hyperplane design problem resolved itself into a state-feedback control paradigm for the fictitious triple .A11; A12/, in the situation when only output information is available this will become some form of restricted state-feedback design problem: in fact a static output-feedback design problem for a certain triple .A11; A12; C1/. Secondly the control laws described in the previous section involved a linear state-feedback control component. This is unlikely to be achievable in an output-feedback context.
Here, the situation when there are more outputs than inputs is considered, since in the square case, no design freedom exists in terms of selecting the dynamics of the sliding motion. Two assumptions will be made:
(A1) The parameter CB is full rank. (A2) Any invariant zeros of .A; B; C / have negative real parts.
Remark 2.6. The dependence on invariant zeros is not perhaps surprising and the presence of zeros plays an important role in linear systems theory. It is also worth noting that for appropriate initial conditions associated with a particular zero direction y.t/ can be made zero for all time with an appropriate control linear control input although the state itself is not zero. This has clear links with the concept of a sliding motion (without the robustness properties).
These assumptions will be central to the output-feedback-based sliding mode control used here. The following lemma provides a canonical form for the system triple .A; B; C / which will be used in the subsequent analysis:
Lemma 2.1. Let .A; B; C / be a linear system with p > m and rank .CB/ D m. Then a change of coordinates exists so that the system triple with respect to the new coordinates has the following structure:

2.6 Output-Based Hyperplane Design

79

(a) The system matrix can be written as Ä
A D A11 A12 A21 A22

(2.131)

where A11 2 R.n m/ .n m/ and the (fictitious) pair .A11; C1/ is detectable where

C1 D 0 Ip m

(2.132)

(b) The input distribution matrix has the form

Ä BD 0
B2

where B2 2 Rm m and is nonsingular

(2.133)

(c) The output distribution matrix has the form

C D 0 T where T 2 Rp p and is orthogonal

(2.134)

Remark 2.7. It can be shown that the unobservable modes of .A11; C1/ are in fact the invariant zeros of the triple .A; B; C /.
The idea is to first achieve a regular form structure for the input distribution matrix and then to exploit the fact that CB is full rank to create another transformation which preserves the structure of B while enforcing the partition nature of the output distribution matrix C , which is a feature of the canonical form.
Remark 2.8. Note, this can be viewed as a special case of the traditional regular form discussed earlier which was used as the basis for switching function design in the state-feedback case.
Remark 2.9. Clearly the existence of unstable zeros renders difficulties. In fact unstable invariant zeros means the techniques described in this section are not applicable. While this is not ideal, it must be remembered in linear systems the presence of right half plane zeros limits the performance that can be imposed on the closed-loop system.9
Under the premise that only output information is available, the switching function must be of the form

.x/ D F C x.t/

(2.135)

where F 2 Rm p. Suppose a controller exists which induces a stable sliding

motion on

S D fx 2 Rn W F C x D 0g

(2.136)

9This situation is discussed further in "Notes and References" in Chap. 8.

80

2 Conventional Sliding Modes

For a first-order sliding motion to exist on S, the equivalent control will be given by solving
P D F CAx.t/ C F CBueq.t/ D 0

For an unique equivalent control to exist, the matrix F CB 2 Rm m must have full rank: this implies that rank.CB/ D m since rank.F CB/ Ärank.CB/. In all the analysis which follows it is assumed without loss of generality that the system is already in the canonical form of Lemma 2.1. Define matrices F1 and F2 such that

p$m $m F1 F2

DFT

(2.137)

where F2 2 Rm m is assumed to be nonsingular. Notice this structure has a relationship to the hyperplane matrix parametrization given in Eq. (2.83) since Eq. (2.137) can be re-written as

F D F2 K Im T T

(2.138)

where K D F2 1F1. The structure in Eq. (2.138) may not be particularly intuitive, but it nicely isolates the design freedom present in the problem. The matrix F2 is essentially a scaling matrix which is square and invertible and it plays no role in determining the dynamics of the sliding motion. Furthermore it is analogous to the role the matrix S2 plays in the switching function expansion in Eq. (2.83). The other design parameter is K. This is analogous to the matrix M from Eq. (2.83). It is clear from the dimension of the matrices F and M that the former has only .p m/ .n m/ elements while the latter has m .n m/. This reduction in parametrization results in less design flexibility--which is the price to pay for only having output rather than state information.
Based on Eq. (2.138) the matrix which defines the switching function can then be written as
F C D F1C1 F2
where

C1 D 0.p m/ .n p/ I.p m/

(2.139)

In this way F CB D F2B2 and det.F2/ ¤ 0 , det.F CB/ ¤ 0. It follows during sliding D F C x.t/ D 0 and

F1C1z1 C F2z2 D 0

which substituting in the null-space equations yields

zP1.t / D .A11 D .A11

A12F2 1F1C1/z1.t / A12KC1/z1.t /

(2.140)

since K D F2 1F1. Consequently the problem of designing a suitable hyperplane is equivalent to an output-feedback problem for the system .A11; A12; C1/.

2.6 Output-Based Hyperplane Design

81

v r

f
u 

Y

y

x Fig. 2.10 Schematic of the vehicle

Remark 2.10. If the pair .A11; C1/ is observable and the triple .A11; A12; C1/ satisfies the Kimura­Davison conditions10

mCp nC1

(2.141)

output-feedback pole placement methods can be used to place the poles appropriately.

Example 2.9. Consider the fourth-order system

2

3:9354

00

A D 664

0 1:0000

0 14:9206

0 0

0:7287

00

Ä C D 0010
0001

3 14:7110

1:0000 1:6695

775

2:1963

2 B D 664

3 0

0 0

757

(2.142)

0:8116

(2.143)

This represents a linearization of the rigid body dynamics of a passenger vehicle (Fig. 2.10). The first state is an average of the lateral velocity v and yaw rate r; the second state represents , the vehicle orientation; the third state, Y , is the lateral

10See "Notes and References" at the end of the chapter.

82 6

2 Conventional Sliding Modes

4

2

Imag Axis

0

-2

-4

-6

-6

-5

-4

-3

-2

-1

0

1

2

Real Axis

Fig. 2.11 Sliding mode poles as a root locus

deviation from the intended lane position, and the fourth state, r, is the yaw rate. The input to the system, if , is the angular position of the front wheels relative to the chassis.
Notice this is already in the canonical form of Eqs. (2.131)­(2.134), and so

2 3:9354

3 00

A11 D 4

0

0 05

1:0000 14:9206 0

2 A12 D 4

3 14:7110
1:0000 5
1:6695

C1 D 0 0 1

(2.144)

The so-called Kimura­Davison conditions are not met for this example since m C p D 3 < 4 D n. In this case p m D 1 and m D 1 and so the hyperplane matrix can be parameterized as
FD k 1
where k is a scalar design parameter. The sliding motion is determined by a classical root locus of the "plant" Gp D C1.sI A11/ 1A12 in series with a gain "k" in a unity feedback configuration . The root locus plot is given in Fig. 2.11.
For all values of k > 2:58, all the sliding mode poles lie in the LHP, and so, this constitutes an appropriate solution to the existence problem.

2.6 Output-Based Hyperplane Design

83

2.6.2 Static Output-Feedback Control Law Development

Having designed the surface, it is necessary to develop a controller to induce and

sustain a sliding motion. Perhaps a natural choice would be a control structure of

the form

u.t/ D Gy.t/

F C x.t/ .t; y/ kF C x.t/k

(2.145)

where the quantity .t; y/ must upper bound the uncertainty. A common design

methodology is based on synthesizing a static output-feedback gain G numerically

to ensure the so-called reachability condition is satisfied. To facilitate the analysis, an additional, switching function dependent coordinate
transformation will be made. Let z ! 7 TK z D zO where

Ä

TK WD

I.n m/ 0 KC1 Im

(2.146)

with C1 defined in (2.139). In this new coordinate system, the system triple (AO; BO ; F CO / has the property that

AO

D

Ä AO11 AO12 AO21 AO22

Ä BO D 0
B2

F CO D 0 Im (2.147)

where B2 is defined in (2.133). The matrix AO11 D A11

to be stable by choice of K.

Furthermore

CO D 0p .n p/ TO

A12KC1 which is assumed (2.148)

where

TO WD .T1 T2K/ T2

(2.149)

and T1 and T2 represent the first p m and last m columns of the matrix T from Eq. (2.134). Notice that TO is nonsingular. Define a partition of AO21 from

Eq. (2.147) as

AO21 D

n$p AO211

p$m AO212

(2.150)

Ideally the degrees of freedom in selecting the controller should be determined numerically so that the reachability condition

PT < 0

(2.151)

is satisfied where .x/ D F C x.t/ is the switching function. If Eq. (2.151) can be satisfied, then the sliding surface S is globally attractive.

84

2 Conventional Sliding Modes

Assuming an appropriate switching surface has been designed to solve the existence problem, the linear part of the control law can be chosen as

G D F;

>0

(2.152)

For a large enough scalar it can be shown that a sliding motion is obtained in finite time from any initial condition. However the reachability condition P T < 0, where .t/ D F y.t/, only holds in a compact domain around the origin. Outside this domain the controller behaves as a variable structure controller with the property that it forces the state trajectories into the invariant domain (sometimes referred to as the "sliding patch") in finite time. Inside this domain the reachability condition P T < 0 holds and so sliding occurs in finite time. Provided the existence problem can be solved, no additional structural or system conditions need to be imposed.
In practical situations the shortcoming of this controller is that must be large and hence the controller takes on a "high gain" characteristic.
Without loss of generality, write the linear feedback gain as

G D G1 G2 TO 1

(2.153)

where TO is from Eq. (2.149) and G1 2 Rm .p m/ and G2 2 Rm m. Define a symmetric positive definite block diagonal matrix

Ä P WD P1 0 > 0
0 P2

(2.154)

where P1 2 R.n m/ .n m/ and P2 2 Rm m. Then it is possible to find a matrix P as in Eq. (2.154), and a gain matrix G so that

PAc C AcT P < 0

(2.155)

where Ac D AO BO GCO ; then the control law will induce a sliding motion on the surface S inside the domain (the sliding patch)

D f.zO1; zO2/ W kzO1k < Á 0 1g
where 0 D kP2.AO21 G1C1/k and zO1 2 R.n m/, zO2 2 Rm represent a partition of the state zO.
From the point of view of control law design, a requirement is to make

kP2.AO21 G1C1/k

(2.156)

small to make the sliding patch large. The block diagonal structure in Eq. (2.154), together with the canonical
form in Eq. (2.147), effectively guarantees a solution to the structural constraint

2.6 Output-Based Hyperplane Design

85

P BO D .F CO /T , which in turn ensures the transfer function matrix F CO .sI AO/ 1BO is strictly positive real.11
Example 2.10. Consider the example from Sect. 2.9. From the root locus in Fig. 2.11 it can be seen that high gain is needed to improve the damping of the dominant complex conjugate pair. With a value of D 100 the sliding motion poles are governed by
f 1:9241  5:6081i; 167:0320g

and AO21 D 100:7287 1492:0600 16474:8680

It can be shown for that

G D 1095:7134 208:2982

eig.A BGC / D f 162:0054; 12:4248; 0:3736  5:0794i g

and an associated Lyapunov matrix can be found which also satisfies the structural constraint.
Remark 2.11. Although from a control theory point of view this example demonstrates the theory is valid and that a static output-feedback controller does exist, the resulting scheme may not be practical. Here the gain G is large and the sliding motion will be governed by two quite poorly damped dominant complex eigenvalues. This motivates the consideration of compensator-based output-feedback sliding mode controller design.

2.6.3 Dynamic Output-Feedback Hyperplane Design

So far, only the static output feedback case has been considered. In certain circumstances, the subsystem triple .A11; A12; C1/ is known to be infeasible with respect to static output-feedback stabilization. In such situations, consider the introduction of a dynamic compensator. Specifically, let

zPc.t/ D H zc.t/ C Dy.t/

(2.157)

where the matrices H 2 Rq q and D 2 Rq p are to be determined. Define a new hyperplane in the augmented state space, formed from the plant and compensator state spaces, as

Sc D f.z; zc / 2 RnCq W Fczc C F C z D 0g

(2.158)

11For details and definitions see [175]. This is also discussed in Appendix B.

86

2 Conventional Sliding Modes

where Fc 2 Rm q and F 2 Rm p. Define D1 2 Rq .p m/ and D2 2 Rq m as

D1 D2 D DT

(2.159)

then the compensator can be written as

zPc.t / D H zc .t / C D1C1z1.t / C D2z2.t /

(2.160)

where C1 is defined in Eq. (2.139). Assume that a control action exists which forces and maintains motion on the hyperplane Sc given in Eq. (2.158). As before, in order
for a unique equivalent control to exist, the square matrix F2 must be invertible. By writing K D F2 1F1 and defining Kc D F2 1Fc then the system matrix governing the reduced-order sliding motion, obtained by eliminating the coordinates z2, can be
written as

zP1.t / D .A11 A12KC1/z1.t / A12Kczc.t / zPc .t / D .D1 D2K/C1z1.t / C .H D2Kc/zc .t /

(2.161) (2.162)

It follows that stability of the sliding motion depends only on the matrix

Ä A11 .D1

A12KC1 D2 K /C1

A12 Kc H D2Kc

(2.163)

As in the uncompensated case, it is necessary for the pair .A11; C1/ to be detectable. To simplify the design problem, at the expense of removing some of the design flexibility, one can specifically choose D2 D 0 in Eq. (2.163).
The resulting matrix in Eq. (2.163) can be viewed as the negative feedback interconnection of the "plant" Gp.s/ D C1.sI A11/ 1A12 and the "compensator"

K.s/ D K C Kc.sI H / 1D1

(2.164)

Note that this still has a very generalized structure and any linear design paradigm that creates an internally stabilizing closed loop can be employed to synthesize the sliding mode compensator matrices D1 and H , and a hyperplane, represented by the matrices K and Kc,
In certain situations it is advantageous to consider the feedback configuration in Fig. 2.12 and to design a compensator K.s/ using any suitable paradigm to yield appropriate closed-loop performance. From the state-space realization of K.s/ in Eq. (2.164), the parameters K; Kc; D1, and H can be identified. If the quantity p m is small, using "classical control" ideas, very simple compensators may be found which give good closed-loop performance to the fictitious feedback system in Fig. 2.12 which governs the sliding mode performance of the real system.

2.6 Output-Based Hyperplane Design

87

Gp(s)
-

K (s)

Fig. 2.12 A general linear feedback configuration

2.6.4 Dynamic Output-Feedback Control Law Development

Example 2.11. The third-order "plant" from Eq. (2.144) has a double pole at the

origin. In terms of classical control, this suggests the use of a lead compensator.

Choosing

K.s/ D .s C 0:5/ .s C 10/

(2.165)

in unity feedback with Gp.s/ gives closed-loop poles at

f 12:1413; 0:9656; 1:2490  0:9718g

This has improved the damping ratio of the dominant complex pair. A realization of the compensator in Eq. (2.165) is H D 10, D1 D 1, Kc D 9:5, and K D 1. Using these values (and D2 D 0) in the formulae in Eqs. (2.138) and (2.159) gives

Fa WD Fc F D 11:7059 1:2322 1:2322

(2.166)

and DD 1 0

Using these matrices, an appropriate controller to induce a sliding motion may be obtained by using the method described earlier for the augmented system

Ä

Aa D

H 0

DC A

Ä

Ba D

0 B

Ä

Ca D

10 0C

(2.167)

where the switching function matrix Fa is defined in Eq. (2.166). Choosing G D 45:9050 4:7749 0:3392
gives

eig.Aa BaGCa/ D f 8:6605; 3:0494  1:9424i; 0:8238  0:3124g

88

2 Conventional Sliding Modes

2.6.5 Case Study: Vehicle Stability in a Split-Mu Maneuver

This section will show how these output-feedback sliding mode ideas can be applied to a realistic control problem. One of the areas of active research in the automotive industry is vehicle chassis control. The principal aims are to increase vehicle safety, maneuverability, and passenger comfort while reducing the work load on the driver. Most modern vehicles have antilock brake systems (ABS) which prevent the wheels locking under heavy braking. However, if a so-called split-mu surface is encountered, in which the traction between the road surface and the tire on one wheel becomes significantly reduced compared to the others, for instance, if a patch of ice is encountered, then any braking maneuver will introduce a sudden unexpected yawing moment. At high speed the driver will not have sufficient time to react, and a potentially extremely dangerous spin may occur.
This case study will consider a steer-by-wire system which will aim to maintain heading and vehicle stability in such a situation. An eighth-order nonlinear model of the vehicle, wheels, and road/tire interaction has been developed.12 This model has been tuned to be representative of a typical family saloon. A linearization has been performed about an operating condition which represents a straight line trajectory at 15 ms 1 longitudinal velocity, corresponding wheel velocities, and zero lateral velocity, yaw rate, and yaw angle. The linearization assumes a uniform friction coefficient on each wheel. Considering yaw rate and lateral deviation as measured variables, a reduced-order linear model of the rigid body states is given in Eqs. (2.142) and (2.143).
The scenario that will be considered is an emergency stop on a split-mu surface. A simple ABS system has been incorporated into the nonlinear vehicle model. This is designed to bring the vehicle to a standstill in as short a time as possible. The steer-by-wire system will alter the front wheel position (the control input) in an effort to brake in a straight line. The key requirement is, therefore, to keep the third state, Y , in Eq. (2.143) as near to zero as possible.
From the canonical form in Eq. (2.144) the output of the fictitious system Gp.s/ D C1.sI A11/ 1A12 (as far as the switching function design is concerned) is, in the real system, the output of interest, Y . Because Gp.s/ has a double integrator characteristic no integral action is needed to achieve a steady-state error of zero.
The closed-loop simulation obtained from a fully nonlinear model is shown in Fig. 2.13. The controller manages to stop the vehicle from developing an excessive yaw angle. Also, the lateral deviation, Y , is halted with a peak of 17 cm and is regulated to zero. The controller develops and maintains sufficient yaw angle as is necessary to counteract the yawing moment induced by the asymmetric ABS braking. The input signal which the controller utilizes to perform this is shown in Fig. 2.14. It is also demonstrated that a sliding motion is maintained throughout the maneuver.

12For details of the model see [72, 108].

2.7 Integral Sliding Mode Control

89

yaw rate (rad/s) yaw angle (rad) lat. dev. (m)

long. vel. (m/s)

30

20

10

0

0

1

2

3

4

5

6

7

8

9

10

0.5

0

-0.5

0

1

2

3

4

5

6

7

8

9

10

0.06

0.04

0.02

0

0

1

2

3

4

5

6

7

8

9

10

0.05

0

-0.05

0

1

2

3

4

5

6

7

8

9

10

time (s)

Fig. 2.13 Vehicle states and braking torques for closed-loop simulation

2.7 Integral Sliding Mode Control
As discussed earlier in this chapter, sliding mode control techniques are very useful for the controller design in systems with matched disturbances/parametric uncertainties. The system's compensated dynamics become insensitive to these matched disturbances and uncertainties under sliding mode control. This property of insensitivity is only achieved when the sliding surface is reached and the sliding motion is established. In this section we explore a method to compensate for the disturbance without the presence of a reaching phase.
For known linear systems, traditional controllers, including proportional-plusderivative (PD), proportional-plus-integral-plus-derivative (PID), and optimal linear-quadratic regulator (LQR), can be successfully designed to achieve ideal closed-loop dynamics. Also known, nonlinear systems (with certain structures) can be controlled using, for instance, feedback linearization, backstepping, or any other Lyapunov-based nonlinear technique. Once a system is subjected to external bounded disturbances, it is natural to try to compensate such effects by means of an auxiliary (sliding mode) control while the original controller compensates for the unperturbed system.

90

2 Conventional Sliding Modes

Road Wheel Angle (rad) s

x 10-3 1.4

1.2

1

0.8

0.6

0.4

0.2

0

0

1

2

3

4

5

6

7

8

9

10

0

-0.05

-0.1

-0.15

-0.2 0

1

2

3

4

5

6

7

8

time (s)

Fig. 2.14 Switching function and control signal

9

10

In this section we will design a so-called integral sliding mode (ISM) auxiliary controller compensating for the disturbance from t 0, while retaining the order of the uncompensated system. This can be achieved assuming that the initial conditions are known.

2.7.1 Problem Formulation

Let us consider the following controlled uncertain system represented by the statespace equation

xP D f .x/ C B .x/ u C .x; t/ ;

(2.168)

where x 2 Rn is the state vector, u 2 Rm is the control input vector, and x.0/ D

x0. The function .x; t/ represents the uncertainties affecting the systems, due to parameter variations, unmodeled dynamics, and/or exogenous disturbances.

Let u D u0 be a nominal control designed for Eq. (2.168) assuming D 0, where

u is designed to achieve a desired task, whether stabilization, tracking, or an optimal

control problem. Thus, the trajectories of the ideal system ( D 0) are given by the

solutions of

xP0 D f .x0/ C B .x0/ u0:

(2.169)

2.7 Integral Sliding Mode Control

91

When ¤ 0 the trajectories of Eqs. (2.168) and (2.169) are different. The trajectories of Eq. (2.169) satisfy some specified requirements, whereas the trajectories of Eq. (2.168) might have a quite different and possibly even undesirable performance (depending on ).
In order to design the controller assume that:

(A1) Rank .B .x// D m for all x 2 Rn. (A2) The disturbance .x; t/ is matched and there exists a vector
such that .x; t/ D B .x/ .x; t/. (A3) A known upper bound for .x; t/ can be found, i.e.,

.x; t/ 2 Rm

k .x; t/k Ä C.x; t/:

(2.170)

Obviously, the second restriction is needed to exactly compensate . If were known exactly, it would be enough to chose u D . However, since is uncertain, some other restrictions are needed in order to eliminate the influence of . Here the sliding mode approach is used to replace exact knowledge of .

2.7.2 Control Design Objective

Now the problem is to design a control law such that x .0/ D x0 .0/, and guarantees the identity x .t/ D x0 .t/ for all t 0. Comparing Eqs. (2.168) and (2.169), it can
be seen that the objective is achieved only if the equivalent control is equal to minus
the uncertainty (i.e., u1eq D ). Thus, the control objective can be reformulated in the following terms: design the control u D u .t/ as

u .t/ D u0 .t/ C u1 .t/ ;

(2.171)

where u0 .t/ is the nominal control part designed for Eq. (2.169) and u1 .t/ is the ISM control part compensating for the unmeasured matched uncertainty .x; t/, starting from .t D 0/.

2.7.3 Linear Case

Let us consider the linear time-invariant case:

xP .t/ D Ax.t/ C B .u0.t/ C u1.t// C .t; x/; .t; x/ D B .t; x/

In this case the vector function can be defined as

.x/ D G .x.t/

x .0//

Zt G .Ax . / C Bu0 . // d ;
0

(2.172) (2.173)

92

2 Conventional Sliding Modes

where G 2 Rm n is a projection matrix satisfying the condition

det.GB/ ¤ 0

The time derivative of has the form

P .x/ D GB.u1 C /

The control u1 is taken as the unit vector

u1 D

.GB /T .t; x/
k.GB/T k

(2.174)

where .t; x/

k C.t; x/k. Taking V

D

1 2

T

and in view of Eq. (2.170) the

derivative of V on time is

VP D T GB.u1 C / Ä k.GB/T k.M

C/ < 0

Hence, the ISM is guaranteed. Example 2.12. Let us consider the following system:

xP D Ax C B .u0 C u1/ C

(2.175)

representing a linearized model of an inverted pendulum on a cart, where x1 and x2 are the cart and pendulum positions, respectively, and x3 and x4 are the respective velocities. The matrices A and B are taken with the following values:

2

3

0 0 10

2

3

0

A D 646

0 0

0 1:25

0 0

1 0

775 , B

D 664

0 0:19

775 ;

0 7:55 0 0

0:14

and the control u0 D u0 is designed for the nominal system, where u0 solves the following optimal problem subject to an LQ performance index:

Z1 J .u0/ D x0T .t / Qx0 .t / C u0T .t / Ru0 .t / dt
0
where u0 D arg min J .u0/. It is known (see Appendix C) that the solution of this problem is the following:

u0 .x/ D R 1BT P x D Kx;

2.7 Integral Sliding Mode Control

93

Fig. 2.15 States x1 (dashed) and x2 (solid) using ISM in the presence of matched uncertainties

where P is a symmetric positive definite matrix that is the solution of the algebraic Riccati equation
AT P C PA PBR 1BT P D Q:
For the considered matrices A and B and taking Q D I and R D 1, we have

K D 1 131:36 4:337 48:47 :

In the simulation control is

D B with D 2 sin .0:5t/ C 0:1 cos .10t/ and the ISM u1 D 5 sign . / ;

where is designed according to Eq. (2.173). Now, the only restriction on the matrix G is det GB ¤ 0. One simple choice is G D 0 0 1 0 ; thus we obtain GB D 0:19, which obviously is different from zero.
Figure 2.15 shows the position of the cart and the pendulum. We can see that there is no influence of the disturbance due to the compensation effect caused by the ISM control part u1.

94

2 Conventional Sliding Modes

2.7.4 ISM Compensation of Unmatched Disturbances

To solve the problems of the reaching phase and of robustness against unmatched uncertainties=disturbances simultaneously, the main idea, as in the conventional sliding mode case, has been the combination of ISM and other robust techniques. However, in practice we also need to ensure that the compensation (a) does not amplify unmatched uncertainties=disturbances and ideally (b) minimizes the effect of the unmatched uncertainties=disturbances.
Consider the linear system (2.172), together with assumption (A1) and the assumption that there exists an upper bound for the perturbation .x; t/. It is not assumed that this perturbation is matched. For that reason, before we obtain the sliding motion equations and try to understand how the uncertainty affects it, it is convenient to project the perturbation .x; t/ into matched and unmatched spaces.
Let B? 2 Rn .n m/ be a full rank matrix whose image is orthogonal to the image of B, i.e., BT B? D 0. As a consequence the matrix B B? is nonsingular. Furthermore rank.I BBC/ D n m, where BC D BT B 1 BT , and .I BBC/B D 0. Therefore, the columns of B? can be formed from the linearly independent columns of .I BBC/T . Thus, let .x; t/ 2 Rm and .x; t/ 2 Rn m be the vectors defined by

Ä .x; t/ D B B? 1 .x; t/ .x; t/

(2.176)

Thus, Eq. (2.172) takes the following form:

xP D Ax C B .u1 C u0/ C B C B?

(2.177)

Then selecting as in Eq. (2.173), we have

P D GB .u1 C / C GB?

The control component u1 should be designed as in Eq. (2.174) under the assumption

GB is nonsingular. Let the modulation function

C C .GB/C GB? . The

equivalent control obtained from solving P D 0 is given by the equation

u1eq D

.GB/ 1 GB?

Substitution of u1eq in Eq. (2.177) yields the sliding motion equation:

xP D Ax C Bu0 C .I B .GB/ 1 G/B?

2.7 Integral Sliding Mode Control

95

Define dN WD .I B .GB/ 1 G/B? . Taking G D BT or G D BC, we get dN D B? , i.e., the application of the sliding mode controller has not affected the

unmatched disturbance part. Now the question is, is it possible to select G to ensure the norm of dN is less than
the norm of B? ? This is addressed in the following proposition.

°

«

Proposition 2.1 The set of matrices G D QBT W Q 2 Rm m and det.Q/ ¤ 0 is

the solution of the optimization problem

G D arg min k.I B .GB/ 1 G/B? ;
G2GN
where GN D fG 2 Rm n W det.GB/ ¤ 0g :

¤ 0k

Proof. Since B? and B .GB/ 1 GB? are orthogonal vectors, the norm of the vector k.I B .GB/ 1 G/B? k is always greater than kB? k. Indeed,

k.I B .GB/ 1 G/B? k2 D kB? k2 C kB .GB/ 1 GB? k2

That is,

k.I B .GB/ 1 G/B? k kB? k

(2.178)

If identity (2.178) is achieved, then the norm of k.I B .GB/ 1 G/B? k
is minimized with respect to G. The identity is obtained, if and only if B .GB/ 1 GB? D0. Or equivalently, since rank.B/ D m, GB? D 0, i.e., G D QBT , where Q is nonsingular. This completes the proof.

Remark 2.12. Notice that the control law itself is not modified in order to optimize
the effect of the unmatched uncertainties, and moreover, an optimal solution for G is simple: the simplest choice is G D BT , but BC D BT B 1 BT is another
possibility.

Proposition 2.2 For an optimal matrix G , the Euclidean norm of the disturbance is not amplified, that is,

k .t/ k k.I B G B 1 G /B? .t/ k

(2.179)

Proof. From Proposition 2.1 it follows that
k.I B G B 1 G /B? .t/ k D k.I BBC/B? .t/ k D kB? .t/ k (2.180)
Now, since .t/ D B C B? , and BT B? D 0, we obtain the equation
k .t/ k2 D kB .t/ C B? .t/ k2 D kB .t/ k2 C kB .t/ k2 kB .t/ k2 (2.181)
Hence, comparing Eqs. (2.180) and (2.181), we can obtain Eq. (2.2).

96

2 Conventional Sliding Modes

Example 2.13. Consider system Eq. (2.175) with the uncertainty .x; t/ shown below:

.x; t/ D

0

0

2 sin .0:5t/ C 0:1 cos .10t/

T
0:1 sin .1:4t/

The first step is to project the perturbation .x; t/ into the matched and unmatched spaces using the expression in Eq. (2.176). Note the selection of the matrix B? is

not unique: one simple choice is given by

2 10

B? D 646

0 0

1 0

3 0

0 0:14

757

0 0 0:19

In this way and in system (2.177) become

D 3:41.2 sin .0:5t/ C 0:1 cos .10t// C 2:51.0:1 sin .1:4t//;

2

3

0

D4

0

5

3:41 OE0:1 sin .1:4t/ 2:51 OE2 sin .0:5t/ C 0:1 cos .10t/

The control law is the same as in Example 2.12, except for the choice of matrix G, which according to Proposition 2.1 is optimal if G D BT D
0 0 0:19 0:14 or G D BC. Here we consider three cases: the case when we use G D BT , the case when the ISM control is not applied, and the case when G is not selected in an optimal manner. For this last case, we use G D 0 0 1 0 as in Example 2.12. For the first case, the states x1 and x2 (the positions) are depicted in Fig. 2.16; there we can see that the uncertainties do not significantly affect the trajectories of the system. To compare the effect of the ISM in presence of unmatched disturbances, Fig. 2.17 shows the trajectories of x1 and x2 when the ISM control part is omitted (u D u0). It is clear that in this case, the disturbances affect the system considerably compared with the trajectories of Fig. 2.17 where a well-designed ISM control (with an optimal G) reduces significantly the effect of the disturbances. Figure 2.18 shows the effect of the matrix G in the design of the sliding surface. In Fig. 2.18 we compare the behavior of the variable x2 when G is badly chosen.

2.8 Notes and References
A very readable concise treatment of some of the material in this chapter appears in The Control Handbook [58].

2.8 Notes and References

97

Fig. 2.16 States x1 (dashed) and x2(solid) without ISM compensator

Fig. 2.17 States x1 (dashed) and x2 (solid) for G D BT

98

2 Conventional Sliding Modes

Fig. 2.18 Trajectories of the position x2 for G D BT (solid) and G D 0 0 1 0 (dashed)
Regular form-based methods were first introduced in [136, 137]. Linear hyperplane design methods for a class of single-input systems are given in [2, 171]. Another approach to the hyperplane design, which can be used for treating the unmatched uncertainties, is based on the linear methods of [149]. For details of different design methods for the hyperplane matrix M see Chap. 4 in [63, 67].
The control structure considered in Sect. 2.3.2 is essentially that of Ryan and Corless from [157] and is described as the unit-vector approach. The unit-vector structure appears first in [103]. The precise relationship between the control law in Eqs. (2.90) and (2.91) and the original description of Ryan and Corless is described in Sect. 3.6.3 in [67].
A variety of approximations of the discontinuous control functions are described and analyzed in the literature [40]. Power law approximations are given in Ryan and Corless [157], and state based approximations are given in Tomizuka [49]. DeJager compares different approximation methods in [60]. A specific treatment on chattering reduction is also included in [171].
The so-called equivalent control method is attributed to Utkin [182]. The solution concept proposed by Filippov [81] for differential equations with discontinuous right-hand sides constructs a solution as the "average" of the solutions obtained from approaching the point of discontinuity from different directions. The definition for the solution to the differential inclusion given in Definition 2.2 is from [81].
Details of the proof of Lemma 2.1 and the canonical form that can be achieved are discussed in [67]. A common design methodology for output-feedback sliding mode controller design [13,73,109,110] is based on synthesizing a static output-feedback gain G numerically to ensure the so-called reachability condition is satisfied. In [66], assuming an appropriate switching surface has been designed to solve the existence problem, the linear part of the control law was chosen as a scaling of the switching

2.9 Exercises

99

function, thought of as a feedback gain. The static output-feedback control law development in Sect. 2.6.2 is based on [71]. Example 2.9 is taken from the sliding mode output-feedback paper [72]. In the case study relating to vehicle control, the aims of increasing vehicle safety, maneuverability, and passenger comfort, while reducing the work load on the driver are discussed in detail in [1]. The limitations of some static output-feedback sliding mode controllers are discussed in [68].
The ISM concept was proposed independently by Matthews and DeCarlo [140] and Utkin and Shi [185]. In this chapter we followed the approach of Matthews and DeCarlo [140]. The ISM approach described in Sect. 2.7 can be easily extended to the class of affine nonlinear systems given by
xP D f .x/ C B .x/ .u0 C u1 C /
For a detailed analysis of this case see [43]. Additional material for the advance study of the ISM approach can be found in many publications including [156, 192]. In particular, various combinations of ISM with H1 are studied in [43­45, 191]. The use of ISM schemes for "robustification" of solutions of LQR problems can be found in [93, 154] (a multi-model optimization problem); see also the design of robust output LQR control in [21, 26] and multiplant LQR control in [27]. The ISM controllers are widely used in robotic applications [50, 151] when it is necessary to track the reference trajectories. The corresponding references can be found in the books [186, 187] and the paper [59] and references therein.
An interesting application avenue exploiting the robustness properties of sliding modes with respect to matched uncertainties is the area of fault tolerant control. In such scenarios, actuator faults appear naturally within the control channels of the plant and can be accommodated "automatically" by sliding mode controllers [6, 7, 105, 162].
Although not discussed in this book, the main ideas and techniques of discretetime sliding mode control can be found [3, 14, 97, 141, 187].

2.9 Exercises
Exercise 2.1. Consider the linear system
xP D Ax C Bu D Gx
with as the sliding variable. Find the equivalent control ueq and the sliding mode equations when
Ä (a) A D 2 19 , B D 2 3 T and G D 9 12
3 29

100

2 Conventional Sliding Modes

Fig. 2.19 DC­DC buck converter

2

3

111

2 3

(b) A D 4 0 1 3 5, B D 4 1

101

1

Exercise 2.2. Consider the system given by

3 9

Ä

2 5 and G D 1 29 0

1 12 0

0

xP1 D x1 C x2 C x3 C u1 C 10u2 xP2 D x2 C 3x3 C u1 2u2 xP3 D x1 C x3 u1
1 D x1 C 10x2; 2 D x1 C 5x2
Find the system dynamics in the sliding mode 1 D 2 D 0. Exercise 2.3. Consider the DC­DC buck converter in Fig. 2.19 which belongs to the class of attenuation circuits; the corresponding dynamic equations are given by:

L

d d

i t

D

v C uVin

C

dv dt

D

i

v R

where i is the current through the inductor L, v is the voltage across the capacitor C ,

Vin is the input voltage, and u 2 f0; 1g is the switching control signal. The goal is

to stabilize the output voltage v at the desired level vd . This goal is to be achieved

via stabilization of the inductor current i

at the desired level id

D

vd R

using sliding

mode control, for this purpose:

(a) Setting

Di

id

and using the control input u

D

1 2

.1

sign. //, find the

equivalent control and the sliding mode dynamics.

(b) Considering L D 20 mH, C D 20 F, R D 30 , Vin D 15 V, vd D 10 V, and the initial conditions i.0/ D 0:1 A and v.0/ D 5 V, confirm the efficacy of the

controller by simulations.

2.9 Exercises

101

Exercise 2.4. Consider the linear system

xP D Ax C B.u C f /

with:

Ä

Ä

A D 3 5 ;B D 1

12

2

that is stabilized by the sliding mode controller u D .6jjxjj C 3/sign. / in the presence of the bounded disturbance jf j Ä 2. Design the sliding variable assuming f D 0, considering the two cases:
(a) LQR minimization, with Q D I and R D 1 (b) Eigenvalue assignment, considering the eigenvalue D 2
Confirm your design by simulations, using f D 2 sin.t/ and the initial conditions x1.0/ D 2 and x2.0/ D 1.
Exercise 2.5. Using the sliding variable D x1 and the control u D sign. /, find the sliding mode equation for the systems given below, by using the equivalent control method and Filippov method for the cases:
(a) xP1 D u xP2 D .2u2 1/x2
(b) xP1 D u xP2 D .u 2u3/x2
(c) xP1 D u xP2 D .u 2u2/x2
Exercise 2.6. Consider the linear system given by

xP D Ax C Bu y D Cx

with

2

3

23

2

3

010

0

1 8=3 1

A D 4 0 0 1 5 ; B D 415 ; C D 44 2 25

1

1 3

1

1

00 1

Design an output-feedback sliding mode control to stabilize the system at the origin using u D Ksign. /; use the eigenvalue assignment algorithm in order to design the sliding variable , and consider the eigenvalues, 1;2 D 2  j 5. Considering

102

2 Conventional Sliding Modes

Fig. 2.20 Helicopter pitch angle, Â , control
the initial condition x.0/ D OE1; 2; 3T , obtain the appropriate value of K to ensure a reaching time tr D 2:5 s and confirm your design by simulation.
Exercise 2.7. Consider the Chua's circuit of Example 2.7 with the output yDx1. Propose a control law based on sliding modes in order to achieved the output tracking of yr D 5 sin.2t/. Confirm your design by simulation.
Exercise 2.8. The equations of motion of the high-performance helicopter in Fig. 2.20 are given by:
ÂR D a1ÂP b1xP C ni xR D gÂ a2ÂP b2xP C gi
where x is the translation in the horizontal direction. Design a sliding mode controller in terms of the rotor thrust angle i that forces the pitch angle Â to asymptotically follow the reference profile Âd D 6 C 12 sin.t/. Considering the initial conditions Â.0/ D 0:2 rad, ÂP D 0 rad/s, x.0/ D 0 m, and xP .0/ D 50 m/s, confirm your design by simulations of system with the parameters a1 D 0:415, a2 D 0:0198, b1 D 0:0111, b2 D 1:43, n D 6:27, and g D 9:81.
Exercise 2.9. Consider the satellite in Example 2.6 and design an ISM control u D u0 C u1. Preserve the linear control u0 D ul as in Example 2.6 in order to stabilize the equilibrium point .0; 0; 0/T for the ideal system (without nonlinear disturbance terms). The control law u0 should be designed using the LQR minimization algorithm. Design the ISM control component u1 as in Eq. (2.174) to compensate the matched disturbances. Consider Q and R as identity matrices

2.9 Exercises

103

Fig. 2.21 Cart­pendulum

of appropriate dimensions. Simulate the system where for simulation purposes
consider the initial condition x.0/ D OE0:5; 1; 2T and the parameters I1 D 1 kgm2, I2 D 0:8 kgm2, and I3 D 0:4 kgm2.

Exercise 2.10. Consider the following linear system subject to external disturbances:

xP D Ax C Bu C

2

3

11 0

2

3

00

2

3

3 sin.t/

where A D 4 0 3 1 5, B D 4 1 0 5 and D 4 4 cos.t/ 5

10 2

01

4 cos.t/

(a) Identify if the disturbance vector is matched. If it is not, then project the
disturbance into matched and unmatched terms. (b) Design the control u D u0 C u1. The linear control u0 is to be designed for
nominal system (without disturbances) in order to stabilize the equilibrium
point .0; 0; 0/ using the LQR algorithm. Consider Q and R identity matrices
with appropriate dimensions. Design an ISM control component u1 as in Eq. (2.174) to compensate the matched disturbances, and select the matrix G D BC D .BT B/ 1BT that helps to accommodate the unmatched disturbance
term. Confirm the effectiveness of the controller design via simulations. For simulation purposes consider the initial conditions x.0/ D .1; 2; 3/T .

Exercise 2.11. Consider the cart­pendulum system in Fig. 2.21 that consists of a cart of mass M that moves along the axis x, with a ball of mass m at the end of a rigid massless pendulum of length l. Shown as inputs are a horizontal force F D u

104

2 Conventional Sliding Modes

acting on the cart and a force d acting on the ball perpendicular to the pendulum. The output signals are the angles Â and the position of the ball y D x C l sin.Â/. The two linearized equations about the equilibrium point .x; Â / D .0; / are

.M C m/xR C mlÂR D u C d

xR C lÂR gÂ

D

1 m

d

Design an ISM control based on a LQR algorithm (see the explanation in Exercise 2.10) in order to stabilize the unstable equilibrium point. For simulation purposes use d D 2 sin.t/ and initial condition .x.0/; Â.0// D . 0:7; 3 /.

Chapter 3
Conventional Sliding Mode Observers

The purpose of an observer is to estimate the unmeasurable states of a system based only on the measured outputs and inputs. It is essentially a mathematical replica of the system, driven by the input of the system together with a signal representing the difference between the measured system and observer outputs. In the earliest observer, attributed to Luenberger, the difference between the output of the plant and the observer is fed back linearly into the observer. However, in the presence of unknown signals or uncertainty, a Luenberger observer is usually (a) unable to force the output estimation error to zero and (b) the observer states do not converge to the system states. A sliding mode observer, which feeds back the output estimation error via a nonlinear switching term, provides an attractive solution to this issue. Provided a bound on the magnitude of the disturbances is known, the sliding mode observer can force the output estimation error to converge to zero in finite time, while the observer states converge asymptotically to the system states. In addition, disturbances within the system can also be reconstructed.

3.1 Introduction

Consider initially a nominal linear system

xP .t/ D Ax.t/ C Bu.t/

(3.1)

y.t/ D C x.t/

(3.2)

where A 2 Rn n, B 2 Rn m, and C 2 Rp n. Without loss of generality assume that C has full row rank which means each of the measured outputs is independent. The objective is to obtain an estimate of the state x.t/ based only on knowledge of the quantities y.t/ and u.t/. An algebraic condition on the matrix pair .A; C /--the notion of observability--was proposed as a necessary and sufficient condition for

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

105

DOI 10.1007/978-0-8176-4893-0 3, © Springer Science+Business Media New York 2014

106

3 Conventional Sliding Mode Observers

state reconstruction (for details see Appendix C). For simplicity, the observability condition will be assumed to hold, although technically some of the developments only require the weaker restriction of detectability on the pair .A; C /.
One way of viewing the approach of Luenberger is to think of the observer system as comprising a model of the plant together with a feedback term which corrects the estimates by injecting back the discrepancy between its output and the output of the system, through a designer-specified gain. In the simplest form of sliding mode observer, instead of feeding back the output error between the observer and the system in a linear fashion, the output error is fed back via a discontinuous switched signal.

3.2 A Simple Sliding Mode Observer

Consider a coordinate transformation x 7! Tcx associated with the invertible matrix

Tc

Ä D

NcT C

(3.3)

where the submatrix Nc 2 Rn .n p/ spans the null-space of C . By construction

det.Tc/ ¤ 0. Applying the change of coordinates x 7! Tcx, the triple .A; B; C / has

the form

Ä

Ä

TcATc 1 D

A11 A12 A21 A22

; TcB D

B1 B2

; C Tc 1 D

0 Ip

(3.4)

where A11 2 R.n p/ .n p/ and B1 2 R.n p/ m. The structure imposed on the output distribution matrix in (3.4) is crucial to what follows. Assume without loss of generality the system (3.1) and (3.2) is already in the form of (3.4).
Utkin proposed an observer for (3.1) and (3.2) of the form

xPO .t/ D AxO .t/ C Bu.t/ C Gn

(3.5)

yO.t/ D C xO .t/

(3.6)

where .xO ; yO/ are the estimates of .x; y/ and is a discontinuous injection term. Define e.t/ WD xO .t/ x.t/ and ey.t/ WD yO.t/ y.t/ as the state estimation and output estimation errors, respectively. The term is defined component-wise as

i D sign.ey;i /; i D 1; 2; :::; p

(3.7)

where is a positive scalar and ey;i represents the i th component of ey. The term is designed to be discontinuous with respect to the sliding surface S D fe W C e D 0g to force the trajectories of e.t/ onto S in finite time. Assume without loss of generality that the system is already in the coordinate associated with (3.4), then the gain Gn has the structure

3.2 A Simple Sliding Mode Observer

107

Ä

Gn D

L Ip

(3.8)

where L 2 R.n p/ p represents the design freedom. It follows from the definition of e.t/ and Eqs. (3.1) and (3.5) that the error system is given by

eP.t/ D Ae.t/ C Gn

(3.9)

From the structure of the output distribution matrix C in (3.4), the state estimation error can be partitioned as e D col.e1; ey/ where e1 2 Rn p. Consequently the error system from (3.9) can be written in the form

eP1.t / D A11e1.t / C A12ey.t / C L ePy .t / D A21e1.t / C A22ey .t /

(3.10) (3.11)

Furthermore Eq. (3.11) can be written component-wise as

ePy;i .t / D A21;i e1.t / C A22;i ey .t / sign.ey;i /

(3.12)

where A21;i and A22;i represent the i th rows of A21 and A22, respectively. To develop conditions under which sliding will take place, the reachability condition will be tested. From (3.12)

ey;i ePy;i D ey;i .A21;i e1 C A22;i ey/ jey;i j < jey;i j. j.A21;i e1 C A22;i ey/j/

Provided the scalar is chosen large enough such that

> jA21;i e1 C A22;i ey j C Á

(3.13)

where the scalar Á 2 RC, then

ey;i ePy;i < Ájey;i j

(3.14)

This is the eta-reachability condition discussed in Chap. 2 and implies that ey;i will converge to zero in finite time. When every component of ey.t/ has converged to zero, a sliding motion takes place on the surface S.

Remark 3.1. Note that this is not a global result. For any given , there will exist initial conditions of the observer (typically representing very poor estimates of the initial conditions of the plant) so that (3.13) is not satisfied.

During sliding, ey.t/ D ePy.t/ D 0, and the error system defined by (3.10) and (3.11) can be written in collapsed form as

eP1.t / D A11e1.t / C L eq 0 D A21e1.t / eq

(3.15) (3.16)

108

3 Conventional Sliding Mode Observers

where eq is the so-called equivalent output error injection that is required to maintain the sliding motion. This is the natural analogue of the equivalent control discussed in Chap. 2. Substituting for eq from (3.15) and (3.16) yields the following expression for the reduced-order sliding motion:

eP1.t / D .A11 C LA21/e1.t /

(3.17)

This represents the reduced-order motion (of order n p) that governs the sliding mode dynamics.
It can be shown if .A; C / is observable, then .A11; A21/ is also observable, and a matrix L can always be chosen to ensure that the reduced-order motion in (3.17) is stable.

Example 3.1. Consider a second-order state-space system described by (3.1) and (3.2) where

Ä

Ä

AD 0 1 ; BD 0 ; C D 1 1

20

1

(3.18)

which represents a simple harmonic oscillator. For simplicity, assume u.t/ D 0.

A suitable choice for the nonsingular matrix Tc from (3.3) is

Ä

Tc D

1 1

1 1

(3.19)

Following the change of coordinates x ! 7 Tcx, the system triple .A; B; C / becomes

Ä

TcATc 1 D

0:5 1:5

Ä

1:5 0:5

;

TcB D

1 1

;

C Tc 1 D

0

1

(3.20)

and A11 D 0:5 and A21 D 1:5. Suppose the nonlinear gain from (3.8) is chosen as L D 3. This results in the sliding motion being governed by A11CLA21D 4, which is stable. In the original coordinates of (3.18), the nonlinear gain can be calculated as

Ä

Ä

Ä

Ä

Gn D Tc 1

L 1

D

0:5 0:5 0:5 0:5

3D 1

1

2

(3.21)

The following simulation was performed with the system having initial conditions x.0/ D col.0:5; 0:8/ and the observer having zero initial conditions.
Figure 3.1 shows the system states x.t/ and the estimates xO .t/. After approximately 1:5 s, excellent tracking of the states occurs. Figure 3.2 shows the output estimation error ey.t/ and the state estimation errors e.t/. After approximately 0:66 s, ey.t/ becomes zero and remains zero. This is indicative of a sliding motion taking place on S. Subsequently, the errors (Fig. 3.1) evolve governed the dynamics of the reduced-order motion. Figure 3.3 shows that during the sliding motion, the term exhibits high-frequency switching. Figure 3.4 shows an approximation of the equivalent output error injection signal eq obtained from low-pass filtering

3.2 A Simple Sliding Mode Observer

109

1.5 1
0.5 0
-0.5 -1
-1.5 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 seconds Fig. 3.1 System states x.t / (solid) and the observer estimates xO.t / (dashed)

0.6
0.4
0.2
0
-0.2
-0.4
0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 seconds
Fig. 3.2 The output estimation error ey .t / (dashed) and the components of the state estimation error e.t / (solid)
1 0.8 0.6 0.4 0.2
0 -0.2 -0.4 -0.6 -0.8
-1 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 seconds
Fig. 3.3 The nonlinear injection switching term

110

3 Conventional Sliding Mode Observers

2 1.5
1 0.5
0 -0.5
-1 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 seconds
Fig. 3.4 The equivalent output error injection eq (solid) and A21e1.t / (dashed)
1.5
1
0.5
0
-0.5
-1 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 seconds
Fig. 3.5 The output estimation error ey .t / (dashed) and the components of the state estimation error e.t / (solid)

from Fig. 3.3 through a first-order filter with time constant D 0:02 s. Notice that the term eq shows good agreement with the formal expression for eq in Eq. (3.16) once a sliding motion is taking place.
In the next set of simulations the same observer is employed but the initial conditions of the plant states have been changed to 0:5 and 1:5, respectively. Once again the initial conditions of the observer are set as zero. The direct consequence of this is that the initial conditions e1.0/ and ey.0/ are larger than previously simulated, and the response of the error system is qualitatively different.
Figure 3.5 shows that the output estimation error ey.t/ now pierces the sliding surface S at approximately 0:87 s but does not remain there, and sliding does not take place. The reason is that the state estimation error e1.t/ at that time instant ey.t/ D 0 does not satisfy the reachability condition in (3.14). However, when ey.t/ becomes zero again at approximately 1:55 s, a sliding motion begins. At this

3.3 Robustness Properties of Sliding Mode Observers

111

1 0.8 0.6 0.4 0.2
0 -0.2 -0.4 -0.6 -0.8
-1 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 seconds
Fig. 3.6 The discontinuous term with larger error initial conditions

point in time, the error e1.t/ is much smaller, and the reachability condition (3.14) is satisfied. Figure 3.6 shows the injection term in the case when the initial errors are large. It is clear that the onset of sliding occurs much later since the high-frequency sliding motion does not appear until 1.5 s.

3.3 Robustness Properties of Sliding Mode Observers

Now suppose the nominal linear system in Eq. (3.1) is replaced by the uncertain system

xP .t/ D Ax.t/ C Bu.t/ C M .t; x; u/

(3.22)

where .t; x; u/ 2 Rh is a disturbance and M 2 Rn h is the associated distribution matrix. To exploit the robustness properties associated with sliding modes described

in Chap. 2, suppose the gain Gn is designed such that it is matched to the disturbance distribution matrix, i.e., M D GnX for some X 2 Rp h. As a consequence in the
coordinates of (3.4) and (3.8)

Ä

Ä

M D LX D L X

X

I

(3.23)

and the error system in (3.10) and (3.11) becomes

eP1.t / D A11e1.t / C A12ey.t / C L LX .t; x; u/ ePy.t / D A21e1.t / C A22ey.t / C X .t; x; u/

(3.24) (3.25)

112

3 Conventional Sliding Mode Observers

Again it is necessary to develop conditions under which a sliding motion can be enforced. To this end, from (3.25)

ey;i ePy;i D ey;i .A21;i e1 C A22;i ey C Xi / jey;i j < jey;i j. jA21;i e1 C A22;i ey C Xi j/

and it is clear that if the gain of the switching term is large enough so that > jA21;i e1 C A22;i ey C Xi j C Á for a scalar Á > 0 then the reachability condition in (3.14) is satisfied. An ideal sliding motion is then guaranteed to take place in finite time. During the sliding motion Eqs. (3.24) and (3.25) take the form

eP1.t / D A11e1.t / C L eq LX .t; x; u/ 0 D A21e1.t / eq C X .t; x; u/

(3.26) (3.27)

Substituting for eq from (3.27) and (3.26) yields

eP1.t / D .A11 C LA21/e1.t /

(3.28)

which is independent of the disturbance .t; x; u/.

Remark 3.2. Notice that for the existence of an ideal sliding motion, the matching condition (3.23) is not required; a large enough is sufficient to induce a sliding motion. The matching condition is only required for the reduced-order motion (3.28) to be independent of .t; x; u/.

Example 3.2. Consider system (3.18), subject to uncertainty entering via the

distribution matrix

Ä MD 1
2

In the simulations which follow .t; x; u/ D 0:2 sin.x1.t// but this information is not available to the observer. Notice from (3.21) that the gain matrix Gn D M and the so-called matching conditions in Eq. (3.23) are satisfied with X D 1.
Figures 3.7 and 3.8 show a sliding motion occurring after 0.66 s. Also notice that the state estimation errors evolve according to a first-order decay. Crucially the evolution is unaffected by the disturbance. This disturbance rejection property is a major advantage of sliding mode observers compared to traditional linear Luenberger observers. It can be seen from Fig. 3.9 that although the effect of the disturbance .t; x; u/ is not present in the state estimation errors, it appears directly in the signal eq. In fact once the reduced-order motion e1.t/ has become sufficiently small (at about 1.5 s), the signal eq exactly "reproduces" the disturbance .t; x; u/ (with a small delay due to the low-pass filter used to obtain eq). This is a powerful result because the term was not designed with any a priori knowledge about .t; x; u/, except that it is bounded.
Figure 3.3 shows the term consists of high-frequency switching once sliding is established. In the observer this does not present the sort of problem it does for

3.3 Robustness Properties of Sliding Mode Observers

113

0.8

0.6

0.4

0.2

0

-0.2

-0.4

-0.6 0

1

2

3

4

5

6

7

8

9 10

seconds

Fig. 3.7 The output estimation error ey .t / (dashed) and the components of the state estimation error e.t / (solid)

1

0.5

0

-0.5

-1

-1.5 0

1

2

3

4

5

6

7

8

9 10

seconds

Fig. 3.8 The error vector associated with the sliding motion e1.t /

1

0.8

0.6

0.4

0.2

0

-0.2

-0.4

-0.60

1

2

3

4

5

6

7

8

9 10

seconds

Fig. 3.9 The equivalent output error injection eq (solid) and the disturbance .t; x; u/ (dashed)

114

3 Conventional Sliding Mode Observers

1 0.8 0.6 0.4 0.2
0 -0.2 -0.4 -0.6 -0.8
0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 seconds
Fig. 3.10 The output error injection term after being smoothed

control problems because the signal does not need to be realized by an actuator. However, that said, it does to a certain extent pose a problem for the numerical scheme used to solve the observer equations; consequently it is still often useful to "smooth" the discontinuity. Recall that is defined component-wise as i D
sign.ey;i /, which can also be expressed as

iD

ey;i jey;i j

if ey;i .t / ¤ 0

(3.29)

The expression in (3.29) can be approximated by a smooth sigmoid function

iD

ey;i jey;i j C i

(3.30)

where i is a small positive scalar. As in the control problem this results in a trade-off between maintaining close to ideal performance and achieving a smooth output error injection signal. Repeating the simulation, now using as in (3.30) with i D 0:0001, yields the responses shown in Fig. 3.10. Clearly the signal is smooth and there is no visible chattering. Furthermore, from Fig. 3.11, it can be seen that the performance of the system is relatively unaffected by this approximation.
As explained earlier, the observer does not provide any guarantee of global state estimation convergence. In the observer in (3.5)­(3.7), the size of dictates the size of the domain in which sliding is guaranteed to take place. This results in a trade-off. For practical reasons, a very large value of is not desirable (since chattering is amplified), but a large increases the set of initial conditions for which the estimation error converges. This is explored in the next example.

Example 3.3. For pedagogical purposes consider an unstable state-space system

Ä AD 2
1

Ä

3 ; BD 0 ; CD 0 1

3

1

(3.31)

3.3 Robustness Properties of Sliding Mode Observers

115

0.6 0.4 0.2
0 -0.2 -0.4
0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 seconds
Fig. 3.11 The output estimation error ey.t / (dashed) and the components of the state estimation error e.t / (solid)

Notice that in this example no change of coordinates is needed because the output distribution matrix C is already in the required structure of (3.4). Specifying L D 0 gives linear (reduced-order) first-order dynamics with a pole at 2. In the simulations which follow D 1. Also a full-order state feedback u.t/ D F x.t/ controller is used where F D 1 1 so that eig.A C BF / D f1:4142i g. The reason for this choice of closed-loop eigenvalues is that the states will be oscillatory, and the tracking of the states can be more readily observed. In Fig. 3.12, the "shaded" area is the region in which the initial conditions .e1.0/; ey.0// must lie for a sliding motion to occur. Outside this set of points the observer fails to converge. The shaded region is sometimes referred to as the sliding patch. The size of the shaded area can of course be enlarged by increasing the value of , but this is undesirable since increasing tends to lead to more severe chattering.

A more elegant way to enlarge the sliding patch is to add a linear output error

feedback term to the observer. Specifically Eq. (3.5) can be modified to take the

form

xOP .t/ D AxO .t/ Gl ey.t/ C Bu.t/ C Gn

(3.32)

where Gl 2 Rn p. An appropriate choice of the gain Gl will enlarge the sliding

patch. From Eqs. (3.1), (3.2), and (3.6), the state estimation error associated with

the observer in (3.32) is

eP.t/ D .A Gl C /e.t/ C Gn

(3.33)

The error system in (3.33) is nonlinear and so a good approach to try to establish global asymptotic stability is to consider Lyapunov-based methods. Consider the quadratic form

V D eT P e

(3.34)

116 1.5

3 Conventional Sliding Mode Observers

1

0.5

Inital condition of ey

0

-0.5

-1

-1.5-3

-2

-1

0

1

2

3

Inital condition of e1

Fig. 3.12 The sliding region

where P 2 Rn n is a symmetric positive definite matrix, as a candidate Lyapunov function. Differentiating (3.34) with respect to time yields

VP D ePT P e C eT P eP D eT .P .A Gl C / C .A Gl C /T P /e C 2eT P Gn

(3.35)

If P , Gl , and Gn can be chosen such that the expression in (3.35) is negative, then the error system in (3.33) is (globally) quadratically stable.

Example 3.4. For the system in (3.31), choosing

Ä

Gl D

3 6

Ä

and Gn D

0 1

(3.36)

results in a closed-loop error system

eP1.t/ D 2e1.t/ ePy.t/ D e1.t/ 3ey.t/ sign.ey/

(3.37) (3.38)

3.3 Robustness Properties of Sliding Mode Observers

117

Consider a positive definite quadratic function as in (3.34) where e D .e1; ey/ and

Ä1 PD 4

0

01

(3.39)

Differentiating with respect to time yields

VP

D

1 2

e1

eP1

C

2ey

ePy

1 D 2 e1. 2e1/ C 2ey.e1 3ey

D e12 6ey2 C 2e1ey 2jeyj

D .e1 ey /2 5ey2 2jeyj

sign.ey //

If .e1; ey/ ¤ 0, then VP < 0 and global stability of the error system is proven.

Furthermore it can be shown that a sliding motion takes place in finite time. Once the

error e.t/ becomes sufficiently small, the reachability condition in (3.14) is satisfied

and a sliding motion takes place. From the arguments above, since e ! 0, e1 ! 0

as

t

!

1.

In

particular

at

some

finite

time

t0,

je1.t /j

<

1 2

for

all

t

t0. Now form

a typical reachability test

eyePy D ey.e1 3ey sign.ey// Ä je1jjeyj 3ey2 jeyj Ä je1jjeyj jeyj

(3.40)

and therefore for all t > t0,

1 eyePy Ä 2 jeyj

(3.41)

which implies ey ! 0 in finite time and a sliding mode takes place. This example shows that the introduction of a linear output error injection term
can be beneficial.

The problem of robust state estimation for systems with bounded matched uncertainty will now be explored. Consider the following uncertain system

xP .t/ D Ax.t/ C Bu.t/ C Bf .t; y; u/ y.t/ D C x.t/

(3.42) (3.43)

where f W RC Rp Rm ! 7 Rm represents lumped uncertainty or nonlinearities. The function is assumed to be unknown but bounded so that

kf .t; y; u/k Ä .t; y; u/

(3.44)

118

3 Conventional Sliding Mode Observers

where . / is known. Consider an observer of the form

zP.t/ D Az.t/ C Bu.t/ GC e.t/ P 1C T F T

(3.45)

where e D z x. The symmetric positive definite matrix P 2 Rn n and the gain matrix G are assumed to satisfy

PA0 C A0T P < 0 where A0 WD A GC , and the structural constraint
PB D .F C /T

(3.46) (3.47)

for some F 2 Rm p. The discontinuous scaled unit-vector term

D

.t

;

y;

u/

F kF

C C

e.t e.t

/ /k

(3.48)

and e.t/ D z.t/ x.t/. Under these circumstances the quadratic form given by V .e/ D eT P e can be
shown to guarantee quadratic stability. Furthermore an ideal sliding motion takes place on
SF D fe 2 Rn W F C e D 0g
in finite time.

Remark 3.3. It should be noted that if p > m then sliding on SF is not the same as sliding on C e.t/ D 0.

Example 3.5. Consider the equations of motion for a pendulum system written as

R .t/ D

g sin. .t//

l

where g is the gravitational constant and l is the length of the pendulum. These can

be rewritten in state-space form as

Ä

Ä

xP .t/ D 0 1 x.t/ C 0

00

1

.t; x/

(3.49)

where x1 D , x2 D P , and .t; x1; x2/ D

g l

sin.

/. Somewhat artificially choose

as an output measurement y.t/ D C x.t/ where

CD 1 1

(3.50)

i.e., the sum of position and velocity. Also assume the term .t; x1; x2/ is unknown--possibly because the length of the pendulum is imprecisely known. The aim is both to estimate x.t/ and reconstruct .t; x/ from y.t/.

3.3 Robustness Properties of Sliding Mode Observers

119

Outputs

2

1

0

-1

-2

0

2

4

6

8 10 12 14 16 18 20

Time, sec

Fig. 3.13 Plant output y.t / and the observer estimate yO.t /

Choosing

Ä

Gl D

1 1

means the eigenvalues of A Gl C are f 1; 1g and furthermore

P .A Gl C / C .A Gl C /T P < 0

if Ä
PD 2 1 11

Notice also for this choice of P , the structural equation PB D C T is satisfied. The

sliding mode observer is

Ä

Ä

Ä

zP.t/ D 0 1 z.t/ 00

1 1

ey.t /

0 1

2sign.ey /

(3.51)

where
ey.t/ D C z.t/ y.t/
is the output estimation error. When the initial conditions of the true states and observer states are deliberately
set to different values the output of the observer tracks the output of the plant in finite time as shown in Fig. 3.13.
Figure 3.14 shows the same information as a plot of ey. A sliding motion takes place after 0:2 s. The finite time response is a characteristic of sliding modes.
Figure 3.15 shows the states and the state estimation errors. Although the output estimation error converges to zero in finite time, the state estimation error is asymptotic. However, asymptotic convergence has been achieved despite the plant/model mismatch resulting from the term .t; x1; x2/ which is not used in the sliding mode observer.

120

3 Conventional Sliding Mode Observers

Output error

0.5 0
-0.5 -1
-1.5 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 Time, sec Fig. 3.14 The output estimation error ey

1st State

1.5

1

0.5

0

-0.5

-1

-1.5

-2

0

2

4

6

8 10 12 14 16 18 20

Time, sec

1.5

1

0.5

0

-0.5

-1

-1.5

0

2

4

6

8 10 12 14 16 18 20

Time, sec

Fig. 3.15 System states x.t / (solid) and the observer estimates xO.t / (dashed)

2nd State

Figure 3.16 shows a low-pass-filtered version of the injection signal D 2sign.ey/ from the observer. It clearly replicates the "unknown signal" .t; x1; x2/ and compensates for it to allow perfect (asymptotic) convergence of the state estimates.

3.4 A Generic Conventional Sliding Mode Observer

121

Output error injection

2

1

0

-1

-2

0

2

4

6

8 10 12 14 16 18 20

Time, sec

Fig. 3.16 The injection signal and the unknown input

3.4 A Generic Conventional Sliding Mode Observer

Consider the following uncertain dynamical system:

xP .t/ D Ax.t/ C Bu.t/ C Mf .t; y; u/ y.t/ D C x.t/

(3.52) (3.53)

where x 2 Rn are the states, y 2 Rp are the measurable outputs, and u 2 Rm are the measurable inputs. The signal f 2 Rq is the lumped uncertainty acting upon the
system where q < p. It is unknown but assumed to be bounded so that

kf .t; t; u/k Ä .t; y; u/

(3.54)

where . / is known. Assume without loss of generality that the matrices C and M are full rank. The objective is to reconstruct both the states and the unknown input f .t/ based only on the measured signals u.t/; y.t/.
Two lemmas will now be presented which underpin the rest of this chapter. They will describe a canonical form which will help facilitate understanding of the problem and provide a framework for solving the problem.

Lemma 3.1. Let the triple .A; M; C / represent a linear system with p > q and suppose rank.CM / D rank.M / D q, then there exists a change of coordinates x ! 7 Tox for the system (3.52) and (3.53) such that in the new coordinates the triple .A; M; C / of the transformed system has the following structure:

2 AD4

A11 A211 A212

3 A12
5;

Ä MD 0

; CD 0 T

A22

M2

(3.55)

122

3 Conventional Sliding Mode Observers

where A11 2 R.n p/ .n p/; A211 2 R.p q/ .n p/, T 2 Rp p is orthogonal, and M2 2 Rp q has the structure

Ä

M2 D

0 Mo

(3.56)

where Mo 2 Rq q is nonsingular.

Proof. First introduce a coordinate transformation to make the last p states of the system the outputs. To achieve this, define

Ä

Tc D

NcT C

(3.57)

where Nc 2 Rn .n p/ is such that its columns span the null space of C . The coordinate transformation x 7! Tcx is nonsingular by construction and in the new coordinate system

C D 0 Ip

Suppose in the new coordinate system

Ä M D M1
M2

ln p lp

in which M1 and M2 have no particular structure other than the fact that

rank.M2/Dq. This follows because CM D M2 and so by assumption rank.M2/Dq. Hence the left pseudo-inverse M2 is well defined. Also there exists an orthogonal matrix T 2 Rp p such that

Ä

T T M2 D

0 Mo

(3.58)

where Mo 2 Rq q is nonsingular. Such a matrix can be found in QR factorization. Consequently, the coordinate transformation x 7! Tbx where

"

Tb D

In p 0

# M1M2 TT

(3.59)

is nonsingular, and in the new coordinates the triple .A; M; C / is in the form

Ä A D A11 A12 ;
A21 A22

Ä MD 0 ;
Mo

CD 0 T

(3.60)

where A11 2 R.n q/ .n q/ and the remaining subblocks in the system matrix are partitioned accordingly. The triple in (3.60) has exactly the structure claimed in the lemma statement.

3.4 A Generic Conventional Sliding Mode Observer

123

Lemma 3.2. The pair .A11; A211/ is detectable if and only if the invariant zeros of .A; M; C / are stable.

Proof. From the PBH rank test,1 the unobservable modes of .A11; A211/ are given by the values of s that make the following matrix pencil lose rank:

Ä

Pobs.s/ D

sI A11 A211

The zeros of .A; M; C / are given by the values of s that make the Rosenbrock matrix

Robs.s/ lose rank, where

2

3

Ä

Robs.s/ D

sI A C

sI A11

M 0

D 664

A211 A212

A12 ? ?

0

0 Mo

775

0

T

0

and the ? represents elements that do not play a role in the subsequent analysis. Since Mo and T are both square and invertible, Robs.s/ loses rank if and only if Pobs.s/ loses rank. Clearly the unobservable modes of .A11; A211/ are the invariant zeros of .A; M; C /, and hence the proof is complete.

Assume that for the system in (3.52) and (3.53):

A1. rank.CM / D rank.M /. A2. The invariant zeros (if any) of .A; M; C / are stable.

The canonical form associated with Lemma 3.1 will be used as a basis for the solution to the problem of estimating both the states and unknown inputs.
The following observer will be considered:

xOP .t/ D AxO .t/ C Bu.t/ Gl ey.t/ C Gn yO.t/ D C xO .t/

(3.61) (3.62)

where ey.t/ WD yO.t/ y.t/ is the output estimation error. The design freedom is associated with the two gains Gl 2 Rn p and Gn 2 Rn p which are design matrices
to be determined. The vector is defined by

.t/ D .t; y; u/ ey key k

if ey.t/ ¤ 0

(3.63)

where . / is a positive scalar function dependent on the magnitude of the unknown input signal f .t/. Condition A1 means that the canonical form in (3.55) can be

1For details see appendix C.

124

3 Conventional Sliding Mode Observers

attained, and hence without loss of generality assume that the triple .A; M; C / has the form given in (3.55). In the coordinates of (3.55), let

Ä

Gn D

L Ip

T T Po 1

(3.64)

where L D Lo 0 and Lo 2 R.n p/ .p q/. The symmetric positive definite matrix Po 2 Rp p and the gain Lo are design matrices. Defining Ao D A Gl C and the state estimation error as e.t/ WD xO .t/ x.t/. From (3.52) and (3.61) and
(3.53) and (3.62), the following error system can be obtained:

eP.t/ D Aoe.t/ C Gn Mf .t; xO e; y/

(3.65)

Proposition 3.1. If there exists a matrix Gl and a Lyapunov matrix P of the form

Ä

PD

P1 LT P1

P1L T T PoT C LT P1L

>0

(3.66)

where P1 2 R.n p/ .n p/, which satisfies

PAo C AoT P < 0

(3.67)

and .t; y; u/ kPoCM k.t; y; u/ C Áo where Áo > 0, then the state estimation error e.t/ is asymptotically stable.

Proof. Consider as a candidate Lyapunov function

V D eT P e

(3.68)

where P is given in (3.66). Differentiating (3.68) with respect to time yields

VP D ePT P e C eT P eP D eT .PAo C ATo P /e C 2eT P Gn

2eT PMf

From the definitions of P , Gn, and M in (3.66), (3.64), and (3.55), respectively, it can be verified that

P Gn D C T

(3.69)

and

PM D C T PoCM Using (3.67) and (3.69)­(3.70), VP becomes

(3.70)

VP Ä 2eT C T 2eT C T PoCMf

From the definition of in (3.63) and using the bound of f in (3.54)

3.4 A Generic Conventional Sliding Mode Observer

125

VP < 2 keyk 2eyT PoCMf Ä 2keyk. kPoCM k/ Ä 2Áokeyk < 0 for e ¤ 0

which proves the state estimation error is quadratically stable.
Using this result, it can be further shown that a sliding motion can be achieved in finite time.
Corollary 3.1. A stable sliding motion takes place on the surface

S D fe W C e D 0g

(3.71)

in finite time and the sliding motion is governed by A11 C LoA211.

Proof. To prove a sliding motion is attained, firstly apply a change of coordinates

x 7! TLx where

Ä

TL D

In p L 0T

(3.72)

such that the triple .A; M; C / in (3.55) is transformed to be

Ä AN D

AN11 AN21

AN12 AN22

;

Ä

MN D

0 MN 2

;

CN D

0 Ip

(3.73)

where AN11 D A11 C LoA211. This follows from the structure of L in (3.64). Using (3.73), the error system (3.65) can be partitioned as

eP1.t / D AN11e1.t / C .AN12 ePy.t / D AN21e1.t / C .AN22

GN l;1/ey .t / GN l;2/ey .t / C Po 1

MN 2f .t/

(3.74) (3.75)

where

Ä GN l;1 GN l;2

D TLGl

Introduce a candidate Lyapunov function for the subsystem (3.75) as

(3.76)

Vs D eyT Poey Differentiating Vs with respect to time and using (3.75) yield VPs D eyT .Po.AN22 GN l;2/C.AN22 GN l;2/T Po/ey C2eyT PoAN21e1 C2eyT

2eyT PoMN 2f

126

3 Conventional Sliding Mode Observers

It can be shown that

Ä

.TLT / 1P TL 1 D

P1 0 0 Po

(3.77)

and

TLAoTL

1

D

Ä AN11 AN21

AN12 AN22

GN l;1 GN l;2

(3.78)

By direct calculation it follows that .TLT / 1.PAo C ATo P /TL 1 can be expanded as

Ä P1AN11 C AN1T1P ?

? Po.AN22 GN l;2/ C .AN22 GN l;2/T Po

<0

(3.79)

where the ? represents elements that do not play any significant role in the analysis. Since (3.79) is symmetric, Po.AN22 GN l;2/ C .AN22 GN l;2/T Po < 0 and hence

VPs < 2eyT PoAN21e1 C 2eyT 2eyT PoMN 2f

Ä 2keykkPoAN21e1k 2Áokey k D 2keyk.kPoAN21e1k Áo/

(3.80)

Notice that

p

p

keyk2 D. Poey /T Po 1. Poey/

p min.Po 1/k Poeyk2 D min.Po 1/Vs (3.81)

Define Á as a scalar satisfying 0 < Á < Áo. Since from Proposition 3.1 the state estimation error is quadratically stable, in finite time e1.t/ enters the domain
Á D fe1 W kPoAN21e1k < Áo Ág

and remains there. Inside the domain Á inequality (3.80) becomes

d Vs < dt

2Ákeyk <

q

p

2Á mi n.Po 1/ Vs

This proves that a sliding motion takes place on S in finite time.
When a sliding motion has been achieved, ey.t/ D ePy.t/ D 0 and from (3.74) the remaining dynamics e1.t/ are governed by AN11 D A11 C LoA211. Since from inequality (3.79) P1AN11 C ANT11P1 < 0 and P1 > 0, the matrix AN11 is stable. This completes the proof.

Remark 3.4. The following observations can be made:

· One possible choice of linear gain in (3.61) is

Ä

Gl D

A12 A11L C LA2s2 A22 LA21 A2s2

3.4 A Generic Conventional Sliding Mode Observer

127

where As22 2 Rp p is any Hurwitz stable matrix. For a given L which makes A11 C LA21 stable, this guarantees the existence of a matrix P of the form in (3.66) such that P .A Gl C / C .A Gl C /T P < 0. This choice is far from
unique and optimization methods can be applied to synthesize Gl according to
some criteria.
· During the sliding motion when ePy D ey D 0, from (3.75)

0 D AN21e1.t / C Po 1 eq MN 2f .t; xO e; y/

(3.82)

Furthermore since the autonomous dynamical system in (3.74) is asymptotically stable, e1.t/ ! 0 as t ! 1. Therefore

Po 1 eq MN 2f .t; xO e; y/ ! 0

(3.83)

and the equivalent injection compensates for the unknown uncertain term f .t; xO e; y/. Consequently not only does the state xO asymptotically tend to x.t/ but also the scaling of the equivalent injection

MN 2Po 1 eq.t / ! f .t; xO e; y/

where MN 2 is any left pseudo-inverse of MN 2. Example 3.6. Consider the fourth-order system

2

3:9354

00

A D 646

0 1:0000

0 14:9206

0 0

0:7287

00

Ä CD 0 0 1 0
0001

3 14:7110

1:0000 1:6695

757

2:1963

2

3

0

B D 664

0 0

757

0:8116

(3.84) (3.85)

This represents a linearization of the rigid body dynamics of a passenger vehicle

(Fig. 2.10). The first state is an average of the lateral velocity v and yaw rate r; the

second state represents « , the vehicle orientation; the third state, Y , is the lateral

deviation from the intended lane position, and the fourth state, r, is the yaw rate.

It is easy to identify the following subcomponents:

Ä

A11 D

3:9354 0 00

A211 D 1:0000 14:9206

(3.86)

It can be verified that .A11; A211/ is observable and so a matrix Lo can be found such that A11 C LoA211 is stable. Choosing
Ä Lo D 0:0318
0:1362

128

3 Conventional Sliding Mode Observers

ensures the eigenvalues of A11 C LoA211 are at f 2; 4g. A particular choice of the Luenberger gain in the sliding mode observer is

2 Gl D 466

0:0297 0:4087 5:0646

3 14:7111

1:0000 1:6695

775

0:0232 0:8037

which is obtained by choosing As22 D 3I2.

3.5 A Sliding Mode Observer for Nonlinear Systems

In this section, a class of nonlinear uncertain systems is considered which might be termed semi-linear. Consider a system described by

xP D Ax C .x; u/ C Df .y; u; t/ y D Cx

(3.87) (3.88)

where x 2 Rn, u 2 Rm, and y 2 Rp are the state variables, inputs, and outputs, respectively. The matrices A 2 Rn n, D 2 Rn q, and C 2 Rp n (q Ä p < n)
are constant, with D and C both full rank. The known nonlinear term .x; u/ is assumed to be Lipschitz with respect to x for all u 2 U (here U is an admissible control set): i.e., there exists a positive scalar L such that

k .x; u/ .xO ; u/k Ä L kx xO k

(3.89)

The gain L can be thought of as the steepest possible gradient that . / achieves with variations in x. The unknown function f .y; u; t/ 2 Rq is assumed to satisfy

kf .y; u; t/k Ä .y; u; t/

(3.90)

where the function .y; u; t/ is known. The system in (3.87) and (3.88) might represent a nonlinear system subject to
faults captured by the unknown input signal f .y; u; t/. In particular if D D B, then the faults are associated with the actuators of the system--hence the direct dependence of the signal f . / on the control signal u.t/.
The following assumptions will be imposed on system (3.87) and (3.88): Assumption 1. rank.CD/ D rank.D/: Assumption 2. All the invariant zeros of the matrix triple .A; D; C / lie in the left half plane.

3.5 A Sliding Mode Observer for Nonlinear Systems

129

From Lemma 3.1, it can be assumed without loss of generality that system (3.87) and (3.88) already has the form

xP1 D A1x1 C A12x2 C 1.x; u/ xP2 D A21x1 C A22x2 C 2.x; u/ C D2f .y; u; t / y D C2x2

(3.91) (3.92) (3.93)

where x D col.x1; x2/ with x1 2 Rn p, and 1.x; u/ and 2.x; u/ are the first n p and the last p components of .x; u/.

Now a robust sliding mode observer will be proposed using the system structure

characteristics shown in Sect. 3.4. First introduce a coordinate transformation z D

T x where

Ä T WD In p L
0 Ip

(3.94)

where L has the structure

L D Lo 0

(3.95)

and Lo 2 R.n p/ .p q/. Then, it follows that in the new z coordinates, system (3.91)­(3.93) has the following form:

zP1 D .A11 C LA21/z1 C .A12 C LA22 .A11 C LA21/L/ z2 C In p L .T 1z; u/
zP2 D A21z1 C .A22 A21L/ z2 C 2.T 1z; u/ C D2f .y; u; t / y D C2z2

(3.96) (3.97) (3.98)

where z WD col.z1; z2/ with z1 2 Rn p. Notice that (3.96) is independent of the unknown function f . /. This very specific structure (3.96) occurs because LD2 D 0. For system (3.96)­(3.98), consider a dynamical system (the observer) given by

zOP1 D .A11 C LA21/zO1 C .A12 C LA22 C In p L .T 1zO; u/
zPO2 D A21zO1 C .A22 A21L/ zO2 K.y yO D C2zO2

.A11 C LA21/L/ C2 1y C2zO2/ C 2.T 1zO; u/ C

(3.99) (3.100) (3.101)

where zO WD col.zO1; C2 1y/ and yO is the output of the dynamical system. Note that zO does not represent the state estimate col.zO1; zO2/. It is merely used as a convenient notation in the developments which follow. Also note that the unknown input f . /
does not appear in (3.99) and (3.100) but the known nonlinearity . / does--except
its arguments depend on zO and not z. The gain matrix K is chosen so that the matrix C2.A22 A21L/C2 1 C C2K is symmetric negative definite. This is always possible

130

3 Conventional Sliding Mode Observers

since C2 is nonsingular and an explicit formula is given later. Define the output estimation error as ey D y yO, and the injection signal as

WD

k.

/C2

1

ey key k

(3.102)

where k. / is a positive scalar function to be determined. Let e1 D z1 zO1 and ey D y yO D C2.z2 zO2/. Then from (3.96) to (3.98) and (3.99) to (3.101), the state estimation error dynamical system is described by

eP1 D .A11 C LA21/e1 C In p L .T 1z; u/ .T 1zO; u/

(3.103)

ePy D C2A21e1 C C2.A22 CC2 2.T 1z; u/

A21L/C2 1 C C2K ey C C2D2f .t / 2.T 1zO; u/

C2 (3.104)

where zO D col.zO1; C2 1y/ and is defined by (3.102). From Lemma 3.1 and Assumptions 1­2, a matrix L of the form in (3.95) can be found to make A11 CLA21
stable. As argued earlier, a gain matrix K 2 Rp p can be chosen as

K D .A22 A21L/C2 1 C2 1As

(3.105)

where As is symmetric positive definite to ensure C2.A22 A21L/C2 1 C C2K is negative definite, and hence the nominal linear system matrix of the state estimation

error dynamical system (3.103) and (3.104) given by

Ä A11 C LA21 C2A21

C2.A22

0 A21L/C2 1 C C2K

(3.106)

is stable. From (3.94) and (3.98), it follows that
Ä T 1z T 1zO D In p
0
) T 1z

Ä

L

z1 zO1

Ip z2 C2 1y

T 1zO D ke1k

Ä D e1
0

(3.107)

For system (3.103) and (3.104), consider a sliding surface

°

«

S D .e1; ey/ j ey D 0

(3.108)

Then, the following can be proved:

Proposition 3.2. Under Assumptions 1­2, the sliding motion of system (3.103) and (3.104), associated with the surface (3.108), is asymptotically stable if the matrix inequality

ANT PN T C PN AN C 1 PN PN T C " L "

2 In p C P < 0

(3.109)

3.5 A Sliding Mode Observer for Nonlinear Systems

131

where " and  are positive constants, L is the Lipschitz constant for .x; u/ with respect to x, and L has the structure in (3.95), is solvable for PN where

PN WD P In p L

Ä and AN WD A11
A21

(3.110)

with P > 0.

Proof. The analysis above has shown that (3.103) represents the sliding dynamics when restricted to the sliding surface (3.108). Therefore, it is only required to prove that (3.103) is asymptotically stable. Consider a candidate Lyapunov function V D e1T P e1. The time derivative of V along the trajectories of system (3.103) is given by
VP j.3:103/ D e1T .A11 C LA21/T P C P .A11 C LA21/ e1
C2e1T P In p L .T 1z; u/ .T 1zO; u/
D e1T ANT PN T C PN AN e1 C 2 PN T e1 T .T 1z; u/ .T 1zO; u/

From the well-known inequality2 that 2X T Y

Ä

"X T X

C

1 "

Y

T

Y

for any scalar

" > 0, it follows that

VP j.3:103/ Ä e1T PN AN C ANT PN T e1 C "e1T PN PN T e1

C 1 .T 1z; u/ "

.T 1zO; u/ T .T 1z; u/

From (3.107),

k .T 1z; u/ .T 1zO; u/k Ä L ke1k

Consequently

.T 1zO; u/ (3.111)

VP j.3:103/ Ä e1T

PN AN C ANT PN T

e1

C

"e1T

PN PN T

e1

C

1 "

L

2 ke1k2

D e1T

PN AN C ANT PN T

C "PN PN T C 1 "

L

2 I e1

Ä e1T P e1 D V

(3.112)

where (3.109) has been used to obtain the last inequality, and the proof is complete.
Remark 3.5. Note that inequality (3.109) can be transformed into the following Linear Matrix Inequality (LMI) problem: for a given scalar  > 0, find matrices P and Y and a scalar " such that

2This is sometimes known as Young's Inequality.

132

3 Conventional Sliding Mode Observers

2

64

,.P; Y / C P P

C"

L

2

YT

P "In p
0

3

Y 0

57 < 0

"Ip

(3.113)

where ,.P; Y / WD PA1 CAT1 P CYA21 CAT21Y T and the decision variable Y WD PL with P > 0. This problem can be solved by LMI techniques. If L is known, then for a given , the problem of finding P , Y , and " to satisfy (3.113) is a standard LMI feasibility problem. Alternatively, an optimization problem can be posed which is to find P , Y , and " which maximizes L in (3.113). This is a convex eigenvalue optimization problem and can be solved using standard LMI algorithms.
Since VP .t/ Ä V .t/ in (3.112), it follows that there exists a positive scalar M such that

ke1.t/k Ä M ke1.0/k expf t=2g

(3.114)

q

where a choice is M WD

max .P min.P

/ /

.

Based

on

inequality

(3.114),

introduce

a

dynamic

system given by

wPO .t/ D

1 2

wO .t

/

(3.115)

For any value e1.0/, choose wO .0/ such that M ke1.0/k Ä wO .0/. Then, it is easy to see that the available solution wO .t/ to Eq. (3.115) is an upper bound on the size of the corresponding state estimation error e1.t/; specifically ke1.t/k Ä wO .t/ for all t 0.
Proposition 3.3 has shown that the sliding mode associated with the sliding surface S given in (3.108) is stable if the matrix inequality (3.109) is solvable. The objective is now to determine the scalar gain function k. / in (3.102) such that the system can be driven to the surface S in finite time and a sliding motion can be maintained.

Proposition 3.3. Under Assumptions 1­2, system (3.103) and (3.104) is driven to the sliding surface (3.108) in finite time and remains there if the gain k. / in (3.102) is chosen to satisfy

k.t; u; y; zO/ .kC2A21k C kC2kL /wO .t/ C kC2D2k .y; u; t/ C Á (3.116)

where Á is a positive constant and wO is the solution to the differential Eq. (3.115). Proof. Let VQ .ey/ D eyT ey. From the expression for the output estimation error in (3.104), it follows that
VQP DeyT C2.A22 A21L C2 1 C C2K C C2.A22 A21L/C2 1 C C2K T ey C C2eyT C2A21e1 C C2 2.T 1z/ 2.T 1zOy / C C2D2f .t / C2 (3.117)

3.6 Fault Detection: A Simulation Example

133

Since, by design C2.A22 A21L/C2 1 C C2K is symmetric negative definite, it follows that
C2.A22 A21L/C2 1 C C2K T C C2.A22 A21L/C2 1 C C2K < 0 (3.118)

By applying (3.90) and (3.118) to (3.117), it follows from (3.107) that

VQP Ä 2keyk kC2A21k C kC2kL ke1k C kC2D2k .y; u; t / 2eyT C2 (3.119)

From the arguments above, ke1.t/k Ä wO .t/, and substituting the given in (3.102) into (3.119) yields

VPQ D 2keyk .kC2A21k C kC2kL /wO 2k. / keyk

(3.120)

From (3.116) and (3.120) it follows that VPQ Ä

2Ákeyk Ä

2ÁVQ

1 2

:

This

shows

that the reachability condition is satisfied. It follows that VQ D 0 in finite time and

consequently a sliding motion is achieved and maintained after some finite time

ts > 0. Hence the proof is complete.

3.6 Fault Detection: A Simulation Example

Consider a single-link flexible joint robot system, where the system nonlinearities come from the joint flexibility modeled as a stiffened torsional spring, and the gravitational force. The dynamical model for the robot can be described by

ÂP 1 D !1

!P 1

D

1 J1

.Ä

1.Â

2

Â 1/ C Ä2.Â 2

Â 1/3/

Bv J1

!1

C

K J1

u

ÂP 2 D !2

!P 2 D

1 J2

.Ä

1

.Â

2

Â 1/ C Ä2.Â 2

Â 1/3/

ml gh J2

sin.Â 2/

(3.121) (3.122) (3.123) (3.124)

where Â1 and !1 are the motor position and velocity, respectively; Â2 and !2 are the link position and velocity, respectively; J1 is the inertia of the DC motor; J2 is the inertia of the link; 2h is the length of the link, while ml represents its mass; Bv is the viscous friction; Ä1 and Ä2 both are positive constants; and K is the amplifier gain. The domain considered here is f.Â 1; !1; Â 2; !2/ j jÂ 2 Â 1j < 2:8; j!1j Ä 50g: It is assumed that the motor position, motor velocity and the sum of link velocity,
and link position are measured. Suppose that a fault occurs in the input channel in
the robot system. Therefore the fault distribution matrix D will be equal to the input distribution matrix. Suitable values for the parameters are: J1 D 3:7 10 3kgm2, J2 D 9:3 10 3kgm2, h D 1:5 10 1m, m D 0:21kg, Bv D 4:6 10 2m, Ä1 D Ä2 D 1:8 10 1Nm/rad, and K D 8 10 2Nm/V. Let x D col.x1; x2; x3; x4/ WD

134

3 Conventional Sliding Mode Observers

.Â 1; !1; Â2; !2/. Then, the robot system can be described in the form (3.87) and (3.88) where

2

3

0

.x; u/ D 646

0:0194.x3

x1/3 C 21:6216u 0

577

0:0486.x3 x1/3 83:4324 sin.x3/

A suitable transformation is given by z D T x with T defined as

2 1:4142

T D 664

0 1

00 01 10

3 0

0 0

757

0

0 0 0:01

It follows that
" A11 A21

2

#

1

A12 A22

D

664

0 8:0496

0:0137

0 0 0:0486 0:0194

3 1:4142 0

0 11:4324

1 0

775

0

0

(3.125)

" #2

D2 D

0 D22

D4

3 0 21:6216 5
0

2

3

0 10

C2 D 4 1 0 0 5

00 1

(3.126) (3.127)

and

2

3

0

.T 1z; u/ D 466

21:6216u

0 0:0486.z2 C 0:7071z1/3

577

0:0002.z2 C 0:7071z1/3 C 0:3319 sin.z2/

Let  D 0:5. From the LMI synthesis, the optimal value of the Lipschitz gain L D 0:75 when L D 0 0 0 , " D 2, and P D 1:5 and the conditions of Proposition 3.2 are satisfied. Finally, by choosing

2 0
K D 4 10:2324

3 1:1 1 0:0486 0 5

0

0:0194 1

3.6 Fault Detection: A Simulation Example

0.1

0.1

135 0.1

reconstruction with noise

reconstruction signal

0.05

0.05

0.05

fault signal f

0 -0.05

0 -0.05

0 -0.05

fault signal f

-0.1 0

2

4

time [sec]

1

-0.1 0

2

4

time [sec]

Fig. 3.17 Fault estimation

1

-0.1 0

2

4

time [sec]

1

reconstruction with noise

reconstruction signal

0.5

0.5

0.5

0

0

0

-0.5

-0.5

-0.5

-1

0

5

time [sec]

-1

0

5

time [sec]

Fig. 3.18 Fault estimation

-1 0

5

time [sec]

it follows that C2.A22

2 1:2
A21L/C2 1 C C2K D 4 0
0

3 00 1:1 0 5
01

and thus (3.118) is true. For simulation purposes, a linear state feedback controller has been introduced
to stabilize the system. In the first case, the fault signal is f .y; u; t/ D 0:5 sin.u/ which does not affect the stability of the system. The associated simulation is shown in Fig. 3.17. In the second case, the fault signal is f .y; u; t/ D sin.u/ which destroys the system stability. The corresponding simulation is shown in Fig. 3.18. The simulations show that the signal fQ can reconstruct the fault perfectly, even if the fault destroys closed-loop stability. However, in the second simulation, the reconstruction properties will eventually be lost over time as the states of

136

3 Conventional Sliding Mode Observers

the plant become unbounded. It also shows that in the presence of sensor noise the reconstruction scheme is still effective. From (3.104) during the sliding motion ey D ePy D 0 and

eq D D2f .y; u; t/ C .T 1z; u/ .T 1zO; u/

(3.128)

Furthermore since zO ! z as t ! 1 from (3.128) it follows that

eq ! D2f .y; u; t /

and so the fault estimate signal

fO WD .D2T D2/ 1D2 eq ! f

(3.129)

as t ! 1. Consequently .D2T D2/ 1D2 eq is an asymptotic estimate of the fault.

3.7 Notes and References
The earliest observer is attributed to Luenberger [134, 135] in which the difference between the output of the plant and the observer is fed back linearly into the observer. There is a vast literature devoted to this topic. The earliest work in terms of sliding mode methods applied to observer problems is attributed to Utkin [182], although these ideas had appeared in the Russian literature many years earlier [37].
The term sliding patch to describe the region in which sliding takes place was first coined in [172]. This sought to enlarge the region in which sliding takes place. It represents one of the earliest sliding mode observers with both linear and nonlinear injection terms. The example in Sect. 3.2, to demonstrate the effects of the linear and nonlinear terms on the observer performance, is taken from [7].
The problem of robust state estimation for systems with bounded matched uncertainty was first explored by Walcott and Z ak [188]. In terms of the design of Walcott and Z ak, a system theoretic interpretation of the constraints in (3.46) and (3.47) by Steinberg and Corless [175] is that the transfer function matrix G.s/ D F C.sI A0/ 1B is strictly positive real. The problem of synthesizing P; G, and F (and incorporating some sort of design element) is nontrivial. The structural requirements (3.46) and (3.47) of Walcott and Z ak were shown in [70] to be solvable if and only if:
· Rank.CB/ D m. · All the invariant zeros of .A; B; C / have negative real parts.
Under these circumstances a (semi-)analytic expression for the solution to the observer design problem is given in terms of a gain matrix L 2 R.n p/ .p m/ and a stable matrix A2s2 2 Rp p that defines Gl (see [70]). The approach in this chapter builds on the work of Edwards and Spurgeon [65] which builds on the ideas of Walcott and Z ak [188]. An interesting comparison between sliding mode observers

3.8 Exercises

137

and other nonlinear techniques appears in [189]. A well-cited tutorial on sliding mode observers is presented in [62]. A recent tutorial on this material appears in [174]. The observer from Sect. 3.5 to deal with Lipschitz nonlinear systems is given in Yan and Edwards [193]. The single-link flexible joint robot system is taken from [78]. A comparison of these observers with so-called unknown input observers appears in [69].
The optimization problem in Sect. 3.5 is a convex eigenvalue optimization problem and can be solved using standard LMI algorithms [99] (largely based on interior point methods). A now classical account of the different applications of convex optimization to control problems is given by Boyd et al. [38].
One of the earliest paper to apply sliding mode observers to fault detection and isolation problems is Edwards et al. [70]. These ideas have been expanded upon to incorporate directly robust reconstruction [178]. Subsequently the relative degree one restrictions in this chapter has been removed using a cascade of conventional sliding mode observers [179]. An overview of applications of these ideas to fault detection and fault tolerant control problems appears in [7].

3.8 Exercises

Exercise 3.1. Show that for the system

xP .t/ D Ax.t/ y.t/ D C x.t/

where

Ä AD 0 1
00

CD 1 0

choosing the gain

Ä

Gn D

1 1

in the observer from (3.5) and (3.6) yields a stable sliding motion.

Exercise 3.2. Consider the system

xP .t/ D Ax.t/ y.t/ D C x.t/

where

Ä AD 0 1
00

CD 1 1

(3.130) (3.131) (3.132)
(3.133)
(3.134) (3.135) (3.136)

138

3 Conventional Sliding Mode Observers

Find the range of values of the scalar gain for which the gain vector Ä
Gn D 1

(3.137)

in the observer from (3.5) and (3.6) yields a stable sliding motion. Exercise 3.3. For the triple integrator

y«.t/ D u.t/

(3.138)

written in state-space form, with the states chosen as col.y; yP; yR/, design an observer of the form (3.5) and (3.6).
Exercise 3.4. Consider the system

xP .t/ D Ax.t/ C Bu.t/ C D .t; x/ y.t/ D C x.t/

(3.139) (3.140)

where .t; x/ is an unknown but bounded disturbance and

Ä AD 0 1
00

Ä BDDD 0
1

CD 1 

(3.141)

where  is a scalar. Find the range of value of  for which it is possible to design an observer of the form (3.61) and (3.62).
Exercise 3.5. Consider a simple quarter-car vehicle model written in state space form choosing as states v (forward velocity) and ! (wheel angular velocity)

xP .t/ D Ax.t/ C Bu.t/ C Df .t; x/

(3.142)

where x D col.v; !/ and

Ä

AD

vg 0

0

!
J

Ä

BD

0
Kb

J

Ä4

DD

m r

J

(3.143)

In the above, f .t; x/ represents the unmeasured breaking force applied to the wheel. The positive scalars v, w, J , Kb, r, m, g, and r are physical parameters associated with the vehicle. It is assumed that only angular wheel speed ! is measured, and in this case the output distribution matrix is given as

CD 0 1

(3.144)

The following model-based nonlinear observer is proposed

xOP .t/ D AxO .t/ C Bu.t/ C Gl ey C D

(3.145)

3.8 Exercises

139

where xO D col.vO; !O /, the design gain Gl 2 R2, ey D ! !O , and D ksign.F ey/ where k is a scalar gain, F is a scalar which will be defined later, and vO and !O are

estimates of v and !, respectively. The design problem is to compute Gl , F , and k so that the estimated angular velocity !O is such that ey D ! !O Á 0 in finite time:

i.e., a sliding motion is achieved in finite time.

Here the gain Gl is proposed as

Ä Gl WD

4J vg rm

4J rm



!
J

C

(3.146)

where  is a positive scalar.

1. Show that the eigenvalues of .A Gl C / D f vg; g which implies .A Gl C /

is stable by design.

2. Consider as a Lyapunov function V D eT P e where

"

P WD

P1

4J rm

P1

#

4J rm

P1

P2

C

16J 2 r 2 m2

P1

(3.147)

and P1 and P2 are positive scalars. Define Q WD P .A Gl C / C .A Gl C /T P

(3.148)

Show that Q is symmetric positive definite.

3. Show that PD D F C T for the scalar F WD

2

r J

P2.

Use this information to demonstrate that (3.145) induces a sliding motion on the hyperplane S D fe W C e D 0g in finite time.

Exercise 3.6. A more complex model of the same system, but now including a LuGre friction model, is

xPp.t/ D Apx.t/ C Bpu.t/ C DpÂ x1.t/f .x3/

(3.149)

where the control signal u.t/ D Pb.t/ and

2 00

3 1

Ap WD 4 g 0 g v g. 1 C 2/ 5

q 0 g v q. 1 C 2/

2 Bp WD 4

3 0 05
r kb J

The distribution matrix through which the nonlinear terms operate is

2 Dp WD 4

3 1 g 15
q1

(3.150) (3.151)

140

3 Conventional Sliding Mode Observers

In these matrices, the aggregate parameter q WD

.g

C

Fn r J

2

/.

Since

it

is

assumed

that only angular wheel speed ! is measured, the output distribution matrix

Cp D

0

1 r

1 r

Consider an observer of the form

(3.152)

xPOp.t / D ApxOp.t / C Bpu.t / C Gpey C Dp

(3.153)

where Gp 2 R3 and D kpsign.ey/ where kp is a scalar gain. The main objective is to synthesize an observer to generate an estimated angular velocity !O D C xO such that ey D ! !O Á 0 in finite time despite the nonlinear friction terms which have been ignored in (3.153). It is shown in [148] that if

gN1

D r C .g C


1

/

J Fnr

gN2 D g. C g N

0 1

/

J Fn

r

C gr.

1C

2/

gN3 D . 1 C 2/q

w
J

C

0 1



where N D v C 1 C 2 and  is a negative scalar, then

2

3

gN1

Gp D 4 gN2 5

rgN3 gN2

(3.154) (3.155) (3.156)
(3.157)

is an appropriate choice of gain in (3.153). Define ep D xp xOp as the state estimation error, where xp D col.x1; x2; x3/. The dynamics of the error system can be obtained from (3.149) and (3.153) as

ePp D .Ap GpCp/ep C Dp Â f .x3/x1 kp sign.ey/

Show the reduced-order sliding motion is governed by the linear system

Ä eP1 eP2

"

0

D

1

0

#Ä

2 1

e1

vg

e2

(3.158) (3.159)

and so the sliding motion is stable Exercise 3.7. Consider the following Lur'e-type representation for Chua's circuit:

xPi D Axi C D i .yi / C Bui yi D C xi

(3.160) (3.161)

3.8 Exercises

141

where

2

3

2

3

al1 a 0

a.l0 l1/

AD4 1 1 1 5 ; D D4 0 5

0 b0

0

Ä CD 1 0 0
010

(3.162) (3.163)

The nonlinearity is

i .yi /

D

1 2

.jxi1

C

cj

jxi1

cj/, which has a sector bound OE0; 1.

The chosen values of the parameters are a D 9; b D 14:286; c D 1; l0 D 1=7, and

l1 D 2=7 in order to obtain double-scroll attractor behavior.

Design a sliding mode observer for this system.

Chapter 4
Second-Order Sliding Mode Controllers and Differentiators

As we have seen, classic sliding modes provide robust and high-accuracy solutions for a wide range of control problems under uncertainty conditions. However, two main restrictions remain. First, the constraint to be held at zero in conventional sliding modes has to be of relative degree 1, which means that the control needs to explicitly appear in the first time derivative of the constraint. Thus, one has to search for an appropriate constraint. Second, high-frequency control switching may easily cause unacceptable practical complications (chattering effect), if the control has any physical sense. Suppose that the problem is to keep the sliding variable s at zero, while the control appears only in sR. Usually the constraint function D s C sP is chosen. By construction, P D sP C sR contains the control, and can be kept at zero in a classic sliding mode (Chap. 2). As a result s tends asymptotically to zero. Keeping it at exact zero is not possible. One also needs to calculate sP to realize this scheme. Both of these goals, exact robust differentiation and exactly keeping s D 0, can be accomplished by the second-order sliding mode technique to be developed in this chapter. Suppose that the problem is to keep s at zero, while the control appears already in sP. This problem is easily solved by means of conventional sliding modes (Chap. 2). But often the chattering effect makes the solution unacceptable. A possible solution is to consider the control derivative as a new virtual control. Then the above reasoning can be applied, and using a second-order sliding mode technique, the task can be accomplished exactly, and in finite time, by means of continuous control. As a consequence it can be expected that the chattering effect is significantly attenuated.

4.1 Introduction

Consider a simple control system involving target pointing by means of a pendulum (with the angle coordinate measured from q D =6) given by

xP D sin.x C q/ C u; q D =6

(4.1)

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

143

DOI 10.1007/978-0-8176-4893-0 4, © Springer Science+Business Media New York 2014

144

4 Second-Order Sliding Mode Controllers and Differentiators

Fig. 4.1 Asymptotically stable second-order sliding mode at x D 0; u D sin.q/

The targeting problem is reformulated as the stabilization of Eq. (4.1) at x = 0. It is easily solved by means of the standard relay controller

u D 2 sign.x/

(4.2)

As we have already seen, this controller produces considerable chattering. One of the natural ways to avoid chattering is to introduce dynamical regularization gradually switching the control

uP D u  sign.x/

if juj > 2 if juj Ä 2

(4.3)

where u.0/ D u0. Let x and u be the new coordinates (Fig. 4.1), and suppose  is sufficiently
large. Obviously, we get xP > 0 with u > ueq D sin.x C =6/ and xP < 0 with u < sin.x C q/. Each trajectory starting from the point .0; u0/, with u0 > sin.q/ D sin. =6/ D 0:5, revolves around the point .0; 0:5/. The closer is the initial point to .0; 0:5/, the closer is the trajectory to .0; 0:5/. Thus the point .0; 0:5/ is the limit of trajectories. Furthermore it can even be shown that solutions asymptotically converge to this point. From the theory of ordinary differential equations one learns that a limit trajectory also has to be a solution trajectory. In other words,

4.1 Introduction

145

x D 0; u D 0:5 is a constant solution of the system (4.1), (4.3). Moreover, obviously the solution should still be x D 0; u D sin.q/, with q slowly changing. The point x D 0; u D 0:5 does not represent a solution in any classical sense, but is a solution in the sense of Filippov.
The point x D 0; u D sin.q/ D 0:5 satisfies the conditions

x D 0; xP D 0

(4.4)

Such a constant solution would be an ideal solution for the stated control problem, provided it can indeed be considered as a solution of Eqs. (4.1), (4.3). Motions satisfying (4.4) are said to be in the second-order sliding mode or 2-sliding mode. The point x = 0, u = 0.5 is the 2-sliding manifold. In this chapter we will learn how to establish such modes and to ensure their finite-time stability. But first we need to redefine the very notion of the solution for the case of differential equations with discontinuous right-hand sides.

Definition 4.1. Consider a discontinuous differential equation xP D f .x/ (Filippov differential inclusion xP 2 F .x/) with a smooth output function D .x/, and let it be understood in the Filippov sense. Then, provided that:

1.

and the total time derivative P D

0 x

.x/f

.x/

are

continuous

functions

of

x

2. The set

D P D0

(4.5)

is a nonempty integral set 3. The Filippov set of admissible velocities at the set defined by Eq. (4.5) contains
more than one vector

the motion on the set (4.5) is said to exist in a 2-sliding (second-order sliding) mode
(Fig. 4.2), and the set (4.5) is called a 2-sliding set. The nonautonomous case is reduced to the considered one by introducing the fictitious equation tP D 1.

Note that the third requirement means that set (4.5) is a discontinuity set of the equation, and it is introduced here only to exclude extraneous cases of integral manifolds of continuous differential equations. That condition is illustrated by the two limit velocity vectors at the 2-sliding point M in Fig. 4.2. Also note that the extension of the above definitions by the introduction of the fictitious equation tP D 1 actually makes time similar to other coordinates. This approach is different from the standard definition by Filippov, it is simpler, and it provides for more solutions.
The conventional sliding mode described in Chap. 2 is called first order ( is continuous, and P is discontinuous). The general definition of the sliding mode order is very similar and is introduced in Chap. 6.

Remark 4.1. The notion of the sliding order appears to be connected with the notion of relative degree.

146

4 Second-Order Sliding Mode Controllers and Differentiators

Fig. 4.2 2-sliding mode

Consider a general system linear in the control given by

xP D a.t; x/ C b.t; x/u

(4.6)

x 2 Rn, with the output

D .t; x/

(4.7)

The functions a; b; are assumed to have all the necessary derivatives. In this chapter we consider the simplest case when ; u 2 R. The total time derivative of is defined as

PD

0 t

C

0 x

a

C

0 x

bu

Suppose that

0 x

b

Á

0.

Then

calculating

the

second

total

derivative

yields

RD

00 tt

C

2

00 tx

a

C

0 x

at0

C

OE

00 xx

.a

C

bu/a

C

0 x

OEax0

.a

C

bu/

Thus,

R D h.t; x/ C g.t; x/u; g.t; x/ D .

00 xx

b

/a

C

0 x

.ax0

b/

(4.8)

where h is another appropriately defined function. Hence, the relative degree equals

1 if

0 x

b

¤

0,

and

it

equals

2

,

if

0 x

b

Á

0

and

.

00 xx

b

/a

C

0 x

.ax0

b/

¤

0.

Suppose that the system relative degree exists, and the control function u is

defined by some discontinuous feedback. Then with relative degree 1 the function

P is discontinuous, while of course is continuous. On the other hand with relative

degree 2 and discontinuous u get that , P are continuous functions, while R

is discontinuous. Therefore we come to conclusion that the conventional sliding

(1-sliding) mode can only be achieved with relative degree 1, while the second-order

sliding (2-sliding) mode requires relative degree 2 with respect to discontinuous

control.

4.2 2-Sliding Mode Controllers

147

4.2 2-Sliding Mode Controllers

Once more consider a dynamic system of the form

xP D a.t; x/ C b.t; x/u; D .t; x/

(4.9)

where x 2 Rn, u 2 R is control, is the only measured output, and the smooth

functions a; b; (and the dimension n) are unknown. The task is to make the output

vanish in finite time and to keep Á 0 by means of discontinuous globally

bounded feedback control. The system trajectories are supposed to be infinitely

extendible in time for any bounded input. The system is understood in the Filippov

sense.

Assume that the measured output .t; x/ is twice differentiable with respect to

time and the condition

0 x

b

Á

0

and

.

00 xx

b

/a

C

0 x

.ax0 b/

¤

0

hold.

Then

calculating

the second total time derivative R along the trajectories of Eq. (4.9), under the

conditions outlined above in Eq. (4.8), we obtain

R D h.t; x/ C g.t; x/u

where the functions h

D

R juD0, g

D

@ @u

R

¤

0 are some unknown smooth functions.

Suppose that the inequalities

0 < Km Ä g Ä KM ; jhj Ä C

(4.10)

hold globally for some Km; KM ; C > 0. Note that, at least locally, Eq. (4.10) is satisfied for any smooth system (4.8) with the well-defined relative degree 2.
Obviously, no continuous feedback controller of the form u D '. ; P / can solve the stated problem. Indeed, such a control ensuring Á 0 has to satisfy the equality R Á 0 as well, which means that '.0; 0/ D h.t; x/=g.t; x/, whenever D P D 0 holds. The uncertainty in the problem prevents it, since the controller will not be effective for the simple autonomous linear system R D c C ku, Km Ä k Ä KM , jcj Ä C , with '.0; 0/ ¤ c=k. In other words, due to the uncertainty, the 2-sliding mode D P D 0 needs to be established.
Assume now that Eq. (4.10) holds globally. Then Eqs. (4.8), (4.10) imply the differential inclusion

R 2 OE C; C  C OEKm; KM  u

(4.11)

Most 2-sliding controllers may be considered as controllers for Eq. (4.11) steering ; P to 0 in (preferably) finite time. Since the inclusion (4.11) does not "remember"
the original system (4.9), such controllers are obviously robust with respect to any perturbations preserving (4.10).
Hence, the problem is to find a feedback

u D '. ; P/

(4.12)

148

4 Second-Order Sliding Mode Controllers and Differentiators

such that all the trajectories of Eqs. (4.11), (4.12) converge in finite time to the origin D P D 0 of the phase plane ; P . We will now consider a number of the simplest
and most popular controllers solving this problem.

4.2.1 Twisting Controller

The twisting controller described below is historically the first 2-sliding controller which was proposed. It is defined by the formula

u D .r1sign. / C r2sign. P // ; r1 > r2 > 0

(4.13)

Theorem 4.1. Let r1 and r2 satisfy the conditions

.r1 C r2/Km C > .r1 r2/KM C C; .r1 r2/Km > C

(4.14)

The controller in Eq. (4.13) guarantees the appearance of a 2-sliding mode D P D 0 attracting the trajectories of the sliding variable dynamics (4.11) in finite time.

Proof. It is easy to see that every trajectory of the system crosses the axis D 0 in finite time. Indeed, due to Eqs. (4.13), (4.14) sign. / sign. R / < 0 and with sign. / being constant for a long time, P < 0 is established, while the absolute value of P tends to infinity. It follows from Eq. (4.14) that with ¤ 0

OEKM .r1 C r2/ C C Ä R sign. / Ä OEKM .r1 C r2/ C  < 0 with P > 0 OEKM .r1 r2/ C C Ä R sign. / Ä OEKM .r1 r2/ C  < 0 with P < 0
(4.15)
According to the Filippov definitions, the values taken on a set of the measure 0 (in particular on any curve) do not matter. Let P 0; M ; P M (Fig. 4.3.) be the trajectory of differential equation

RD

OEKm.r1 C r2/ C sign. / with P > 0

OEKM .r1 r2/ C C sign. / with P Ä 0;

(4.16)

with the same initial conditions. Assume now for simplicity that the initial values are D 0, P D P 0 > 0 at t D 0. Thus, the trajectory enters the half-plane P >0. Simple calculation shows that with > 0 the solution of Eq. (4.16) is determined by the equalities

DM DM

P2 2OEKm .r1 Cr2 /

C

with P > 0

P2 2OEKM .r1 r2/CC 

with

P

Ä0

where M is determined from the equation

(4.17)

4.2 2-Sliding Mode Controllers

149

Fig. 4.3 Construction of a majorant trajectory for the twisting controller

2OEKM .r1 C r2/

C

M

D

P

2 0

(4.18)

Consider any point P . P ; P P / of this curve (Fig. 4.3). The velocity of Eqs. (4.11), (4.13) at this point has coordinates ( P P , R P ). Hence, the horizontal component of the velocity depends only on the point itself. Since the vertical component satisfies the inequalities (4.15), the velocity of Eqs. (4.11), (4.13) always "looks" into the region bounded by the axis D 0 and curve (4.17). That curve is called the majorant. Let the trajectory of Eqs. (4.11), (4.13) next intersect the axis D 0 at the point P 1. Then, obviously, j P 1jÄ j P M j and
j P 1j = j P 0j Ä OEKM .r1 r2/ C C  = OEKM .r1 C r2/ C 1=2 D q < 1 (4.19)

Extending the trajectory into the half-plane < 0, after similar reasoning, guarantees that the successive crossings of the axis D 0 satisfy the inequality

j P iC1j = j P i j Ä q < 1

(4.20)

as shown in (Fig. 4.3). Therefore, the algorithm obviously converges. Next the

convergence time is to be estimated. The real trajectory consists of an infinite

number of segments belonging to the half-planes

0 and Ä 0 (Fig. 4.4).

On each of these segments P changes monotonously according to Eq. (4.15). The

total variance of the function P .t/ is

Var . P . // D j P iC1j Ä j P 0j

1 C q C q2 C : : :

D jP0j 1q

(4.21)

150

4 Second-Order Sliding Mode Controllers and Differentiators

Fig. 4.4 Twisting controller trajectory

and the total convergence time is estimated as

X TÄ

jPij

Ä

j P 0j

OEKm.r1 r2/ C  .1 q/OEKm.r1 r2/ C 

(4.22)

The proof of the theorem is complete.
Remark 4.2. Note that considering the successive intersections of the trajectory with the axis, a similar inequality can be obtained:

j iC1j = j i j Ä OEKM .r1 r2/ C C  = OEKM .r1 C r2/ C 1=2 D q2 < 1 (4.23)

which also can be used for the proof. The same majorant curves are used, taken in the half-plane P Ä 0 or P 0.
Remark 4.3. In practice the parameters are never assigned according to inequalities (4.14). Usually the real system is not exactly known, the model itself is not really adequate, and the estimations of parameters KM , Km, C are much larger than the actual values (often 100 times larger!). The larger the controller parameters, the more sensitive is the controller to any switching imperfections and measurement noises. Thus, a pragmatic way is to adjust the controller parameters via computer simulations. (In fact this is true with respect to all controllers described in this chapter.)

4.2 2-Sliding Mode Controllers

151

Fig. 4.5 Suboptimal controller trajectory convergence (the case of q < 1)

4.2.2 Suboptimal Algorithm

The so-called suboptimal controller is given by

u D r1sign

=2 C r2sign ; r1 > r2 > 0;

(4.24)

where

r1

C

r2

>

; Km

r1

C

r2

>

4C

C

KM .r1 3Km

r2/ ;

(4.25)

and is the value of detected at the last time when P was equal to 0. The initial

value of is equal to 0. Any computer implementation of this controller requires successive measurements of P or . Usually, the detection P D 0 occurs when

the difference between successive measurements of changes sign. The idea of

the controller is directly derived from time-optimal control of a double integrator. A trajectory of the suboptimal controller is shown in the coordinates , P in Fig. 4.5.

In the figure 0; 2 are two successive points of the intersection with the axis P D 0 and 1 D 0=2. Similar to the proof of the twisting controller inequality (4.19), this implies that

j 1 2j = j 0 1j Ä OEKM .r1 r2/ C C  = OEKM .r1 C r2/ C  D q2 < 2 (4.26)

152

4 Second-Order Sliding Mode Controllers and Differentiators

(see the remark after the twisting controller proof). Let 0 > 0, then considering the cases 2 > 0 and 2 Ä 0 one can obtain that j 2j = j 0j Ä 1=2, which also provides finite-time convergence. Note that with q < 1 the overshoot case 2 Ä 0 is excluded and monotonic convergence to zero is ensured (Fig. 4.5). The previous results can be summarized as the following theorem:
Theorem 4.2. Controller (4.24), (4.25) guarantees the finite-time establishment and keeping of the 2-sliding mode Á 0 for the sliding variable dynamics satisfying (4.11).

4.2.3 Control Algorithm with Prescribed Convergence Law

The controller with prescribed convergence law is defined as

u D  sign . P C . // ;  > 0

(4.27)

where . / is a continuous function smooth everywhere except D 0. It is assumed that all solutions of the differential equation P C . / D 0 converge to 0 in finite time. The idea is to keep P C . / D 0 in the 1-sliding mode. Choosing . / D j j1=2 sign ,  > 0, in Eq. (4.27) yields the controller

u D  sign. P C j j1=2 sign /

(4.28)

The following result can be proved:

Theorem 4.3. Controller (4.28) guarantees the establishment and maintenance of a 2-sliding mode Á 0 for the sliding variable dynamics given by Eq. (4.11), in finite time.

Proof. Differentiating the function  D P C  j j1=2 sign . / along the trajectory yields

P 2 OE C; C 



OEKm;

KM



sign

./

C

1 2



P

j

j

1=2

(4.29)

Checking the condition P sign. / < const < 0 in a vicinity of each point on the curve  D 0, using P D  j j1=2 sign . /, implies that the 1-sliding-mode existence condition holds at each point except at the origin, if Km C > 2=2.
The trajectories of the inclusion inevitably hit the curve  D 0 due to geometrical

reasons. Indeed, each trajectory, starting with  > 0, terminates sooner or later at

the semi-axis D 0; P < 0 , if u D  sign./ keeps its constant value 

(Fig. 4.6). Thus, on the way it inevitably hits the curve  D 0. The same is true

for the trajectory starting with  < 0. From that moment the trajectory slides along

the curve  D 0 towards the origin and reaches it in finite time. Obviously, each

trajectory starting from a disk centered at the origin comes to the origin in a finite

time, the convergence time being uniformly bounded in the disk.

4.2 2-Sliding Mode Controllers

153

Fig. 4.6 Trajectories of the controller with the prescribed convergence law
Consider the region " confined by the lines P D " and the trajectories of the differential equations R D C C Km with initial conditions D "2=2; P D ", and R D C Km with initial conditions D "2=2; P D " (Fig. 4.6). No trajectory starting from the origin can leave ". Since " can be taken arbitrarily small, the trajectory cannot leave the origin. This completes the proof.

4.2.4 Quasi-Continuous Control Algorithm

An important class of controllers comprises the recently proposed so-called quasicontinuous controllers, featuring control continuous everywhere except the 2-sliding manifold D P D 0 itself. Since the 2-sliding condition requires the simultaneous fulfillment of two exact equalities, in the presence of any small noises and disturbances, the general-case trajectory does not ever hit the 2-sliding set. Hence, in practice the condition D P D 0 is never fulfilled, and the control remains continuous function of time, all the time. The larger the noises and switching imperfections, the worse the accuracy and the slower the changing rate of u. As a result, chattering is significantly reduced. The following is a 2-sliding controller with such features:

uD

P C j j1=2sign. /  j P j C j j1=2

(4.30)

154

4 Second-Order Sliding Mode Controllers and Differentiators

Fig. 4.7 Trajectories of the quasi-continuous controller

This control is continuous everywhere except the origin and it vanishes on the parabola P C j j1=2 sign . / D 0. For sufficiently large , there are numbers
1; 2 W 0 < 1 <  < 2 such that all the trajectories enter the region between the curves P C i j j1=2 sign . / D 0; i D 1; 2 and cannot leave it (Fig. 4.7).

Theorem 4.4. Let

;  > 0; Km C > 0

(4.31)

and suppose the inequality

Km C

 2Km C 

1 2>0 2

(4.32)

holds for some positive >  (it is always true for a sufficiently large ), then the controller (4.30) guarantees the establishment of a stable 2-sliding mode Á 0 for the sliding variable dynamics given by Eq. (4.11), in finite time.

Remark 4.4. The conditions of the theorem can be solved for , but the resulting expressions are redundantly cumbersome.
Proof. Denote D P = j j1=2. Due to the symmetry of the problem, it is enough to consider the case of > 0 and 1 < < 1. Calculations show that u D  . / = .j j C / and

4.3 Control of Relative Degree One Systems

Â

Ã

P2

OE C; C

OEKm; KM   j

 C1 jC 2

2sign .

/

j j 1=2

155
(4.33)

With a negative or small positive , the rotation velocity P is always positive due
to Eq. (4.31). Thus there is a positive 1 <  such that the trajectories enter the region > 1. It is now necessary to show that there is a 2 >  such that in some vicinity of D 2 the inequality P < 0 holds. This is exactly condition (4.32). Thus, conditions (4.31), (4.32) provide for the establishment and keeping of the inequality
1 < < 2 and the proof of the theorem is complete.

4.2.5 Accuracy of 2-Sliding Mode Controllers
Consider the cases of noisy and/or discrete measurements with respect to the sampling interval . We will see in Chap. 6 that the discrete-sampling versions based on the Euler scheme provide an accuracy level of D O. 2/; P D O. / in the absence of noise. Noisy measurements lead to the accuracy D O."/, P D O."1=2/ , if the maximal errors of and P and the sampling are of the order of " and "1=2, respectively, and the maximal sampling interval is of the order "1=2. Note that this result does not require any practical dependence between and noise magnitudes. Indeed, in practice there are always specific values of noise magnitudes and sampling intervals, which can always be considered as a sample of an infinite family (in a nonunique way). Moreover, one can always reduce either the noise magnitudes or the sampling interval, preserving the same upper accuracy estimation.

4.3 Control of Relative Degree One Systems
All the controllers described this far require real-time measurements of P or at least of sign. P /. In other words, in order to guarantee D P D 0, both and P measurements are needed. This is reasonable but, nevertheless, not inevitable. The following controller can be used instead of the conventional (first-order) sliding mode using the same available information.

4.3.1 Super-Twisting Controller

Consider once more the dynamical system (4.9) of relative degree 1 and suppose that

P D h.t; x/ C g.t; x/u

(4.34)

156

4 Second-Order Sliding Mode Controllers and Differentiators

Fig. 4.8 Trajectory of the super-twisting controller

Furthermore assume that for some positive constants C , KM , Km, UM , q jhPj C UM jgPj Ä C; 0 Ä Km Ä g.t; x/ Ä KM ; jh=gj < qUM ; 0 < q < 1 (4.35)

hold and define u D j j1=2sign. / C u1;

( uP 1 D

u; sign. /;

juj > UM juj Ä UM

(4.36)

Then the following result is obtained.

Theorem 4.5. With Km > C and sufficiently large, the controller (4.36) guarantees the appearance of a 2-sliding mode D P D 0 in system (4.34), which attracts the trajectories in finite time. The control u enters in finite time the segment OE UM ; Um and stays there. It never leaves the segment, if the initial value is inside at the beginning.

Remark 4.5. Note that the controller does not need measurements of P .

The controller given in Eq. (4.36) is called the super-twisting controller. The cor-

responding phase portrait is shown in Fig. 4.8. A sufficient (very crude!) condition

for validity of the theorem is

s

>

2 .Km C C /KM .1 C q/

.Km C /

Km2 .1 q/

(4.37)

Proof. Computing uP with juj > UM yields uP D

1 2

P j j 1=2

u . It follows from

Eqs. (4.34), (4.35) that P u > 0 with juj > UM and thus, uPu < 0, and u moves

4.3 Control of Relative Degree One Systems

157

Fig. 4.9 A majoring curve for the super-twisting controller

towards the segment juj Ä UM . Therefore juj Ä UM is established in finite time, for juPj > UM when juj > UM . Note that a 1-sliding mode with u D Umsign. / could exist during time intervals of constant sign. / (e.g., see Fig. 4.1). The following equation is satisfied with juj < UM ; ¤ 0 :

R D hP C gPu

1P

g 2

j j1=2

g  sign. /

The

trivial

identity

d dt

j

j= P sign.

/ is used here. Note that once more, the values

taken on sets of measure 0 are not accounted for; thus the differentiation is

performed with sign. / D const. The latter equation may be rewritten as

R 2 OE C; C

Â 1
OEKm; KM  2

jPj j j1=2 C sign .

Ã /

(4.38)

This inclusion does not `remember' anything about the original system. Then

similarly to the proof of Theorem 4.1, with > 0, P > 0, the real trajectory

is confined by the axes D 0; P D 0 and the trajectory of the equation R D

.Km C / . Let M be the intersection of this curve with axis P D 0. Obviously,

2 .Km

C/

M

D

P

2 0

(Fig.

4.9).

It

is

easy

to

see

from

Fig.

4.9

that

> 0;

P > 0;

1 2

j

jPj j1=2

>

C Km

C

)R

>0

158

4 Second-Order Sliding Mode Controllers and Differentiators

Thus, the majoring curve with > 0 is constructed from the following curves (Fig. 4.9):

P 2 D 2 .Km C / . M

/

with

P

> 0;

P

2 0

D 2 .Km

Â

Ã

D M with 0 P

2 C C  1=2 Km

Â

Ã

P D PM D

2

C C Km

1=2 M

with

0

Ä

ÄM

C/ M

The condition j P M = P 0j < 1 is sufficient for the algorithm convergence while juj < UM . That condition is rewritten as

2.Km C C /2 2Km2 .Km C /

<

1

Unfortunately, the latter inequality is still not sufficient, for this consideration does not include the possible 1-sliding mode keeping of u D UM . It is easy to see that such a mode is not possible with P > 0. Indeed, in that case u P stays negative and
does not allow any sign switching of u Um. On the other hand, from Eqs. (4.34), (4.35) and juj Ä UM , in such a sliding mode

Km.1 q/UM Ä j P j D g jh=g C uj Ä KM .1 C q/UM

Thus, P 0 Ä KM .1 C q/UM , and the condition



PM P0



<

Km.1 KM .1 C

q/UM q/UM

D Km.1 q/ KM .1 C q/

is sufficient to avoid keeping u D UM in sliding mode. The resulting condition above coincides with Eq. (4.37).
It is now required to prove the finite-time convergence. It is enough to consider only a sufficiently small vicinity of the origin, where juj < UM is guaranteed. Consider an auxiliary variable D h.t; x/ C g.t; x/u1. Obviously, D P at the moments when D 0 , and u1 ! h=g as t ! 1. Thus, D g.h=g C u1/ tends to zero. Starting from the moment when ju1j < UM holds, its derivative P D hP C gPu1 g  sign.x/ satisfies the inequalities

0 < Km C Ä P sign. / Ä KM  C C
P As in the proof of Theorem 4.1, the total variation of is equal to j P i j, is bounded P by a geometric series, and therefore converges. The total convergence time T Ä
j P i j=.Km C / and the proof of the theorem is complete. Note that the accuracy estimations formulated at the end of Sect. 4.2 remain valid for sufficiently small noises and/or sampling intervals. This robustness feature leads to the application of the controller in observation and identification. One of the most important applications is considered in the next Subsection.

4.3 Control of Relative Degree One Systems

159

4.3.2 First-Order Differentiator

The super-twisting controller is used for systems of relative degree 1. In other words it can be used instead of a standard 1-sliding-mode controller in order to avoid chattering. However for relative degree 2 systems a 2-sliding controller, like a twisting one, is needed to stabilize system (4.6) in finite time. In order to avoid the use of P measurements, a differentiator (observer) is needed. Popular linear high-gain observers cannot fulfill this task because they only provide asymptotic stabilization at an equilibrium state. The differentiator needed here has to feature robust exact differentiation with finite-time convergence in the absence of the measurement noise.
Let the input signal f .t/ be a function defined on OE0; 1/ consisting of a bounded Lebesgue-measurable noise with unknown features and an unknown base signal f0.t/ with the first derivative having a known global Lipschitz constant L > 0. The problem is to find real-time robust estimations of f0.t/ and fP0.t/ which are exact in the absence of measurement noise.
Consider the auxiliary system zP0 D v, where v is a control input. Let 0 D z0 f0.t/ and let the task be to keep 0 D 0 in a 2-sliding mode. In that case
0 D P 0 D 0, which means that z0 D f0.t/ and fP0 D v . The system can be rewritten as
P 0 D fP0.t/ C v; jfR0j Ä L
The function fP0 can be not smooth, but its derivative fR0 exists almost everywhere due to the Lipschitz property of fP0. A modification of the super-twisting controller
v D 1j 0j1=2sign. 0/ C z1 zP1 D 2sign. 0/
is applied here. The modification is needed, for neither fP0.t/ nor v is bounded. The resulting form of the differentiator is

zP0 D v D 1 jz0 f .t /j1=2 sign .z0 f .t // C z1 zP1 D 0sign.z0 f .t//

(4.39)

where both v and z1 can be taken as the differentiator outputs.
Theorem 4.6. In the absence of noise for any 0 > L for every sufficiently large 1, both v and z1 converge in finite time to fP0.t/, while z0 converges to f0.t/.
The proof of the theorem is actually contained in the proof of Theorem 4.5. Sufficient crude convergence conditions are

0 > L;

2. 0 C 21. 0

L/2 L/

<

1

(4.40)

160

4 Second-Order Sliding Mode Controllers and Differentiators

Theorem 4.7. Let the input noise satisfy the inequality jf .t/ f0.t/j Ä ". Then the following inequalities are established in finite time for some positive constants
1; 2; 3, depending exclusively on the parameters of the differentiator and L:
jz0 f0.t /j Ä 1"; jz1 fP0.t /j Ä 2"1=2; jv fP0.t /j Ä 3"1=2

Moreover, these asymptotics cannot be improved. Sketch of the proof. Let 0 D z0 f0.t/ , 1 D z1 fP0.t/, then
P 1 D fR0.t / 0sign. 0/ 2 OE L; L 0sign. 0/;

and the differentiator equations in the absence of the input noise may be replaced by the inclusion

P 0 D 1j 0j1=2sign. 0/ C 1 P 1 2 OE 0 L; 0 C Lsign. 0/

(4.41)

Its solutions converge to the origin 0 D 0; 1 D 0 in finite time. With " ¤ 0 inclusion (4.41) turns into

P 0 2 1j 0 C OE "; "j1=2sign. 0 C OE "; "/ C 1 P 1 2 OE 0 L; 0 C Lsign. 0 C OE "; "/

For small " D "0, the trajectories are concentrated in a small set 0 Ä Ä0, 1 Ä Ä1 and stay there forever. Apply a combined transformation of coordinates, time, and parameters:
G W . 0; 1; t; "0/ ! 7 . 2 0; 1; t; 2"0/

Then it is easy to see that the trajectories of inclusion (4.40) are transferred into

the trajectories of tphe same inclusion, but with different noise magnitude " D 2"0.

Now define inequalities

D 0Ä

"="0 2Ä0 D

and get that .Ä0="0/" ,

the Ä

Än1ewDa.tÄtr1a=cptin"g0

invariant /".

set

satisfies

the

Theorem 4.8. Let parameters 1 D 1, 0 D 0 of the differentiator in Eqs. (4.39), (4.40) guarantee exact differentiation with L D 1. Then parameters
1 D 1L1=2 , 0 D 0L are valid for any L > 0 and guarantee the accuracy
level

jz0 f0.t /j Ä 1"; jz1 fP0.t /j Ä 2L1=2"1=2; jv fP0.t /j Ä 3L1=2"1=2

for some positive constants 1; 2; 3. Proof. Denote fQ D f =L, then the following differentiator provides for the exact differentiation of fQ.t/:

zPQ0 D 1jzQ0 fQ.t /j1=2sign.zQ0 fQ.t // C zQ1 zQP1 D 0sign.zQ1 fQ.t//

4.4 Differentiator-Based Output-Feedback 2-SM Control

161

By multiplying by L and defining z0 D LzQ0 , z1 D LzQ1, the statement of the theorem is proven.

The parameter choices 1 D 1:5L1=2, 0 D 1:1L and 1 D L1=2, 0 D 2L are valid, even though they do not satisfy (4.40). The first one of these choices seems to be a good compromise providing a reasonably fast convergence and high accuracy.

Remark 4.6. Note that while v is noisy in the presence of the input noise, z1 is a Lipschitzian signal, but small input noises lead to a small phase delay of z1.

Example 4.1. Suppose that t0 D 0, the initial values of the internal variable z0.0/

and the "measured" input signal f .0/ coincide, and the initial value of the output

signal z1 is zero. The simulation was carried out using the Euler method with measurement and integration steps equaling 10 4.

The proposed differentiator (4.39), (4.40) was compared with a simple linear

differentiator described

by

the

transfer

function

s .0:1sC1/2

.

Such

a

differentiator is

actually a combination of the ideal differentiator and a low-pass filter. The dif-

ferentiator parameters were chosen as 1 D 6, 0 D 8. The output signals f .t/ D sin.t/ C 5t; f .t/ D sin.t/ C 5t C 0:01 cos.10t/; andf .t/ D sin.t/ C 5t C 0:001 cos.30t/ together with the ideal derivatives fP0.t/ are shown in Fig. 4.10. The

linear differentiator is seen not to differentiate exactly. At the same time it is highly

insensitive to any signals with frequency above 30. The proposed differentiator handles properly any input signal f with jfRj Ä 7 regardless the signal spectrum.

4.4 Differentiator-Based Output-Feedback 2-SM Control

We are now able to construct a robust output-feedback 2-sliding mode (2-SM) controller for the system with relative degree 2. Recall that the system is described by the equation and conditions

xP D a.t; x/ C b.t; x/u

@

0

<

Km

Ä

R @u

Ä KM ;

jRj Ä C

The control is to solve the stabilization problem in finite time, only using mea-
surements of . The robust exact differentiation of is always possible due to the boundedness of R 2 OE C; C  C OEKm; KM u with bounded control u. Combining any above 2-sliding controller u D U. ; P / and the differentiator achieves

u D U. ; z1/ zP D 1jz j1=2sign.z / C z1; zP1 D 2sign.z /; 1 D 1:5L1=2; 2 D 1:1L

(4.42)

162

4 Second-Order Sliding Mode Controllers and Differentiators

Fig. 4.10 Comparison of the 2-sliding mode-based differentiator and a linear filter

4.5 Chattering Attenuation

163

Any value L > C CKM sup jU j can be used here. As a consequence of Theorem 4.1 and Theorem 4.6 the controller provides exact stabilization and finite-time convergence. It can be proven that in the presence of a bounded Lebesgue-measurable noise with the maximal mapgnitude ", the steady-state accuracies sup j j and supj P j are proportional to " and ", respectively. Note that in practice the differentiator parameter L is often taken conservatively large to provide for the better closed-loop performance in the presence of noises.
Example 4.2. Consider the dynamic system

xR D sin.14:12t/ C .1:5 C 0:5 cos.21t//u D x;

with C D 1; Km D 1; KM D 2 and the output-feedback control

u D 5 sign z0 3 sign z1 zP0 D 7jz0 xj1=2sign.z0 zP1 D 18sign.z0 x/

x/ C z1

At the time instant t D 0 the initial values z0.0/ D x.0/, z1 D 0 were taken. The trajectory in the plane xxP and the mutual graph of x, xP , and z1 are shown in Fig. 4.11a,b, respectively. The graph of z0 is not shown, since one cannot distinguish it from x. Convergence in the presence of a high-frequency noise with magnitude
0:01 is shown in Fig. 4.11c,d, respectively. The resulting steady-state accuracies are jxj Ä 0:041 and jxP j Ä 0:79.

4.5 Chattering Attenuation

A problem with conventional (first-order) sliding mode control is attenuation of the chattering effect. However 2-sliding mode control provides effective tools for the reduction or even practical elimination of the chattering, without compromising the benefits of the standard sliding mode. Recalling the problem statement from Sect. 4.3.1, let the relative degree of the system (4.5) be 1, and instead of Eqs. (4.8), (4.10) assume

P D h.t; x/ C g.t; x/u; 0 < Km Ä g Ä KM ; jhj Ä C

(4.43)

where the functions g; h are some unknown smooth functions. Let also the control u D k sign . / solve the problem of establishing and keeping Á 0 . In particular, assume that

kKm C > 0

(4.44)

164

4 Second-Order Sliding Mode Controllers and Differentiators

Fig. 4.11 Output-feedback 2-sliding control

Consider uP as a new virtual control, in order to overcome the chattering. Differentiating (4.43) yields

R D h1.t; x; u/ C g.t; x/uP h1 D h0t C hx0 .a C bu/ C gt0 C gx0 .a C bu/ u

Assume that the function h1.t; x; u/ is bounded so that

sup jh1.t; x; u/j D C1
jujÄk1

(4.45)

Any previously discussed controller uP D U.; ; P / can be used here in order to overcome the chattering and improve the sliding accuracy of the standard sliding mode. Indeed, define

uP D

u; juj > k U.; ; P /; juj Ä k

(4.46)

4.5 Chattering Attenuation

165

Theorem 4.9. Let U be any one of the 2-sliding controllers considered in Sect. 4.2, and suppose the controller parameters are properly chosen in accordance with the corresponding convergence conditions. Then for a sufficiently large parameter , the controller (4.46) guarantees the establishment of the finite-time stable 2-sliding mode on D P Á 0.
Proof. It follows from Eqs. (4.43), (4.44) that the inequality j P j < kKm C implies juj Ä k. Thus, within the set j P j < kKm C , the system is driven by the controller uP D U.; ; P /. Controller(4.46) keeps juj Ä k, and on certain time intervals u Á k or u Á k is kept in a 1-sliding mode and the proof of the theorem is complete.
Lemma 4.1. Any trajectory of the system (4.43), (4.46) hits in finite time the manifold D 0 or enters the set P < 0, juj Ä k.
Proof. Indeed, suppose that does not change its sign. Obviously, the inequality juj Ä k is established in finite time. If the condition P < 0 is attained, the statement of the lemma is true. Suppose that P 0 holds, then, according to (4.46), u moves towards u D k sign . / with juPj min .; k/, both if juj > k. or juj Ä k. The conclusion that u D k sign . / can be established only with P < 0 proves the lemma.
Lemma 4.2. With sufficiently large  any trajectory of the system (4.43), (4.46) hits in finite time the manifold D 0.
Proof. Denote by S the set defined by the inequalities j P j < kKm C , P < 0. There is a specific set , for each controller, adjacent to the axis D 0 and lying in the strip S , such that any trajectory entering it either converges in finite time to
D P D 0 or hits the axis D 0; also no trajectory can enter S oÁutside of ,. For example, , is defined by the inequalities P C j j1=2 sign . / Ä 0 and
j P j< kKm C for the controller in Eq. (4.21). Any trajectory starting in S either leaves it in finite time or enters ,. Thus, there are two options: at some moment on a trajectory that stays out of S , which means that j P j kKm C , P < 0, or it enters ,. In both cases the trajectory hits D 0. The lemma is proven.
The following lemma is obviously true for any convergent 2-sliding controller.
Lemma 4.3. There is a vicinity of the origin within the strip j P j < kKm C , which is invariant with respect to the controller uP =U.; ; P /.
Proof. Consider the auxiliary problem when Eq. (4.45) holds independently of the control value and the corresponding differential inclusion. Since all trajectories starting in a closed disk centered at the origin converge to the origin in finite time, the set, which comprises these transient trajectory segments, is an invariant compact for the controller uP D U.; ; P /.
All the proposed controllers produce the closed system (4.11) which is invariant with respect to the transformation
GÄ W .t; ; P / 7 ! Ät; Ä2 ; Ä P

166

4 Second-Order Sliding Mode Controllers and Differentiators

Applying now this transformation, the set can be retracted into the strip j P j < kKm C , where Eq. (4.45) is really kept, and the proof of the lemma is complete.

Lemma 4.4. For a sufficiently large , any trajectory starting on the manifold D 0 with juj Ä k enters the invariant set .

Proof. Any trajectory starting with D 0 and P ¤ 0 inevitably enters the region

P > 0 , juj < k. Within this region uP D  sign . / holds. Hence, the control u

moves towards the value k sign . /, and on the way the trajectory hits the set P D

0, which still features juj < k. From Eq. (4.43), juj Ä k implies the global bound

j P j Ä kKM C C . That restriction is true also at the initial point on the axis D 0.

Simple calculations show that the inequality j

j

Ä

1 2

.kKM

C

C /2

= .K1

C1/

holds at the moment when P vanishes. With sufficiently large  that point inevitably

belongs to .

Once the trajectory enters , it continues to converge to the 2-sliding mode

according to the corresponding 2-sliding dynamics considered in Sect. 4.2. This

proves convergence to the 2-sliding mode. In the presence of small noises and

sampling intervals, the resulting motion will take place in a small vicinity of the

2-sliding mode D P = 0. Thus, if this motion does not leave , the studied

2-sliding dynamics is still in charge, and the corresponding accuracy estimations

remain true. The proof of the lemma is now complete.

4.6 Case Study: Pendulum Control

Consider a variable-length pendulum control problem where all the motions are restricted to some vertical plane. A load of some known mass m is moving along the pendulum rod (Fig. 4.12).
Its distance from the origin O equals R.t/ and is not measured. There is no friction. An engine transmits a torque w that is considered as the control input. The task is to force the angular coordinate x of the rod to follow some profile xc.t/ given in current time. The system is described by the differential equation

RP

1

1

xR D 2 xP R

g R

sin

.x/

C

mR2

w

(4.47)

where g D 9:81m=s2 is the gravitational constant and the mass m is taken as m D 1kg. Let 0 < Rm Ä R Ä RM ; also assume that RP ; RR ; xPc; xRc are bounded and
D x xc is available. The initial conditions are x.0/ D xP .0/ D 0 . The following functions R and xc are considered in the simulation:
R D 1 C 0:25 sin.4t/ C 0:5 cos.t/
xc D 0:5 sin.0:5t/ C 0:5 cos.t/

4.6 Case Study: Pendulum Control

167

Fig. 4.12 Variable-length pendulum

4.6.1 Discontinuous Control

The relative degree of the system is 2. Here condition (4.10) holds only locally, since R juD0 depends on xP and is not uniformly bounded. Thus, the controllers are effective only in a bounded vicinity of the origin x D xP D w D 0. The appropriate
discontinuous controller, Eq. (4.42) based on a quasi-continuous controller, has
the form

wD

10 z1 C j

j1=2sign.

/ ;

jz1j C j j1=2

Dx

xc

(4.48)

zP0 D 10:61 jz0 j1=2 sign.z0 / C z1

(4.49)

zP1 D 55 sign.z0 /

(4.50)

where z0; z1 are real-time estimations of , P , respectively. The differentiator (4.49), (4.50) is exact for the input signal , with a second time derivative not exceeding 50 in absolute value.
The initial conditions x.0/ D xP .0/ D 0 have been taken as z0.0/ D x.0/ xc.0/ D 0:5; z1.0/ D 0. The sampling time step and the integration step have been chosen as 0:0001.
2-sliding tracking performance and trajectory tracking in the absence of noise, are shown in Fig. 4.13a, b, respectively. The corresponding achieved accuracies are j j D jx xcj Ä 5:4 10 6, jxP xPcj Ä 1:0 10 2 with D 0:0001. The control signal associated with Eq. (4.48) is shown in Fig. 4.13c. It is seen from the graph that the control remains continuous until a 2-sliding mode D P D 0 takes place. The differentiator convergence is demonstrated in Fig. 4.13d.

168

4 Second-Order Sliding Mode Controllers and Differentiators

Fig. 4.13 Quasi-continuous pendulum control

The tracking results obtained from using Eqs. (4.48), (4.49), (4.50) and the differentiator performance in the presence of noise with the magnitude 0:01 are demonstrated in Fig. 4.14a, b, respectively. The tracking accuracy is j j D jx xcj Ä 0:036 (the noise is a periodic non-smooth function with nonzero average). The performance does not significantly change, when the frequency of the noise varies from 101=s to 1000001=s.
Any other 2-sliding controller could also be implemented. Consider a twisting controller

w D 10 sign.z0/ 5 sign.z1/

(4.51)

The trajectory of the twisting controller (4.49)­(4.51) in the coordinates x xc and
xP xPc, in the absence of noise, is shown in Fig. 4.15b. The corresponding accuracy is jx xcj Ä 6:7 10 6; jxP xPcj Ä 0:01.

4.6 Case Study: Pendulum Control

169

Fig. 4.14 Performance of the quasi-continuous controller with noisy measurements

4.6.2 Chattering Attenuation

In the case when torque chattering is unacceptable, u = wP is considered as a new control. Define
D .xP xPc/ C 2 .x xc/
Again, the relative degree of the system with respect to the new input w is equal 2. Also condition (4.10) holds only locally, and thus the controllers are effective only in a bounded vicinity of the origin x D xP D w D 0. Their global application requires the standard method described in Sect. 4.5, which is not implemented here for simplicity.
The applied output-feedback controller is of the form Eq. (4.42) and is based on the twisting controller (4.13):

wP D u D 15 sign .z0/ 10 sign.z1/ zP0 D 35 jz0 j1=2 sign .z0 / C z1 zP1 D 70 sign .z0 / ; D .xP xPc/ C 2 .x xc/

(4.52) (4.53) (4.54)

Here the angular velocity xP is assumed to be directly measured.1 The initial values x.0/ D xP .0/ D 0 are taken in the simulations. The value
w.0/ D 0 is taken for controller (4.52)­(4.54), and the sampling step D 0:0001. The trajectory in the coordinates x xc and xP xPc, in the absence of noise, is shown in Fig. 4.15a. The accuracy jx xcj Ä 1:6 10 6; jxP xPcj Ä 1:8 10 5 has been achieved. The trajectories in the presence of noise with magnitude 0:02 in

1Otherwise, a 3-sliding controller can be applied together with a second-order differentiator (see chap. 6) producing both xP xPc and xR xRc.

170

4 Second-Order Sliding Mode Controllers and Differentiators

Fig. 4.15 Pendulum output-feedback twisting control, a,c,d: D .xP xPc/ C 2.x xc/, b: D x xc
the -measurements are shown in Fig. 4.15c, and the tracking results are shown in Fig. 4.15d. The tracking accuracy jx xcj Ä 0:018; jxP xPcj Ä 0:16 is achieved. The performance does not differ when the frequency of the noise changes from 101=s to 100001=s.
4.7 Variable-Gain Super-Twisting Control
An extension of the standard super-twisting algorithm for the conventional two-step SM control design procedure that provides exact compensation of smooth uncertainties/disturbances bounded together with their derivatives by known functions is considered in this section.

4.7 Variable-Gain Super-Twisting Control

171

4.7.1 Problem Statement

Consider a linear time-invariant system (LTI) with a matching nonlinear perturbation

xP D Ax C B.u C .x; t//

(4.55)

where x 2 Rn is the state vector, u 2 Rm is the control input, the A and B are constant matrices of appropriate dimensions, and is an absolutely continuous uncertainty/disturbance in the system (4.55). As in Chap. 2 the system in Eq. (4.55) is first transformed into regular form. The following properties are assumed:

(A1) Rank B D m. (A2) The pair .A; B/ is controllable. (A3) The function together with its gradient is bounded by known continuous
functions almost everywhere.

Under assumptions (A1) and (A2), after the linear state transformation,

! z1 D T x ; z2

T

D

Ä B

?

BC

; BC D .BT B/ 1BT ; B?B D 0

(4.56)

system (4.55) has the regular form

zP1 D A11z1 C A12z2 zP2 D A21z1 C A22z2 C u C Q .z1; z2; t /

(4.57)

where z1 2 Rn m and z2 2 Rm. The structure of the system allows us, without loss of generality, to restrict ourselves to the single input case (m D 1). The results are easily extended to the multi-input case. The sliding surface is chosen to have the form

D z2 Kz1 D 0

(4.58)

As a consequence, when the motion is restricted to the manifold, the reduced-order model

zP1 D .A11 C A12K/ z1

(4.59)

has the required performance. Since the pair .A11; A12/ is controllable, the matrix K can be designed using any linear control design method for system (4.59); see, for example, Chap. 2. Using .z1; / as state variables and applying the controller

u D .A21 C A22K K .A11 C A12K// z1 .A22 KA12/ C v (4.60)

system (4.57) takes the form

zP1 D .A11 C A12K/ z1 C A12 P D v C Q .z1; C Kz1; t/

(4.61) (4.62)

172

4 Second-Order Sliding Mode Controllers and Differentiators

When the perturbation is bounded by a known function % .x/

j .x; t/j Ä % .x/

(4.63)

a (first-order) sliding mode can be enforced by a variable-gain controller

v D .% .x/ C %0/ sign . /

(4.64)

with %0 > 0. Alternatively, unit vector controllers can also be used for this purpose (see Chap. 2). The main disadvantage of these controllers is that they produce chattering, which grows with the uncertainty bound % .x/.
Here a Lyapunov-based design is employed.

4.7.2 The Variable-Gain Super-Twisting Algorithm

The variable-gain super-twisting algorithm (VGSTA) proposed here is given by

Zt

v D k1 .t; x/ 1 . /

k2 .t; x/ 2 . / dt

0

(4.65)

where

1. /

D

j

j

1 2

sign

.

/ C k3

2. /

D

1 2

sign

.

/

C

3 2

k3

j

1
j 2 sign .

/ C k32

;

k3 > 0

When k3 D 0 and the gains k1 and k2 are constant, we recover the standard super-twisting algorithm. The additional term k3 > 0 allows us to deal with perturbations growing linearly in s, i.e., outside of the sliding surface, and the variable gains k1 and k2 make it possible to render the sliding surface insensitive to perturbations growing with bounds given by known functions. Note that the uncertainty/disturbance can always be written as

Q .z1;

h C Kz1; t/ D Q .z1;
,,

i

C Kz1; t/ ,

Q

.z1

;

K

z1;

t

/ ...

C

Q ,,

.z1

;K,z1;

t.../

g1.z1; ;t /

g2.z1;t /

where g1 .z1; ; t/ D 0; when D 0. It follows from assumption (A3) that the uncertainty/disturbance .x; t/ is bounded almost everywhere:

jgd1
dt

.z1; ; g2 .z1;

tt//j

Ä Ä

%1 %2

.t; .t;

x/ x/

j j

1. 2.

/j /j

where %1 .t; x/ 0, %2 .t; x/ 0 are known continuous functions.

(4.66)

4.7 Variable-Gain Super-Twisting Control

173

System (4.62) driven by the VGSTA (4.65) can be written as

zP1 D .A11 C A12K/ z1 C A12

P D k1 .t; x/ 1 . / C z C g1 .z1; ; t/

zP0 D

k2 .t; x/

2.

/

C

d dt

g2

.z1;

t/

(4.67)

The algorithm is presented in the following theorem:

Theorem 4.10. Suppose that for some known continuous functions %1 .t; x/ 0, %2 .t; x/ 0 the inequalities (4.66) are satisfied. Then for any initial condition .z1.0/; .0/; z0.0// the sliding surface D 0 will be reached in finite time if the
variable gains are selected as

k1 .t; x/

D

i

C

1 

1 4

.2

%1 C %2/2 C

C2

%2 C

C .2 C %1/  C 4 2

k2 .t; x/ D  C 4 2 C 2 k1 .t; x/

(4.68)

where  > 0, > 0, i > 0 are arbitrary positive constants. The reaching time of

the sliding surface can be estimated by

where V .

; z0/ D

Â

Ã

T D 2 ln

2V

1 2

.

.0/; z0.0// C 1

2

1

h

TP

; with

TD

j

1
j 2 sign .

/ C k3

;

i z0 and

(4.69)

1

1D

2
min

fP

g

;

max fP g

2D

2 k3 max fP g

Proof. We will show that the quadratic form

(4.70)

V . ; z0/ D T P

(4.71)

where

h

i

TD

j

1
j 2 sign .

/ C k3

;

z0

(4.72)

and

Ä

Ä

P D p1 p3 D  C 4 2 ; 2

p3 p2

2

1

(4.73)

with arbitrary positive constants  > 0, > 0, is a Lyapunov function for the

subsystem . ; z0/ of Eq. (4.67), showing finite-time convergence. Function (4.71)

is positive definit°e, everywhere continu«ous, and differentiable everywhere except on the set S D . ; z0/ 2 R2 j D 0 . The inequalities (4.66) can be rewritten

as g1 .z1;

; t/

D

1 .t; x/

1.

/

and

d dt

g2

.z1;

t

/

D

2 .t; x/

2.

/ for some

174

4 Second-Order Sliding Mode Controllers and Differentiators

functions j1 .t; x/j Ä %1 .t; x/ and j2 .t; x/j Ä %2 .t; x/. Using these functions

and noting that

2. /D

0 1

.

/

1 . / one can show that

Ä PD

0 1

.

/ f k1 .t; x/ 1 . / C z0 C g1 .x; t/g

k2 .t; x/

2.

/

C

d dt

g2

.x;

t/

Ä

D

0 1

.

/

.k1 .t; x/ 1 .t; x// ; 1 .k2 .t; x/ 2 .t; x// 0

D

0 1

.

/ A .t; x/

for every point in R2nS, where this derivative exists. Similarly one can calculate the derivative of V .x/ on the same set as

VP . ; z0/ D

0 1

.

/

T

AT .t; x/ P C P A .t; x/

D

0 1

.

/

T Q .t; x/

where

Ä

Q .t; x/ D

2 .k1 .t; x/ 1/ p1 C 2 .k2 .t; x/ 2/ p3 .k1 .t; x/ 1/ p3 C .k2 .t; x/ 2/ p2 p1 ;

F 2p3

Selecting P as in Eq. (4.73) and the gains as in Eq. (4.68), we have

Ä

Q

2 ID

2k1 C 4 .2 k1 k2/ 2  C 4 2 1 C 4 2 k2 2 k1  C 4 2 C 2 1 2 ;

2

F 2

Ä D 2k1

 C 4 2 .4 C 21/ C 4 2 2

F

2 1 2 ;

2

that is positive definite for every value of .t; x/. This shows that

VP D

0 1

.

/

T Q .t; x/

Ä

2

0 1

.

/

T

D

2

!

1 1 C k3

T

2j j2

Since min fP g k k22 Ä T P Ä max fP g k k22 ; where

k k22 D

2 1

C

2 2

D

j

j C 2k3 j

3
j2

C k32

2 C z20

is the Euclidean norm of , and

j

1j Ä k

k2

Ä

V

1 2
1

.

; z0/

2
min

fP

g

4.7 Variable-Gain Super-Twisting Control

175

we can conclude that

VP Ä

1
1V 2 . ; z0/

2V . ; z0/

1

1D

2
min

fP

g

;

max fP g

2D

2 k3 max fP g

(4.74)

°

«

Note that the trajectories cannot stay on the set S D . ; z0/ 2 R2 j D 0 . This

means that V is a continuously decreasing function and we can conclude that the

equilibrium point . ; z0/ D 0 is reached in finite time from every initial condition.2

Since the solution of the differential equation

vP D

1
1v 2

2v ; v.0/ 0

is given by

v.t/ D exp .

Ä

2t/

1
v.0/ 2

C

1

1

2

ÁÁ 2 exp 2 t
2

it follows that . .t/ ; z0 .t// converges to zero in finite time and reaches that value at most after a time given by Eq. (4.69). This concludes the proof of Theorem 4.10.
Remark 4.7. Theorem 4.10 proposes a methodology to design a sliding mode controller ensuring a sliding motion on the surface (4.58) substituting the discontinuous control law (4.64) by an absolutely continuous VGSTA (4.65). In this case the chattering level can be substantially reduced.
When .x/ D const, first-order sliding mode controllers (4.64) are able to compensate the bounded perturbations .x.t/; t/ measurable along the system trajectories. On the other hand the super-twisting algorithm with constant gains k1 and k2 is able to compensate for the Lipschitz continuous perturbations .x; t/ along the system trajectories, but their absolute value cannot grow faster than a
1
linear function of t, nor faster than linear with respect to j .t/j 2 along the system trajectories. Theorem 4.10 extends the VGSTA design for the class of perturbations (4.66).

2For details see Zubov's stability theorem [196].

176

4 Second-Order Sliding Mode Controllers and Differentiators

4.8 Case Study: The Mass­Spring­Damper System

4.8.1 Model Description

The mass­spring­damper (MSD) system consists of two masses, three springs, one damper, and a DC motor in the configuration shown in Fig. 4.16. The system is the Educational Control Products (ECP) model 210a.
The dynamics of the system are given by the following set of ordinary differential equations:

m2 R 2 C .Ä3 C Ä2/ 2 C c1 P 2 Ä2 1 D 0

(4.75)

m1 R 1 C .Ä1 C Ä2/ 1 Ä2 2 D F

(4.76)

where 1; P 1; R 1; 2; P 2; R 2 are the position, velocity, and acceleration of the masses 1 and 2, respectively. The term F is the force that the DC motor inputs into mass 1.

The state vector is selected as x1 D 1, x2 D P 1, x3 D 2, and x4 D P 2, and the input u D F . The state space representation is

xP1 D x2

xP2 D

Ä1 m1

x1

Ä2 m1

x1

C

Ä2 m1

x3

C

1 m1

u

xP3 D x4

xP4 D

.Ä

3

C m2

Ä

2

/

x3

c1 m2

x4

C

Ä2 m2

x1

(4.77) (4.78) (4.79) (4.80)

The nominal values are shown in Table 4.1.

It is possible to measure the positions x1; x3 through the encoders that are coupled to mass 1 and mass 2 respectively.

Fig. 4.16 The mass­spring­damper (MSD) system

Table 4.1 Model Nominal Values

Name m1 m2 Ä1

Ä2

Value 1.28 1.05 190

780

Units OEkg OEkg OEN=m OEN=m

Ä3 450 OEN=m

c1 15 OEN s=m

4.8 Case Study: The Mass­Spring­Damper System

177

Fig. 4.17 The mass­spring system with disturbance

4.8.2 Problem Statement

To design the control we will consider just the mass m1 and the spring Ä1 as part of the system and everything else is considered a disturbance as shown in Fig. 4.17. This configuration yields the state-space representation

xP1 D x2

xP2 D

Ä1 m1

x1

C

1 .u
m1

C

w/

(4.81) (4.82)

where

w D Ä2.x3 x1/

(4.83)

The goal of the control is to track the desired position OExd ; 0T where xd is constant. To work at the equilibrium point instead of the point OExd ; 0T the following change
of coordinates can be applied:

Ä xN1 xN2

Ä

D

x1 xd

x2

and using the control law u D Ä1xd C u1 we can obtain the system

xNP1 D xN2

xNP2 D

Ä1 m1

xN1

C

1 m1

.u1

C

w/

(4.84) (4.85)

such that when xN D 0 then OEx1; x2T D OExd ; 0T . System (4.85) satisfies assumptions (A1) and (A2) and therefore it can be transformed to the regular form using

Eq. (4.56) so that

Ä z1 z2

Ä

Ä

D

b0 0 b1

xN1 xN2

(4.86)

178

4 Second-Order Sliding Mode Controllers and Differentiators

where

b

D

1 m1

.

Using

Eq. (4.56),

system

(4.85)

is

transformed

into

zP1 D b2z2

zP2 D

Ä1 b

z1

C

u1

C

w

The control aim now is to stabilize the origin of system.

(4.87) (4.88)

4.8.3 Control Design

Let us design the sliding surface as

D z2 C Kz1

(4.89)

such that when the motion is restricted to the manifold, the reduced-order dynamics will have the desired performance

zP1 D b2Kz1

and the desired value will be tracked exponentially z1 D C1e Kb2t

Secondly we want to change the state variables .z1; z2/ to .z1; /. Taking into account (4.89) we can write z2 as

z2 D

K z1

and P as

P D zP2 C KzP1 Then using Eqs. (4.90) and (4.91) we can easily construct the input

u1 D

K.

b2Kz1 C b2

/

C

Ä1 b

z1

C

v

that will transform the system into

(4.90) (4.91) (4.92)

zP1 D b2Kz1 C b2 P DvCw

(4.93) (4.94)

where v is the virtual control established in Eq. (4.65). To select the bounds for the disturbance, we can write (4.83) in terms of .z1; / as

w.t; z1/ D Ä2x3.t / Ä2bz1

(4.95)

4.9 Notes and References

179

where the term x3.t/ is considered as exogenous, and only x1 belongs to system (4.82). From Eq. (4.95) we can obtain the terms g1 and g2 as

g1.z1; ; t/ D 0

(4.96)

g2.z1; t / D Ä2x3.t / Ä2bz1

(4.97)

dg2.z1; t / dt

D

Ä2x4.t /

Ä2bzP1

(4.98)

dg2.z1; t / dt

D

Ä2x4.t /

Ä2b.b2

b 2 K z1 /

(4.99)

Next %1 and %2 are selected to accomplish the restriction (4.66). Since j'2.

/j

>

1 2

everywhere except on D 0 we can select %1 and %2 as follows %1 D 0 and

%2 D 2OEÄ2x4.t / Ä2b.b2 b2Kz1/

(4.100)

Finally we use the inverse transform

Ä

Ä

0 b

u1

D T1

0 1

u1

4.8.4 Experimental Results
The total time of the experiment was 10OEs and the desired position was xd D 1OEcm, This position is demanded when t D 0:5OEs. The parameters i, , and of the variable gains k1 and k2 and the fixed gain k3 are selected as i D 0:001,  D 4:1,
D 0:11, and k3 D 8, and the parameter K from the sliding surface (4.89) is selected as K D 3. The reference xd is reached despite the disturbance as can be seen in Figs. 4.18 and 4.19. Chattering is completely eliminated (see Fig. 4.18). This result is achieved with a sampling time of Ts D 1OEms. The behavior of is shown in Fig. 4.20 and the VGSTA output is shown in Fig. 4.21.
4.9 Notes and References
The twisting controller [75, 132] was historically the first 2-sliding mode controller to be proposed. The suboptimal controller appears first in [18, 20]. The controller with prescribed convergence law was proposed in [75, 132]. The quasi-continuous control algorithm is proposed in [127, 128]. In the particular case when
Á u D  sign P C  j j1=2 sign . / ; ;  > 0; Km C > 2=2 (4.101)

180

4 Second-Order Sliding Mode Controllers and Differentiators

Fig. 4.18 Output of the system tracking xd D 1OEcm

Fig. 4.19 Zoom of the system output tracking xd D 1OEcm Fig. 4.20 The sliding surface

4.9 Notes and References

181

Fig. 4.21 The output of the VGSTA
the controller given in Eq. (4.101) is similar to so-called terminal sliding mode controllers [138]. An alterative detailed proof of Theorem 4.2 can be found in [17].
The long-standing concern associated with conventional sliding mode control is the attenuation of the so-called chattering effect. Many different approaches have been suggested: see, for example, [29, 31, 87­90, 98, 171]. However, 2-sliding mode control ideas provide effective tools for the reduction or even practical elimination of the chattering without compromising the benefits of conventional sliding modes: see, for example, [18,20,31,33­35,125,132]. Additional information about 2-sliding mode controllers and differentiators can be in [15, 16, 19, 122, 153].
Theorem 4.8 is based on the results presented in [123]. The accuracy estimations formulated in Theorem 4.8 remain valid in the presence of sufficiently small noise and/or sampling intervals. Note that although Theorem 4.9 is not formulated for arbitrary 2-sliding homogeneous controllers, it is valid for all standard 2-SM controllers [20, 132]. It can be shown that the chattering phenomenon is indeed mitigated by means of this procedure. Moreover, noise caused by unaccounted-for fast stable actuators and sensors does not produce chattering. Theorem 4.10 extends the Lyapunov-based design method from [142] for the standard twisting algorithm in order to include (i) linear (nonhomogeneous) terms and (ii) variable gains, in order to alleviate the drawbacks of the standard twisting algorithm. The use of the Lyapunov method is instrumental here, since neither geometric or homogeneity based proofs can be used to deal with these extensions [12, 126]. Section 4.9 presents the results of the paper [101]. It is a particular case of the Lyapunovbased approach to the second-order sliding mode control design presented by Moreno in [142, 143]. Based on this approach fixed-time convergent controllers and differentiators [51, 152] are developed ensuring a uniform convergence time with respect to initial conditions. Such algorithms being applied to hybrid and switched systems with strictly positive dwell-time can ensure the convergence of observers and controllers before the system jumps of switches.

182
4.10 Exercises

4 Second-Order Sliding Mode Controllers and Differentiators

Exercise 4.1. Prove the local asymptotic convergence of the trajectories of

Eqs. (4.1), (4.3) to the 2-sliding mode x D 0; u D 1=2 for any a > 2.

Hint:

consider

the

Lyapunov

function

V .x/

D

jxj

C

1 2a

.u

sin.x C =6//.

Exercise 4.2. List all the controllers from Sect. 4.2 capable of making the output x of the perturbed pendulum xR D sin.x/ C f .t/ C u; j f .t/j Ä 1 exactly follow any real-time available function xc.t/ with jxRcj Ä 1.

Exercise 4.3. Locally solve the previous problem with jxP j < 2 to provide asymp-

ctootnictraolllylere.xAacsstutmraeckthinegabddyitmioenaanlscoonf dciotinotninsuofuPs

control, Ä 1, jx«cj

using Ä 2;

the super-twisting xP hold. Hint: Keep

the constraint xP C x D 0.

Exercise 4.4. Solve the previous problem of asymptotically exact tracking, by means of continuous control, using the controllers from Sect. 4.2. Both xP and xR are assumed to be available.

Exercise 4.5. Choose the parameters of the differentiator (4.38), (4.39) to facilitate the exact differentiation of the signal f D cos.2.3t 5// C 4t.

Exercise 4.6. Check the solution of the previous problem by means of computer simulation. Introduce arbitrary noise of the magnitude 0:01 and check the robustness of the differentiator in the presence of nosie of different frequencies (e.g., one can take the "noise" 0:01si n.!t/ or any other periodic function, even discontinuous).

Exercise 4.7. Solve problems 4.2, 4.3 by means of output-feedback controllers.

Exercise 4.8. Solve problem 4.4 using a differentiator assuming that xP is available.

Exercise 4.9. Verify the solutions of problems 4.7, 4.8 by computer simulation. In addition introduce small measurement noise.

Chapter 5
Analysis of Sliding Mode Controllers in the Frequency Domain

Conventional sliding mode control, studied in Chap. 2, and second-order sliding mode control (Chap. 4) are the most obvious choices in controlling systems with bounded matched disturbances/uncertainties. Sliding mode control laws allow us achieve to insensitivity of system's compensated dynamics to these perturbations. The ultimate price for this insensitivity is a high-frequency (that is equal to infinity in an ideal sliding mode) switching control function that after being filtered by the plant yields self-sustained oscillations of almost zero amplitude. The main advantage of higher (second-)order sliding mode control is its ability to guarantee higher accuracy of the sliding variable stabilization at zero than conventional sliding mode control. Both conventional and second-order sliding mode control laws are derived (see Chaps. 2 and 4) assuming that the relative degree is equal to one in the case of conventional sliding mode control and equal to two for the case of second-order sliding modes. However, any real plant and any real switching element will contain parasitic dynamics that are not taken into account in the system's mathematical model. These parasitic dynamics increase the system's relative degree and could yield control chattering, i.e., self-sustaining oscillations of lower frequency and nonzero amplitude, causing degradation in the system's performance. In this chapter the robustness of the system in a sliding mode with respect to parasitic dynamics is studied using the describing function technique. This approximate technique is useful from a practical point of view for the analysis of self-sustained oscillation (limit cycles) as soon as the transient response is over.

5.1 Introduction

The phenomenon of chattering is caused by the inevitable existence of so-called parasitic or unmodeled dynamics that exist along with the principal dynamics of the plant. The principal dynamics are the dynamics of the plant model that are used for the SMC design. However, to implement the designed control algorithms, devices such as actuators and sensors are needed. These devices bring into the system certain

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

183

DOI 10.1007/978-0-8176-4893-0 5, © Springer Science+Business Media New York 2014

184

5 Analysis of Sliding Mode Controllers in the Frequency Domain

parasitic dynamics that are not accounted for during the SMC design and which are treated as unmodeled dynamics at this step. Since the parasitic dynamics are usually connected in series with the principal dynamics, the combined relative degree of the actuator­plant­sensor becomes equal to the sum of the plant relative degree, the actuator relative degree, and the sensor relative degree.
It is known that conventional SMC in systems with parasitic dynamics of relative degree two or higher exhibit chattering.1 For the same reason, it is logical to expect a similar behavior from systems with 2-SM controllers, as the above-mentioned 2-SM algorithms contain the sign function or infinite gains. In this chapter systems controlled by conventional SMC and all principal 2-SM controllers are analyzed in the frequency domain, while the parasitic/unmodeled dynamics are taken into account. The goal of this study is to analyze the robustness of the conventional SMC and the major 2-SM controllers, including the continuous super-twisting algorithm (see Chaps. 2 and 4), to parasitic/unmodeled dynamics by detecting possible self-sustained oscillations (limit cycles) and estimating their parameters (such as amplitude and frequency) via describing function (DF) techniques (see Appendix B). It is worth noting that the DF method provides only an approximate solution.2

5.2 Conventional SMC Algorithm: DF Analysis
Conventional SMC techniques rest on the concept of switching the system's structure in order to force the trajectory of the system to a switching surface and to maintain the system's motion on this surface thereafter. The system's motion on the sliding surface appeared to be insensitive to bounded model uncertainties and external disturbances (see Chap. 2). However, the robustness of conventional SMC to parasitic/unmodeled dynamics requires special consideration. It is expected that these dynamics may cause control chattering, which yields limit cycles and degradation in the system's performance. In many systems chattering is highly undesirable especially after the transient response is over. An analysis of selfsustained oscillations (limit cycles) in linear time-invariant systems with SMC and parasitic dynamics, via DF technique, is presented in this section. The linear system's principal dynamics are assumed to be given in Brunovsky's canonical form:

1This agrees with the classical research work on relay feedback systems theory [9, 181], where it was proven that for the plant of order 3 and higher the equilibrium point in the origin cannot be stable.
2There exists a method named the locus of a perturbed relay system Locus of Perturbed Relay System (LPRS) [29] that gives an exact analysis of limit cycles in perturbed relay systems. However, the LPRS method is computationally much more intensive than DF method. Conversely, the DF method is simple and efficient and provides accuracy sufficient for the analysis of practical systems.

5.2 Conventional SMC Algorithm: DF Analysis

185

where

xP .t/ D Apx .t/ C Bpu .t/

2

3

0 1 0 ::: 0

Ap D 664

0 ::

0 ::

1 ::: :: : : :

0 ::

577

a0 a1 a2 : : : an 1

(5.1)

23 0

Bp D 6664

0 :::

7757

b

It is assumed that the characteristic polynomial

P . / D n C an 1 n 1 C : : : C a1 C a0

of system in (5.1) is Hurwitz. The sliding variable is designed to have the form

D xn C cn 1xn 1 C C c1x1

(5.2)

The relative degree of the sliding variable in (5.2) is equal to one. Therefore, any conventional SMC that drives the sliding variable to zero in finite time can be designed by satisfying the sliding mode existence condition:

PÄ j j

(5.3)

The sliding mode control law is chosen as

u.t/ D Umsign. /

(5.4)

where the modulation amplitude Um > 0 is assumed to be chosen large enough. The system's (5.1) dynamics in the sliding mode D 0 are derived:

8

^^^^^<

xP1 D x2 xP2 D x3

^^^^^:

::: xPn 1 D c1x1 c2x2 xn D c1x1 c2x2

cn 1xn 1 cn 1xn 1

(5.5)

In an ideal sliding mode, the frequency of switching of the control function (5.2) and (5.4) is infinite, while the sliding variable (5.2) oscillates with zero amplitude, and the state variables are continuous. However, parasitic dynamics may constrain the system's motion only to some vicinity of the switching surface j j Ä " > 0 (a real sliding mode). In a real sliding mode, systems with SMC and parasitic dynamics can exhibit lower frequency self-sustained oscillation (chattering).

186

5 Analysis of Sliding Mode Controllers in the Frequency Domain

Fig. 5.1 Block diagram of a linear system with relay control and ideal sliding

Ideal Sliding Mode Analysis via DF Technique

The block diagram of the system (5.1), (5.2) and (5.4) is shown below in Fig. 5.1. The transfer function of the plant is identified as

G.s/ D

.s/ u.s/

D

b

sn 1 C cn 1sn 2 C : : : C c2s C c1 sn C an 1sn 1 C : : : C a1s C a0

(5.6)

Assume that there exists a periodic motion (self-sustained oscillations or a limit cycle) with amplitude Ac and oscillation frequency !c in some vicinity of the switching surface (5.2) j j Ä " where " > 0 in the system. In the frequency domain analysis we replace the Laplace variable s by j !, where ! is the frequency. Thus we assume that the following equation is valid:

D Ac sin.!c /

(5.7)

The amplitude Ac and the oscillation frequency !c have to satisfy the harmonic balance equation (see Appendix B)

G.j !/ D

1

(5.8)

N.A; !/

where the describing function of the relay nonlinearity is identified as follows:

N.A; !/ D 4Um

(5.9)

A

Definition 5.1. A strictly stable linear system3 with a transfer function (5.6) will be strictly passive if and only if

3For details see [100].

5.2 Conventional SMC Algorithm: DF Analysis

187

jarg G.j !/j < 8! 2 OE0; 1/ 2

(5.10)

It is obvious that the phase characteristic of the transfer function (5.6) satisfies the following equality:

lim OEarg G.j !/ D

as ! ! 1

2

lim OEarg G.j !/ D 0 as ! ! 0

(5.11)

Assume that the coefficients c1; c2; : : : ; cn 1 have been selected so that the passivity condition (5.10) is met. Then there exists a unique solution: the magnitude Ac D 0 and the frequency !c ! 1 of Eqs. (5.8) and (5.9). This fact is illustrated in the following example.
Example 5.1. Let the plant be given by the following equations:

xP1 D x2 xP2 D x1 x2 C u
D x1 C x2

(5.12)

with control

u D sign. /

(5.13)

In accordance with Fig. 5.1

sC1 G.s/ D
s2 C s C 1

(5.14)

and the harmonic balance condition is given by two equations that equate the real and imaginary parts of Eq. (5.8):

A Re OEG.j ! D
4Um

(5.15)

i.e.,

1 .1

! C !2 !2/2 C !2

D

A 4Um

and

!2 .1 !2/2 C !2 D 0

(5.16)

The obvious solution of Eq. (5.15) and (5.16) is Ac D 0; !c ! 1

(5.17)

188

5 Analysis of Sliding Mode Controllers in the Frequency Domain

Fig. 5.2 Graphical solution of the harmonic balance equation for system G.s/. (a) Graphical solution. (b) Surface
This solution can be interpreted as a limit cycle with infinity frequency and zero amplitude that is expected in systems with ideal sliding mode control. The DF method does not give the opportunity to identify finite time or asymptotic convergence to the predicted limit cycle. A simple criterion for finite time convergence is achieved if the angle between the high-frequency asymptote of the Nyquist plot of the plant and the low-amplitude asymptote of the negative reciprocal of the describing function of the nonlinear element, the so-called phase deficit, is greater than zero. The graphical solution of the harmonic balance Eq. (5.8) that is presented in Fig. 5.2 confirms the solution given by (5.17) and also finite time convergence.

5.2 Conventional SMC Algorithm: DF Analysis

189

Fig. 5.3 Block diagram of linear system with relay control and parasitic dynamics

Real Sliding Mode Analysis via Describing Function Technique

Now system (5.1), (5.2) and (5.4) with parasitic dynamics is considered. The block diagram of this system is shown in Fig. 5.3 and the transfer function of the parasitic dynamics is

D.s; d/ D sk C dk

1sk

d0 1 C : : : C d1s C d0

(5.18)

where the characteristic polynomial Pd . / D k C dk 1 k 1 C : : : C d1 C d0 is Hurwitz.

In the system with parasitic dynamics given in (5.18) the relative degree of the sliding variable (5.2) is based on the combined principal (5.1) and parasitic dynamics (5.18) and is equal to k C 1. Consequently, the sliding mode existence

condition (5.3) cannot be met, which is why only a real sliding mode can exist in

such a system.

Suppose the coefficients in the equation of the switching surface (5.2) are chosen such that the passivity condition (5.10) is met. It is obvious that the phase frequency

characteristic of the transfer function D.s; d/G.s/ satisfies the following:

lim OEarg D.j !; d/G.j !/ D .k C 1/ as ! ! 1 2

(5.19)

Therefore, the transfer function D.s; d/G.s/ is not passive for all k 1. Assume that in the real sliding mode there exist self-sustained oscillations (limit cycle) with amplitude Ac and oscillation frequency !c in the system given by the block diagram

190

5 Analysis of Sliding Mode Controllers in the Frequency Domain

presented in Fig. 5.3. The amplitude Ac and the frequency of the oscillations !c can be computed based on the equation of harmonic balance:

D.j !; d/G.j !/ D

1 ; N.A; !/ D 4Um

N.A; !/

A

(5.20)

Assuming k D 1 it is obvious that there exists a unique solution: the magnitude Ac D 0 and the oscillation frequency !c ! 1. Real sliding mode control using the DF technique is illustrated in the next example.
Example 5.2. Let the plant with the actuator model be given by the following equations:

xP1 D x2 xP2 D x1 x2 C u
0:01uPa D ua C u D x1 C x2

(5.21)

and the controller given by

u D sign. /

(5.22)

In accordance with Fig. 5.3 we have

D.s; d /G.s/

D

.0:01s

sC1 C 1/.s2 C

s

C

1/

(5.23)

The solution for the harmonic balance equation for the system associated with D.s; d /G.s/ is presented in Fig. 5.4.
Based on Fig. 5.4 we can conclude that the existence of an asymptotic limit cycle with Ac D 0 and !c ! 1 is predicted.
Assuming k D 2, it is obvious that there exists a unique solution with magnitude Ac > 0 and frequency 0 < !c D C < 1 to Eq. (5.20). This fact is graphically illustrated in the following example.

Example 5.3. Let the plant with the actuator be given by the following equations:

xP1 D x2 xP2 D x1 x2 C u

(5.24)

0:0001uRa D 0:01uPa ua C u D x1 C x2

The solution for the harmonic balance equation for system D.s; d/G.s/ is presented in Fig. 5.5a. Figure 5.5b shows a zoom of the intersection between G.j !/ and

5.2 Conventional SMC Algorithm: DF Analysis

191

Fig. 5.4 Graphical solution of the harmonic balance equation for the system D.s; d/G.s/ with a first-order actuator. (a) Graphical solution. (b) Graphical solution zoom. (c) Surface

192

5 Analysis of Sliding Mode Controllers in the Frequency Domain

Fig. 5.5 Graphical solution of the harmonic balance equation for system D.s; d/G.s/ with second-order actuator. (a) Graphical solution. (b) Graphical solution zoom. (c) Surface

5.3 Twisting Algorithm: DF Analysis

193

N.A; !/ 1 where we can see the value of the oscillation parameters. Based on Fig. 5.5b, c we can conclude the existence of a limit cycle with Ac D 0:0127 and !c D 100.rad=sec/.
The results of the presented analysis are summarized in the following proposition:
Proposition 5.1. If the switching surface (5.2) is designed to make the transfer function (5.6) strictly passive and the stable parasitic dynamics are given by Eq. (5.18), then in the system given by Eqs. (5.1), (5.2), (5.4) and (5.18) there exist:
(a) An ideal sliding mode for k D 0 (b) An asymptotic sliding mode for k D 1 (c) A real sliding mode with chattering for k 2

5.3 Twisting Algorithm: DF Analysis

The twisting algorithm (see Chap. 4) is one of the simplest and most popular algorithms among the second-order sliding mode algorithms. There are two ways of using the twisting algorithm: to apply it to the principal dynamics of a system of relative degree two or to apply it to the principal dynamics of a system of relative degree one and introduce an integrator in series with the plant (twisting as a filter). For the principal dynamics of relative degree two it can be formulated as follows. Let the plant (or the plant plus actuator) be given by the following differential equations:

xP .t/ D Ax .t/ C Bu .t/ ; D C x

(5.25)

where A and B are matrices of appropriate dimensions, x 2 Rn, and 2 R can be treated as either the sliding variable or the output of the plant. We assume that the plant is asymptotically stable, apart from some possible integrating terms, and is a low-pass filter. We shall also use the plant description in the form of a transfer function W .s/, which can be obtained from the formulas (5.25) as follows:

W .s/ D C.I s A/ 1B

Also, let the control u of the twisting algorithm be given as

u.t/ D 1sign. / 2sign. P /

(5.26)

where 1 and 2 are positive values, 1 > 2 > 0. Assume that a periodic motion occurs in the system with the twisting algorithm.
The objective is to find the parameters of this periodic motion. The system will be analyzed with the use of the DF method. As normal in a DF analysis, we assume that the harmonic response of the plant is that of a low-pass filter, so that the output

194

5 Analysis of Sliding Mode Controllers in the Frequency Domain

of the plant is a harmonic oscillation. To find the DF of the twisting algorithm as the first harmonic of the periodic control signal divided by the amplitude of .t/,

! Z 2 =!

! Z 2 =!

ND

u.t/ sin.!t/dt C j

u.t/ cos.!t/dt

A0

A0

(5.27)

where A is the amplitude of the input to the nonlinearity (of .t/ in our case) and

! is the frequency of .t/. However, the twisting algorithm can be analyzed as

the parallel connection of two ideal relays where the input to the first relay is the

sliding variable and the input to the second relay is the derivative of the sliding

variable. The DF for those nonlinearities are well known. For the first relay the DF

is N1

D

41 A

and for the second relay N2

D

42 a

,

where

a

is the amplitude of

d =dt. Also, we need to take into account the relationship between and d =dt

in the Laplace domain, which gives the relationship between the amplitudes A and

a as a D A!, where ! is the frequency of the oscillation. Using the notation of

the twisting algorithm we can write this as follows:

N

D N1 C sN2 D

41 A

C j ! 42 a

D

4 A .1 C j 2/

(5.28)

where s D j !. Note that the DF of the twisting algorithm depends on the amplitude value only. This suggests finding the parameters of the limit cycle via the solution of the harmonic balance equation:

W .j !/N.A/ D 1

(5.29)

where A is the generic amplitude of the oscillation at the input of the nonlinearity and W .j !/ is the complex frequency response characteristic (Nyquist plot) of the plant. Using the notation of the twisting algorithms this equation can be rewritten as follows:

W .j !/ D 1 N .A/

(5.30)

where the function at the right-hand side is given by

1D N

A

1 4.21

C j2 C 22/

Equation (5.29) is equivalent to the condition of the complex frequency response

characteristic of the open-loop system intersecting the real axis at the point . 1; j 0/.

A graphical illustration of the technique of solving Eq. (5.29) is given in Fig. 5.6.

The function

1 N

is a straight line whose slope depends on the ratio 2=1. This

line is located in the second quadrant of the complex plane. The point of intersection

of this function and the Nyquist plot W .j !/ provides the solution of the periodic

problem. This point gives the frequency of the oscillation !c and the amplitude Ac.

Therefore, if the transfer function of the plant (or plant plus actuator) has relative

5.3 Twisting Algorithm: DF Analysis

195

Fig. 5.6 Transformed system with twisting control
degree higher than two a periodic motion may occur in such a system. For that reason, if an actuator of first or higher order is added to the plant of relative degree two driven by the twisting controller, a periodic motion may occur in the system.
The conditions for the existence of a periodic solution in a system with the twisting controller can be derived from the analysis of Fig. 5.6. Obviously, every system with a plant of relative degree three and higher would have a point of intersection with the negative reciprocal of the DF of the twisting algorithm and, therefore, a periodic solution could exist.
Another modification of the twisting algorithm is its application to a plant with relative degree one with the introduction of an integrator (see Chap. 4). This is usually referred to as the "twisting as a filter" algorithm. The above reasoning is applicable in this case too. The introduction of the integrator in series with the plant makes the relative degree of this part of the system equal to two. As a result, any actuator introduced in the loop increases the overall relative degree to at least three. In this case, there always exists a point of intersection between the Nyquist plot of the serial connection of the actuator, the plant and the integrator, and of the negative reciprocal of the DF of the twisting algorithm (Fig. 5.7). Thus, if an actuator of first or higher order is added to the plant with relative degree one, a periodic motion may occur in the system with the "twisting as a filter algorithm.".
Remark 5.1. The asymptotic 2-SM relay controller
xR D axP bx k sign.x/; a > 0; k > 0
can also be studied. It can be shown that this system is exponentially stable. With respect to our analysis, from Fig. 5.7, it also follows that the frequency of the periodic solution for the twisting algorithm is always higher than the frequency of the asymptotic second-order sliding mode relay controller, because the latter is determined by the point of intersection of the Nyquist plot and the real axis.

196

5 Analysis of Sliding Mode Controllers in the Frequency Domain

Fig. 5.7 Finding a periodic solution in system with twisting control

5.4 Super-Twisting Algorithm: DF Analysis

5.4.1 DF of Super-Twisting Algorithm

The super-twisting algorithm is probably one of the most popular second-order sliding mode algorithms. It is used for systems with principal dynamics of relative degree one. The control u.t/ for the super-twisting algorithm is given as a sum of two components:

u.t/ D u1.t/ C u2.t/

(5.31)

uP1 D sign. /

u2 D

js0j sign. /; if j j > s0 j j sign. /; if j j Ä s0

where , , and s0 are design parameters, with 0:5 Ä < 1: The system under analysis can be represented in the form of the block diagram
as in Fig. 5.8. For an arbitrary value of the power in (5.31), the formula for the DF of such a
nonlinear function can be given as follows:

N2 D 2 A 1 Z .sin. // C1d
0

D 2 pA 1

. 2 C 1/ . 2 C 1:5/

(5.32)

5.4 Super-Twisting Algorithm: DF Analysis

197

Fig. 5.8 Block diagram of a linear system with super-twisting control

where 0 < < 1; A is the amplitude of the variable y, A Ä s0 (this is considered as the most important range of the amplitude values for the analysis of the steady state), and is the gamma function.4

With the square root nonlinearity . D 0:5/ the DF formula can be derived as

Z

N2 D

2 A

0

p A sin.

/ sin.

/d

D p2 A

.1:25/ Ð 1:1p128

.1:75/

A

(5.33)

The DF of the first component of the super-twisting algorithm can be written:

N1 D

41 A j!

which is a result of the cascade connection of the ideal relay having a DF equal to

4 A

and

an

integrator

with

transfer

function

1=s

(for

the

harmonic

signal,

the

Laplace

variable s can be replaced with j !). Taking into account both control components,

we can rewrite the DF of the super-twisting algorithms as

N

D N1 C N2 D

41 A j!

C 1:1p128 A

(5.34)

Note that the DF of the super-twisting algorithm depends on both the amplitude and the frequency values. The parameters of the limit cycle can be found via the solution of the harmonic balance Eq. (5.29), where the DF N is given by (5.34). The negative reciprocal of the DF can be represented by the following formula:

1 N

D

1 1:1128 p C
A

41 A j!

D

p

0:8986

A C j1:1329

1 2!

1 C 1:3092

21 2 A!2

4For details, see, for example,[39].

198

5 Analysis of Sliding Mode Controllers in the Frequency Domain

Fig. 5.9 Plots of the function 1=N for super-twisting control

Now 1=N is a function of two variables: the amplitude and the frequency. It can

be depicted as a number of plots representing the amplitude dependence, with each

of those plots corresponding to a certain frequency. The frequency range of interest

lies below the frequency corresponding to the intersection of the Nyquist plot and

the real axis. The plots of the function 1=N are depicted in Fig. 5.9. Plots 1­

4 correspond to four different frequencies, with the following relationship: !1 >

!2 > !3 > !4: Each of these plots represents the dependence of the DF on the

amplitude value.

The function N 1.A/ (where !=const) has an asymptote as A ! 1, which is

the horizontal line

j1:1329

2

1 !

:

Also,

it

is

easy

to

show

that

lim arg. N 1.A/; !/ D =2
A!0

5.4.2 Existence of the Periodic Solutions

The solution of the harmonic balance Eq. (5.29) can be computed numerically by the application of various iterative techniques. However, the complex Eq. (5.29) with two unknown variables, A and !, can be reduced to one real equation having only one unknown variable ! as follows. Write Eq. (5.29) in the form of N.A/ D
W 1.j !/, where N.A/ is given by (5.34):

4 1 C 1:1128 p D W 1.j !/

A j!

A

(5.35)

5.4 Super-Twisting Algorithm: DF Analysis

199

Considering the real part of both sides we can obtain

1:1128 p D Re W 1.j !/ A

(5.36)

Eliminating A from the Eqs. (5.35) and (5.36) an equation with one unknown

variable ! can be obtained as follows:

« .!/ D

4

1

! Im W 1.j !/

Â 1:1128
Re W 1.j

!/

Ã2

D

0

(5.37)

Once Eq. (5.37) has been solved, the amplitude of oscillation Ac can be computed as follows:

4

1

Ac D !c Im W 1.j !c/

(5.38)

where !c is the frequency of the oscillations. Therefore, if a periodic motion occurs, its parameters can be estimated from
(5.37) and (5.38).

Proposition 5.2. If the relative degree of the plant is two or higher and the plant does not have double zero poles, then at least one periodic solution of the system with the super-twisting algorithm can be always predicted and estimated using the DF technique.

Proof. We first prove Proposition 5.2 for plants of relative degree three and higher. It follows from the formula of the DF of the algorithm (5.34) that a periodic solution should always be looked for within the frequency range that corresponds to =2 and of the phase characteristic of the plant (see also Fig. 5.9). Denote by !1 the frequency where the phase characteristic of the plant is =2 (assuming that there is only one such frequency). Similarly denote the frequency !2 as the frequency at which the phase characteristic of the plant is arg W .j !2/ D . Both frequencies are finite. Find the following two limits of the function from (5.37): « .!1C/ D 1 and « .!2 / D 1. Now observe that the signs are different and that the function « .!/ is continuous within the range ! 2 .!1; !2/ [This follows from (5.37).] Therefore, within the specified range, there exists at least one solution of Eqs. (5.25) and (5.31). Assume now that the relative degree of the plant is two. In this case, we can define the frequency !1 in the same manner as before, but the frequency !2 becomes infinite. Write the asymptotic representation of the plant transfer function for high-frequency inputs in a polynomial form:

W .s/

Ð

a2s2

1 C a1s

C a0

200

5 Analysis of Sliding Mode Controllers in the Frequency Domain

Then, substituting j ! for s, we obtain W 1.j !/ Ð a2!2 C a0 C ja1!, and it is easy to see that for sufficiently large !,

41

1:11282 2

« .!/ D

>0

a1!2 .a0 a2!2/2

Therefore, between !1 and !2, there always exists a certain frequency !, which provides a solution to Eq. (5.37). This completes the proof.

Remark 5.2. It is important that the point of intersection is located in the third quadrant of the complex plane. Therefore, if the transfer function of the plant (or the plant plus actuator) has relative degree higher than one, a periodic motion may occur in such a system. For that reason, if parasitic dynamics of first or higher order are added to the principal dynamics of a relative degree one system driven by the super-twisting controller, a periodic motion may occur in the system. From Fig. 5.9, it also follows that the frequency of the periodic solution for the supertwisting algorithm is always lower than the frequency of the periodic motion in the system with the conventional first-order SM relay controller, because the latter is determined by the point of the intersection of the Nyquist plot and the real axis.

5.4.3 Stability of Periodic Solution

Proposition 5.3. If the following inequality holds then the periodic solution given by Eq. (5.37) is locally stable:

Re

h1.A; !/

h2.A;

!/

C

N .A;

!/

@

ln W .s/ @s

jsDj !

<

0

(5.39)

where

h1.A; !/

D

1:1128
3

2A 2

j

4 !A2

;

h2.A;

!/

D

4 !

2

A

.

Proof. To investigate the local stability of the solution of (5.37), we consider the

system transients due to small perturbations of this solution when A is quasistatically varied to .A C 4A/. Here we assume that the harmonic balance equation

still holds for small perturbations, so that a damped oscillation of the complex frequency j ! C .4 C j !/ corresponds to the modified amplitude .A C 4A/:

N.A C 4A; j ! C .4 C j !//W .j ! C .4 C j !// D 1 (5.40)

where the DF N.A; !/ is given by Eq. (5.34). The nominal solution is determined by zero perturbations: 4 D ! D 4A D 0: By considering variations around the nominal solution defined by ! and A, let us find the conditions when D 4 =4A is negative. First write an equation for the amplitude perturbation 4A: For that purpose take the derivative of (5.40) with respect to 4A as follows:

5.5 Prescribed Convergence Control Law: DF Analysis

201

dN.4A; 4 ; d 4A

!/ j4AD0W .j !/

C

d W .4 ; d 4A

!/ j4AD0N.A; !/

4A D 0

(5.41)

Taking derivatives of N and W , and considering their composite functions, we

obtain

Â

Ã

dN.4A; 4 ; d 4A

!/ j4AD0 D

4! j A2

1:1128

2A

3 2

C4 A !2

d4 d 4A

Cj

d d

4! 4A

dW

dW

Âd4

d 4! Ã

d 4A j4AD0 D ds jsDj ! d 4A C j d 4A

(5.42) (5.43)

Solving

(5.41)

for

.

d4 d 4A

C

j

d d

4! 4A

/

and

taking

account

of

(5.42)

and

(5.44),

we

can obtain an analytical formula. Considering only the real part of this formula we

obtain (5.39). This completes the proof.

5.5 Prescribed Convergence Control Law: DF Analysis
The prescribed convergence control law is given as follows:
u D sign. P C j j sign. //
with 0:5 < < 1: The system under analysis can be represented in the form of the block diagram as in Fig. 5.10. In an autonomous mode (i.e., with no input signal), the error signal is equal to the negative output. Assuming that a periodic motion occurs, the objective is to find the parameters of this periodic motion. The controller has one input and, for that reason, a describing function of the algorithm can be obtained in accordance with the definition given in (5.27) above. As previously, assume that .t/ D Asi n.!t/. Applying Eq. (5.27) to the nonlinear

Fig. 5.10 Block diagram of a linear system with prescribed convergence control law

202

5 Analysis of Sliding Mode Controllers in the Frequency Domain

Fig. 5.11 Plots of the function 1=N for the prescribed control law
function denoted as a dashed rectangle in Fig. 5.10, the describing function of the algorithm can be easily obtained. For the prescribed control law, the DF is a function of not only the amplitude but also of the frequency. The DF can be found only algorithmically. The values of the negative reciprocal of the DF are given in Fig. 5.11 as functions of the amplitude A for a few discrete values of the frequency !.0 < !1 < !2 < !3 < !4; !0 D 0/: The function N1 1.A; !/ (where ! Dconst) is completely located in the second quadrant. Two limiting cases for the frequencies ! ! 0 and ! ! 1 correspond to the real half axis and to the imaginary half axis, respectively. Note that the magnitude of the describing function for the prescribed control law does not depend on frequency and is given by the following formula: jN j D 4 =. A/: In Fig. 5.11, the contours representing equal values of A are depicted as dash lines. The Nyquist plot of any plant of relative degree three or higher will have a point of the intersection with the plot N1 1.A; !/ because the former is located in the second quadrant of the complex plane. Therefore, if the transfer function of the plant has relative degree higher than two, a periodic motion may occur in such a system. For that reason, if an actuator of first or higher order is added to the plant with relative degree two driven by the prescribed control law, a periodic motion may occur. From Fig. 5.11, it also follows that the frequency of the periodic solution for the prescribed control law algorithm is always higher than the frequency of the periodic motion in the system with the asymptotic 2-SM relay controller, because the latter is determined by the point of the intersection of the Nyquist plot and the real axis.

5.6 Suboptimal Algorithm: DF Analysis

203

5.6 Suboptimal Algorithm: DF Analysis

Now consider the generalized suboptimal algorithm given as follows:

u.t/ D .t/UM sign. .t/  M .t//
( .t/ D 1 if M .t/.y.t/  M .t// 0
 ; if M .t/.y.t/  M .t// < 0

(5.44)

where M .t/ is a piecewise constant function representing the value of the last

singular point of .t/ (i.e., the most recent value of .t/ satisfying the condition .Pt/ D 0), UM is the control amplitude,  2 OE0; 1/ is the anticipation parameter, and
 1 is the modulation parameter. Let us assume that the steady-state behavior

of the system (5.25) and (5.44) is a periodic, unimodal symmetric motion with zero

mean and shows that the motion under this assumption can exist. The sequence

of singular points of the variable .t/ is then an alternating sequence of positive

and negative values of the same magnitude:

P M

,

P M

;



P M

,



P M

(where

"P "

stands for periodic). The switching of the control occurs at the instants when the

plant output

.t/ becomes equal either to

P M

or

to



P M

.

This

would

correspond

to

the following nonlinear characteristic of the controller (Fig. 5.12).

With this representation, the DF method can be conveniently used for analysis of

the system with the suboptimal algorithm. The usual assumption for applicability of

the DF method is the linear part (the combined principal and parasitic dynamics)

Fig. 5.12 Nonlinear characteristic of sub-optimal control

204

5 Analysis of Sliding Mode Controllers in the Frequency Domain

Fig. 5.13 Finding a periodic solution in a system with suboptimal control

satisfying the filtering hypothesis. As a result, the DF of the suboptimal algorithm

can be given by the following equation:

N.A/ D 2UM

q . C 1/ 1

2 C j OE.

A

1/ C . C 1/

(5.45)

where A D

P M

is

the

amplitude of

the

oscillations of

the

output.

A

periodic

solution

of the system (5.25) and (5.44) takes place if the negative reciprocal of the DF

has a point of intersection with the Nyquist plot of the linear part of the system.

The negative reciprocal of the DF (that corresponds to the amplitude) is

1D N .A/

8

q

9

A ^< . C 1/ 1 2

. 1/ C . C 1/ >=

4UM ^:  2. C 1/ C .1

Cj /  2. C 1/ C .1

/ ;>

(5.46)

The negative reciprocal of the DF is a straight line in the complex plane that begins at the origin (A D 0) and makes a clockwise angle with the negative part of the real axis. The plot is totally located in the second quadrant (Fig. 5.13). From (5.46), the angle between the real axis and the line can be obtained as follows:

D

. arctan

1/ Cq. C 1/

. C 1/ 1 2

(5.47)

The frequency of possible periodic motions is the frequency of the Nyquist plot of

the plant at the point of intersection with the plot

1 N.A/

.

This

can

be

expressed

as

the solution of the following nonlinear equation:

5.7 Comparisons of 2-Sliding Mode Control Algorithms

205

arg W .j !/ D

(5.48)

where is given by Eq. (5.47), ! is the frequency of the periodic solution, and W .s/

is the transfer function of the combined parasitic and principal dynamics.

The amplitude of this periodic motion depends on the magnitude of the frequency

response W .j !/ of the plant at the frequency !. Usually a larger value of provides

a higher frequency and a smaller amplitude of the periodic motion. The amplitude

Ac of the periodic motion can be evaluated as follows:

pp Ac D 2 2Um  2.1 C / C 1  j arg W .j !c/j

(5.49)

where !c is the frequency of the oscillations. It follows from (5.47) that the range of values is OE0I =2. Therefore, a periodic
motion may occur if the phase characteristic of the combined parasitic and principal dynamics includes the range from to 1:5 . This is only possible if the combined relative degree of the parasitic and principal dynamics is three or higher (however, there may be some cases when the phase characteristic a plant of relative degree lower than three can go below ).

5.7 Comparisons of 2-Sliding Mode Control Algorithms
The examples which have been studied confirm the properties of the algorithms and also demonstrate high accuracy--the DF analysis matches very accurately the results of the simulations (see Tables 5.1­5.4). In the simulations the following values of control algorithm parameters have been used: for the twisting algorithm

Table 5.1 Results of computing and simulations for the system with the

plant of relative degree

two Wp.s/

D

1 s2 CsC1

and an actuator of relative

degree

one

Wa.s/

D

1 0:01sC1

driven

by

the

2-SM

control

algorithms

Twisting

Prescribed

Suboptimal

!c (DF analysis) !c (simulations) Amplitudes, Ac

77.05 77.68 1.67e-4

80.85 81.72 1.51e-4

59.81 55.16 3.6e-4

Table 5.2 Results of computing and simulations for the system with

the plant of relative degree two Wp.s/

D

1 s2 CsC1

and an actuator of

relative

degree

two Wa.s/

D

1 0:0001s 2 C0;01s C1

driven

by the 2-SM

control

algorithms

!c (DF analysis) !c (simulations) Amplitudes, Ac

Twisting
54.64 54.53 4.83e-4

Prescribed
63.10 61.60 3.67e-4

Suboptimal
50.83 50.67 4.63e-4

206

5 Analysis of Sliding Mode Controllers in the Frequency Domain

Table 5.3 Results of computing and simulations for the system with the plant

of relative degree

one Wp.s/

D

sC1 s 2 Cs C1

and an actuator of

relative

degree

one

Wa.s/

D

1 0;01sC1

driven

by

the

2-SM

control

algorithms

Twisting as a filter Super-twisting Conventional SMC

! (DF analysis) ! (simulations) Amplitudes, Ac

75.00 75.51 2.53e-6

66.16 64.96 2.33e-4

1 Converge to 1 0

Table 5.4 Results of computing and simulations for the system with the plant

of

relative

degree

one

Wp .s/

D

sC1 s2 CsC1

and

an

actuator

of

relative

degree

two

Wa.s/

D

1 0:0001s2C0;01sC1

driven

by the 2-SM

control

algorithms

Twisting as a filter Super-twisting Conventional SMC

! (DF analysis) ! (simulations) Amplitudes, Ac

53.52 53.41 9.48e-6

55.18 54.26 4.81e-4

100.00 99.26
1.27e-4

c1 D 0:8; c2 D :0:6; for the prescribed control law D  D 1; D 0:5; for the sub optimal algorithm  D 1;  D 0:5; and for the super-twisting algorithm
D 0:6; D 0:8; D 0:5: The presented analysis demonstrates that the 2-SM control algorithms cannot be chattering-free although the algorithms are continuous. A frequency domain analysis of the known 2-SM control algorithms proves that very convincingly. Furthermore the cause of chattering is the inevitable existence of parasitic (not accounted for in the 2-SM controller design) dynamics associated with the actuators, sensors, etc. However, new algorithms may be developed in the future that may be claimed to be chattering-free. Of course, an individual frequency-domain analysis of each available algorithm can provide some clues, but a more detailed analysis of the principles the 2-SM is based on would be very useful and might prevent wishful but wrong conclusions in the future. The frequency-domain analysis which has been presented leads to the formulation of two ideas or two frequency-domain interpretations of the 2-SM controller designs. Those ideas are (1) an advance switching and (2) control smoothing due to introduction of an integrator. The first principle is applied to plants of relative degree two, and the second principle is applied to the plants of relative degree one. Let us consider those two principles in more detail. The advance switching idea is used in the twisting algorithm, prescribed control law, and suboptimal algorithm. The advance switching is different in comparison with the switching in the conventional relay feedback control and is achieved by introducing phase-lead elements (differentiators) into the system loop or from the use of the negative hysteresis of the relay nonlinearity. In the frequency domain it is manifested as the location of the negative reciprocal of the DF of the respective algorithm in the second quadrant of the complex plane (see Figs. 5.6, 5.11, and 5.13).

5.7 Comparisons of 2-Sliding Mode Control Algorithms

207

Fig. 5.14 Equivalent relay system
The control smoothing idea is realized via introducing an integrator in series with one of the 2-SM control algorithms which have advance switching or a relay nonlinearity (the super-twisting algorithm). This idea essentially exploits the stability margins of a relay control system with a plant of relative degree one, since the addition of one more relative degree does not cause finite frequency periodic motions in such systems. However, the introduction of the integrator in series with the principal dynamics of relative degree one makes the relative degree of this part of the system equal to two. As a result, any parasitic dynamics increases the overall relative degree to at least three. In this case, there always exists a point of intersection between the Nyquist plot of the serial connection of the actuator, the plant and the integrator, and the negative reciprocal of the DF of the SMC algorithm. Thus, if parasitic dynamics of relative degree one or higher are added to the principal dynamics of relative degree one, a periodic motion may occur in the system. Therefore, the existence of parasitic dynamics makes the existence of chattering unavoidable even in the case of the continuous control algorithms.
From the above analysis, the following observation can be formulated: regardless of the algorithm, if the system relative degree (that includes the actuator, plant, and the algorithm itself if the latter contains integrators) is three or higher, a periodic motion may occur in the system. Let us analyze this fact on the basis of the DF method. First note that any 2-SM control algorithm contains the relay (sign) function. After that let us transform the original system into the conventional relay feedback system notation. In Fig. 5.14, the equivalent plant, which now includes the original plant, actuator, and all parts of the 2-SM control algorithm except for the relay element, is nonlinear. However, the nonlinearities of this equivalent plant do not change the order and relative degree of the equivalent plant. Consequently they can be replaced with some gains (which is what was done in the DF analysis above). Therefore, a property which is known for the relay systems should also apply to the equivalent relay system in Fig. 5.14. It can be formulated as the possibility of the existence of a periodic motion if the relative degree is three or higher and the existence of an ideal sliding mode otherwise.
The nature of the parasitic dynamics is the dynamics of energy transformation from one form to another. For example, an actuator is supposed to transform an electrical signal into a force or mechanical motion, and a sensor has to transform mechanical motion into an equivalent electrical signal. It follows from first principles that the relative degree of the actuator­plant­sensor dynamics will always

208

5 Analysis of Sliding Mode Controllers in the Frequency Domain

be higher than two. Moreover, even lower levels of detail can be considered, if necessary, such as delays in the electronics, resistance, capacitance, and inductance of the wires. If we assume that an ideal sliding mode exists in the system in Fig. 5.14, this is equivalent to assuming that the SMC generates a discontinuous control of infinite frequency, which cannot occur in any real system. For that reason, any implementation of the 2-SM control system (as well as a conventional SMC system) will always exhibit chattering. Thus, if for some sliding mode design, we obtained results corresponding to an ideal sliding mode that only means that the parasitic dynamics were either not considered or not considered in sufficient detail. Chattering is an inherent property of the sliding mode principal. The problem is therefore in controlling the parameters of the chattering and adjusting them to acceptable values. The approach presented here can be of significant help in achieving those goals.

5.8 Notes and References
DF analysis can give (predict) only the approximate limit cycle solution. The early results on the analysis of self-sustained oscillations in systems with conventional SMC can be found in [161]. A precise limit cycle analysis can be undertaken in 2-sliding systems using the LPRS technique presented in [29].
It is worth noting that the nonlinearity in Fig. 5.12 can be represented as a sum of two conventional hysteresis relays, for which the DFs are known [11].
The criterion for finite time convergence in terms of the angle between the high-frequency asymptote of the Nyquist plot of the plant and the low-amplitude asymptote of the negative reciprocal is given in [30].
A detailed analysis of self-sustained oscillations (chattering) in 2-SM systems is given in [28­30, 32, 34, 35, 88­90, 117, 150]. The analysis of the propagation of periodic signals for the systems governed by 2-SM control is studied in [36]. The self sustained oscillations in mechanical systems are studied in [4, 5].

5.9 Exercises
Exercise 5.1. Study a real sliding mode in the system xP1 D x2 xP2 D 2x1 3x2 C ua
0:0001uRa D 0:01uPa ua C u D x1 C x2

5.9 Exercises

209

with the controller

u D sign. /

(a) Predict the parameters of the limit cycle by solving the harmonic balance equation.
(b) Confirm the results via computer simulation.

Exercise 5.2. Repeat Exercise 5.1 assuming that the system is controlled by the twisting controller

u D 0:8sign. / 0:6sign. P /

Exercise 5.3. Repeat Exercise 5.1 assuming that the system is controlled by the super-twisting controller
u.t/ D u1.t/ C u2.t/

uP1 D sign. /

u2 D

js0j sign. /; if j j > s0 j j sign. /; if j j Ä s0

with D 0:8, D 0:6, and D 0:5.

Exercise 5.4. Repeat Exercise 5.1 assuming that the system is controlled by the prescribed convergence control law

u D sign. P C j j sign. //

where D 1, D 0:5 and  D 1.
Exercise 5.5. Repeat Exercise 5.1 assuming that the system is controlled by the sub-optimal controller

u.t/ D UM sign. .t/  M .t//

(5.50)

with UM D 0:1 and  D 0:2.
Exercise 5.6. Consider the DC­DC converter presented in Fig. 5.15. The corresponding dynamic equations are given by

L

d d

i t

C

dv dt

D v C uaVin

Di

v R

where i is the current through the inductor L, v is the voltage across the capacitor C , Vin is the input voltage, and u 2 f0; 1g is the switching control signal. The goal is to stabilize the output voltage v at the desired level vd .

210

5 Analysis of Sliding Mode Controllers in the Frequency Domain

Fig. 5.15 DC­DC Buck converter

Fig. 5.16 Mass­spring­damper system

Assume that the switching element has the following dynamics:

uPa D ua C u

where

u

D

1 2

.1

sign. // and

Dv

vd .

(a) Predict the parameters of the limit cycle by solving the harmonic balance equation.
(b) Confirm the results via computer simulations.

Exercise 5.7. Consider the mass­spring­damper system presented in Fig. 5.16. The dynamic model of the system is

m1xR1 C .k1 C k2/x1 k2x2 D u m2xR2 C cxP2 C .k3 C k2/x2 k2x1 D 0

where m1 D 1:28, m2 D 1:08, k1 D 190, k2 D 450, k3 D 190, c D 15, and x1 and x2 are the positions of the masses m1 and m2, respectively. The goal of control is to stabilize the position of m2 at the origin. Using the suboptimal controller

u D 0:1sign. 0:5 M /

where y D x2, compute the parameters of the limit cycle by solving the harmonic balance equation and confirm the results via computer simulation.

5.9 Exercises

211

Fig. 5.17 Control system of the heading angle y of the bi-wing aircraft

Exercise 5.8. Consider the disk drive suspension system represented by the transfer functions

5

Ga .s /

D

0:001s

I C1

48:78 Gp.s/ D s.s C 20/

where Ga.s/ is the transfer function of the actuator, named the motor coil, and Gp.s/ is the transfer function of the plant, named the arm. Assume the input of the actuator is produced by the twisting algorithm

u D 0:8sign. / 0:6sign. P /

Then compute the parameters of the limit cycle by solving the harmonic balance equation, and confirm the results via a computer simulation.
Exercise 5.9. The heading angle y of a bi-wing aircraft is controlled by the prescribed convergence controller
u D 10sign. P C 2j j0:5 sign. //

The block diagram of the control system is given in Fig. 5.17, where the transfer function of the engine is considered as unmodeled dynamics. Compute the parameters of the limit cycle by solving the harmonic balance equation and confirm the results via computer simulation.

Chapter 6
Higher-Order Sliding Mode Controllers and Differentiators

In this chapter we further develop the ideas of Chap. 4 where second-order sliding modes were formulated. As we have seen, second-order sliding modes make the sliding variables vanish in finite time, when the relative degree of the variable equals two, and are able to solve the same problem by means of continuous control, if the relative degree is one. This helps to remove dangerous high-energy vibrations (the dangerous types of chattering). So-called higher-order sliding modes (HOSMs) solve these problems for arbitrary relative degrees. The realization of the scheme requires more information: usually one needs to calculate or measure a number of successive time derivatives of the sliding variables. However that problem is also solved within a similar framework. As a result, arbitrary-order exact robust differentiators are developed, having their own significance in terms of general observation theory. In particular, tracking problems are solved in finite time and with ideal accuracy, by means of smooth control, if the output relative degree is known. The accuracy remains high in the presence of small noises, switching inaccuracies and delays, etc.
While the theory presented in this chapter can be considered complicated, its application is very simple and straightforward. Suppose that the studied problem is to make a smooth scalar output vanish and to keep it at zero. Assume that the system is smooth and affine in the (scalar) control and also that when the output is successively differentiated with respect to time, the control appears for the first time in the rth total time derivative .r/ and its functional coefficient is strictly positive. The number r is called the relative degree. The derivatives P , . . . , .r 1/ which are required to implement the controller can be calculated in real time by means of the HOSM differentiator. The differentiator is robust with respect to input noises and exact in their absence. If the coefficient of control in .r/ is negative, one simply needs to change the sign of the listed controllers.
At that point one can just start to use the results, as applied in Sect. 6.10, and the reader is indeed invited to look at Sect. 6.10 before reading the preceding theoretical developments. However, the theory is required for deep understanding of the proposed method, its accuracy, and limitations. In particular, the HOSM problem

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

213

DOI 10.1007/978-0-8176-4893-0 6, © Springer Science+Business Media New York 2014

214

6 Higher-Order Sliding Mode Controllers and Differentiators

is shown to be reduced to finite-time stabilization of a differential inclusion. The task is performed in the framework of homogeneity theory that not only simplifies the proofs and the control design but also readily calculates the accuracy of the controllers and differentiators.

6.1 Introduction

The main idea of sliding mode control is to keep a properly chosen constraint at zero in sliding mode. It is natural to classify sliding modes by the smoothness degree of the constraint function calculated along the system trajectories. More precisely, let the constraint be of the form D 0, where is some smooth function of the state and time, and let it be kept identically on Filippov trajectories of a discontinuous dynamic system. There is no sense to consider the function on the sliding mode trajectories, for it is just identical zero. On the other hand the sliding mode Á 0 may be classified by the first total derivative .r/ which contains a discontinuity in a small vicinity of the sliding mode trajectories. That number r is called the sliding order. The formal definition is following.

Definition 6.1. Consider a discontinuous differential equation xP D f .x/ (Filippov differential inclusion xP 2 F .x/) with a smooth output function D .x/, and let it be understood in the Filippov sense.1 Then, if

1. The total time derivatives , P , . . . , .r 1/ are continuous functions of x

2. The set

D P D : : : D .r 1/ D 0

(6.1)

is a nonempty integral set (i.e., consists of Filippov trajectories) 3. The Filippov set of admissible velocities at the r-sliding points Eq. (6.1) contains
more than one vector

the motion on the set Eq. (6.1) is said to exist in an r-sliding (rth-order sliding) mode. The set Eq. (6.1) is called the r-sliding set. The nonautonomous case is reduced to the one considered above by introducing the fictitious equation tP D 1.
The words "rth-order sliding" are often abridged to "r-sliding," and the term "rsliding controller" replaces the expression "finite-time-convergent r-sliding mode controller." In the case when is a vector function, the same definition is applied to each scalar component of , and results in a vector sliding order.
As we will immediately see, the sliding order is closely connected to the notion of relative degree. In order to introduce the concept we need the notion of a Lie derivative, which is actually the derivative of a function along the trajectories of a vector field.
Let .x/ be a differentiable function, where x 2 Rn and f .x/ is a vector field (i.e., an n-dimensional vector function). Then the Lie derivative of with respect to f at the point x0 is defined as

1For details, see Sect. 2.1.1.

6.1 Introduction

215

Xn @ Lf .x0/ D r .x0/ f .x0/ D iD1 @xi .x0/fi .x0/ Consider a smooth dynamic system

xP D a.x/ C b.x/u; x 2 Rn; u 2 R

(6.2)

with a scalar input (control) u 2 R and a smooth scalar output .x/. The total derivative of the output is defined as the time derivative of along the trajectory of the system

PD d dt

.x.t/ D r

.x/.a.x/ C b.x/u/ D La

.x/ C Lb

.x/u

(6.3)

The relative degree of the output with respect to the input u at the point x is defined as the order of the total derivative of , at which the control appears with a nonzero coefficient for the first time, provided the control coefficients are identically zero in all the lower-order derivatives. In particular, the relative degree equals 1 at the given point x0, if Lb .x0/ ¤ 0. Suppose that Lb .x/ Á 0 in a vicinity of x0 then differentiating Eq. (6.3) yields

R D L2a .x/ C LbLa .x/u

Continuing the calculation in this way we obtain the following formal definition by Isidori.
Definition 6.2. The number r is called the relative degree of the output of the system (6.2) with respect to the input u at the point x0, if the conditions

Lb .x/ D LbLa .x/ D : : : D Lb Lar 2 .x/ D 0; LbLar 1 .x/ ¤ 0

hold in some vicinity of the point x0. The case when the system depends on time so that

xP D a.t; x/ C b.t; x/u; x 2 Rn; u 2 R; D .t; x/ 2 R

(6.4)

can be handled by introducing the fictitious equation tP D 1 so that one obtains the system

Â ÃÂ

ÃÂ

Ã

xP tP

D

a.t; x/ 1

C

b.t; x/ 0

u D aQ .t; x/ C bQ.t; x/u

and the definition above then can be applied.

216

6 Higher-Order Sliding Mode Controllers and Differentiators

Definition 6.3. The number r is called the relative degree of the output of the system (6.4) with respect to the input u at the point .t0; x0/, if the conditions
LbQ D LbQLaQ D : : : D LbQLarQ 2 D 0; LbQLraQ 1 ¤ 0
hold in some vicinity of the point .t0; x0/. Thus, if the relative degree equals r, the output of Eq. (6.4) satisfies the equations
.i/ D LaiQ ; i D 1; 2; : : : r 1I .r/ D LraQ C LbQLraQ 1 u
Therefore, .i/; i D 1; 2; : : : r 1, are continuous functions of t; x, and keeping Á 0 by means of a permanently switching control is only possible in the r-sliding
mode.

6.2 Single-Input Single-Output Regulation Problem

Consider a dynamic system of the form (6.4), where x 2 Rn, a; b, and W RnC1 !

R are unknown smooth functions and even the dimension n might be uncertain.

Suppose only measurements of are available in real time. The task is to force in

finite time Á 0 by means of an appropriate control u 2 R. Note that the stated

problem can be considered as a general tracking problem for a black-box uncertain

process.

The relative degree of the system is assumed to be constant and known and given

by r so that

.r/ D h.t; x/ C g.t; x/u

(6.5)

where h.t; x/ D LraQ and g.t; x/ D LbQLarQ 1 ¤ 0. It is assumed that g.t; x/ is positive and for some Km; KM ; C > 0 the inequalities

0 < Km Ä g.t; x/ Ä KM ; jh.t; x/j Ä C

(6.6)

hold--which is always true at least locally. If g.t; x/ is negative one just needs to change the sign of the controller which will be developed. The trajectories of Eq. (6.4) are assumed infinitely extendible in time for any Lebesgue-measurable bounded control u.t; x/.
Thus, the task is actually to finite-time stabilize the states P , . . . , .r 1/ of the uncertain system (6.5) depending on the variable parameter x(t) under the conditions in Eq. (6.6). Note that while the relative degree r is indeed needed to be known, the exact knowledge of the parameters Km; KM ; C is not really necessary in practice, for they only influence the magnitude of the control to be designed. Indeed, in any case, probably the best way to determine the control parameters is by extensive simulation of system (6.4).

6.3 Homogeneity, Finite-Time Stability, and Accuracy

217

Unfortunately no static continuous output-feedback control is capable of sta-

bilizing system (6.5) under the uncertainty conditions considered. Indeed, any continuous control

u D '. ; P ; : : : ; .r 1//

(6.7)

forcing Á 0, would need to satisfy the equality '.0; 0; ::; 0/ D h.t; x/=g.t; x/, whenever Eq. (6.5) holds. Obviously, '.0; 0; ::; 0/ 2 OE C =Km; C =Km. Consider two trivial systems of the form (6.5) satisfying conditions (6.6):

.r/ D C C Kmu; 2 R; u 2 R; x D . ; P ; : : : ; .r 1//T 2 Rr

(6.8)

.r/ D C C Kmu; 2 R; u 2 R; x D . ; P ; : : : ; .r 1//T 2 Rr

(6.9)

It is impossible to find a continuous control law to simultaneously satisfy Eqs. (6.8) and (6.9) while .r/ D 0. Thus, the control defined in Eq. (6.7) has to be discontinuous at least on the set Eq. (6.1). In other words, an r-sliding mode D 0 is to be established.
From Eqs. (6.5) and (6.6), the solutions of Eq. (6.5) satisfy the inclusion

.r/ 2 OE C; C  C OEKm; KM  u

(6.10)

In contrast to the uncertain system (6.5), the inclusion in Eq. (6.10) is perfectly known. However it does not "remember" about system (6.4) except the constants r; C; Km; KM . Thus, provided Eq. (6.6) holds, the finite-time stabilization of Eq. (6.10) at the origin simultaneously solves the stated problem for all possible systems (6.4).
The closed differential inclusion Eqs. (6.7), (6.10) is understood in the Filippov sense, which means that the control Eq. (6.7) should be locally bounded and the right-hand-side vector set is enlarged at the discontinuity points of Eq. (6.7) in order to satisfy the convexity and semi-continuity conditions from Definition 2.2. For this end the Filippov procedure from Definition 2.3 is applied to the function (6.7), and the resulting scalar set is substituted for u in Eq. (6.10).
Note that implementing the HOSM controller given by Eq. (6.7) requires observation of the derivatives P , . . . , .r 1/ or real-time differentiation of the output. The problem remains complicated, even if the derivatives P , . . . , .r 1/ are available. One of the main approaches to this problem is based on homogeneity theory. The controllers, which we will design, are r-sliding homogeneous. Let us now introduce the necessary notions.

6.3 Homogeneity, Finite-Time Stability, and Accuracy
Assign a weight (the homogeneity degree) mi to each coordinate xi 2 R, where mi > 0. We will write
deg.xi / D mi

218

6 Higher-Order Sliding Mode Controllers and Differentiators

The corresponding simple linear transformation

dÄ W .x1; x2; : : : ; xn/ ! 7 .Äm1x1; Äm2x2; : : : ; Ämnxn/

(6.11)

is called the homogeneity dilation, and Ä > 0 is called its parameter.
Definition 6.4. A function f W Rn ! R is called homogeneous of the degree (weight) q 2 R with the dilation Eq. (6.11) and written as deg.f / D q, if for any Ä > 0, the identity f .dÄx/ D Äqf .x/ holds.
For instance, in accordance with Definition 6.4, quadratic and cubic forms are homogeneous functions of weights 2 and 3, respectively, corresponding to the trivial homogeneity weights deg xi D 1. Next, let us try deg x1 D 2; deg x2 D 3; then
Á deg x13 x22sign.x1/ C 2 jx1j3=2 x2 D 6

Indeed Ä2x1Á3

Ä3

Á2 x2

sign.Ä2x1/

C

2 Ä2x13=2 Ä3x2

D

Ä6

x13

Á x22sign.x1/ C 2 jx1j3=2 x2

The following are the simple rules of homogeneous arithmetic. The homogeneity
degree of zero is not defined. Let A and B be some homogeneous functions of x 2 Rn different from identical zero, and let be a real number; then

1. The sum of A and B is a homogeneous function only if deg A = deg B

2. 8 ¤ 0 deg D 0

3. deg AB D deg A C deg B

4. deg .A=B/ D deg A deg B

5. deg . A/ D deg A

6.

deg

@ @xi

A

D

deg A

deg

xi ,

if

@ @xi

A

is

not

identical

zero

To verify the last equality it can be seen that

@ @Ä mi

xi

A.dÄ x/

D

Ä

mi @ Ädeg AA.x/ D Ädeg A @xi

mi @ A.x/ @xi

Definition 6.5. A vector field f W Rn ! Rn, f D .f1; f2; : : : ; fn/T , is called homogeneous of degree q 2 R with the dilation Eq. (6.11)and written as deg f D q, if all its components fi are homogeneous and the identities

deg fi D deg xi C deg f D deg xi C q; i D 1; 2; : : : ; n

(6.12)

hold. In order to better understand the above definition, consider the differential equation

xP D f .x/

(6.13)

6.3 Homogeneity, Finite-Time Stability, and Accuracy

219

and introduce a homogeneity weight of the time variable. Let deg t D q; q 2 R; then Eq. (6.12) reads as

deg xPi D deg xi deg t D deg fi ; i D 1; 2; : : : ; n

and means that Eq. (6.13) is invariant with respect to the linear time-coordinate

transformation

GÄ W .t; x/ ! 7 .Ä qt:dÄ x/; Ä > 0

(6.14)

Therefore, we will also call differential equation (6.13) homogeneous with homogeneity degree q. The equalities (6.12) can be rewritten as one vector equality:

f .x/ D Ä qdÄ 1f .dÄ x/

Note that in the scalar case x 2 R any function f W R ! R can be considered

as a vector field as well. The homogeneity degrees of the function f and of the vector field f are different in that case. Indeed, let for example deg x D 1, then the homogeneity degree of the function x2 equals to 2, while the homogeneity degree

of the corresponding vector field is 1. The ambiguity disappears if we speak about the homogeneity of the differential equation xP D x2. Indeed, deg x2 D 2, but on the other hand, due to homogeneity, deg x2 D deg x deg t, which means that
deg t D 1 and the homogeneity degree of the differential equation is 1.

Any linear time-invariant homogeneous differential equation is indeed homoge-

neous with homogeneity degree 0, and deg xi D 1; i D 1; 2; : : : n. Let the weights of x1 and x2 be 3 and 2, respectively. Then the system of differential equations

( xP1 D x2 xP2 D x11=3

jx2j1=2sign.x2/

(6.15)

is homogeneous of the degree 1, deg t D 1.
The nonzero homogeneity degree q of a vector field can always be scaled to 1 by an appropriate proportional change to the weights of the coordinates and time. Indeed, substituting Ä D s, where ; s > 0, one obtains Ämi xi D smi xi , Ä qt D sqt.

Definition 6.6. A vector-set field F .x/ Rn, x 2 Rn; and the differential

inclusion

xP 2 F .x/

(6.16)

are called homogeneous of the degree q 2 R with the dilation Eq. (6.11), which is written as deg F D q, if Eq. (6.16) is invariant with respect to the time-coordinate transformation Eq. (6.14).

The invariance is equivalent to the identity

F .x/ D Ä qdÄ 1F .dÄx/; Ä > 0

(6.17)

220

6 Higher-Order Sliding Mode Controllers and Differentiators

Indeed, the necessary equivalence of xP

2

F .x/

and

d.dÄ x/ d.Ä q t /

2

F .dÄx/ implies

Eq. (6.17). Definition 6.5 is a particular case of Definition 6.6. Also here the nonzero

homogeneity degree can always be scaled to 1.

Let once more the weights of x1 and x2 be 3 and 2, respectively. Then the

differential inequality

jxP1j C xP24=3 Ä x14=3 C x22

corresponds to the homogeneous differential inclusion

.xP1; xP2/

2

° .z1; z2/ jjz1j

C

z24=3

6

x1 4=3

C

x22;

z1; z2

2

R2«

and has degree C1. Indeed, let deg t D 1; then deg jxP1j D deg xP24=3 D deg x14=3 D deg x22 D 4.
Definition 6.7. A differential inclusion xP 2 F .x/ (equation xP D f .x/) is further called globally asymptotically stable at 0, if it is Lyapunov stable, and all solutions are infinitely extended in time and converge to 0 as t ! 1.

Definition 6.8. A differential inclusion xP 2 F .x/ (equation xP D f .x/) is called globally uniformly asymptotically stable at 0, if it is Lyapunov stable, and for any R > 0, " > 0 there exists T > 0 such that any trajectory starting within the disk jjxjj < R enters the disk jjxjj < " in time T and stays there forever.

It can be shown that in the case of a homogeneous continuous differential equation the last two definitions are equivalent.

Definition 6.9. A differential inclusion xP 2 F .x/ (equation xP D f .x/) is further called globally uniformly finite-time stable at 0, if it is Lyapunov stable, and for any R > 0 there exists T > 0 such that any trajectory starting within the disk jjxjj < R stabilizes at zero in the time T.

The importance of the notions introduced is justified by the following re-

markable result: asymptotic stability of a (continuous) homogeneous differential

equation (6.13) with negative homogeneous degree is equivalent to its global

uniform finite-time stability.

For example, system (6.15) is finite-time stable. Indeed, consider the Lyapunov

function

V

D

3 4

x14=3

C

1 2

x22 ;

VP

D

jx2 j3=2

Then, according to LaSalle's theorem, the trajectories asymptotically converge to the largest invariant subset of the set VP D 0, i.e., to the origin. Thus, the system is
asymptotically stable. Since its homogeneity degree is 1, we also get finite-time
stability.

Definition 6.10. A set D is called dilation retractable if dÄD D for any Ä 2 OE0; 1. In other words for each point x it contains the whole line dÄx, Ä 2 OE0; 1.

6.3 Homogeneity, Finite-Time Stability, and Accuracy

221

Definition 6.11. A homogeneous differential inclusion xP 2 F .x/ (equation xP D f .x/) is called contractive if there are two compact sets D1 and D2 and a number T > 0, such that D2 lies in the interior of D1 and contains the origin; D1 is dilation retractable; and all trajectories starting at the time 0 within D1 remain in D2 at the time moment T.
The properties of homogenous Filippov inclusions are studied in Theorems 6.1, 6.2, and 6.3 presented below.
Theorem 6.1. Let xP 2 F .x/ be a homogeneous Filippov inclusion with a negative homogeneous degree p, i.e., deg t D p; then Definitions 6.8, 6.9, and 6.11 are equivalent and the maximal settling time is a locally bounded homogeneous function of the initial conditions of the degree p.
Sketch of the proof. Obviously, both Definitions 6.8 and 6.9 imply Definition 6.11 and Definition 6.9 implies 6.8. Thus, it is enough to prove that 6.11 implies 6.9. All trajectories starting in the set D1 concentrate in a smaller set D2 in time T . Applying the homogeneity transformation it can be verified that the same is true with respect to the sets dÄD1, dÄD2 and the time ÄT for any Ä > 0. An infinite collapsing chain of embedded regions is now constructed, such that any point belongs to one of the regions and the resulting convergence time is majored by a geometric series.
Due to the continuous dependence of solutions of the Filippov inclusion xP 2 F .x/ on its graph D f.x; y/ j y 2 F .x/g, the contraction feature is obviously robust with respect to perturbations causing small changes of the inclusion graph in some fixed vicinity of the origin.

Corollary 6.1 The global uniform finite-time stability of homogeneous differential equations (Filippov inclusions) with negative homogeneous degree is robust with respect to locally small homogeneous perturbations.
Let xP 2 F .x/ be a homogeneous Filippov differential inclusion with deg xi D mi > 0 and deg t D p > 0. Consider the case of "noisy measurements" for xi with the magnitude i mi , i ; > 0 that is
xP 2 F .x1 C 1 OE 1; 1 m1 ; : : : ; xn C n OE 1; 1 mn/

Successively applying the global closure of the right-hand-side graph and the convex closure at each point x, a new Filippov differential inclusion xP 2 F .x/ can be obtained.

Theorem 6.2. Let xP 2 F .x/ be a globally uniformly finite-time stable homogeneous

Filippov inclusion with homogeneity weights m1; : : : ; mn and degree p < 0, and

let > 0. Suppose that a continuous function x.t/ is defined for any t

p

satisfying some initial conditions x.t/ D .t/, t 2 OE p; 0. Then, if x.t/ is any

solution of the disturbed inclusion

xP 2 F .x.t p; 0//; 0 < t < 1

222

6 Higher-Order Sliding Mode Controllers and Differentiators

the inequalities jxi j < i mi are established in finite time with some positive constants i independent of and .
Note that Theorem 6.2 covers the cases of retarded or discrete noisy measurements of all or some of the coordinates and any mixed cases. In particular, infinitely extendible solutions certainly exist in the case of noisy discrete measurements of some variables or in the constant time-delay case. For example, with small delays of the order of introduced in the right-hand side of Eq. (6.15), an accuracy of x1 D O. 3/; xP1 D x2 D O. 2/; and xP2 D O. / is obtained. From Corollary 6.1, for a sufficiently small ", the addition of the term "x12=3 in the first equation of Eq. (6.15) disturbs neither the finite-time stability nor the asymptotic accuracy.

6.4 Homogeneous Sliding Modes

Suppose that the feedback in Eq. (6.7) imparts homogeneity properties to the closedloop inclusion Eqs. (6.7), (6.10). Due to the term OE C; C, the right-hand side of Eq. (6.10) can only have homogeneity degree 0 with C ¤ 0. Indeed, with a positive degree, the right-hand side of Eqs. (6.7), (6.10) approaches zero near the origin, which is not possible with C ¤ 0. With a negative degree it is not bounded near the origin, which contradicts the local boundedness of '. Thus, deg .r/ D deg .r 1/ deg t D 0, and the homogeneity degree of .r 1/ has to be opposite to the degree of the whole differential inclusion.
Scaling the inclusion homogeneity degree to 1, get that the homogeneity weights of t; , P , . . . , .r 1/ are 1; r; r 1; : : : ; 1, respectively. This homogeneity is called r-sliding homogeneity.
Definition 6.12. The inclusion Eqs. (6.7), (6.10) is called r-sliding homogeneous if for any Ä > 0 the combined time-coordinate transformation

GÄ W t; ; P ; : : : ; .r 1/ ! 7 Ät; Är ; Är 1 P ; : : : ; Ä .r 1/

(6.18)

preserves the closed-loop inclusion Eqs. (6.7), (6.10).

Note that the Filippov differential inclusion corresponding to the closed-loop inclusion Eqs. (6.7), (6.10) is also r-sliding homogeneous.
Transformation Eq. (6.18) transfers Eqs. (6.7), (6.10) into

d r .Är / .d Ät /r

2

OE

C; C  C OEKm; KM 

'

Är

; Är

1P;:::;Ä

.r

1/

and hence, Eqs. (6.7), (6.10) is r-sliding homogeneous if

' Är ; Är 1 P ; : : : ; Ä .r 1/ D ' ; P ; : : : ; .r 1/

(6.19)

6.5 Accuracy of Homogeneous 2-Sliding Modes

223

Definition 6.13. Controller Eq. (6.7) is called r-sliding homogeneous (rth-order sliding homogeneous) if Eq. (6.19) holds for any ; P ; : : : ; .r 1/ and Ä > 0. The corresponding sliding mode is also called homogeneous (if it exists).
Such an r-sliding homogeneous controller is inevitably discontinuous at the origin .0; : : : ; 0/, unless ' is a constant function. It is also uniformly bounded, since it is locally bounded and takes on all its values in any vicinity of the origin. Recall that the values of ' on any zero-measure set do not affect the corresponding Filippov inclusion.
A controller is called r-sliding homogeneous in the broader sense if Eq. (6.18) preserves the resulting trajectories of Eq. (6.10). Thus, the suboptimal 2-sliding controller (see Sect. 4.2.3)

u D r1sign.

=2/ C r2sign. /; r1 > r2 > 0

(6.20)

where

r1

r2

>

CI Km

r1

C r2

>

4C

C KM .r1 3Km

r2/

is homogeneous, although it does not have the feedback form (6.7).

(6.21)

6.5 Accuracy of Homogeneous 2-Sliding Modes

With r D 2 we get deg D 2, deg P D 1. As follows from Theorem 6.2 the discretesampling versions of 2-sliding homogeneous controllers with the sampling interval
provide the accuracy level D O. 2/, P D O. /. Similarly, noisy measurements lead to the accuracy D O."/, P D O."1=2/, if the maximal errors arising from sampling and P are of the order of " and "1=2, respectively.
Almost all known 2-sliding controllers are 2-sliding homogeneous. Let us check the homogeneity of the 2-sliding controllers studied in Chap. 4. In other words, condition (6.19) is to be checked:
· The twisting controller (Sect. 4.2.2) satisfies Eq. (6.19); indeed

u D .r1sign. / C r2sign. P // D .r1sign Ä2 C r2sign .Ä P //

has the convergence conditions

.r1 C r2/ Km C > .r1 r2/ KM C C; .r1 r2/ Km > C

Its typical trajectory in the plane , P is shown in Fig. 6.1. · The controller with the prescribed convergence law Eq. (4.21) satisfies

uD

Á  sign P C  j j1=2 sign. / D

 sign Ä P C  Ä2 1=2 sign Ä2

Á

224

6 Higher-Order Sliding Mode Controllers and Differentiators

Fig. 6.1 Convergence of various 2-sliding homogeneous controllers (a) Twisting controller (b) Prescribed convergence law (c) Quasi-continuous controller (d) Contractivity

· The quasi-continuous controller Eq. (4.21) satisfies

uD

P C j j1=2sign.  j P j C j j1=2

/D

Ä P C jÄ2 j1=2sign.Ä2 /  jÄ P j C jÄ2 j1=2

Next consider the super-twisting controller Eq. (4.36) applied to a system of relative degree 1, satisfying Eqs. (4.34) and (4.35) (see the end of the proof of Theorem 4.5). Starting from the moment when ju1j < UM is established, the closedloop system solutions satisfy the inclusion

P 2 OEKm; KM j j1=2sign. / C P 2 OE C; C  OEKm; KM sign. /

6.6 Arbitrary-Order Sliding Mode Controllers

225

where D h.t; x/ C g.t; x/u1. The inclusion is homogeneous with homogeneity degree 1, deg D 2; deg D 1. Since it is finite-time stable, we get the accuracies D O. 2/; P D D O. /, and D O."/; P D D O."1=2/, which
have been already announced, but not proved in Sect. 4.2.5. The same accuracy is
also obtained for the first-order differentiator (Sect. 4.3.2).

6.6 Arbitrary-Order Sliding Mode Controllers

The following are the two most well-known r-sliding controller families. The controllers of the form

u D r 1;r ; P ; : : : ; .r 1/

(6.22)

are defined by recursive procedures, have magnitude  > 0, and solve the general

output regulation problem for system (6.10). The parameters of the controllers can

be chosen in advance for each relative degree r. Only the magnitude  is to be

adjusted for any fixed C; Km; KM , most conveniently by computer simulation, thus

avoiding complicated and redundantly large estimations. Obviously,  has to be

negative with

@ @u

.

.r// < 0. In the following, 1; : : : ; r

>

0 are the controller

parameters, which define the convergence rate.

6.6.1 Nested Sliding Controllers

The following procedure defines the "nested" r-sliding controllers, based on a pseudo-nested structure of 1-sliding modes. Let q 2 N and q > 1. The controllers are built by the following recursive procedure:
Ni;r D j jq=r C j P jq=.r 1/ C : : : C  .i 1/q=.r iC1/Á1=q 0;r D sign. /; i;r D sign .i/ C i Ni;r i 1;r

What follows are the nested sliding mode controllers (of the first family) for r Ä 4 with q being the least multiple of 1; : : : ; r:

1. u D 2. u D 3. u D
4. u D

 sign. /

Á

 sign P C j j1=2 sign. /

Â  sign R C 2

j P j3 C j

j2Á1=6

ÁÃ sign P C j j2=3 sign. /

Â  sign « C 3

R 6 C P 4 C j j3Á1=12

Â sign R C

P 4 C j j3Á1=6 sign

ÁÃÃ P C 0:5 j j3=4 sign. /

226

6 Higher-Order Sliding Mode Controllers and Differentiators

These controllers can be given an intuitive inexact explanation based on recursively nested standard sliding modes. For example, consider the 3-sliding controller

uD

Â  sign R C 2

j P j3 C j

j2Á1=6

ÁÃ sign P C 1 j j2=3 sign. / (6.23)

which is applied to the corresponding inclusion

« 2 OE C; C C OEKm; KM u

(6.24)

First of all, we check its 3-sliding homogeneity. The homogeneity weights are deg R D 3, deg P D 2, deg D 1, and

Â sign Ä R C 2

Ä2 P 3 C Ä3

2Á1=6

sign Ä2 P C 1 Ä3 2=3 sign Ä3

ÁÃ

Â D sign R C 2

j P j3 C j

j2 Á1=6

ÁÃ sign P C 1 j j2=3 sign. /

The idea is that for a sufficiently large , a 1-sliding mode is established on the surface

R C 2 j P j3 C j j2Á1=6

Á sign P C 1 j j2=3 sign. / D 0

(6.25)

In turn Eq. (6.25) leads to the establishment of the sliding mode

P C 1 j j2=3 sign. / D 0

(6.26)

and solutions of Eq. (6.26) converge to identical zero. Unfortunately, this explanation is not correct. Indeed, no sliding modes are
possible on the discontinuous surface Eq. (6.25). In reality, the sliding mode is established on the continuous components of the surface Eq. (6.25) and is lost when the sliding trajectory reaches the discontinuity set Eq. (6.26). It leaves the surface Eq. (6.25) towards its other continuity component. Once it hits the other continuous component of Eq. (6.25), a 1-sliding mode is once more established on Eq. (6.25). The 1-sliding trajectory once more reaches the set Eq. (6.26) and so on. As a result, a motion arises around the set Eq. (6.26) in the 3-dimensional space , P , R . The larger 2, the faster the trajectories arrive at another continuity component of Eq. (6.25), and the smaller the resulting 3-dimensional vicinity of Eq. (6.26). In the projection to the coordinates , P we get a disturbed Eq. (6.26). Obviously its solutions converge to some vicinity of D 0, P D 0, which corresponds to some vicinity of D 0, P D 0, R D 0 in the 3-dimensional space.
The above reasoning means that starting from the unite ball centered at the origin D 0, P D 0, R D 0, with a sufficiently large 2 and a correspondingly

6.6 Arbitrary-Order Sliding Mode Controllers

227

large , the trajectories concentrate in a small vicinity of the origin. Thus we have the contractivity feature of the 3-sliding homogeneous inclusion Eqs. (6.23), (6.24). Now from Theorem 6.2 finite-time stability is ensured.

6.6.2 Quasi-continuous Sliding Controllers

The obvious disadvantage of the nested sliding mode controllers is the high-

frequency leaping of transient trajectories when they approach the HOSM. Although the leaping magnitude tends to zero during the transient, it may cause problems in

practice.

As we have seen in Sect. 6.2 the control law in Eq. (6.22) should be discontinuous

at least at the HOSM:

D P D : : : D .r 1/ D 0

(6.27)

An r-sliding controller Eq. (6.7) is called quasi-continuous, if it is continuous everywhere except at Eq. (6.27). In practice with r > 1, such a control law remains continuous, since due to noise, delays, and other imperfections, the r equalities in Eq. (6.27) never hold simultaneously. The following procedure defines a family of quasi-continuous controllers:

'0;r D

; N0;r D j

j;

0;r

D

'0;r N0;r

D sign.

/

'i;r D

.i /

C

i

Ni.r

i /=.r 1;r

iC1/ i

1;r

Ni;r D 

.i / 

C

i

Ni.r

i /=.r 1;r

i C1/;

i;r

D

' i ;r Ni;r

The following are quasi-continuous controllers with r Ä 4, which have simulationtested i :

1. u D  sign. /

Á

Á

2. u D  P C j j1=2 sign. / = j P j C j j1=2

3. u D 4. u D

R C2 j P jCj j2=3 1=2 P Cj j2=3sign. /



j R jC2 j P jCj j2=3 1=2

 '3;4=N3;4 where

Ä '3;4 D « C 3 R C

j P j C 0:5 j

Á j3=4

1=3

Á P C 0:5 j j3=4 sign. /

Ä jRj C

j P j C 0:5 j

j3=4Á2=3

1=2

228
and

6 Higher-Order Sliding Mode Controllers and Differentiators

Ä N3;4 D j«j C 3 j R j C

j P j C 0:5 j

j3=4Á2=3

1=2

It is easy to see that the sets of parameters i are the same for both the quasicontinuous and nested controllers with r Ä 4. Note that while enlarging  increases the class Eq. (6.5), Eq. (6.6) of systems, to which the controller is applicable, the parameters i are tuned to provide the required convergence rate. The authors consider the latter family as the best one. In addition to the reduced chattering, another advantage of these controllers is the simplicity in terms of adjustment of their coefficients.
The idea of the quasi-continuous controllers is a generalization of the idea of the 2-sliding controller Eq. (4.31) in Theorem 4.4.
Theorem 6.3. Each representative of order r in the two families of arbitrary-order sliding mode controllers above is r-sliding homogeneous and finite-time stabilizing.
Sketch of the proof. The proof of the theorem is based on Theorem 6.1, i.e., on the proof of the contractivity property. Asymptotic accuracies of these controllers are readily obtained from Theorem 6.2. In particular .i/ D O. r i /, i D 0; 1; : : : ; r 1, if the sampling interval equals .

6.7 Arbitrary-Order Robust Exact Differentiation

Any r-sliding homogeneous controller can be complemented by an .r 1/th order differentiator producing an output-feedback controller. In order to preserve the demonstrated exactness, finite-time stability, and the corresponding asymptotic properties, the natural way to calculate P , . . . , .r 1/ in real time is by means of a robust finite-time-convergent exact homogeneous differentiator. Its application is possible due to the boundedness of .r/ provided by the boundedness of the feedback control Eq. (6.7).
Let the input signal f .t/ be a function defined on OE0; 1/ consisting of a bounded Lebesgue-measurable noise with unknown features and of an unknown base signal f 0.t/, whose kth derivative has a known Lipschitz constant L > 0. The problem of finding real-time robust estimations of fP0.t/; fR0.t/; : : : ; f 0.k/.t/ which are exact in the absence of measurement noises is solved by the differentiator

zP0 D v0; v0 D kL1=.kC1/ jz0 f .t /jk=.kC1/ sign .z0 f .t // C z1 zP1 D v1; v1 D k 1L1=k jz1 v0j.k 1/=k sign .z1 v0/ C z2
:::

zPk 1 D vk 1; vk 1 D 1L1=2 jzk 1 vk 2j1=2 sign .zk 1 vk 2/ C zk

zPk D

0L sign .zk vk 1/

(6.28)

6.7 Arbitrary-Order Robust Exact Differentiation

229

If the parameters 0; 1; : : : ; k > 0 are properly chosen, the following equalities are true in the absence of input noise, after a finite-time transient process:
z0 D f0.t /; : : : ; zi D vi 1 D f0.i 1/.t /; i D 1; 2; ::; i
Note that the differentiator has a recursive structure. Once the 0, 1,. . . , k 1 are properly chosen for the .k 1/th-order differentiator with Lipschitz constant L, only one parameter k needs to be tuned for the kth-order differentiator with the same Lipschitz constant and the parameter k just has to be taken sufficiently large. Any
0 > 1 can be used to start this process.
Theorem 6.4. For any given 0 > 1 there exists an infinite positive sequence f ng, such that for each natural k the parameters 0; 1; : : : ; k provide finite-time convergence of the kth-order differentiator Eq. (6.28).
Sketch of the proof. Denote i D zi f .i/.t/ =L: Then dividing all the equations by L and subtracting f .iC1/.t/=L from both sides of the equation with zPi on the left, i D 0; : : : ; k; one obtains

P0 D P1 D
::: Pk 1 D
Pk 2

k j 0jk=.kC1/ sign . 0/ C 1; k 1 j 1 P 0j.k 1/=k sign . 1

P 0/ C 2;

1 j k 1 P k 2j1=2 sign . k 1 P k 2/ C k ; 0L sign . k P k 1/ C OE 1; 1

where the inclusion f .iC1/.t/=L 2 OE 1; 1 is used in the last line. This differential inclusion is homogeneous with homogeneity degree 1 and weights k C 1; k; : : : ; 1 of 0; 1; : : : ; k, respectively. The finite-time convergence of the differentiator follows from the contractivity property of this inclusion and Theorem 6.1.

Remark 6.1. A possible choice of the differentiator parameters for k Ä 5 is 0 D 1:1; 1 D 1:5; 2 D 3; 3 D 5; 4 D 8; 5 D 12. Another possible choice is
0 D 1:1; 1 D 1:5; 2 D 2; 3 D 3; 4 D 5; 5 D 8.

Theorem 6.2 gives the asymptotic accuracy of the differentiator. Let the measure-

ment noise ". Then an

baeccaunryacLy eobfesgziu.et-/meafs0u.ir/a.bt /le

function with magnitude not exceeding D O.".kC1 i/=.kC1// is obtained. That

accuracy is shown to be asymptotically the best possible.

Note that the differentiator in Eq. (6.28) is not presented in the standard form of

dynamic system, i.e., zP D f .t; z/. When implementing it in a computer, one should

check that all auxiliary variables vi are evaluated using the same current values of zi , i D 0; 1; : : : ; k. One can also substitute the value of v0 from the first line of

Eq. (6.28) into the second line, then substitute the value of v1 from the second line

into the third line, etc., to obtain the non-recursive form of the differentiator

230

6 Higher-Order Sliding Mode Controllers and Differentiators

zP0 D zP1 D
:::
zPk 1 D zPk D

Q kL1=.kC1/ jz0 f .t /jk=.kC1/ sign .z0 f .t // C z1

Q
k

1L2=.kC1/ jz0

f .t /j.k 1/=.kC1/ sign .z0

f .t// C z2

Q 1Lk=.kC1/ jz0 f .t /j1=.kC1/ sign .z0 f .t // C zk Q 0L sign .z0 f .t//

(6.29)

It can be verified that Q k D

k, Qi =

i

Q

i i

=.i C1/
C1 ,

i

D

k

1; k

2; : : : ; 0. In particular,

with the choice 0 D 1:1; 1 D 1:5; 2 D 2; 3 D 3; 4 D 5; 5 D 8 for

the coefficients

i,

for

k

D

1

one

obtains

Q
0

D

1:1,

Q
1

D

1:5I

for

k

D

2

one

obtains Q 0 D 1:1; Q 1 D 2:12; Q 2 D 2; for k D 3 one obtains Q 0 = 1.1, Q 1

D

3:06; Q 2

D

4:16; Q 3

D

3;

for

k

D

4

one

obtains

Q
0

D

1:1; Q 1

D

4:57; Q 2

D

9:3; Q 3 D 10:03; Q 4 D 5; for k D 5 one obtains Q 0 D 1:1; Q 1 D 6:93; Q 2 D

21:4; Q 3 D 34:9; Q 4 D 26:4; Q 5 D 8. Note that these parameter values can be

rounded to 2 meaningful digits without any loss of convergence.

Example 6.1. The following is the fifth-order differentiator:

zP0 D v0; v0 D 8L1=6 jz0 f .t /j5=6 sign .z0 f .t // C z1 zP1 D v1; v1 D 5L1=5 jz1 v0j4=5 sign .z1 v0/ C z2 zP2 D v2; v2 D 3L1=4 jz2 v1j3=4 sign .z2 v1/ C z3 zP3 D v3; v3 D 2L1=3 jz3 v2j2=3 sign .z3 v2/ C z4 zP4 D v4; v4 D 1:5L1=2 jz4 v3j1=2 sign .z4 v3/ C z4 zP5 D 1:1L sign .z5 v4/ ;  f .6/.t / Ä L

It is applied, with L = 1, for differentiating the function f .t / D sin.0:5t/ C cos.0:5t/  f .6/.t/ Ä 1

The initial values of the differentiator variables are taken zero. In practice it is reasonable to take the initial value of z0 equal to the current sampled value of f .t/, significantly shortening the transient. Convergence of the differentiator is demonstrated in Fig. 6.2. The fifth derivative is not exact due to the software restrictions (the number of decimal digits of the mantissa). In fact, higher-order differentiation requires special software development.

6.8 Output-Feedback Control

Introducing the differentiator of order r 1 given above in the feedback loop, one obtains an output-feedback r-sliding controller

u D  '.z0; z1; : : : ; zr 1/

(6.30)

6.8 Output-Feedback Control

231

Fig. 6.2 Fifth-order differentiation

where

zP0 D v0; v0 D r 1L1=r jz0 j.r 1/=r sign .z0 / C z1

zP1 D v1; v1 D r 2L1=.r 1/ jz1 v0j.r 2/=.r 1/ sign .z1 v0/ C z2 :::

zPr 2 D vr 2; vr 2 D 1L1=2 jzr 2 vr 3j1=2 sign .zr 2 vr 3/ C zr 1

zPr 1 D

0L sign .zr 1 vr 2/

(6.31)

with L C C sup j'j KM and the parameters i of differentiator Eq. (6.31) are chosen in advance (Sect. 6.7).

Theorem 6.5. Let controller Eq. (6.30) be r-sliding homogeneous and finitetime stable, and the parameters of the differentiator in Eq. (6.31) be properly chosen with respect to the upper bound of j'j. Then the output-feedback controller Eqs. (6.30), (6.31) provides the finite-time convergence of each trajectory to the r-sliding mode Á 0.

Proof. Denote si D zi

.i/. Then using .r/ 2 OE L; L, the controller

Eqs. (6.30), (6.31) can be rewritten as

u D  ' s0 C ; s1 C P ; : : : ; sr 1 C .r 1/

(6.32)

232

6 Higher-Order Sliding Mode Controllers and Differentiators

where

sP0 D sP1 D
:::
sPr 2 D sPr 1 2

r 1L1=r js0j.r 1/=r sign .s0/ C s1 r 2L1=.r 1/ js1 sP0j.r 2/=.r 1/ sign .s1 sP0/ C s2
1L1=2 jsr 2 sPr 3j1=2 sign .sr 2 sPr 3/ C sr 1 0Lsign .sr 1 sPr 2/ C OE L; L

(6.33)

Solutions of Eqs. (6.5), and (6.30), (6.31) correspond to solutions of the Filippov differential inclusion Eqs. (6.10), (6.32), (6.33). Assign the weights r i to si , .i/, i D 0; 1; : : : ; r 1, to obtain a homogeneous differential inclusion Eqs. (6.10), (6.32), (6.33) of degree 1. Let the initial conditions belong to some ball in the space si , .i/. Due to the finite-time stability of the differentiator part of the inclusion Eq. (6.33), it collapses in finite time, and the controller becomes equivalent to Eq. (6.7), which is uniformly finite-time stabilizing by assumption. Due to the boundedness of the control, no solution leaves some larger ball until the moment when s0 Á Á sr 1 Á 0 is established. Hence, Eqs. (6.10), (6.32), (6.33) is also globally uniformly finite-time stable. Theorem 6.3 completes the proof.
The convergence time is bounded by a continuous function of the initial conditions in the space , P , . . . , .r 1/, s0; s1; : : : ; sr 1. This function is homogeneous of weight 1 and vanishes at the origin (Theorem 6.1).
Let the measurements be obtained with a sampling interval , or let them be corrupted by noise given by an unknown bounded Lebesgue-measurable function of time of magnitude "; then the solutions of Eqs. (6.10), (6.32), (6.33) are infinitely extendible in time under the assumptions of Sect. 6.2, and the following theorem is a simple consequence of Theorem 6.2.

Theorem 6.6. In the absence of measurement noise the discrete-measurement

version of the controller Eqs. (6.32), (6.33) with a sampling interval ensures

j j Ä 0 r ; j P j Ä 1 r 1; : : : ;  .r 1/ Ä r 1

(6.34)

for some 0; 1; : : : ; r 1 > 0. With continuous measurements in the presence of measurement noise of magnitude ", the accuracies

j j < i0"; j P j < i1".r 1/=r ; : : : ; j .r 1/j < ir 1"1=r

are obtained for some i0; i1; : : : ; ir 1 > 0. Here 0; 1; : : : ; r 1, and i0; i1; : : : ; ir 1 are positive constants depending only on the parameters from
the problem statement Eq. (6.6) and the controller Eqs. (6.30), (6.31).

The asymptotic accuracy Eq. (6.34) provided by Theorem 6.2, is asymptotically the best possible with discontinuous .r/ and discrete sampling. Note that with homogeneous sliding modes, the missing derivatives can be also estimated by means of divided finite differences. The results of this section are also valid for the suboptimal controller. Hence, the problem stated at the beginning of Sect. 6.2 is solved.

6.9 Tuning of the Controllers

233

6.9 Tuning of the Controllers

Tuning of the controller parameters and possible adaptation of the control magnitude are needed to regulate the convergence rate and to overcome restriction Eq. (6.6).

6.9.1 Control Magnitude Tuning

For simplicity full information about the system state is assumed to be available.

In particular, t; x; and its r 1 successive derivatives are measured. Consider the

controller

u D  ^.t; x/r 1;r ; P ; : : : ; .r 1/

(6.35)

where  > 0 and r 1;r is one of the two r-sliding homogeneous controllers introduced in Sects. 6.6.1 and 6.6.2. The function ^ is any Lebesgue-measurable locally bounded strictly positive function. Any increase in the gain function ^.t; x/ does not interfere with the convergence.
While the function ^ can be chosen large to control exploding systems, it is also reasonable to make the function ^ decrease significantly, when approaching the system operational point, thereby reducing chattering.

6.9.2 Parametric Tuning

The controller parameters presented in Sect. 6.6 provide a formal solution of the stated problem. Nevertheless, in practice one often needs to adjust the convergence rate, either to slow it down (relaxing the burden on the actuators) or to accelerate it in order to meet some system requirements. Note, in this context, redundantly enlarging the magnitude parameter  does not accelerate the convergence, but only increases the chattering, while its reduction may lead to loss of convergence.
A better approach is to take the controller Á
u D r r 1;r ; P = ; : : : ; .r 1/= r 1 ; > 0

instead of

u D r 1;r ; P ; : : : ; .r 1/ ; > 0

which provide approximately a times reduction in the convergence time.

In the case of quasi-continuous controllers (Sect. 6.6.2) the form of the controller

is preserved. formulas Q 1

The D

new 1,

pQa2raDmeterrs=.rQ 11,/

..., 2; :

Q r ::;

1Q,r

Q are 1D

calculated according to the r=2r 1; Q D r . The

following are the resulting quasi-continuous controllers for r Ä 4, with simulation-

tested i and a general gain function ^:

234

6 Higher-Order Sliding Mode Controllers and Differentiators

1. u D ^sign. /

Á

Á

2. u D ^ P C j j1=2 sign. / = j P j C j j1=2

3. u D 4. u D

R C2 3=2 j P jC j j2=3 1=2 P C j j2=3sign. /

^

j R jC2 3=2 j P jC j j2=3 1=2

 ' 3;4 =N3;4

where

Ä '3;4 D « C 3 2 R C

4=3

j P j C 0:5

j

Á j3=4

1=3

P C 0:5

j

j3=4 sign.

Á /

Ä jRj C

4=3

j P j C 0:5

j

j3=4Á2=3 1=2

and

Ä N3;4 D j«j C 3 2 j R j C

4=3

j P j C 0:5

j j3=4Á2=3 1=2

6.10 Case Study: Car Steering Control
Consider a simple kinematic model of car control

xP D v cos.'/ yP D v sin.'/ 'P D v= l tan.Â/ ÂP D u

(6.36) (6.37) (6.38) (6.39)

where x and y are the Cartesian coordinates of the middle point of the rear axle, ' is the orientation angle, v is the longitudinal velocity, l is the length between the two axles, and Â is the steering angle (i.e., the control input) (Fig. 6.3). The task is to steer the car from a given initial position to the trajectory y D g.x/, where g.x/ and y are assumed to be available in real time.
Define D y g.x/. Let v D const D 10m=s, l D 5 m, x D y D ' D Â D 0 at t D 0, g.x/ D 10 si n .0:05x/ C 5. Obviously the control appears for the first time explicitly in the third derivatives of x and y. Thus the relative degree of the system is 3 and both the nested (Sect. 6.6.1) and quasi-continuous (Sect. 6.6.2) 3-sliding controllers solve the problem. The controllers are of the form (6.30), (6.31). Choosing  D 20 the listed nested controller takes the form

uD

Â 20 sign z2 C 2

jz1j3 C jz0j2Á1=6

sign

ÁÃ z1 C jz0j2=3 sign.z0/

6.10 Case Study: Car Steering Control

235

Fig. 6.3 Kinematic car model

where z0; z1; z2 are the outputs of the differentiator Eq. (6.31) with L D 400. For the quasi-continuous controller given earlier  D 1 has been chosen so that

Ä z2 C 2

Á jz1j C jz0j2=3

1=2

Á z1 C jz0j2=3 sign.z0/

uD

Ä jz2j C 2

jz1j C jz0j2=3Á1=2

The differentiator Eq. (6.31) takes the form
zP0 D v0; v0 D 14:7361 jz0 j2=3 sign .z0 / C z1 zP1 D v1; v1 D 30 jz1 v0j1=2 sign .z1 v0/ C z2 zP2 D 400 sign .z2 v1/
in the both cases. The controller parameter  has conveniently been found by simulation. The
differentiator parameter L D 400 is chosen deliberately large, in order to provide better performance in the presence of measurement errors (L D 40 is also sufficient but is worse with sampling noises). The control was applied only from time t D 1, in order to provide some time for the differentiator to converge.
The integration was carried out using the Euler method (the only reliable integration method with discontinuous dynamics), the sampling step being equal to the integration step D 10 4 s. It is seen from Fig. 6.4 that the nested controller indeed demonstrates additional chattering during the transient as predicted.
Using the quasi-continuous controller, in the absence of noise, the tracking accuracies j j Ä 5:4 10 7, j P j Ä 2:4 10 4, j R j Ä 0:042 were obtained. With
D 10 5 s the accuracies j j Ä 5:6 10 10, j P j Ä 1:4 10 5,j R j Ä 0:0042

236

6 Higher-Order Sliding Mode Controllers and Differentiators

Fig. 6.4 Quasi-continuous 3-sliding car control (a) Car trajectory tracking (b) 3-sliding tracking deviations (c) Steering angle derivative (control) (d) Steering angle
were attained. The car trajectory, 3-sliding tracking errors, the steering angle Â, and its derivative u are shown in Fig. 6.5a­d respectively. It is seen from Fig. 6.5c that the control u remains continuous until the 3-sliding mode is obtained. The steering angle Â remains smooth and is quite practical.
In the presence of output noise of magnitude 0:01 m, tracking accuracy levels of j j Ä 0:02; j P j Ä 0:14; j R j Ä 1:3 were obtained. With measurement noise of magnitude 0:1 m, the accuracy changes to j j Ä 0:20; j P j Ä 0:62; j R j Ä 2:8. The performance of the controller with a measurement error magnitude of 0:1 m is shown in Fig. 6.6. It is seen from Fig. 6.6c that the control u is a continuous function of t. The steering angle vibrations have a magnitude of about 7 degrees and a frequency of 1 rad/s, which is also quite feasible. The performance does not significantly change, when the frequency of the noise varies in the range 100­ 100,000 rad/s.

6.11 Case Study: Blood Glucose Regulation

237

Fig. 6.5 Performance with the input noise magnitude 0.1 m (a) Car trajectory tracking (b) 3-sliding tracking deviations (c) Steering angle derivative (control) (d) Steering angle
6.11 Case Study: Blood Glucose Regulation
6.11.1 Introduction to Diabetes
The normal blood glucose concentration level in a human lies in a narrow range, 70­ 110 mg/dl. Different factors including food intake, rate of digestion, and exercise can affect this concentration. Two pancreatic endocrine hormones, glucagon and insulin, are responsible for regulating the blood glucose level. They are secreted from - and -cells of pancreas, respectively. These two hormones form two feedback loops in controlling the blood sugar level that function inversely. Insulin is secreted to lower the blood glucose concentration, e.g., after food intake, and glucagon responsible for increasing the glucose in blood, e.g., in fasting periods.
Diabetes is a disease characterized by an abnormal high glucose concentration caused by an impaired secretion (or action) of the insulin. It is diagnosed by a fasting blood glucose concentration higher than 126 mg/dl, and it can be treated by different schemes--one of them is the insulin therapy that consists of the injection of exogenous insulin.

238

6 Higher-Order Sliding Mode Controllers and Differentiators

Fig. 6.6 3-sliding nested car control (a) Car trajectory tracking (b) 3-sliding tracking deviations (c) Steering angle derivative (control) (d) Steering angle
Implementing tight glucose control in critically ill patients is the most important issue in diabetes management. The current medical guidelines for insulin therapy suggest three to four daily glucose measurements and an equivalent number of intramuscular insulin injections. Finding less invasive and less frequent methods has been the subject of interest for many researchers who are working in this area.
An alternative approach is to deliver insulin using a closed-loop device like a pump, which works like an artificial pancreas. This closed-loop device would include a glucose sensor imbedded under the skin and an insulin pump implanted in the abdomen. The sensor can measure blood glucose concentration and pass the information to a feedback control system that would calculate the necessary insulin delivery rate to keep the patient under metabolic control. A control signal will be sent to an insulin pump by the controller, to deliver the calculated amount of insulin. The pump infuses insulin through a catheter placed under the patient's skin. Since the latest generation of the implantable pumps allows different infusion rates of insulin, the feedback control system mimics the normal function of a pancreas more closely.
In general, using pumps is preferable to the frequent injection of insulin since it is more reliable in maintaining the correct level of sugar in the blood and also is

6.11 Case Study: Blood Glucose Regulation

239

Fig. 6.7 Closed-loop control of diabetic patients using insulin pumps
closer to the normal action of the pancreas. However, creating a device, which would accurately replace three or more insulin injections per day for approximately 3-year lifespan, is not an easy task. It should be made from biocompatible materials and as small as possible. Ways to make the function of the implantable insulin pumps more ideal are currently under research. Figure 6.7 shows the block diagram of a closed-loop control system of a diabetic patient using an insulin pump.
In modeling drug delivery to the human body, certain requirements like finite reaching time and robustness to uncertainties should be satisfied. The human body is very sensitive to deviations of blood glucose concentration from the basal level. A small perturbation for a long period of time can cause in irreversible brain, kidney, and microcirculatory damage. So the time required to achieve the glucose regulation is of great importance. On the other hand, the primary drawback of any detailed physiological model is identifying a "nominal patient" to implement the model parameters. It is obvious that physical characteristics vary from person to person and so different patients have different responses to the same treatment, which in turn can cause parameter variations in the system. It must be taken into consideration that a small change in some of the parameters can dramatically affect the closedloop performance and even result in the patient's death. Therefore, it is vital for the patients that controller used in designing the closed-loop system be robust to any kind of perturbations and disturbances.
In this case study, a relative degree approach together with a HOSM controller is used in designing the feedback algorithm for the glucose­insulin regulatory system. While in MPC, the controller is designed based on the previous information about the system; the HOSM control utilizes the current real-time information processed by HOSM observers/differentiators. Insensitivity to internal and external disturbances, ultimate accuracy and robustness as well as finite-time convergence that are main features of HOSM control, make it a suitable choice for control algorithms related to the human body, where extreme robustness to the patient parameters and external disturbances such as food intake and workout as well as

240

6 Higher-Order Sliding Mode Controllers and Differentiators

continuity of control is of great importance. In this section the advantages of sliding mode control are exploited to design a controller for insulin delivery in diabetic patients.

6.11.2 Insulin­Glucose Regulation Dynamical Model

Until now, a wide range of models has been used to describe the insulin­glucose regulatory system dynamics in the human body. One of the pioneers in this task was Dr. Richard Bergman, who developed the so-called "minimal model."The Bergman minimal model, which is a commonly referenced model in the literature, approximates the dynamic response of a diabetic patient's blood glucose concentration to the insulin injection, using the following nonlinear differential equations:

GP .t/ D p1OEG.t/ Gb X.t/G.t/ C D.t/ XP .t/ D p2X.t/ C p3OEI.t/ Ib IP.t/ D nOEI.t/ Ib C OEG.t/ hCt C u.t/

(6.40)

where t D 0 indicates the time at which the glucose enters blood and the "+" sign shows the positive reflection to glucose intake. The variables in the equations above have the following physical meanings:
· G.t/, the glucose concentration in the blood plasma (mg/dl) · X.t/, the insulin's effect on the net glucose disappearance, the insulin concentra-
tion in the remote compartments (1/min) · I.t/, the insulin concentration in plasma at time t ( U/ml) · Gb, the basal preinjection level of glucose (mg/dl) · Ib, the basal preinjection level of insulin ( U/ml) · p1, the insulin-independent rate constant of glucose uptake in muscles and liver
(1/min) · p2, the rate for decrease in tissue glucose uptake ability (1/min) · p3, the insulin-dependent increase in glucose uptake ability in tissue per unit of
insulin concentration above the basal level [( U/ml) min 2] · n, the first-order decay rate for insulin in blood (1/min) · h, the threshold value of glucose above which the pancreatic -cells; release
insulin (mg/dl) · , the rate at which the pancreatic -cells' release insulin after the glu-
cose injection when the glucose concentration is above the threshold [( U/ml min 2(mg/dl) 1]

6.11 Case Study: Blood Glucose Regulation

241

Bergman also introduces two other factors that play an important role in the regulation of glucose inside the body:
· SI , insulin sensitivity, which is the capability of insulin to increase glucose disposal to muscles and liver and is the ratio of p3=p2
· SG, glucose effectiveness, which is the ability of glucose to enhance its own disposal at basal insulin level and is equal to p1
These two factors are part of the so-called metabolic portrait for every person and are important indicators of how glucose and insulin act inside that person's body. The term OEG.t/ hC in the third equation of the model acts as an internal regulatory function that formulates the insulin secretion in the body, which does not exist in diabetic patients that use insulin therapy. It has been also argued2 that for diabetic subjects, the value of p1 will be significantly reduced and can be approximated as zero. It is worth noting that all the values are calculated for a person of average weight and these are not constant numbers and vary from patient to patient, which makes the design of the controller a more challenging task.
To show the complete dynamics of the glucose­insulin regulatory system, two other terms are considered in Eq. (6.40). The term D(t) shows the rate at which glucose is absorbed into the blood from the intestine, following food intake. Since in diabetic patients the normal insulin regulatory system does not exist, this glucose absorption is considered as a disturbance for the system dynamics. This disturbance can be modeled by a decaying exponential function of the form

D.t/ D A exp. Bt/; B > 0

(6.41)

where t is in (min) and D(t) is in (mg/dl/min). The signal u(t), which is the controller, defines the insulin injection rate and replaces the normal insulin regulatory system of the body (which does not exist in diabetic patients). Therefore, the goal is to employ HOSM techniques to design the appropriate control function, u(t) to compensate for the uncertainties and disturbances, and to stabilize the blood plasma glucose concentration of a diabetic patient at the basal level. It should be mentioned that the dynamics of the insulin pump is neglected in the model introduced in Eq. (6.40).

6.11.3 Higher-Order Sliding Mode Controller Design

The system introduced in Eq. (6.40) can be rewritten in state-space form as follows:

xP1 D xP2 D xP3 D

p1OEx1 Gb x1x2 C D.t /
p2x2 C p3OEx3 Ib nOEx3 Ib C OEx1 hCt C u.t /

(6.42)

2For details see [82].

242

6 Higher-Order Sliding Mode Controllers and Differentiators

where x1; x2, and x3 are blood plasma glucose concentration (mg/dl), the insulin's effect on the net glucose disappearance (1/min), and the insulin concentration in plasma ( U/ml), respectively.
Stabilizing the glucose concentration in the diabetic patient's blood at the basal/reference level Gb is an output tracking problem; thus, the tracking error is defined as the difference between the glucose concentration level and its basal value in the diabetic patient's blood as

e D Gb G.t / D Gb x1

(6.43)

Given the dynamical system introduced in Eq. (6.42), the controller u(t) must be designed such that e ! 0 in the presence of uncertainties, parameter variations, and disturbances like oral food intake, D.t/.
First the relative degree of the system must be defined. Assuming y D x1, the relative degree could be defined as the required number of successive differentiations of y D x1 until the control appears in the equation. Using Eq. (6.42), the control function appears in the equations after the third differentiation, i.e.,

x1.3/ D .x; t / p3x1u.t /

(6.44)

where

.x; t / D x1OE p1.p12 C 3p3Ib/ p3Ib.p2 C n/ p3 .x1 h/Ct 

Cx2OE p12.1 C Gb/ C p1p2.2Gb 1/ C 2D.p1 C p2/

Cx3OE 2p3.p1 C D/ C x1x2OE .p1 C p2/2 3p3Ib

Cx1x3OEp3.3p1 C p2 C n/ C x1x22OE 3.p1 C p2/

Cx22.p1Gb C D/ C 3p3x1x2x3 x1x23 CDR C .p1Gb C D/.p12 C 2p3Ib/

(6.45)

Since p3 ¤ 0; x1 ¤ 0, and p3x1 2 OE1:2 10 4; 3 10 2, the system (6.44) has a well-defined relative degree, r D 3. This allows us to design the controller for the system in Eq. (6.42) that ensures e ! 0.

Nested HOSM Control Design
Arbitrary-order sliding mode controllers with finite-time convergence, that generate continuous controls, which were demonstrated and described earlier in this chapter, will be employed.
Introducing the sliding variable

D e D Gb x1

(6.46)

6.11 Case Study: Blood Glucose Regulation

243

the sliding variable dynamics are derived as

.3/ D .x; t / C p3x1u.t / uP.t/ D v

where v is a virtual control. Then .4/ D
with

1.x; t / C p3x1v

(6.47) (6.48)

1.x; t/ D P .x; t/Cp3xP1u.t/ D P .x; t/Cp3u.t/OE p1.x1 Gb/ x1x2 CD.t/ (6.49)
It is assumed in the design procedure that Eq. (6.49) is bounded by some positive value, i.e., j 1j Ä L. A HOSM controller that stabilizes at zero in a finite time is taken as

v D  sign « C 3. R 6 C P 4 C j j3/1=12 ÁÁ
sign R C . P 4 C j j3/1=6sign. P C 0:5 j j3=4 sign. //

(6.50)

It is obvious that introducing the virtual controller adds one further differentiation and increases the relative degree of the system. Now we have r D 4 instead of 3.
In order to compute .k/; k D 1; 2; 3, the HOSM differentiator in Eq. (6.28) is
employed.

Remark 6.2. Increasing the relative degree from 3 to 4 yields high-frequency switcRhing in the virtual control, v, while the original control, u, is continuous since u D vd . Also a fourth-order quasi-continuous controller can be used instead of the fourth-order nested controller given by Eq. (6.50). Chattering attenuation would be expected to be better.

HOSM (Quasi-Continuous) Control Design

A quasi-continuous HOSM that stabilizes the sliding variable Eq. (6.46), whose dynamics are given in Eq. (6.48), is

v D  '3;4=N3;4

(6.51)

where

Ä '3;4 D « C 3 2 R C

4=3

j P j C 0:5

j

Á j3=4

1=3

P C 0:5

Á j j3=4 sign. /

Ä jRj C

4=3

j P j C 0:5

j j3=4Á2=3 1=2

Ä N3;4 D j«j C 3 j R j C

j P j C 0:5 j

j3=4 Á2=3

1=2

244

6 Higher-Order Sliding Mode Controllers and Differentiators

Fig. 6.8 Open-loop glucose regulatory system
The controller in Eq. (6.51) is continuous everywhere except on the r-sliding mode, i.e., when Á 0 or when D P D R D .3/ D 0. Remark 6.3. Although controller Eq. (6.51) is continuous everywhere except for
D P D R D .3/ D 0, its discontinuity and high-frequency switching in the 4-sliding mode makes Eq. (6.50) preferable for controlling the system (6.42), thus providing continuity for the control function u.
6.11.4 Simulation
The quasi-continuous control algorithm in Eq. (6.51) has been used for controlling the system (6.42) in the simulations. The third-order (k D 3) differentiator Eq. (6.28) is used to estimate P , R , and « while computing the control function (6.51).
MATLAB is used to simulate the closed-loop system in order to show the validity of the proposed design. The first part of simulation has been done for the system of equations in Eq. (6.42), assuming there is no controller. Figure 6.8 shows the

6.11 Case Study: Blood Glucose Regulation

245

Fig. 6.9 Closed-loop glucose regulatory system using the controller
response of a healthy person and a sick person, to show the difference between their glucose regulatory systems. It is easy to see that the glucose value of the healthy person is finally stabilized back at the basal level in the presence of the meal disturbance, but the sick person's glucose level stays dangerously out of range.
To validate the proposed algorithm in Eq. (6.51), the control function is applied to the system (6.42) and the response of a sick person is examined. To check the robustness of the control algorithm to parameter variations, three sets of parameters for three different "patients" have been used. Figure 6.9 shows the results obtained from the simulation. It is obvious that the transient responses of the different patients to the same controller are different, but in all three cases, the glucose is stabilized at the basal level in a reasonable time interval. Figures 6.10 and 6.11 show the insulin profile and the control function for the three patients. The values that have been used in implementing the model and its parameters are given in Table 6.1. It should be noted that the dynamics of the pump is neglected in the simulations (Fig. 6.7).
Remark 6.4. A chattering analysis of the quasi-continuous control Eq. (6.51) in the presence of the actuator (insulin pump) unmodeled dynamics could be performed using the describing function techniques from Chap. 5.

246

6 Higher-Order Sliding Mode Controllers and Differentiators

Fig. 6.10 Closed-loop insulin profile

Fig. 6.11 Control function

6.12 Notes and References

247

Table 6.1 Minimal Bergman model parameters

Normal

Patient 1

Patient 2

p1 0.0317

0

0

p2 0.0123

0.02

0.0072

p3 4:92 10 6 5:3 10 6 2:16 10 6

0.0039

0

0

n 0.2659

0.3

0.2465

h 79.0353

78

77.5783

Gb 70

70

70

Ib 7

7

7

G0 291.2

220

200

I0 364.8

50

55

Patient 3
0 0.0142 9:94 10 5 0 0.2814 82.9370 70 7 180 60

6.12 Notes and References
Chattering is highly undesirable especially if the energy associated with it cannot be neglected, i.e., if the energy does not vanish with the gradual vanishing of chattering-producing factors (noises, delays, small singular perturbation parameters, etc.). Corresponding formal notions of chattering were introduced in [130]. The standard chattering attenuation procedure is to consider the control derivative as a new control input, thus increasing the relative degree [18, 132]. It is proved in [130, 131] that the resulting systems are robust with respect to the presence of unaccounted-for fast stable actuators and sensors and no dangerous chattering is generated either by additional dynamics or by noise and delays. That also remains true when output feedback controllers are constructed, as in Sect. 6.8.
The formal definition of relative degree is given by Isidori in [112]. For details about homogeneity and in particular the definition of homogeneity degree, homogeneity dilation, etc., see [12]. Finite-time stabilization of smooth systems at an equilibrium point by means of continuous control is considered in [22]. The result that asymptotic stability of a continuous homogeneous differential equation with negative homogeneous degree is equivalent to global uniform finitetime stability is due to Bhat and Bernstein [22]. The homogeneous degree of a differential inclusion and global uniform finite-time stability of the Filippov inclusion appear in [126]. The properties of the homogenous Filippov inclusion that are studied in Theorems 6.1, 6.2, and 6.3 are from [126]. The qualitative proof of Theorem 6.2 follows the rigorous proof from [125]. Finite-time stability of homogeneous discontinuous differential equations is also considered in [129, 145].
The two families of r-sliding mode controllers, (nested and quasi-continuous) were originally proposed in [125, 127, 128]. The HOSM approach for systems with unmatched uncertainties is developed in [76, 77].
Details of the construction and proofs of the robust finite-time-convergent exact homogeneous differentiators are presented in [123,125]. The accuracy of the HOSM differentiators coincides with the Kolmogorov estimations [120]. The list of gains

248

6 Higher-Order Sliding Mode Controllers and Differentiators

for the arbitrary-order exact differentiator given in Remark 6.1 is from [125­127]. High-gain observers for nonlinear systems are studied in [10]. The formulas in Sect. 6.9.2 for the HOSM controllers with the tuned parameters appear in [133]. The proof of Theorem 6.4 is given in [125].
For further reading on the traditional treatment of diabetes see [55] and [144]. The Bergman insulin­glucose regulation model and the values of its parameters are introduced in [82]. Details on the delivery of insulin using a closed-loop device like an insulin pump are given in [114]. The relative degree approach and the HOSM control used to design the control algorithm for the glucose­insulin regulatory system is discussed in [115].
The study of adaptive HOSM control is an interesting direction of on-going research for HOSM control and improves its implementability [168, 170]. In systems of relative degree 1 with absolutely continuous perturbations the supertwisting algorithm can be used for finite-time compensation. If the perturbation is r times differentiable, an (rC1)th-order HOSM controller can be designed producing a control signal with an rth order of smoothness that theoretically exactly compensates the perturbation. Thus the decision about the sliding mode order depends on the perturbation smoothness. Therefore, the only theoretical restriction on the smoothness of HOSM-based controllers the smoothness of the perturbations to be rejected.
On the other hand the smoothness of the control law is an important requirement for controller realization due to the properties of some actuators. Moreover, the complexity of HOSM algorithms increases with their order. Therefore, the order of sliding is a compromise between (a) the smoothness of the perturbations; (b) the requirements associated with the actuators; (c) the complexity of the algorithms; (d) the level of noise; and finally (e) the discretization step. Suppose that we have made a decision about the order of the HOSM algorithm. Such a controller will experience chattering due to the discontinuity terms in the rth output derivative. If the estimation of the perturbation boundary is known, then the HOSM controllers can be easily designed. If the bound of the rth derivative of the perturbation is known, then, an r-sliding controller can be designed with overestimated control gains. However this leads to increased chattering and the waste of control energy. Hence, it is important to adapt a HOSM controller to the real perturbations that affect the system. The adaptive-gain 2-SMC, in particular, adaptive twisting and supertwisting controllers, for systems with matched bounded disturbances with unknown bounds are studied in [118, 119, 168, 170].

6.13 Exercises
Exercise 6.1. Prove the homogeneity of the nested sliding mode controllers presented in Sect. 6.6.1. Exercise 6.2. Prove the homogeneity of the quasi-continuous sliding mode controllers presented in Sect. 6.6.1.

6.13 Exercises

249

Exercise 6.3. Prove that the quasi-continuous controllers (Sect. 6.6.2) are during continuous everywhere except during the HOSM.
Exercise 6.4. What is the differentiator, which provides the 3 exact derivatives of the signal sin.3t/?
Exercise 6.5. Check by computer simulation its performance in the presence of noises 0:000001 cos.1000t/ and 0:001 cos.1000t/, 0:01 cos.1000t/.
Exercise 6.6. Consider the system
xP1 D cos.t / ecos.t/x2
xP2 D a.x1; x2; x3; t/ C .2 C cos.x3//u
xP3 D sin.2x1 C x3 C 4t/ x3 C u
where xi , u 2 R. The output is y D x1. The command signal yc.t/ is smooth and is assumed to be unknown in advance, i.e., its exact formula should not be used in the controller. In addition the same controller should also work for both a D cos.x1 C x3/ and a D cos.x1 x3/ as well. Design a controller to force y D yc.t/ by means of a continuous bounded control and in finite time for zero initial conditions xi D 0; i D 1; 2; 3:
a. Using full measurements, including the required derivatives of yc.t/ b. Using only real-time measurements of y.t/ yc.t/;while x2; x3 are not available c. To check the robustness of the designed output-feedback controller with respect
to small sampling noises of y.t/ yc.t)
Exercise 6.7. Design a car control to provide tracking of the trajectory y D 12 sin.0:05x/ 5 cos.0:02x/. Check the robustness of the controller with respect to small measurement errors.
Exercise 6.8. Consider the insulin­glucose dynamics of patient 1, modeled by the Bergman minimal model in Eq. (6.42) with the parameters given in Table 6.1. Assume that the diabetic patient had a meal at 100 min after the start of the treatment: a corresponding disturbance term is given by Eq. (6.41) with A D 50 and B D 3. Design a nested HOSM controller given by Eq. (6.50). Tune the parameters of the HOSM controller. Study the robustness of the designed HOSM controller to the meal disturbance, via computer simulations.

Chapter 7
Observation and Identification via HOSM Observers

Control systems normally perform under uncertainties/disturbances and with measurement signals corrupted by noise. For systems with reliable models and noisy measurements, a filtration approach (Kalman filters, for example) is efficient. However, as shown in Chap. 3, sliding mode observers based on first-order sliding modes are effective in the presence of uncertainties/disturbances. Nevertheless, as discussed in that chapter, they are only applicable when the relative degree of the outputs with respect to the uncertainties/disturbances is one, and differentiation of noisy outputs signals is not needed.
Unfortunately, even for observation of mechanical systems with measured positions, the estimation of velocities--i.e., the derivatives of position--is necessary. The uncertainties/disturbances in mechanical systems are in the equations for accelerations and have relative degree two with respect to the measured positions. This means that differentiators which can provide the best possible accuracy in the presence of sampling steps and noise are needed for the general case of observation of control systems working under uncertainties/disturbances. HOSM differentiators are one class of such differentiators. In this chapter we will show how to design these HOSM observers for different types of systems.
In this chapter sliding mode based observers are presented as an alternative to the problem of observation of perturbed systems. In particular, high-order sliding mode (HOSM) based observers can be considered as a successful technique for the state observation of perturbed systems, due to their high precision and robust behavior with respect to parametric uncertainties. The existence of a direct relationship between differentiation and the observability problem makes sliding mode based differentiators a technique that can be applied directly for state reconstruction. Even when the differentiators appear as a natural solution to the observation problem, the use of the system knowledge for the design of an observation strategy results in a reduction in the magnitude of the gains for the sliding mode compensation terms. Moreover, complete or partial knowledge of the system model facilitates the application of the techniques to parametric reconstruction or disturbance reconstruction.

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

251

DOI 10.1007/978-0-8176-4893-0 7, © Springer Science+Business Media New York 2014

252

7 Observation and Identification via HOSM Observers

7.1 Observation/Identification of Mechanical Systems

This section will begin by focusing on observation and identification of mechanical systems, which have been the focus of many studies throughout the years. Recent research on these systems has produced many important applications such as telesurgery with the aid of robotic manipulators, missile guidance and defense, and space shuttle control. The general model of second-order mechanical systems is derived from the Euler­Lagrange equations which are obtained from an energy analysis of such systems. They are commonly expressed in matrix form as

M.q/qR C C.q; qP /qP C P .qP / C G.q/ C .t; q; qP / D

(7.1)

where q 2 Rn is a vector of generalized coordinates, M.q/ is the inertia matrix, C.q; qP / is the matrix of Coriolis and centrifugal forces, P .qP / is Coulomb friction, which possibly contains relay terms depending on qP , G.q/ is the term associated with the gravitational forces, .t; q; qP / is an uncertainty term; and is the
generalized torque/force produced by the actuators. The control input is assumed
to be given by some known feedback function. Note that M.q/ is invertible since M.q/ D M T .q/ is strictly positive definite. All the other terms are supposed to be uncertain, but the corresponding nominal functions Mn.q/, Cn.q; qP /, and Pn.qP /, Gn.q/ are assumed known.
Introducing new variables x1 D q, x2 D qP , u D , the model (7.1) can be rewritten in the state-space form

xP1 D x2; xP2 D f .t; x1; x2; u/ C .t; x1; x2; u/; y D x1;

u D U.t; x1; x2/;

(7.2)

where the nominal part of the system dynamics is represented by the function

f .t; x1; x2; u/ D Mn 1.x1/OECn.x1; x2/x2 C Pn.x2/ C Gn.x1/ u
containing the known nominal functions Mn, Cn, Gn, Pn; while the uncertainties are lumped in the term .t; x1; x2; u/. The solutions to system (7.3) are understood in a Filippov sense. It is assumed that the function f .t; x1; x2; U.t; x1; x2// and the uncertainty .t; x1; x2; U.t; x1; x2// are Lebesgue measurable function of t and uniformly bounded in any compact region of the state space x1, x2 .
In order to apply a state-feedback controller or to simply perform system monitoring, knowledge of the coordinate x2 is required. Moreover, in the general case, for the design of the controller, it is necessary to know the parameters of the system. The tasks considered in this section are to design a finite-time convergent observer of the velocity qP for the original system (7.1), when only the position q and the nominal model are available, as well as the development of an identification

7.1 Observation/Identification of Mechanical Systems

253

algorithm to obtain the system parameters through knowledge of only the state x1 (i.e., q) and the input u.t/. Only the scalar case x1; x2 2 R is considered for the sake of simplicity.

7.1.1 Super-Twisting Observer

One of the popular second-order sliding mode algorithms which offer a finite

reaching time and which can be used for sliding mode based observation is

the super-twisting algorithm considered in Chap. 4. The proposed super-twisting

observer has the form

xPO1 D xO2 C z1 xPO2 D f .t; x1; xO2; u/ C z2

(7.3)

where xO1 and xO2 are the state estimates while the correction variables z1 and z2 are output error injections of the form

Taking xQ1 D x1

z1 D jx1 xO1j1=2 sign.x1 xO1/ z2 D  sign.x1 xO1/
xO1 and xQ2 D x2 xO2 we obtain the error equations

(7.4)

xPQ1 D xQ2 jxQ1j1=2 sign.xQ1/ xPQ2 D F .t; x1; x2; xO2/  sign.xQ1/

(7.5)

where

F .t; x1; x2; xO2/ D f .t; x1; x2; u/ f .t; x1; xO2; u/ C .t; x1; x2; y/

(7.6) (7.7)

Suppose that the system states are bounded, then the existence of a constant f C is ensured, such that the inequality

jF .t; x1; x2; xO2/j < f C

(7.8)

holds for any possible t, x1, x2 and jxO2j Ä 2 sup jx2j. According to Sect. 4.3.2 the parameters of observer  and could be selected
as  D a1f C and D a2.f C/1=2, where a1 D 1:1, a2 D 1:5. Convergence of the observer states .xO1; xO2/ from Eqs. (7.3) and (7.4) to the system state variables .x1; x2/ in Eq. (7.3) occurs in finite time, from the theorem in Sect. 4.3.2. All other theorems from Sect. 4.3.2 are also true for the observer Eqs. (7.3) and (7.4).
The standard 2-sliding-mode-based differentiator from Sect. 4.3.2 could be also
implemented here to estimate the velocity. In this case, if the accelerations in

254

7 Observation and Identification via HOSM Observers

the mechanical system are bounded, the constant f C can be found as the double maximal possible acceleration of the system. For the proposed observer, the design of the gains  and is based on an estimate of F .t; x1; x2; xO2; u/. This means that the observer design in Eqs. (7.3) and (7.4) takes into account (partial) knowledge of systems dynamics and is more accurate.
A pendulum, a classical example of a mechanical system, is now used to illustrate the effectiveness of the proposed observer Eqs. (7.3) and (7.4).

Example 7.1. Consider a pendulum system with Coulomb friction and external perturbation given by the equation

ÂR D 1

g sin.Â /

Vs ÂP

Ps sign.ÂP / C v

(7.9)

JL

JJ

where the values m D 1:1, g D 9:815, L D 0:9, J D mL2 D 0:891, VS D 0:18 and Ps D 0:45 are the system parameters for simulation purposes, and v is an uncertain external perturbation satisfying jvj Ä 1. The function v D 0:5 sin.2t/ C 0:5 cos.5t/
was used in simulation. Now let Eq. (7.9) be driven by the twisting controller

D 30 sign.Â Â d / 15 sign.ÂP ÂP d /

(7.10)

where Â d D sin.t/ and ÂP d D cos.t/ are the reference signals. The system can be rewritten as

xP1 D x2;

xP2

D

1 J

g L

sin.x1/

Vs J

x2

Ps J

sign.x2/

C

v

Thus, the proposed velocity observer has the form

xOP1 D xO2 C 1:5.f C/1=2jxQ1j1=2 sign.x1 xO1/

xOP2

D

1 Jn

g Ln

sin.x1/

Vsn Jn

xO2

C

1:1f

C

sign.x1

xO1/

where mn D 1, Ln D 1, Jn D mnL2n D 1, Vsn D 0:2, and Psn D 0:5 are the "known" nominal values of the parameters and f C is to be assigned. Assume also

that it is known that the real parameters differ from the assumed known values by not more than 10 %. The initial values Â D x1 D xO1 D 0 and ÂP D x2 D 1 , xO2 D 0 were taken at t D 0. Noting that 0 Ä Â Ä 2 , Â belongs to a compact set (a ring),

and obviously the dynamic system in (7.9) is BIBS stable.

Easy calculations show that the given controller yields j j Ä 45 and the inequality jÂP j Ä 70 is guaranteed when the nominal values of the parameters

and their maximal possible deviations are taken into account. Taking jx2j Ä 70,

jxO2j

Ä

140

it

follows

that

jF j

D

j

1 J

g L

sin.x1/

Vs J

x2

Ps J

sign.x2/

C

v

1 Jn

C

g Ln

sin.x1/ C

Vsn Jn

xO2j

<

60

D

f

C.

Therefore,

the

observer

parameters



D

66

and D 11:7 were chosen. Simulations show that f C D 6 and the respective

values  D 6:6 and

D

4

are

sufficient.

Note

that

the

terms

mgL J

sin.x1/

and

1 J

would have to be taken into account when selecting the differentiator parameters,

when using the techniques from Chap. 4, causing much larger coefficients to be

7.1 Observation/Identification of Mechanical Systems 1.2 1

255 2 estimation error

0.8

0.6

0.4

0.2

0

-0.2

0

0.5

1

1.5

t[s]

Fig. 7.1 Estimation error for x2

used. The finite-time convergence of the velocity observation error to the origin is demonstrated in Fig. 7.1. Figure 7.2 illustrates the same convergence by comparing the estimated velocity to the real one. Finally, Fig. 7.3 shows the convergence of the observer dynamics in the xQ1 versus xQ2 plane.

7.1.2 Equivalent Output Injection Analysis
It is a well-known fact (see Chaps. 1­3) that the equivalent injection term contains information about the disturbances/uncertainties and unknown inputs in a system and can therefore be used for their reconstruction. This important concept is used in the analysis below to reconstruct unknown inputs in mechanical systems. Moreover, the problem of parameter estimation is also addressed in the latter part of this subsection.
Equivalent Output Injection
The finite-time convergence to the second-order sliding mode set ensures that there exists a time t0 > 0 such that for all t t0 the following identity holds:
0 Á xPQ2 Á F .t; x1; x2; xO2; u/ C .t; x1; x2; u/ .1sign.xQ1//eq

256 1.2 1

7 Observation and Identification via HOSM Observers
2 2 estimated

0.8

0.6

0.4

0.2

0

-0.2

0

0.5

1

1.5

t[s]

Fig. 7.2 Real and estimated velocity

1.2

1

0.8

x2 estimation error

0.6

0.4

0.2

0

-0.2 -2

0

2

4

6

8

10 12

x1 estimation error

Fig. 7.3 Convergence to 0 of both xQ1 and xQ2

14 16 x 10-3

7.1 Observation/Identification of Mechanical Systems

257

Notice that F .t; x1; x2; xO2; u/ D f .t; x1; x2; u/ f .t; x1; xO2; u/ D 0 because xO2 D x2. Then the equivalent output injection zeq is given by

zeq.t / Á .1sign.xQ1//eq Á .t; x1; x2; u/

(7.11)

Recall that the term .t; x1; x2; u/ is composed of uncertainties and perturbations. This term may be written as

.t; x1; x2; u/ D .t/ C F .t; x1; x2; u/

(7.12)

where .t/ is an external perturbation term and F .t; x1; x2; u/ embodies the parameter uncertainties.

Theoretically, the equivalent output injection is the result of an infinite frequency

switching of the discontinuous term 1sign.xQ1/. Nevertheless, the realization of the

observer produces high (finite) switching frequency making the application of a

filter necessary. To eliminate the high-frequency component we will use the filter of

the form:

N zNPeq.t / D zNeq.t / C 1sign.xQ1/

(7.13)

where N 2 R and h

1 with h being the sampling step. It is possible to

rewrite zeq as the result of a filtering process in the following form

zeq.t / D zNeq .t / C ".t /

(7.14)

where ".t/ 2 Rn is the difference caused by the filtration process and zNeq .t/ is the filtered version of zeq.t /. It can be shown the limN!0;h=N!0 zNeq . ; h/ D zeq .t /: In other words, the equivalent injection can be obtained by appropriate low-pass
filtering of the discontinuous injection signals.

Perturbation Identification

Consider the case where the nominal model is totally known, i.e., for all t > t0 the uncertain part F .t; x1; x2; u/ D 0. The equivalent output injection takes the form

zNeq.t / D .1sign.xQ1//eq D .t /

(7.15)

The result of the filtering process satisfies limN!0;h=N!0 zNeq . / D .t/. Then, any bounded perturbation can be identified, even in the case of discontinuous perturbations, by directly using the output of the filter. This is illustrated in the next example where a smooth continuous signal and a discontinuous perturbation are identified.

Example 7.2. Consider the mathematical model of the pendulum in Example 7.1 given by

ÂR

D

1 u

M gL sin.Â /

Vs ÂP C v.t/

J

2J

J

258

7 Observation and Identification via HOSM Observers

Fig. 7.4 Sinusoidal external perturbation identification

where m D 1:1 is the pendulum mass, g D 9:815 is the gravitational force, L D 0:9 is the pendulum length, J D mL2 D 0:891 is the arm inertia, VS D 0:18 is the pendulum viscous friction coefficient, and v.t/ is a bounded disturbance term.
Assume that the angle Â is available for measurement. Introducing the variables x1 D Â, x2 D ÂP and the measured output y D Â, the pendulum equation can be written in the state-space form as

xP1 D x2

xP2

D

1 u
J

y D x1

mgL 2J sin.x1/

Vs J

x2

C

v.t

/

Suppose that all the system parameters (m D 1:1, g D 9:815, L D 0:9, J D mL2 D 0:891, VS D 0:18) are well known. The super-twisting observer for this system has the form

xOP1 D xO2 C 2jxQ1j1=2 sign.xQ1/

xPO2

D

1 J

u

mgL 2J sin.x1/

Vs J

xO2

C

1

sign.xQ1/

xQ1 D y xO1

and the equivalent output injection in this case is given by

zeq D .1sign.xQ1//eq D v.t /

using a low-pass filter with N D 0:02OEs. For a sinusoidal external perturbation, the identification is shown in Fig. 7.4. Using a filter N D 0:002OEs the perturbation identification for a discontinuous signal is shown in Fig. 7.5.

7.1 Observation/Identification of Mechanical Systems

259

Fig. 7.5 Discontinuous perturbation identification
7.1.3 Parameter Identification
A problem that often arises in many control tasks is the uncertainty associated with the values of certain parameters, or even, in some cases, a complete lack of knowledge. In this situation, schemes to provide estimates of the unknown parameters at each instant are required. Although many algorithms have been developed to generate these estimates, the first step is usually to obtain a parametric model in which the desired parameters are concentrated in what is called the unknown parameter vector (denoted in most literature by Â). The interaction of these parameters within the system can then be expressed in regressor form as a linear combination of Â and a regressor which is a vector of known linear or nonlinear functions.
Regressor Form
Consider the nominal case when the system is not affected by disturbances and the only perturbations present are in the form of parametric uncertainties, i.e., .t/ D 0 and .t; x1; x2; u/ D F .t; x1; x2; u/. The system acceleration (i.e., xP2) can be represented as the sum of a well-known part and an uncertain part:
xP2 D f .t; x1; x2; u/ C F .t; x1; x2; u/ where f .t; x1; x2; u/ 2 Rn is the known part of the system and F .t; x1; x2; u/ is the uncertain part. Using the regressor notation1 we can write the uncertain part as
F .t; x1; x2; u/ D Â .t /'.t; x1; x2; u/
1For details see [173].

260

7 Observation and Identification via HOSM Observers

where Â.t/ 2 Rn l is composed of the values of the uncertain parameters m, C , G, P and '.t; x1; x2; u/ 2 Rl is the corresponding regressor. The system in Eq. (7.3)
takes the form

xP1 D 7x2 xP2 D f .t; x1; x2; u/ C Â .t /'.t; x1; x2; u/; y D x1

u D U.t; x1; xO2/

(7.16)

and the observer can be rewritten as

xPO1 D xO2 C 2 jxQ1j1=2sign.xQ1/ xPO2 D f .t; x1; xO2; u/ C ÂN .t /'.t; x1; xO2; u/ C 1sign.xQ1/

(7.17)

where ÂN 2 Rn l is a matrix of nominal values of the matrix Â.t/. The error dynamics becomes

xPQ1 D xQ2 2 .xQ1/sign.xQ1/ xQP2 D Â .t / '.t; x1; x2; u/ ÂN .t//'.t; x1; xO2; u/ 1sign.xQ1/

(7.18)

The task is to design an algorithm which provides parameter identification for the original system (7.1), when only the position x1 is measurable and the nominal model ÂN .t/'.t; x1; x2; u/ is known.

Time-Invariant Parameter Identification

Consider the case when the system parameters are time invariant, i.e., Â.t/ D Â.

During the sliding motion, the equivalent output injection can be represented in the

form

zeq.t / D .1sign.xQ1//eq D .Â ÂN /'.t; x1; x2; u/

(7.19)

Notice that 1sign.xQ1/ is a known term and finite-time convergence of the observer guarantees '.t; x1; xO2; u/ D '.t; x1; x2; u/ for all t t0. Equation (7.19) represents a linear regression model where the vector parameters to be estimated are .Â ÂN /. To obtain the real system parameters Â a linear regression algorithm could be proposed from Eq. (7.19).
The recursive least-squares algorithm applied for parameter identification of dynamical systems is usually designed using discretization of the regressor and derivative of the states in order to obtain the regressor form. Then the algorithm is applied in discrete form.
In mechanical system observation and identification, we deal with a data set of a continuous-time nature. That is why the implementation of any standard discretization scheme is related to unavoidable losses of existing information. This produces a systematic error--basically caused by the estimation of the derivatives

7.1 Observation/Identification of Mechanical Systems

261

of the process. As shown above, the proposed second-order sliding mode technique

provides an estimation of the derivatives, converging in finite time, that avoids any

additional errors arising from any standard discretization scheme implementation.

Below we present a continuous-time version of the least-squares algorithm based

on the proposed second-order sliding mode observation scheme. Notice that the

proposed algorithm can be implemented in analog devices directly. Defining Â WD Â ÂN , post-multiplying Eq. (7.19) by 'T .t; x1; x2; u/ (written for notational simplicity as 'T .t/). Now, using the auxiliary variable for integration in time, the

average values of Eq. (7.19) take the form

1 t

Zt
0

zNeq .

/'T .

/d

D

Â

1 t

Z
0

t

'.

/'.

/T d

(7.20)

where zNeq is obtained from Eq. (7.13). Therefore, the system parameters can be estimated from Eq. (7.20) by

ÄZ t

ÄZ t

1

OÂ D

zNeq . /'T . /d

'. /'T . /d

0

0

(7.21)

where OÂ is the estimate of Â . For any square matrix the following equalities hold

 1.t/.t/ D I;  1.t/P .t/ C P 1.t/.t/ D 0

(7.22)

Let

us

define

 .t /

D

hR t
0

'.

/'T .

/d

i1 ; then using Eq. (7.22) we can rewrite

Eq. (7.21) in the form

ÄZ POÂ D

t
zNeq .

/'T .

/d

0

P .t/ C zNeq .t/'T .t/.t/

Now, using Eq. (7.20) we can write OPÂ D OÂ  1.t/P .t/ C zNeq.t/'T .t/.t/

The equalities in Eq. (7.22) allow us to write a dynamic expression for estimating

Â as

OPÂ D h

i OÂ '.t/ C zNeq.t/ 'T .t/.t/

(7.23)

In the same way, a dynamic form to find .t/ is given by

P .t/ D .t/'.t/'T .t/.t/

(7.24)

The average values of the real zeq.t/, without filtering, satisfy the equality

Zt

Zt

zeq. /'T . /d D Â '. /'T . /d

0

0

262

7 Observation and Identification via HOSM Observers

then

ÄZ t

Â D

zeq. /'T . /d .t /

0

Substituting from Eq. (7.14), the real values of the parameter vector Â satisfies

ÄZ t

Zt

Â D

zNeq . /'T . /d C ". /'T . /d .t/

(7.25)

0

0

Let us assume zNeq.t/ D OÂ '.t/. In this case Eq. (7.25) becomes

Ä Zt

Zt

Â D OÂ '. /'T . /d C ". /'T . /d .t/

0

0

which can be written as ÄZ t
Â D OÂ C ". /'T . /d .t/
0

(7.26)

From Eqs. (7.21) and (7.26) it is possible to define the convergence conditions:

sup jjt.t/jj < 1;

1Z t jj ".

/'T .

/d

jj ! 0

as

t !1

t0

(7.27) (7.28)

Condition (7.27), singularity of the

known matrix

as 

the 1.t

/peDrsisRte0tn't .ex/c'itTat.io/ndco.ndTiotioanv,o2idreqthuiisrersestthreicntioonn-,

introduce the term I where 0 <

1 and I is the unit matrix, and redefine

 1.t/ as

Zt  1.t/ D '. /'T . /d C I

0

In this case the value of  1.t/ is always nonsingular.

Notice that the introduction of the term I is equivalent to setting the initial

conditions of Eq. (7.24), as

.0/ D 1I; 0 < -small enough

The introduction of the term ensures the condition supjjt.t/jj < 1 but does

not guarantee the convergence of the estimated parameters to their real values. The

convergence of the estimated values to the real ones is ensured by the persistent

excitation condition

1Z t lim inf

'.

/'.

/T d

>0

t!1 t 0

2See, for example, [173].

7.1 Observation/Identification of Mechanical Systems

263

The condition in Eq. (7.28) relates gence quality of the identification.

Htoowthefafistlttehreintgerpmro1tceRs0ts,".and/'i.t

gives /T d

the converconverges

to zero dictates how fast the parameters will be estimated. The above can be

summarized in Theorem 7.1.

Theorem 7.1. The algorithm in Eqs. (7.23), (7.24) ensures the convergence of OÂ ! Â if conditions (7.27), (7.28) are satisfied

Remark 7.1. The effect of noise sensitivity in the suggested procedure can be easily seen from (7.28):

Z 1

t
".

/ 'T .

/d

! 0 when t ! 1

t0

The term " .t/ in (7.14) includes all error effects caused by observation noise (if

there is any) and errors in the realization of the equivalent output injection. One can

see that if " .t/ and ' .t/ are uncorrelated and are "on average" equal to zero, i.e.,

1Z t ". /d

! 0;

1Z

t
'.

/d

!0

t0

t0

then the effect of noise vanishes.

The pendulum system is once again used to illustrate the previous algorithm.

Example 7.3. Consider the model of a pendulum from Example 7.1 with Coulomb friction given by the equation

ÂR

D

1 u

M gL sin.Â /

Vs ÂP

Ps sign.ÂP /

J 2J

JJ

where m D 1:1 is the pendulum mass, g D 9:815 is the gravitational force, L D 0:9 is the arm length, J D mL2 D 0:891 is the arm inertia, VS D 0:18 is the viscous friction coefficient, and Ps D 0:45 models the Coulomb friction coefficient.
Suppose that the angle Â is available for measurement. Introducing the variables x1 D Â, x2 D ÂP , the state-space representation for the system becomes

xP1 D x2;

xP2

D

1 u
J

y D x1

mgL 2J sin.x1/

Vs J

x2

Ps J

sign.x2/;

where a1

D

mgL 2J

D 5:4528; a2

D

Vs J

D 0:2020; and a3

D

Ps J

D 0:5051 are the

unknown parameters. Design the super-twisting-based observer as

xOP1 D xO2 C 2jxQ1j1=2 sign.xQ1/;

xOP2

D

1 J

u

aN1 sin.x1/

aN 2 xO 2

aN3 sign.x2/ C 1 sign.xQ1/;

264

7 Observation and Identification via HOSM Observers

Fig. 7.6 x1, x2 estimation error LTI case

xQ1 D y xO1
where aN1 D 2, aN2 D aN3 D 0:1 are the nominal values of the unknown parameters. Let the control signal be generated by the twisting controller

u D 30 sign.Â Â d / 15 sign.ÂP ÂP d /;

(7.29)

where the reference signal is Âd D 0:3 sin.3t C =4/ C 0:3 sin.1=2t C /. For a sampling time of  D 0:0001 the state estimation error is shown in Fig. 7.6. In this
case the identification variables are given by

zeq D .1sign.xQ1//eq

Â D OE a1 C aN1

a2 C aN2

Â D2OE 3:4528 3 0:1020 sin.x1/
' D 4 x2 5

sign.x2/

a3 C aN3 0:4051

It is now possible to use ', the nonlinear regressor, to generate the dynamic adaptation gain .t/ using Eq. (7.24). From Eq. (7.19), the value of zNeq is given by
zNeq D zeq D .1sign.xQ1//eq

The dynamic estimate of the parameter error vector Â , which contains all the necessary information to retrieve the desired parameter vector Â, can be generated by implementing the algorithm in Eq. (7.23). Figure 7.7 shows the convergence of the estimated parameters to the real parameter values.

7.2 Observation in Single-Output Linear Systems

265

Fig. 7.7 Parameter identification for LTI case
7.2 Observation in Single-Output Linear Systems
The observer design problem for the general case of linear time-invariant systems will now be addressed in this section. The non-perturbed case will be revisited and then both unknown input and (exact) state estimation in the more complex perturbed case will be studied.

7.2.1 Non-perturbed Case

Consider a linear time-invariant system

xP D Ax C Bu y D Cx

(7.30)

where x 2 Rn, y 2 R are the system state and the output, u 2 Rm is the known control, and the known matrices A; B; C have suitable dimensions. It is assumed that the pair .A; C / is observable. A standard Luenberger observer for this system is given by

xPO D AxO C Bu C L.y yO/

yO D C xO

(7.31)

where L 2 Rn 1 is a gain matrix chosen such that .A LC / is a Hurwitz matrix. Such a gain matrix L always exists because of the assumed observability of the system, and it ensures asymptotic convergence to zero of the estimation error e D x xO .

266

7 Observation and Identification via HOSM Observers

It is important to remark that without any disturbance, the standard Luenberger observer is sufficient to reconstruct asymptotically the states.

7.2.2 Perturbed Case

Now assume that the linear time-invariant system in Eq. (7.30) is perturbed by an external disturbance .t/. The perturbed linear time-invariant system is given by

xP D Ax C Bu C D .t/; D ¤ 0 y D Cx

(7.32)

where x 2 Rn, y 2 R, u 2 Rm, and 2 R is an unknown input (disturbance). The corresponding matrices A; B; C; D have suitable dimensions. The unknown input .t/ is assumed to be a bounded Lebesgue-measurable function, j .t/j Ä C, C > 0.
The equations are understood in the Filippov sense in order to provide for
possibility to use discontinuous signals in observers. It is assumed also that all the
inputs which are considered allow the existence and extension of the solution to the
whole semi-axis t 0.
Suppose that the Luenberger observer Eq. (7.31) is used to estimate the states. The dynamics of the estimation error e D x xO are given by

eP D .A LC /e C D ye D C e

In order to analyze the convergence properties of this observer, consider the Lyapunov-like function V D eT Pee, where Pe D PeT > 0 has suitable dimensions. Computing the first derivative of V we obtain

VP D eT Pe ..A LC /e C D  C OE.A LC /e C D /T Pee

Suppose the matrix Pe is the solution of the Lyapunov equation Pe.A LC / C .A LC /T Pe D H

(7.33)

for some H D H T > 0, then the first derivative of V becomes

VP D eT He C 2.D /T Pee The condition VP Ä 0 is satisfied for all the estimation error satisfying the inequality

jjejj >

2

CjjDT Pejj jjH jj

7.2 Observation in Single-Output Linear Systems

267

This last inequality implies that the proposed Luenberger observer only can ensure the convergence of the estimation error to a bounded region around the origin. As a consequence, standard Luenberger observer cannot be applied for state reconstruction on perturbed systems.
The task in this section is to build an observer guaranteeing asymptotic (and preferably exact finite-time convergent) estimation of the states and the unknown input. Obviously, it can be assumed without loss of generality that the known input u is equal to zero (i.e., u.t/ D 0).
It is very important to establish conditions when the unknown input can be reconstructed along with estate estimation. For this reason, several definitions will be introduced to study the state observation problem for perturbed linear systems. It is assumed in the following definitions that u D 0.

Definition 7.1 ([107]). System (7.32) is called strongly observable if for any initial state x.0/ and any input .t/, y.t/ Á 0 with 8t 0 implies that also x Á 0.

Definition 7.2 ([107]). The system is strongly detectable , if for any .t/ and x.0/ it follows that y.t/ Á 0 with 8t 0 implies x ! 0 with t ! 1.

It is important to remark that these two definitions are not directly related to the structure of the system. However, important consequences on the system structure can be established.

Theorem 7.2. The system (7.32) is strongly observable if and only if the output y has relative degree n with respect to the unknown input .t/, i.e., it has no invariant zeros.

Proof. Let matrix P be defined by

2

3

C

P D 6646

CA :::

7757

CAn 1

Strong observability of the system requires observability, and therefore rankP D n. The observability implies the existence of a relative degree r associated with the output y with respect to the unknown input . Indeed, otherwise PD D 0 and therefore D D 0. Then the coordinate transformation xO D P x turns system (7.32) into

xPO D AO xO C BO u.t / C DO .t / y.t / D CO xO

(7.34)

268

7 Observation and Identification via HOSM Observers

where

20 1 0

03

AO D 666646

0 :::
0

0 :::
0

1 :::
0

:::

0 :::
1

777577

a1 a2 a3

an

DO D OECD; : : : ; CAn 2D; CAn 1DT

CO D OE1; 0; : : : ; 0

(7.35)
(7.36) (7.37)

and the aj , j D 1; : : : ; n are some constants. The vector BO does not have any specific form. Recall that u is assumed to be zero. When r D n only the last component of DO is not zero. It is obvious that in that case the identity y Á 0 implies xO Á 0.
Assume now that r < n. That means that some nontrivial zero dynamics exists, which corresponds to nontrivial solutions satisfying y Á 0 and contradicts the
conditions for strong observability. This ends the proof of the theorem.

7.2.3 Design of the Observer for Strongly Observable Systems

The importance of the property of strong observability for the type of linear systems described by Eq. (7.32) lies in the fact that it ensures the existence of the sliding mode state observer. This part of the chapter will explore the design of such an observer.
Assumption 7.1. System (7.32) has the relative degree n with respect to the unknown input .t/ (i.e., the system is strongly observable).
The observer is built in the form

zP D Az C Bu C L.y C z/ xO D z C Kv vP D W .y C z; v/

(7.38) (7.39) (7.40)

where z; xO 2 Rn, xO is the estimation of x and the matrix L D OEl1; l2; : : : ; lnT 2 Rn is a correction factor chosen so that the eigenvalues of the matrix A LC have negative real parts. (Such an L exists due to Assumption 7.1 and Theorem 7.2.)
The proposed observer is actually composed of two parts. Equation (7.38) is a traditional Luenberger observer providing the boundedness of the difference z x in the presence of the unknown bounded input . System (7.40) is based on high-order sliding modes and ensures the finite-time convergence of the resulting estimation error to zero.

7.2 Observation in Single-Output Linear Systems

269

Suppose that only the states are to be estimated and that Assumption 7.1 holds.

Note that in the simplest case when n D 1 the only observable coordinate coincides

with the measured output and, therefore, only the input estimation problem makes

sense, requiring Assumption 7.1. Thus assume that n > 1.

Since the pair .C; A/ is observable, arbitrary stable values can be assigned to

the eigenvalues of the matrix (A LC ), choosing an appropriate gain matrix L.

Obviously the pair .C; A LC / is also observable and therefore its observability

matrix

2

3

C

PQ D 466666

C.A LC / C.A LC /2
:::

777577

(7.41)

C.A LC /n 1

is nonsingular. Set the gain matrix K D PQ 1 and assign

xO D z C PQ 1v

(7.42)

The nonlinear part of the observer Eq. (7.40) is chosen as

vP1 D w1 D nM 1=njv1 y C C zj.n 1/=n sign.v1 y C C z/ C v2

vP2 D w2 D n 1M 1=.n 1/jv2 w1j.n 2/=.n 1/ sign.v2 w1/ C v3

:::

vPn 1 D wn 1 D 2M 1=2jvn 1 wn 2j1=2 sign.vn 1 wn 2/ C vn

vPn D 1M sign.vn wn 1/

(7.43)

where vi , zi , and wi are the components of the vectors v, z 2 Rn, and w 2 Rn 1, respectively. The parameter M must be chosen sufficiently large, and in particular M > jd j C must be satisfied, where d D CAn 1D. The constants i are chosen recursively and must be sufficiently large (see Chap. 6 for a more detailed discussion). In particular, one of the possible choices is 1 D 1:1; 2 D 1:5; 3 D 2; 4 D 3; 5 D 5; 6 D 8; in a situation when n Ä 6. Note that Eq. (7.43) has a recursive form, useful for the parameter adjustment.
Recall that xO D P x is the vector of canonical observation coordinates and eO D P .xO x/ is the canonical observation error. With this in mind, the following theorem summarizes the exact finite-time convergence properties of the designed observer.
Theorem 7.3. Let Assumption 7.1 be satisfied and the output be measured subject to noise, which is a Lebesgue-measurable function of time with maximal magnitude ". Then with properly chosen j 's, and a sufficiently large M , the state x of the system is estimated in finite time by the observer Eqs. (7.38), (7.41), (7.42)

270

7 Observation and Identification via HOSM Observers

and (7.43). With sufficiently small " the observation errors eOi D xOOi xOOi D CAi 1.xOi xi / are of the order of ".n iC1/=n, i.e., they satisfy the inequalities jeOi j Ä i ".n iC1/=n for some constants i > 0 depending only on the observer, the system parameters, and the input upper bound. A level of accuracy of the order of "1=n is obtained in noncanonical coordinates due to the mix of coordinates. In particular, the state x is estimated exactly and in finite time in the absence of noises.
Remark 7.2. It is worth noting that using a Kalman filter instead of a Luenberger observers in this algorithm may be beneficial in the presence of measurement noise.
The finite-time convergence of the observation error, which is guaranteed using a Luenberger observer, allows us to address the problem of reconstructing , the unknown input to the system.

Identification of the Unknown Input

Now let v 2 RnNC1, where nN D n C k, satisfy the nonlinear differential equation (7.40) in the form

vP1 D w1 D nNC1M 1=.nNC1/jv1 y C C zj.nN/=.nNC1/ sign.v1 y C C z/ C v2 vP2 D w2 D nN M 1=.nN/jv2 w1j.nN 1/=.nN/ sign.v2 w1/ C v3

:::

vPn D kC2M 1=.kC2/jvn wn 1j.kC1/=.kC2/ sign.vn wn 1/ C vnC1 (7.44)

:::

vPnN D wnN D 2M 1=2jvnN 1 wnN 2j1=2 sign.vnNC1 wnN 2/ C vnN

vPnNC1 D 1M sign.vnNC1 wnN /

(7.45)

where M is a sufficiently large constant. As described previously, the nonlinear
differentiator has a recursive form, and the parameters i are chosen in the same way. In particular, one of the possible choices is 1 D 1:1; 2 D 1:5; 3 D 2; 4 D 3; 5 D 5; 6 D 8, in the situation when n C k Ä 5. In any computer realization one has to calculate the internal auxiliary variables wj ; j D 1; : : : ; n C k, using only the simultaneously sampled current values of y; z1, and vj . The equality eN D ! is established in finite time, where ! is the truncated vector

! D .v1; : : : ; vn/T

Thus, in the case of unknown input reconstruction, the corresponding observer Eq. (7.39) is now modified and takes the form

xO D z C PQ 1!

(7.46)

7.2 Observation in Single-Output Linear Systems

271

where PQ is the observability matrix previously defined. The estimation of the input

is given as

O

D

1 d

.vnC1

.a1v1 C a2v2 C

C anvn//

(7.47)

where sn ansn 1

a1 D . 1/ndet.A LC sI / defines the characteristic

polynomial of the matrix A LC .

An example is now presented to illustrate the effectiveness of the proposed

observer Eq. (7.46) for both state and unknown input reconstruction in linear

systems.

Example 7.4. Consider system (7.32) with matrices

2

3

01 0 0

A D 46600

0 0

1 0

0 1

577

65 5 5

B D D D 0 0 0 1 T ;C D 1 0 0 0

and initial conditions x.0/ D 1 0 1 1 . Note that A is not stable since its eigenvalues are 3; 2; 1; 1. The relative degree r with respect to the unknown input equals 4. As a consequence, the system is strongly observable. The unknown input
D cos.0:5t/ C 0:5 sin.t/ C 0:5
is used for pedagogical purposes. It is obviously a bounded smooth function with bounded derivatives. It is also assumed that u D 0. Furthermore, let the output of the system be affected by a deterministic noise of the form

wN D 0:1 sin.1037j cos.687t/j/

of amplitude

D 0:1. The correction factor L D

5

5

5

T
5

places the

eigenvalues of A LC at f 1; 2; 3; 4g. The gain matrix PQ 1 is thus given by

2

3

1000

PQ 1 D 66455

1 5

0 1

00757

5551

(7.48)

The parameters 1 D 1:1; 2 D 1:5; 3; 4 D 3; M D 2 are chosen, and the nonlinear part of the observer takes the form

vP1 D w1 D 3 21=4jv1 y C C zj.3/=4 sign.v1 y C C z/ C v2 vP2 D w2 D 2 21=3jv2 w1j2=3 sign.v2 w1/ C v3

272

7 Observation and Identification via HOSM Observers

Fig. 7.8 State estimation errors in the presence of a deterministic noise of amplitude 10 1

Fig. 7.9 Detail of observer error graphs. Estimation error of x2 (above). Estimation error of x4 (below)
vP3 D wn 1 D 1:5 21=2jv3 w2j1=2 sign.v3 w2/ C v4 vP4 D 1:1 2 sign.v4 w3/
The observer performance and finite-time convergence for the sampling time interval D 0:001 are depicted in Fig. 7.8. Figure 7.9 shows the details of the state convergence. Note that the estimation error associated with x2 converges to a bounded region of order 5 10 3, while the estimation error in x4 converges to a

7.2 Observation in Single-Output Linear Systems

273

Fig. 7.10 Convergence of xO1; xO4 to x1 and x4
Fig. 7.11 System coordinates
bounded region of order 2 10 1. The transient process is shown in Fig. 7.10 for the states x1 and x4. It is seen from Fig. 7.11 that the system trajectories and their derivatives of any order tend to infinity. Thus, the differentiator could not perform the observation alone. Figure 7.12 shows the effect of discretization in observation. The sampling time intervals D 0:0001 and D 0:01 were taken in the absence of noises.

274

7 Observation and Identification via HOSM Observers

Fig. 7.12 Observer errors (detail) with sampling intervals D 0:0001 (above) and D 0:01 (below)
Consider now the input as a bounded function with a Lipschitz derivative, k D 1. Both the state x and the disturbance are now estimated.
The linear part of the observer Eq. (7.40) is designed in the same way as before with L D 5 5 5 5 T and PQ given by Eq. (7.48). Finally, the parameters for Eq. (7.45) are chosen as 1 D 1:1; 2 D 1:5; 3 D 2; 4 D 3; 5 D 5, and 6 D 8 along with M D 1. Finite-time convergence of estimated states to the real states is shown in Fig. 7.13 with the sampling interval D 0:001. The unknown input estimation is obtained using the relation (7.47) and it is demonstrated in Fig. 7.14. The effects of discretization are shown in Fig. 7.15 based on the sampling intervals
D 0:0001 and D 0:01.
7.3 Observers for Single-Output Nonlinear Systems
The sliding mode algorithms given in the last section can be extended to the unknown input reconstruction problem for a more general single-output nonlinear case. A differentiator-based scheme is used. This requires a system transformation into a canonical basis. The unknown inputs are expressed as a function of the transformed states and thus a diffeomorphism must be established to recover the unknown input in the original states.

7.3 Observers for Single-Output Nonlinear Systems

275

Fig. 7.13 Observer errors for the unknown input estimation case

Fig. 7.14 Unknown input estimation

7.3.1 Differentiator-Based Observer

Consider a nonlinear system

xP D f .x/ C g.x/'.t/ y D h.x/

(7.49)

where f .x/ W ! Rn, g.x/ 2 Rn, h.x/ W Rn ! R are smooth scalar and vector

functions defined on an open set

Rn. The states, outputs, and unknown inputs

are given by x 2 Rn, y 2 R, and '.t/ 2 R.

276

7 Observation and Identification via HOSM Observers

Fig. 7.15 Unknown input estimation error with D 0:0001 (above) and 0.01 (below)

Assumption 7.2. For any point x 2 it is satisfied that the output y has relative degree n with respect to the disturbance '.t/, i.e.,

LgLfk h.x/ D 0; k < n 1 LgLfn 1h.x/ ¤ 0

(7.50)

This assumption means that system (7.49) does not have internal dynamics. The problem then is to design a finite-time convergent observer that generates the estimates xO ; 'O .t/ for the state x and the disturbance '.t/ given only the measurements y D h.x/. In order to accomplish this, system (7.49) must first undergo a transformation into a canonical form which we shall now proceed to describe.

System Transformation

The system in Eq. (7.49) with relative degree n can be represented in a new basis that is introduced as follows:

0 10

1

D B@BB

2
:::

ACCC D BB@B

n

10

1.x/

2.x/ :::

ACCC D @BBB

h.x/
Lf h.x/ :::

1 ACCC 2 Rn

n.x/

Lnf 1h.x/

(7.51)

7.3 Observers for Single-Output Nonlinear Systems

277

It is well known3 that if Assumption 7.2 is satisfied, then the mapping

0 ^.x/ D @BBB

1

1.x/

2.x/ :::

ACCC

n.x/

(7.52)

defines a local diffeomorphism in a neighborhood of any point x 2 N
means x D ^ 1. /

, which

This is an important property since the signals obtained for the transformed

system cannot be interpreted for the original system otherwise. Taking into account

Eqs. (7.51) and (7.52), the system (7.49) with relative degree n can be written in the

form

P D  C . / C . ; '.t//

(7.53)

where

2 010



D

4666

0 :::

0 :::

1 :::

000

3 0

0 :::

7577

2

Rn

n

0

(7.54)

and

0 0 10

0

1

. / D B@BB

0 :::

ACCC D BB@B

0 :::

CCAC

Lnf h.x/

Lfn h.^ 1. //

(7.55)

and

0

10

1

0

0

. ; '.t// D BBB@

0 :::

CCAC D BBB@

0 :::

ACCC

LgLnf 1h.x/'.t /

LgLnf 1h.^ 1. //'.t /

(7.56)

In order to obtain the necessary derivatives of the output, the following higher-order sliding mode observation/differentiation algorithm (from Chaps. 4 and 6) is used.

3See, for example, [112].

278

7 Observation and Identification via HOSM Observers

Higher-Order Sliding Mode Observer/Differentiator

The derivatives i , i D 1; : : : ; n of the measured outputs y D h.x/ can be estimated in finite time by the higher-order sliding mode differentiator. This can
be written in the form

zP0 D v0 D z1

Ä 0 jz0

y

j

n nC1

sign.z0

y/

zP1 D v1 D z2 Ä1jz1 v0j n n 1 sign.z1 v0/

:::

zPi D vi D zi

Äi jzi

vi

jni
1 n i C1

sign.zi

vi 1/

:::

zPn D Än sign.zn vn 1/

(7.57)

The choice of Äi , i D 0; : : : ; n is discussed in Chap. 6 (see, for instance, Eq. (6.29)). Therefore, the following estimates are available in finite time:

0 O D BBBB@

O
1
O
2
:::

10 CCCCA D B@BB

O 1.x/ O 2.x/
:::

10 CACC D BBB@

z0
z1 :::

1 CCCA D ^.x/

O
n

O n.x/

zn 1

(7.58)

The finite-time estimation xO of the state x can be easily obtained from Eqs. (7.52)

and (7.58) as

xO D ^ 1.O/

(7.59)

With a proper estimation of the system states achieved we can now concentrate on the other observation objective and proceed to identify the disturbance.

7.3.2 Disturbance Identification

Combining Eq. (7.59) and the last coordinate of the transformed system in Eq. (7.53), we obtain

P
n

D

Lfn

h.^

1.

// C LgLfn

1h.^

1.

//' .t /

(7.60)

Since

the

exact

finite-time

estimate

PO
n

of

P
n

is

available

via

the

high-order

sliding

mode differentiator Eq. (7.57), and using the estimate O of in Eq. (7.60), the finite-

time estimate 'O .t/ of the disturbance can be obtained from

'O .t / D .LgLfn

1h.^

1 . O ///

1 hOP
n

i Lfn h.^ 1.O//

(7.61)

7.3 Observers for Single-Output Nonlinear Systems

279

Example 7.5. Consider a satellite system which is modeled as

P Dv

vP D !2

kg M
2

Cd

!P D 2v! Â! m

In the equations above is the distance between the satellite and the Earth's center, v is the radial speed of the satellite with respect to the Earth, is the angular velocity of the satellite around the Earth, m and M are the mass of the satellite and the Earth, respectively, kg represents the universal gravity coefficient, and Â is the damping coefficient. The quantity d which affects the radial velocity equation is assumed to be a disturbance which is to be reconstructed/estimated. Let x WD col.x1; x2; x3/ WD . ; v; !/. The satellite system can then be rewritten as follows:

0 xP D B@

x2

1 01 0

x1 x32

k1 x12

AC C @1A d.t/

2x2 x3 x1

k2x3

0

(7.62)

y D x1

(7.63)

where y is the system output, k1 D kgM and k2 D Â=m. By direct computation, it follows that
Lgh.x/ D 0; LgLf h.x/ D 1

and thus the system in Eqs. (7.62) and (7.63) has global relative degree 2. Choose

the coordinate transformation as T W 1 D x1; 2 D x2; Á D x12x3. Note that for

x1 ¤ 0, this transformation is invertible and an analytic expression for the inverse

can be obtained as x1 D

1; x2 D

2; x3 D

Á
2

.

Since

x1

D

is the distance of the

1

satellite from the center of the Earth x1 ¤ 0. It follows that in the new coordinates

col. 1; 2; Á/ the system from Eqs. (7.62) and (7.63) can be described by

P
1

D

2

P
2

D

Á2
3

1

k1
2

C

d

1

ÁP D k2Á

In this system the internal dynamics (given by the last equation) are linear and asymptotically stable, since k2 > 0; and therefore the system itself is locally detectable. The higher-order sliding mode differentiator is described by

280

7 Observation and Identification via HOSM Observers

zP01 D v01

v01 D

1 0

jz01

yj2=3sign.z01

zP11 D v11

v11 D

1 1

jz11

v10j1=2sign.z11

zP12 D

1 2

sign.z21

v11/

y/ C z11 v10/ C z21

where col.z10; z21/ or col.z01; v10/ give an estimate of and the estimate for Á can be obtained from the equation ÁPO D k2ÁO. Therefore, the estimate of the disturbance d.t/ is available online, and can be obtained from the expression

dO

D

PO
2

ÁO 2 O3

C

k1 O2

1

1

In the simulations, the parameters have been chosen as follows: m D 10; M D

5:98 1024; kg D 6:67 10 11, and Â D 2:5 10 5. For simulation purposes, the

disturbance d.t/ D exp 0:002t sin.0:02t/ has been introduced. The differentiator

gains

j i

j

have been

chosen as

1 0

D

2 and

1 1

D

1 2

D

1. In the following

simulation, the initial values x0 D .107; 0; 6:3156 10 4/ are used for the plant

states (in the original coordinates) while for the observer z0 D .1:001 107; 0; 1/ and

ÁO0 D 6:3156 10 4 (in the transformed coordinate system). Figures 7.16 and 7.17

show that the states and the disturbance signal d.t/ can be reconstructed faithfully.

7.4 Regulation and Tracking Controllers Driven by SM Observers
7.4.1 Motivation
The higher-order sliding mode observers presented in this chapter provide both theoretically exact observation and unknown input identification. This means that using such observers we cannot only observe the system states but also compensate matched uncertainties/disturbances (theoretically) exactly. Therefore, higher-order sliding mode observers create a situation in which two quite distinct control strategies can be used for the compensation of the matched uncertainties/disturbances:
· Sliding mode control based on observed system states · The direct/continuous compensation of the uncertainties/disturbances based on
its reconstructed/identified values

7.4 Regulation and Tracking Controllers Driven by SM Observers

281

Fig. 7.16 The response of system states and their estimates
Both types of compensation are theoretically exact. In this section the control algorithms based on two proposed strategies are derived and compared. Finally, recommendations for the proper use of proposed algorithms are made which depend on the agility of the actuators, the parameters of discrete time implementation, and the measurement noise.

7.4.2 Problem Statement

Consider the linear time-invariant system with unknown inputs (LTISUI) of the

form:

xP .t/ D Ax .t/ C B .u .t/ C w .t// y .t/ D C x .t/

(7.64)

where x .t/ 2 Rn, u .t/ 2 Rm, y .t/ 2 Rp (1 Ä p < n) are the state vector,
the control, and the output of the system, respectively. The unknown inputs are represented by the function vector w .t/ 2 Rq. Furthermore, rank.C / D p and rank.B/ D m. The following conditions are assumed to be fulfilled henceforth:

A1. The pair .A; B/ is controllable.

282

7 Observation and Identification via HOSM Observers

Fig. 7.17 The disturbance d.t / and its reconstruction signal dO.t /

A2. For u D 0, the system is strongly observable (or the triple .A; C; B/ has no
invariant zeros). A3. w.t/ is absolutely continuous, and there exists a constant wC such that
kw .t/k Ä wC:

In this section we will firstly derive an observer-based robust output control for

system (7.64) of the form

u.t/ D u0.t/ C u1.t/

(7.65)

where u0.t/ is a nominal control designed for the nominal system (i.e., w .t/ D 0) and u1.t/ is a compensator of the unknown input vector w.t/.

7.4.3 Theoretically Exact Output-Feedback Stabilization (EOFS)

Here, a compensation control law is designed based on the estimated states and the unknown input identification. Consider the nominal system

xP0 .t/ D Ax0 .t/ C Bu0 .t/

(7.66)

7.4 Regulation and Tracking Controllers Driven by SM Observers

283

The control signal u0.t/ is a stabilizing state-feedback control for the nominal system,
u0.t/ D Kx.t/
where the gain K can be designed using any control strategy. Let us design the second part of the control input Eq. (7.65) as

u1.t/ D wO .t/

where wO .t/ is the identified unknown input.

Theoretically, assuming exact observation and identification, the equalities

xO .t/ Á x .t/ and wO .t/ Á w .t/ hold after a finite time T . When the EOFS

control law is given by

u.t/ D Kx.t/ wO .t/

(7.67)

applied to system (7.64) it yields the following closed-loop dynamic equation: xP .t/ D .A BK/x.t/. Theoretically the continuous control u1.t/ exactly compensates the matched perturbations and the solutions for systems (7.64) and (7.66) coincide.

7.4.4 Output Integral Sliding Mode Control

In this subsection, we propose applying the ISM method using the estimated states

obtained by the HOSM observer. We will call it output integral sliding mode control

(OISMC). Consider a control input of the form (7.65), where u0.t/ is the nominal
control for the system without uncertainties Eq. (7.66). Let the nominal control
be u0.t/ D Kx.t/. The compensator u1.t/ should be designed to reject the disturbance w .t/ in the sliding mode on the manifold fxW s.x; t/ D 0g ; so that
the equivalent control u1eq D w.t/: The switching function s.x; t/ is defined as s.x; t/ D s0.x; t/ C .x; t/; where s; s0; 2 Rm and s0.x; t/ D BCx.t/ (BC D .BT B/ 1BT ) and the integral part is selected such that x.t/ D x0.t/ for all t 2 OET; 1/. In other words, from t0 D T the system state belongs to the sliding
surface, where the equivalent sliding mode control ueq.t/ should compensate for the unknown input, that is, ueq.t/ D w.t/. To achieve this purpose, is determined from the equation P.t/ D BC .Ax.t/ C Bu0.t// ; with .t0/ D BCs.x.t0//:
The switching surface takes the form

Ä

Zt

s.x .t/ ; t/ D BC x.t/ x.t0/

OEAx. / C Bu0.x; / d

t0

where t0 T . The compensator u1.t/ is designed as a discontinuous unit-vector

control u1.t/ D

s.x ks.x

.t .t

/;t /;t

/ /k

.

Thus,

the

sliding

mode

manifold

s.x;

t/

is

attractive

from t0 if > wC kw .t/ k. Finally, the control law Eq. (7.65) is designed as

follows:

284

7 Observation and Identification via HOSM Observers

u.x; t/ D Kx.t/

s.x; t/ ks.x; t/k

(7.68)

Again, in the ideal case, system (7.64) with u.x; t/ given by Eq. (7.68) takes the form of Eq. (7.66).

7.4.5 Precision of the Observation and Identification Processes

Suppose that we would like to realize the observation with a sampling step  while considering that a deterministic noise signal n.t/ (a Lebesgue-measurable function of time with a maximal magnitude Á) is present in the system output. Let

f .t / D f0 .t / C n .t / ; f0.iC1/ .t / < L; kn.t /k Ä "

(7.69)

From Theorem 6.2, the error caused by the sampling time in the absence of noise for an i th-order HOSM differentiator given by Equation (6.28) is

f0.j / .t / zj .t / Ä O. i j C1/ for j D 0; : : : ; i

(7.70)

and the differentiator error caused by a deterministic upper bounded noise will be

f0.j / .t /

i j C1
zj .t / Ä O." iC1 / for j D 0; : : : ; i

(7.71)

Here, we are dealing with an . C k 1/th-order HOSM differentiator: To recover

the estimated state, .k 1/ differentiations are needed. From expressions (7.70)

and (7.71) it follows that the observation error caused by the sampling time is O. C1/, while the observation error caused by a deterministic upper bounded noise
C1
is O." Ck /.

It is clear that k differentiations are needed in order to recover the estimated

unknown input. Therefore, from (7.70) the sampling step identification error will Ábe

O. /; and the deterministic noise identification error Eq. (7.71) will be O


" Ck

:

The next proposition analyzes the total effect of both sampling step and deterministic noise errors:

Proposition 7.1. Let us assume i Ä k; and Á Ä kÁiC1 with k; kÁ;  some
positive constants. Then after a finite-time, the HOSM observation and identification error will be O C1 and O ./, respectively.

Remark 7.3. Table 7.1 summarizes the observation and identification errors when the unknown input w.t/ satisfies (7.69). Then, an . C k 1/th-order differentiator is used to improve precision.

7.4 Regulation and Tracking Controllers Driven by SM Observers

285

Table 7.1 Precision due to sampling step and bounded noise

Error Observation Identification HOSM differentiator

SamplingÁstep i O iC1 O .i/ O .i/

BoundedÁnoise Á C1
O Á Ck Á

O Á Ck Á 1
O Á Ck

Total effect i O C1 O ./ O ./

EOFS Realization Error. Theoretically, the perturbations are exactly compensated in finite time. Nevertheless, in the previous section we discussed how the discretization and deterministic output noise present in the observation and identification processes affect the compensation accuracy. Furthermore, an additional error, due to the actuator time constant ; will cause an error of order O. /. Now, the EOFS controller stabilization error may be estimated by

D O . / C O C1 C O ./

(7.72)

OISMC Realization Error. As we have seen, when the observation, identification,

and control processes are free from nonidealities, both controllers, EOFS and

OISMC, give identical results. However, in the practical case, the errors appearing

in the complete control process should be taken into account. In the case of the

OISMC the stabilization error is the sum of the observation error plus the control

error, i.e.,

D O. / C O.aC1/

(7.73)

Now, we analyze the accuracy of the HOSM observer and the identification procedure, combined with both control methodologies. Recall that we are using a . C k 1/th-order HOSM differentiator and that we need the .k 1/th and kth derivatives for the state observation and unknown input identification, respectively. Consider the following cases:

(a) O ./

O . /, i.e., the controller execution error is greater than the

identification process error. In such a case, it would be suitable to use the EOFS

strategy to avoid chattering.

(b) O C1

O . / O ./, i.e., the error related to the actuator time

constant is less than the identification process error. Thus, the error in the EOFS

control strategy is mainly determined by the identification error. In this case,

OISMC strategy could be a better solution for systems tolerant to chattering with oscillation frequencies of order O. 1 /.

(c) O . /

O C1 , i.e., the error caused by the actuator time constant

is less than the observation error. Once again, the precision of the EOFS controller is determined by the precision of the identification process O./,

and the precision of the OISMC controller is determined by the accuracy of the observation process O.C1/. However, it should be noted that in this case the

use of the OISMC controller could amplify the observer noise.

286

7 Observation and Identification via HOSM Observers

7.5 Notes and References

The super-twisting-based observer for mechanical systems was first presented in [25, 52].
The design of HOSM observers for strongly observable and detectable linear systems with unknown inputs is suggested in [96] and in [24]. For a proof of Theorem 7.4, see [94]. A step-by-step differentiator approach for linear systems with stable invariant zero is presented in [84].
The design of observers for nonlinear systems with unknown inputs for the case when the relative degree of unknown inputs with respect to measured outputs is well defined is given in [95]. The method in [95] does not require the system to be strongly observable, but the internal dynamics must be asymptotically stable. The first approach to state observation presented in Sect. 7.2 (but for a class of nonlinear systems) was given in [42]. The first paper in which the approach in Sect. 7.3.1 was presented for state observation is [41]. In [41] step-by-step differentiation was used. The work in [83] also uses step-by-step differentiation. Subsequently in [53, 54] HOSM differentiators were applied for the design of HOSM observers, which requires only the transformation of the observability Jacobian, but does not require the inversion of observability map. Parameter identification methods are also studied in [48].
The satellite system example is taken from [95], although the original model is from Marino and Tomei [180].
For details of the recursive least-squares algorithm see, for example, [173]. The proof of Theorem 7.1 is given in [173].
The comparison of effectiveness of HOSM-based uncertainty identification and compensation versus sliding mode based uncertainty compensation, is presented in [79]. HOSM observer based control for the compensation of unmatched uncertainties was developed in [80].
State estimation and input reconstruction in nonminimum phase causal nonlinear systems using higher-order sliding mode observers is studied in [166].
Automotive applications of sliding mode disturbance observer- based control can be found in the book [111].

7.6 Exercises

Exercise 7.1. The pendulum-cart system (see Fig. 7.18), when restricted to a twodimensional motion, can be described by the following set of equations:

.M C m/xP C mlÂR D u.I C ml2/ÂR C mlxR D mgl

(7.74)

where M and m are the mass of the cart and the pendulum, respectively, l is the pendulum length, Â .t/ is its deviation from the vertical, and x.t/ represents the horizontal displacement of the cart. The system parameters are given as M D 2OEkg;

7.6 Exercises

287

Fig. 7.18 The pendulum-cart system

Fig. 7.19 Mass-spring-damper system

m D 0:1OEkg, and l D 0:5OEm. Given the measured outputs Â and x, design a supertwisting observer for ÂP and xP for the uncontrolled case, u D 0. Assume the system's initial conditions are Â.0/ D 0:3OErad; ÂP .0/ D 0:03OErad=s; x.0/ D 0OEm, and
xP .0/ D 0:1 OEm/s. Confirm the efficacy of the estimation algorithm via simulation if ÂO .0/ D 0 OErad; ÂPO .0/ D 0OErad=s; xO .0/ D 0OEm, and xPO D 0OEm/s.

Exercise 7.2. Given the following mass-spring-damper system with friction (see Fig. 7.19)

mxR C b0xP C b1sign .xP / C kx D u

(7.75)

where m D 1 OEkg ; b0 D 0:1 OEkg/s ; b1 D 0:05 kg/s2 ; and k D 0:5 OEkg/s, design a feedback twisting control which achieves the tracking objective

x ! xd D 0:7 sin .2:3t/ C 1:8 sin.6:4t/

(7.76)

288

7 Observation and Identification via HOSM Observers

Fig. 7.20 Mass­spring­damper fourth-order system

Consider the only output of the system to be y D x and design a super-twisting observer with xO D 0 and xOP D 0 to estimate xP for the system starting at rest. Verify the convergence of the state estimates via simulation.

Exercise 7.3. Consider system (7.75) with unknown coefficients m; b0, and k that is controlled by the tracking twisting controller to follow the command profile Eq. (7.76). Use the super-twisting observer with xO D 0 and xOP D 0 to estimate the mass velocity xP as well as the unknown parameters for the system starting at rest. Compare the simulation results with those obtained in Exercise 7.2.

Exercise 7.4. Assuming that x1 is measured, design the twisting tracking controller as in Exercise 7.2 that drives x1 to follow the desired trajectory in Eq. (7.76), for the system shown in Fig. 7.20 and described by

xP1 D x2 xP2 D 500x1 C 150x3 C 1:2u xP3 D x4 xP4 D 200x1 600x3 20x4 y D x1

Estimate x2 via the super-twisting state observer and reconstruct the position of the second mass, x3, treated as a disturbance in the first two equations. Use x0 D OE0:4; 3:0; 0:28; 0T as initial conditions for the system and xO0 D OE0; 0; 0; 0T for the observer in your simulations.

Exercise 7.5. Consider a flux-controlled DC motor whose dynamics are given by the following equations:

xP1 D x2 xP2 D 0:1x2 C 0:1x3u C xP3 D 2x3 0:2x2u C 200

(7.77)

7.6 Exercises

289

where x1 is the rotor position, x2 is the angular velocity, x3 is the current in the motor armature, and is a disturbance. Assume that the system is affected by a perturbation signal ¤ 0 and that both the position x1 and the internal dynamics x3 are measured. A zero-average random noise of amplitude " D 0:001 is assumed to affect the measurement of x1. Apply the concept of equivalent control to identify
D cos.0:5t/ C 0:5 sin.t/ C 0:5 and the discontinuous signal shown in Fig. 7.5, given the initial conditions x0 D OE1000; 4 ; 100T and xO0 D OE0; 0; 0T . Perform simulations to confirm the proper reconstruction of .
Exercise 7.6. If a rotary spring is attached to the axis of the DC motor described in Exercise 7.5 then its dynamics may be represented by

xP1 D x2 xP2 D a1x1 a2x2 C 0:1x3u xP3 D 2x3 0:2x2u C 200

(7.78)

Design an appropriate controller u such that it satisfies the persistent excitation
condition and estimate the unknown parameters a1 and a2 using the second-order sliding mode parameter estimator. Use x0 D OE10; 4 ; 100T and xO0 D OE0; 0; 0T for simulation purposes.

Exercise 7.7. Consider the following LTI system:

2

01

xP

D

646666

0 0 0

0 0 0

3 23 23

0 00

0

0

1 0 0

0 1 0

100777775 x C 646666000777577 u C 664666000577777 .t/;

12 4 15 5 3

1

1

yD 1 0 0 0 0 xC

with initial conditions x.0/ D 1 0 1 0 1 T . Assume that the output is affected by a deterministic noise

D 0:02 cos .1024 j sin .606t/ j/

Identify the constant unknown input D 12 using the sliding mode observer for

strongly observable systems assuming the control input is u D 0. Furthermore,

apply feedback control to place the system poles at 2; 4; 6; 1; 3:5, and

identify the sawtooth wave

.t /

D

2

t 0:5

floor

t 0:5

C

1 2

. In both cases, use

a Luenberger observer as the linear part of the observer and compare the results

through simulations using a Kalman filter. The initial conditions for the observer should be xO0 D OE0; 0; 0; 0; 0T in all cases.

290

7 Observation and Identification via HOSM Observers

Exercise 7.8. Consider the DC motor in Exercise 7.78 described by Eq. (7.77). Assume that a zero-average random noise of amplitude " D 0:001 affects the measurement of x1. Verify the strong observability of the system and apply the sliding mode observer to identify D cos.0:5t/ C 0:5 sin.t/ C 0:5 and the discontinuous signal shown in Fig. 7.5 given the initial conditions x0 D OE0; 4 ; 100T and xO0 D OE0; 0; 0T . Compare the results with those obtained using the observer in Exercise 7.5 by means of simulation.
Exercise 7.9. Consider the following third-order nonlinear system:

xP1 D 2x1 xP2 D x1 xP3 D x32 y D x2

x2 C x3

Â

Ã

2x3

2x1 C sin.x2/ 2 C cos.x3/

C d.t/

(7.79)

where d.t/ D sin .3:18t/ C 2 sin .7:32t/ C 0:5 cos .0:79t/ represents an unknown input. Design a differentiator-based observer that generates estimates of the state x and the unknown input d.t/, given the output y. Show the efficacy of the observer by means of simulations, considering the initial conditions x.0/ D OE1; 2; 1T and xO .0/ D OE0; 0; 0T .
Exercise 7.10. The chaotic Chua's circuit can be described by the following state equations:

xP1 D acx1 C ax2 xP2 D x1 x2 C x3 xP3 D bx2 y D x3

ax13 C d.t /

(7.80)

The parameters of the system are chosen as a D 10, b D 16, c D 0:143. Consider the unknown input term as d.t/ D 0:5 sin.t/. Generate an estimate for the unknown input using the differentiator-based observer. Realize the corresponding simulations given the initial conditions x.0/ D OE0:1 0:1 0:1T and xO .0/ D OE0; 0; 0T .
Exercise 7.11. Develop a differentiator-based observer when Assumption 7.2 is not satisfied, i.e., in the case when the output y has relative degree r < n with respect to the unknown input '.t/.
Exercise 7.12. Necessary and sufficient conditions for the strong observability of linear and nonlinear systems single-output systems were given in this chapter. Formulate the equivalent conditions for strong observability in multiple-input, multiple-output systems.

Chapter 8
Disturbance Observer Based Control: Aerospace Applications

The practical implementation of sliding mode controllers usually assumes knowledge of all system states. It also typically requires information (at least in terms of the boundaries) about the combined effect of drift terms, i.e., the internal and external disturbances of the system. In this chapter a feedback linearizationlike technique is used for obtaining the input­output dynamics and reducing all disturbances to the matched ones. Then the sliding variables are introduced and their dynamics are derived. The higher-order sliding mode differentiator-based observer, which was discussed in Chap. 7, is used to the estimate system states, the derivatives of the sliding variables, as well as the drift terms. Therefore, in finite time, all information about the sliding variable dynamics becomes available. The estimated drift term is then used in the feedback loop to compensate the disturbances. The observed states are then used to design any (continuous) robust state-space controller while eliminating the chattering effect. Two case studies, launch vehicle and satellite formation control, illustrate the discussed robust control technique.

8.1 Problem Formulation

This section presents a continuous SMC technique based on a sliding mode disturbance observer (SMDO) that is applied to robust output tracking in feedbacklinearizable perturbed/uncertain MIMO systems, with nonlinear feedback. Consider a nonlinear MIMO system

xP D f .x; t/ C G.x; t/u

(8.1)

y D h.x; t/

where f .x; t/; 2 Rn; h.x; t/ D OEh1; h2; : : : ; hmT 2 Rm; G.x; t/ D OEg1; g2; : : : ; gm 2 Rn m; and gi 2 Rn 8i D 1; 2; : : : ; m are analytic vector and matrix functions. The system states, outputs, and inputs are given by x 2 Rn, y 2 Rm; and u 2 Rm,

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

291

DOI 10.1007/978-0-8176-4893-0 8, © Springer Science+Business Media New York 2014

292

8 Disturbance Observer Based Control: Aerospace Applications

respectively. Assume that the system (8.1) is completely feedback linearizable in a reasonable compact domain x 2 . Then the system can be transformed into a regular form

2 6466

y1.r1/ y2.r2/ :::

3 7757

D

2 4666

Lrf1 h1.x; t / Lfr2 h2.x; t /
:::

3 7577

C

E.x; t/u

ym.rm/

Lrfm hm.x; t /

(8.2)

where

E.x; t/

D

2 6664

Lg1 .Lfr1 Lg1 .Lfr2
:::

1 h1 / 1 h2 /

Lg2 .Lrf1 1h1/ Lg2 .Lrf2 1h2/
:::

::: ::: :::

Lgm .Lfr1 Lgm .Lfr2
:::

1h1/ 3 1h2/ 5777

Lg1 .Lfrm 1hm/ Lg2 .Lfrm 1hm/ : : : Lgm .Lfrm 1hm/

(8.3)

and det E.x; t / ¤ 0. In the above Lfri hi .x; t / and Lgi .Lfrj 1hj / 8i; j D 1; 2; : : : ; m are the corresponding Lie dP erivatives. The vector rN D OEr1; r2; : : : ; rm is the vector-relative degree, and rt D ri is the total relative degree, such that rt D n.
The problem is in designing a continuous control u that provides robust de-
coupled output tracking in system (8.1):

ei D yic yi ! 0 8i D 1; 2; : : : ; m

(8.4)

where yic is the i th output command profile given online. The formulated problem is addressed by enforcing the desired compensated
dynamics. This is achieved by designing corresponding sliding variables, driving them to zero by means of continuous sliding mode controls ui :

8.1.1 Asymptotic Compensated Dynamics

In this subsection the sliding variables is introduced as

i D ei.ri 1/ C ci;ri 2ei.ri 2/ C : : : C ci;1ei.1/ C ci;0ei ; i D 1; 2; : : : m

(8.5)

The asymptotic decoupled output tracking compensated dynamics in system (8.2), such that ei ! 0 8i D 1; 2; : : : m is achieved in the sliding mode

ei.ri 1/ C ci;ri 2ei.ri 2/ C : : : C ci;1ei.1/ C ci;0ei D 0 8i D 1; 2; : : : m

(8.6)

8.1 Problem Formulation

293

if the coefficients ci;j > 0 8j D 0; 1; ::; ri 2 are chosen to provide the desired eigenvalue placement in the decoupled differential equations (8.6). The dynamics in Eq. (8.6) is enforced by designing control u that drives i ! 0:

8.1.2 Finite-Time-Convergent Compensated Dynamics

In this subsection the sliding variables are chosen to guarantee the finite-timeconvergent compensated dynamics in the sliding mode. They are:

ei.ri /Cki;ri ei.ri

1/i;risign

ei.ri

Á 1/ C: : :Cki;1 jei ji;1 sign .ei / D 0

8i D 1; 2; : : : m

(8.7)

where the coefficients ki;j > 0 8i D 1; 2; : : : m 8j D 1; 2; : : : ri , make the polynomials Pi . / D . ri C ki;ri ri 1 C : : : C ki;1 Hurwitz, and i;1; : : : ; i;ri are defined as

i;j

1

D

i;j i;j C1 2i;j C1 i;j

8i D 1; 2; : : : m 8j D 2; 3; : : : ri

(8.8)

with i;ri C1 D 1 and i;ri D  for some  2 .0; 1/ : The compensated dynamics (8.7) and (8.8) can be enforced by designing an
appropriate continuous control u.
Remark 8.1. In order to compute the sliding variable i given by Eq. (8.5) or to enforce the finite-convergent-time asymptotic dynamics in Eqs. (8.7) and (8.8) the ri 1 consecutive derivatives of the tracking error ei must be calculated/estimated. This can be achieved using the HOSM differentiator studied in Chaps. 4 and 6:

zP0i D v0i D z1i zP1i D v1i D z2i

Ä0i jz0i Ä1i jz1i

ri
ei j ri C1 sign.z0i
ri 1
v0i j ri sign.z1i

:::

zPri ;i D Äri ;i sign.zri ;i vri / 1;i

ei / v0i /

(8.9)

where the Äj i are defined as in Sect. 6.7. The finite-time estimation of the output

tracking errors and their consecutive ri 1 derivatives ei ; : : : ; ei.ri 1/ can be easily obtained from equations z0i D ei ; z1i D ePi ; ::; zri 1;i D ei.ri 1/:

Denoting

v D E.x; t/u , u D E 1.x; t/v; v D OEv1; v2; ::; vmT

(8.10)

the sliding variable (8.5) dynamics can be presented in a decoupled form

P i D i .:/ vi

(8.11)

where i .:/ D yi.cri / Lrfi hi .x; t / C ci;ri 2e.ri 1/ C : : : C ci;0e.1/ 8i D 1; 2; : : : m:

294

8 Disturbance Observer Based Control: Aerospace Applications

Remark 8.2. In order to facilitate the computation of the matrix E 1.x; t/ the state vector x must be estimated in finite time. In particular, it can be achieved using HOSM observers (see Chap. 7).

8.1.3 Sliding Variable Disturbed Dynamics

Assume that the drift terms i .:/ in Eq. (8.11) consist of a sum of known terms 0i .:/ and the unknown terms  i .:/:

i .:/ D 0i .:/ C  i .:/

(8.12)

The unknown terms that are due to external disturbances and model uncertainties
are assumed to be bounded so that j i .:/j Ä Li . Then, Eq. (8.11) can be rewritten in a form

Pi D

0 i

.:/

C



i .:/

vi

(8.13)

Now, the output tracking problem in system (8.2) is reduced to designing the continuous control laws vi that drive the sliding variables i to zero in the presence of the unknown bounded disturbances  i .:/.

8.1.4 Output Tracking Error Disturbed Dynamics

In order to design the controller that drives the tracking errors to zero in finite time, the error dynamics (8.4) for system (8.2) are presented as

ei.ri / D yi.cri / Lfri hi .x; t / vi

(8.14)

where

N
i

unknown

.b:o/uDndeydi.cri /

N

Li .fr:i/h iÄ.xL;Nti/tecramnsb:e

presented

as

a

sum

of

known

N

0 i

.:/

and

N i .:/ D N i0.:/ C  N i .:/

(8.15)

Therefore, the error dynamics in Eq. (8.14) are reduced to the following equation:

ei.ri / D

N

0 i

.:/

C



N

i

.:/

vi

(8.16)

Here the problem is reduced to designing the continuous control laws vi that drive
the output tracking errors in Eq. (8.16) to zero in finite time in the presence of the unknown bounded disturbances  N i .:/.

8.2 Perturbation Term Reconstruction via a Disturbance Observer

295

8.2 Perturbation Term Reconstruction via a Disturbance Observer

In the first step of the continuous SMC/SMDO design methodology, the perturbation term must be estimated/reconstructed.
In order to design the SMDO for estimating the bounded disturbance  i .:/ in Eq. (8.13), the auxiliary sliding variables si are introduced

si D i C zi zPi D 0i .:/ C vi !i

(8.17) (8.18)

whose dynamics are derived as

dsi D  dt

i .:/

!i

(8.19)

where !i is the injection term of the SMDO in Eq. (8.19). For estimating the bounded disturbance  N i .:/ in Eq. (8.16), other auxiliary
sliding variables sNi are introduced:

sNi D ei.ri 1/ C i

P
i

D

N 0i .:/ C vi

$i

(8.20) (8.21)

The sNi dynamics, taking into account Eq. (8.16), are presented as

dsNi dt

D  N i .:/

$i

where $ i is the injection term of the SMDO in Eq. (8.22).

(8.22)

8.2.1 SMDO Based on Conventional SMC

The injection term given in a conventional SMC format is

!i D i sign.si /; i D Li C "i

(8.23)

which drives si ! 0 in finite time. Then, in the auxiliary sliding mode, si D 0; and the disturbance term  i .:/ can be exactly estimated:

 i .:/ D !ieq

(8.24)

296

8 Disturbance Observer Based Control: Aerospace Applications

where !ieq is the equivalent injection term. Note that it is practically impossible to compute the equivalent injection term !ieq exactly, but only estimate it via low-pass filtering of control (8.23) in the sliding mode. For instance, the low-pass filter can
be implemented as a first-order lag block

N

i

d!N ieq dt

D

!N ieq C !i

(8.25)

where N i > 0 is a small-enough time constant of the low-pass filter (8.25). It is
worth noting that the low-pass filter estimates the equivalent injection term !O ieq .t/ with the accuracy proportional to the time constant of the filter O i :

!N ieq !ieq D O. N i /

(8.26)

Therefore, we obtain the estimation of the perturbation term  i .:/ in a conventional sliding mode

 i .:/est !N ieq

(8.27)

with the accuracy

k i .:/est  i .:/k D O. N i /

(8.28)

Furthermore, the lim k i .:/est  i .:/k D 0 as Ni ! 0:
Remark 8.3. Since the term  N i .:/ can be estimated by the conventional SMCbased SMDO only asymptotically, some phase and amplitude distortions are
expected (see, for instance, Eq. (8.28)). Apparently, it is better not to reconstruct the term  N i .:/ using this asymptotic observer for enforcing the output error dynamics in Eqs. (8.7) and (8.8), since these output tracking dynamics are expected to be
finite-time convergent. Consequently, it makes sense to reconstruct the disturbance terms  N i .:/ also in finite time in order to retain overall finite-time convergence (dynamical collapse) in the output tracking.

8.2.2 SMDO Based on Super-Twisting Control

Abosusunmdeidn,gi.eth.,e

ddedrtii.v:/atiÄvesLN io,fthtehienjepcetritounrbteartimons

terms  given in a

i .:/ in Eq. super-twisting

(8.19) format

are are

!i D 0;i jsi j1=2sign.si / C Ái ÁP i D 1;i sign.si /

(8.29)

8.2 Perturbation Term Reconstruction via a Disturbance Observer

297

p with 0;i D 1:5 LN i and 1;i D 1:1LN i which drive si ; sPi ! 0 in finite time (see, for instance, Chaps. 4 and 7). Therefore, in the second-order sliding mode, an exact estimate of the perturbation term  i .:/

 i .:/est D !i

(8.30)

is obtained. The super-twisting-based SMDO can be also designed for estimat-

ing/reconstructing the unknown the derivative of this term is also

disturbances bounded: i.e.,



N
d

i d.N:ti/.:/in

Eq. (8.16), assuming that Ä LQ i : The injection terms

$i are designed in the super-twist format as in Eq. (8.29) so that

$ i D 0;i jsNi j1=2sign.sNi / C i

(8.31)

P i D 1;i sign.sNi /

p

with 0;i D 1:5

LQ i and 1;i

D 1:1LQ i

and

drive

sNi

;

d sNi dt

! 0 in finite time. Thus,

the disturbances  N i .:/ are exactly reconstructed in finite time in accordance with

Eq. (8.22) and the super-twisting SMDO (8.31):

 N i .:/est D $ i

8.2.3 Design of the SMC Driven by the SMDO

Asymptotic Continuous SMC/SMDO Design

The continuous sliding mode controllers vi driven by the sliding mode disturbance observer (SMC/SMDO) that robustly asymptotically stabilize the sliding variable

i , whose dynamics are given by Eq. (8.13) in the presence of an unknown bounded disturbance  i .:/; are designed as follows:

vi D

0 i

.:/

C



i .:/est C Ki

i

(8.32)

The compensated sliding variable dynamics become

P i D Ki i

(8.33)

where Ki > 0 must be selected in order to provide the desired convergence rate i ! 0. Therefore, a continuous control law u that robustly drives the output tracking
error of Eq. (8.1) ei ! 0 8i D 1; 2; : : : m as time increases, in the presence of bounded disturbances, is designed given by

u D E 1.x; t/v; v D OEv1; v2; ::; vmT vi D 0i .:/ C  i .:/est C Ki i 8i D 1; 2; : : : m

(8.34)

298

8 Disturbance Observer Based Control: Aerospace Applications

where the  i .:/est is estimated by either a conventional sliding mode or super-twisting SMDO. The sliding variables i are computed using HOSM differentiators (8.9).
Remark 8.4. The SMC/SMDO design in Eqs. (8.27), (8.30), and (8.34) yields continuous control that is robust to the bounded disturbances and uncertainties. This SMC/SMDO controller can be interpreted as asymptotic SMC since i ! 0 as time increases due to Eqs. (8.33) and (8.6).

Finite-Convergent-Time Continuous SMC/SMDO Design

The continuous sliding mode controllers vi , driven by the sliding mode disturbance observer (SMC/SMDO), which robustly establish the error dynamics in Eq. (8.16) to zero in finite time are designed taking into account Eq. (8.7):

vi D N 0i .:/ C  N i .:/est C ki;ri ei.ri

1/i;ri sign

ei.ri

Á 1/ C : : : C ki;1 jei ji;1 sign .ei /

(8.35)

The compensated finite-convergent-time output tracking error dynamics become as

in Eq. (8.7).

Therefore, the continuous control law u that robustly drives the output tracking

error ei of Eq. (8.1) to zero in finite time in the presence of bounded disturbances is

u D E 1.x; t/v

(8.36)

8.3 Case Study: Reusable Launch Vehicle Control
Flight control of both current and future reusable launch vehicles (RLV) in ascent and descent, as well as in approach and landing modes, involves attitude maneuvering through a wide range of flight conditions, wind disturbances, and plant uncertainties. The discussed SMC/SMDO becomes an attractive robust control algorithm for RLV maneuvers because, as well as being continuous, the SMC/SMDO controller is insensitive and robust to RLV uncertainties and external disturbances. In this section we study SMC/SMDO controller design for RLV flying in the terminal area energy management (TAEM) and approach/land (TAL) regions of flight (Fig. 8.1).

8.3.1 Mathematical Model of Reusable Launch Vehicle
The nonlinear Newton­Euler equations of motion for the rigid vehicle were chosen for the RLV flight control system design. The rotational equations of motion are

8.3 Case Study: Reusable Launch Vehicle Control

299

Fig. 8.1 Example TAEM and approach/land trajectory for a RLV [104]

pP D Lpq pq qP D Mpr pr rP D Npqpq

Lqr qr C L C fL Mr2p2 .r 2 p2/ C M C fM Nqr qr C N C fN

(8.37)

where p; q, and r are the roll, pitch, and yaw rates, respectively; Lpq, Lqr , Mpr , Mr2p2 , Npq, and Nqr are functions of the vehicle inertia, L; M , and N are roll, pitch, and yaw accelerations arising from the aerodynamics, and fL; fM , and fN are disturbance accelerations. Translational accelerations (uP; vP; wP ) in the vehicle body
frame are presented as:

uP D rv qw C X C Gx vP D pw ru C Y C Gy wP D qu pv C Z C Gz

(8.38)

where the acceleration terms X; Y , and Z are from the aerodynamics and Gx; Gy, and Gz are gravity terms given by

Gx D g sin.Â /; Gy D g cos.Â / sin. /; Gz D g cos.Â / cos. /

(8.39)

The Euler angles that define the orientation of the RLV relative to an inertial frame are

300

8 Disturbance Observer Based Control: Aerospace Applications

2P3

2 1

4 ÂP 5 D 46 0

P

0

tan.Â/ sin. /
cos. /
sin. / cos.Â /

tan.Â/ cos. sin. /

/

32 75 4

p q

3 5

cos. / cos.Â /

r

(8.40)

where ; Â, and are the roll, pitch, and yaw angles, respectively. The aerodynamic surfaces for the RLV are represented by three virtual surfaces (aileron, elevator, and rudder). The commanded virtual deflections

ic D OEiac ; iec ; ircT

(8.41)

where the subscripts a; e, and r represent aileron, elevator, and rudder, respectively, are distributed by a control allocator (CA) to actual aero surface actuator commands

iNc D ielc ; ierc ; if lc ; if rc ; irlc ; irrc T

(8.42)

where the subscripts el; er; f l; f r; rl, and rr represent left and right elevons, left and right flaps, and left and right rudders, respectively. These commands are fed into the individual aero surface actuators, modeled here by first-order systems

i iPi D iic ii ; i D el; er; f l; f r; rl; rr

(8.43)

The actual deflection angles in Eq. (8.43) are ii , the actuator time constants are i , and the actuator command inputs are iic:

Remark 8.5. The aero surface actuator models in Eq. (8.43) are simplifications

of the actual models, which are of higher order and nonlinear. Modeling them as

simple, linear first order as in Eq. (8.43) simplifies the controller design. In the

simulations used to verify the design, the actuators were modeled as second-order

systems with the following position and rate limits:

30i 15i 30i 60i

Ä Ä Ä Ä

iiiirrijlrÄÄÄÄ22635600iiii;;;;iPiPiiPPijrrlrÄÄÄÄ310330d00deddegege=gg=s==s;s;sijDDelf;

er l; f

r

8.3.2 Reusable Launch Vehicle Control Problem Formulation
The general problem for the flight control system design during TAL, is to determine aero surface deflection commands such that the guidance commands are robustly asymptotically followed, in the presence of external disturbances and uncertainties in the plant. Guidance commands in the TAL flight are Nzc, normal acceleration

8.3 Case Study: Reusable Launch Vehicle Control

301

(or Azc D Nzc in terms of the body frame acceleration command), c, roll angle, and rc, yaw rate. The RLV mathematical model (8.37)­(8.40) is presented in a quasi-
cascade format:

Ä APz P

Ä

D vP

uP

1 tan.Â/ sin. /

Ä p q

Ä C fAz
f

Ä

Ä

Ä

Ä

pP qP

D

Lpq pq Lqr qr Mpr p r Mr2p2 .r 2 p2

C

L M

C

fL fM

(8.44) (8.45)

rP D Npqpq Nqr qr C N C fN

(8.46)

where the f ; fAz are bounded disturbances (f  Ä L ; jfAzj Ä LAz) in the normal acceleration and roll channels. The term f is caused by modeling errors, while fAz comprises modeling errors and external disturbances, and fL; fM ; and fN are the disturbances in the roll rate, the pitch rate channels, and the yaw rate channel. All disturbances are bounded in a reasonable flight domain.
The goal is to design a continuous SMC/SMDO controller that provides decoupled asymptotic output tracking, i.e., Az ! Azc; ! c; and r ! rNc as time increases, in the presence of bounded disturbances, by means of roll, pitch, and yaw acceleration commands Lc; Mc, and Nc.

8.3.3 Multiple-Loop Asymptotic SMC/SMDO Design

The control problem is addressed using the continuous SMC­SMDO algorithm in a
multiple-loop format. The controller is designed in the following steps: Step 1 A control law for the outer loop that drives Az ! Azc and ! c is
designed in terms of virtual rate commands, pc; qc, that are fed into the inner loop. Step 2 A control law for the inner loop that drives eL D p ! pc; q ! qc; and
r ! rNcrc CrcSAS , where rNc D rc CrcSAS and rcSAS is a special term generated by the stability augmentation system (SAS), is designed in terms of angular accelerations,
Lc; Mc; and Nc. Step 3 A control allocation matrix BA is used to map the angular acceleration
command vector to the actuator virtual deflection commands:

23 Lc
ic D BA I 4 Mc 5 ; ic D OEiac ; ilc; irc 2 R3; BA 2 R3 3; I 2 R3
Nc

(8.47)

CA is then used to distribute the virtual actuator commands ic to actual aero surface actuator commands iN c, which are fed to the individual actuators (8.43): specifically

iN c D CA.ic /; iNc D ielc ; ierc; if lc; if rc; irlc ; irrc T

(8.48)

302

8 Disturbance Observer Based Control: Aerospace Applications

Outer-Loop SMC/SMDO Controller Design

The virtual controls, pc and qc , are designed in the following way:

Ä pc qc

Ä

D vP

uP

1 tan.Â/ sin. /

1 " dOAz C KAz Az # dO C K

(8.49)

where

i D ei ; i D Az; ; eAz D Azc Az; e D c

(8.50)

and dOAz is Assuming

the estimate jdAzj Ä LN Az

,oafnddAzdD

AP Ä

fAz; and dO is the estimate of d LN in a reasonable flight envelope,

D

P
Ac

f:

and denoting

Ä

Ä

Ä

Az D vP

uP

p

1 tan.Â/ sin. / q

(8.51)

the finite-convergence-time SMDO based on a super-twisting injection term is designed, in accordance with Eqs. (8.17), (8.19), (8.23), (8.24), (8.25), and (8.27).
Firstly, auxiliary sliding variables are introduced as

si D i C zi ; zPi D i vi ; i D Az;

(8.52)

and the auxiliary sliding variable dynamics are derived as

sPi D di vi ; i D Az;

(8.53)

Secondly, the super-twisting injection terms that drive the auxiliary sliding variables si , i D Az; to zero in finite time are designed (see Sect. 8.2.2)

vi D 0;i jsi j1=2 sign.si / C Ái

(8.54)

ÁP i D 1;i sign.si /

p with 0;i D 1:5 LN i , 1;i D 1:1LN i . The auxiliary injection terms vAz and vA exactly estimate the disturbances dAz and dA in Eq. (8.53) in finite times, i.e.,

dAz D vAz ; dA D vA

(8.55)

The obtained disturbance estimates are substituted into the virtual control laws in Eq. (8.49).

8.3 Case Study: Reusable Launch Vehicle Control

303

Inner-Loop SMC/SMDO Controller Design

The inner-loop input­output dynamics are taken as the lower part of Eq. (8.46). The inner-loop SMC/SMDO takes the body rate virtual control commands, pc and qc, generated by the outer-loop controller (8.51)­(8.55), and the yaw rate command rc that comes from the guidance function. The inner-loop continuous SMC/SMDO controller is supposed to enforce following the body rate virtual control commands in the presence of bounded disturbances and by generating pitch, roll, and yaw acceleration commands Lc; Mc; and Nc. In addition to tracking virtual body rate commands, the inner loop causes the system to exhibit a linear decoupled motion in the sliding mode. No timescale (separation) between the inner- and outer-loop compensated dynamics is required (but it is welcome). Following the continuous SMC/SMDO controller design algorithm presented above, the components of the vector-sliding variable are introduced as

i D ei ; i D L; M; N eL D pc p; eM D qc q; eN D eSAS

(8.56)

where, in order to provide turn coordination, a SAS generates a yaw rate command

g rcSAS D U sin. /

(8.57)

where g is the gravitational constant, U is true air speed, and the error signal used in the yaw rate loop SMC/SMDO is

esas D .rc C rcSAS r /

(8.58)

In the sliding mode L D M D N D 0, and the inner-loop compensated error dynamics are decoupled. The objective of the inner-loop control is to generate
continuous commands Lc, Mc , and Nc that provide asymptotic convergence of L; M ; N ! 0. The pitch, roll, and yaw acceleration control commands Lc ,Mc ,
and Nc are designed:

23 Lc

2 fQL 3

2

Lpq C Lqr qr

3

4 Mc 5 D 4 fQM 5 C 4 Mpr C Mr2p2 .r 2 p2/ 5

Nc

fQN

Npqpq C Nqr qr

2

32 3

KL 0 0

L

C 4 0 KM 0 5 4 M 5

0 0 KN

N

(8.59)

where fQL fQM fQN T is the estimate vector of the bounded accumulated disturbance

304

8 Disturbance Observer Based Control: Aerospace Applications

2 fNL 3

2 pPc

3 fL

4 fNM 5 D 4 qPc fM 5

fNN

rPc fN

Assuming fNL Ä LN L; fNM  Ä LN Mo, and fNN  Ä LN N

in a reasonable flight

envelope, the SMC/SMDO is designed in accordance with Eqs. (8.17)­(8.27) in

the following steps: Firstly, the components of the auxiliary vector-sliding variable OEsL; sM ; sN T are

introduced

si D i C zi ; zPi D i vi ; i D L; M; N; i D i

(8.60)

and the auxiliary vector-sliding variable dynamics are derived as

sPi D fQi vi ; i D L; M; N

(8.61)

Secondly, the super-twisting injection terms are defined as in Eq. (8.54), and drive the auxiliary sliding variables si to zero in finite times, i D L; M; N . Therefore, the auxiliary injection terms vL , vM , and vN exactly estimate the disturbances fQL; fQM , and fQN in Eq. (8.61) in finite times, i.e.,

fQL D vL ; fQM D vM ; fQN D vN

(8.62)

The disturbance estimates are fed into the virtual control laws in Eq. (8.49). Then, the obtained disturbance estimates in Eq. (8.62) are fed into the torque control laws in Eq. (8.59).

Control System Parameterization

The following choice of the controller (8.49), (8.51), (8.52), (8.53), (8.55), (8.59), (8.60), (8.61), and (8.62) parameters is recommended:

(a)

Ki > 0 8i D Az; ; L; M; N

(b)

Ki > Kj 8i D L; M; N 8j D Az;

(c)

1 Li

> Kj

8i D Az;

; L; M; N 8j D Az;

Condition (a) is necessary for providing the asymptotic stability of sliding variable

dynamics. Condition (b) enforces decoupling (time-scaling) between the inner-

. L; M ; N / and the outer-loop . Az; / sliding variable dynamics given by Eqs. (8.33). Condition (c) provides for the transient times in the SMDO, which

basically are controlled by the time constants of the filters in Eqs. (8.55) and (8.62).

These transients are supposed to be faster than the transients in the control loops.

Meeting this condition helps to reduce the effect of the SMDO dynamics on

the compensated dynamics of the tracking errors. All these conditions are not very

restrictive and can be easily met in the RLV control system design.

8.3 Case Study: Reusable Launch Vehicle Control

305

Fig. 8.2 Guidance command tracking: normal acceleration (top), roll angle (center), yaw rate (bottom), SMC/SMDO simulation, and nominal wind [104]
8.3.4 Flight Simulation Results and Analysis
The designed SMC/SMDO was coded and implemented in MATLAB/SIMULINK and the simulation results were compared with the baseline classical PID with gain-scheduling controller design. Only the autopilots were different between the two simulations; all other models remained unchanged, including a second-order actuator model with position and rate limiting and a wind model.
The simulations began at the TAEM interface and terminated at main gear touchdown on the runway. The control functions (8.59) in terms of roll, pitch, and yaw acceleration commands are transformed into virtual deflection commands by Eq. (8.47), allocated into actual actuator commands by means of the control allocator (8.48), and these are fed to the actuators (8.43) with deflection and rate limits being taken into account. The proposed continuous SMC/SMDO and the baseline controllers were compared in two simulation cases: one with a nominal wind and one with a severe headwind gust. Simulation results from the nominal wind case are shown in Fig. 8.2 through 8.5.
In comparing Figs. 8.2 (SMC/SMDO) and 8.3 (baseline), it can be seen that normal acceleration and roll angle tracking is far better with the SMC/SMDO (in particular, the roll angle command is followed almost perfectly). The yaw rate command is also followed very closely by the SMC/SMDO. The baseline controller

306

8 Disturbance Observer Based Control: Aerospace Applications

Fig. 8.3 Guidance command tracking: normal acceleration (top), roll angle (center), yaw rate (bottom), baseline simulation, and nominal wind [104]
does not follow the yaw rate command (which is always equal to zero, generated by the guidance loop) very well, due to the fact that it too uses turn coordination through interchannel cross-feeds. It is worth noting that the guidance command profiles are slightly different between the two simulations due to the fact that closed-loop guidance shapes its commands as a function of the flight condition and the distance from the landing site. The flight conditions differ because the two controllers produce different aero surface commands resulting in different aerodynamic accelerations on the vehicle. The aero surface deflections are shown in Figs. 8.4 and 8.5 for the SMC/SMDO and for the baseline controller respectively. The average deflections are similar in magnitude; however, in order to provide more accurate guidance command tracking, the SMC commands are more aggressive due to the use of the SMDO in response to maneuvers and other disturbances. This results in large transient deflections that quickly decrease once the tracking error is again close to zero.
To provide a more challenging case for the control system, a severe head-wind gust was simulated by artificially imposing a 25i angle of attack for a duration of 3 s, at 185 s flight time. The simulation results for this more stressing case are shown in Fig. 8.8 through 8.10. The gust appears as a step increase in angle of attack. Guidance command tracking is shown in Figs. 8.6 and 8.7 for the SMC/SMDO and baseline controller, respectively. At the time of the wind gust, the SMC/SMDO allows roughly 4g-error in normal acceleration, while roll and yaw errors are about

8.3 Case Study: Reusable Launch Vehicle Control

307

Fig. 8.4 Elevon (top), flap (center), and rudder (bottom) deflections, SMC/SMDO simulation, and nominal wind [104]
Fig. 8.5 Elevon (top), flap (center), and rudder (bottom) deflections, baseline simulation, and nominal wind [104]

308

8 Disturbance Observer Based Control: Aerospace Applications

Fig. 8.6 Guidance command tracking: normal acceleration (top), roll angle (center), yaw rate (bottom), and SMC simulation with severe wind gust [104]
Fig. 8.7 Guidance command tracking: normal acceleration (top), roll angle (center), yaw rate (bottom), and baseline controller simulation with severe wind gust [104]

8.4 Case Study: Satellite Formation Control

309

Fig. 8.8 Normal acceleration channel (Nz), roll channel (Phi), and yaw rate channel (r) SMC sliding variables and severe wind gust simulation [104]
the same as in the nominal simulation. In the baseline controller simulation, the vehicle rolls through 360i and the yaw rate climbs to a maximum of 50 degree per second. Figure 8.8 shows the sliding variables for the SMC/SMDO outer loop (8.50) and inner loop (8.56). Figure 8.9 shows the sliding variables for the SMDO outer loop (8.52) and SMDO inner loop (8.60). The sliding variables diverge occasionally due to the guidance maneuvers and the wind disturbance but then re-converge to a region around zero. The outer- and inner-loop SMDO disturbance estimates are shown in Fig. 8.10. The disturbance estimates are a function of maneuver rates, wind disturbances, and other unmodeled dynamics.
Remark 8.6. The proposed SMC/SMDO algorithm for the reusable launch vehicle flight control system was coded and implemented in the X-33 MAVERIC simulation. In its implementation, problems faced in real-world applications (like filtering and multi-rate subsystems) were successfully addressed.
8.4 Case Study: Satellite Formation Control
In this section we consider controlling the satellite formation, in particular, controlling the motion of one satellite as it follows a defined path around another satellite (that is orbiting the Earth). This tracking must be robust to model uncertainties

310

8 Disturbance Observer Based Control: Aerospace Applications

Fig. 8.9 Normal acceleration channel (Nz), roll channel (Phi), and yaw rate channel (r) SMDO sliding variables and severe wind gust simulation [104]
and external disturbances. The problem with any satellite formation control is that all orbiting bodies are subject to forces, which include gravitational perturbations, atmospheric drag, and solar radiation pressure, that tend to force the satellites out of their stable Keplerian orbits . Since the satellites are usually controlled by on­ off thrusters, a conventional SMC with a dead-band is often used. The width of the dead-band usually is selected to minimize the fuel consumption. At the same time, simulations show that the jet-thruster duty cycle depends on a board computer step size. It means that using a dead-band controller does not permit controlling the frequency of switching. This could create a problem in using SMC in satellite formation control actuated by jet-thrusters that can be switched " on" and " off" only with a required duty cycle.
8.4.1 Satellite Formation Mathematical Model
The formation control problem studied in this section is a two-satellite formation. The coordinate system used is illustrated in Fig. 8.11.

8.4 Case Study: Satellite Formation Control

311

Fig. 8.10 Normal acceleration channel (Nz), roll channel (Phi), and yaw rate channel (r) SMDO disturbance estimates and severe wind gust simulation [104]

The first satellite, the leader, is in a circular orbit around a spherical Earth and for simplicity it is assumed to maintain that orbit in free flight. Assuming the second satellite is in a slightly elliptical orbit but remains close to the first when compared to the overall radii of their orbits around the Earth, we use the linearized Hill's equations to describe the relative motion between a leader and follower satellite. Since the available thrust levels are very low in many satellite applications, initial misalignments as well as transients resulting from disturbances may take many hours and even days to settle out. So, scaling the natural time t, a new time is defined such that D wt, where w is the mean motion of the leader around the Earth (the value of the constant angular velocity that is required for a satellite to complete one revolution). The normalized Hill equations in the new time are

xR 2y 3x D ux C dx yR C 2xP D uy C dy zR C zP D uz C dz

(8.63)

In Eq. (8.63) ux; uy, and uz are the net (difference between leader and follower)specific control forces acting on the follower satellite, and dx; dy; and dz encompass the net-specific disturbances experienced by the two-satellite system, including linearization residuals. The specific control forces and disturbances are defined as

312

8 Disturbance Observer Based Control: Aerospace Applications

Fig. 8.11 Satellite formation coordinate system [139]

forces per unit mass per mean motion squared. All terms in Eq. (8.63) have a length dimension. The coordinates x; y, and z describe the position of the follower satellite relative to the leader satellite. Parameterizing Equation (8.63) as a function of with all external forces (control and disturbances) is equal to zero provides the reference trajectories for the simulation

xc. / D r sin. C Â / yc. / D 2r cos. C Â / zc. / D mr sin. C Â / C 2nr cos. C Â/

(8.64) (8.65) (8.66)

where r; m; n, and Â are arbitrary constants that define the elliptical desired path that the follower satellite maintains, relative to the leader in a force-free environment. In particular, r gives the size of the ellipse, Â is the initial angular position of the follower satellite on the path, and m and n are the slopes of the plane in which the path is located. For any given Â the follower satellite must enter the path (8.66) at initial conditions that are derived by setting D 0 in Eq. (8.66), as well as in the derivative of Eq. (8.66), yielding

xc.0/ D r sin.Â/; yc.0/ D 2r cos.Â/; zc.0/ D mr sin.Â/ C 2nr cos.Â/ (8.67) xPc.0/ D r cos.Â/; yPc.0/ D 2r sin.Â/; zPc.0/ D mr cos.Â / 2nr sin.Â/

8.4 Case Study: Satellite Formation Control

313

The value of Â defines the angle at which the follower satellite is making with a reference coordinate of the leader. Physically Equation (8.66) provides a circular or elliptical (depending on the choice of constants) reference trajectory around a leader satellite starting with the initial conditions defined in Eq. (8.67).

8.4.2 Satellite Formation Control in SMC/SMDO

If there is a mismatch between the follower satellite and the reference trajectory, then the starting point for the satellite will not be on one of the desired trajectories. Then a control system will be required to force the follower satellite back on track. The continuous SMC/SMDO controllers are supposed to achieve this goal while completely compensating for the bounded disturbances dx; dy; and dz. Otherwise, the disturbances dx; dy; and dz, which are due to the oblateness of the Earth, atmospheric drag, tesseral resonance, solar radiation pressure (so-called J2 effects), and bulges of the Earth (so-called J3 effects), will gradually disperse an uncontrolled formation. The J2 effect is by far the dominant perturbation force compared to J3. For this study, the representative dx; dy; and dz disturbances are sine waves with a frequency of 0:6 rad=s. / and are kept the same for all of the controllers studied. Also we assume that the leader satellite is maintained on the orbit by its own control.
Assuming the relative positions in Eq. (8.63) are measured, the vector-relative degree for this system is identified as rN D OE2; 2; 2T and the sliding variables (8.5) are formed as
Z D x; y ; z T ; i D ePi C ci;0ei C ci; 1 ei d 8i D x; y; z (8.68)
ex D xc x; yy D yc y; ez zc z
The integral terms in Eq. (8.68) are added in order to compensate for constant bias that could occur in the sliding modes at the implementation step. The following, optimized for fuel consumption, compensated dynamics of the output tracking errors in the sliding mode in a normalized time are
Z i D ePi C 1:8ei C 1:0 ei d D 0 ! eRi C 1:8ePi C ei D 0 8i D x; y; z (8.69)

The SMC/SMDO of (8.17)­(8.25), (8.32), and (8.34) is designed (ui D vi since E.x; t/ D I in Eq. (8.63)) for controlling the satellite formation model (8.63)
and (8.66):

ui D 10 i C vOieq 8i D x; y; z

0:05 dvOieq D d si D

vOieq C 2sign.si / Z
i C .ui 2sign.si // d

(8.70)

314

8 Disturbance Observer Based Control: Aerospace Applications

It is worth noting that the injection term vi in the SMC/SMDO (8.70) can be also designed in a form of the super-twisting control as in Sect. 8.2.2.

8.5 Simulation Study

A Simulink model of the follower satellite motion around the leader was developed

to test the effectiveness of the continuous SMC/SMDO algorithm in Eq. (8.70)

against the set of disturbances. For this study, the representative disturbance is a

sine wave with amplitude 0:5 km and a frequency of 0:6 rad=sec. /.

The SMC/SMDO in Eq. (8.70) is compared with the conventional (discontinuous

with dead-band) SMC. The same orbital period is used, i.e., 100:7 m. Recall that is

defined as the product of the mean motion and time. Therefore, for a 100:7 m orbit,

the actual time required to reach D 1 is 961:6 s. For the simulations an Euler

first-order integration algorithm is used, and the time step is fixed at 0:01 ms.

In Eq. (8.66) the values of the parameters are taken as r D 0:5 km for the

reference trajectory, whereas r D 0:6 km for the fpollower satellite in order to create the initial condition offset. Also n D 0 and m D 3 are defined to set the follower

satellite

in

a

circular

orbit

around

the

leader

at



2 3

rad

inclination

with

the

x-

axis. The angular position Â D 2 is the same for both the reference trajectory and

the simulated satellite's trajectory. A pulse-width-modulation (PWM) technique is

used to turn the continuous SMC/SMDO signals into a pulse train that could be

realizable by a satellite on­off jet-thruster. It is assumed that the thruster can cycle

at a frequency of 10 Hz. Due to the 961:6 s. / conversion factor, 10 Hz signal in the

t time domain would need to be approximately a 10000 cycles= signal in the

domain. Therefore, a dither signal, a sine wave of 10000 cycles/ with amplitude

of 0:25 10 5 km=s2, is combined with the control signal to model the required

duty cycle of the thrusters. In order to further optimize weekly fuel consumption,

the dead-zone is used in the relay elements of PWM. The recommended dead-band

optimal value is taken as ii D 0:5 10 5km=s2 and the corresponding PWM with a dead-band is shown in Fig. 8.12.

Fig. 8.12 PWM with dead band [139]

8.5 Simulation Study

315

Fig. 8.13 Continuous SMC/SMDO .km=s2/ [139]
Figure 8.13 shows the control inputs to the follower satellite while using the continuous SMC driven by the SMDO. After a few hours, this control drives the sliding variables and the errors to near zero. However, since this algorithm is supposed to be controlling a satellite thruster that fires pulses of thrust of constant magnitude, the continuous control input shown in Fig. 8.13 versus the original time is not very useful.
Figure 8.14 shows the control inputs with the PWM technique implemented in the original time t.
Here, the 10 Hz duty cycle is clearly illustrated. With the PWM technique, all continuous SMC reduce the errors between reference trajectory and the follower satellite's trajectory to near zero. The upper boundaries of steady-state errors are compared in Table 8.1.
It can be seen that the SMC/SMDO provides more accurate stabilization compared to conventional SMC. Figure 8.15 shows a 3-dimensional view of the relative motion between the leader and follower satellite using the continuous SMC/SMDO with the PWM technique incorporated.
The corresponding weekly fuel consumptions in terms of V , which are low for both methods, are shown in Table 8.2
Remark 8.7. The studied SMC/SMDO easily drives the control on­off thrusters with given duty cycle using the PWM technique, which is an improvement over a conventional (discontinuous with dead-band) SMC. The simulation analysis shows

316

8 Disturbance Observer Based Control: Aerospace Applications

Fig. 8.14 Continuous SMC/SMDO modulated by PWM [139]

Table 8.1 Steady-state stabilization errors

Method

jeexy

j

.k .k

m/ m/

jezj .km/

Conventional SMC
3:610 4 3:410 4 3:710 4

SMC/SMDO
1:510 5 0:410 5 2:810 5

that the continuous SMC/HOSM algorithm is effective in reducing the tracking errors of the follower satellite in the presence of a bounded disturbance function while keeping fuel consumption at a low level. It also appears that the PWM technique introduced does not degrade the tracking performance to any significant degree retaining fixed duty cycle.

8.6 Notes and References
For details about vector and total relative degree, see, for example, [112]. It is worth noting that the problem formulated in Sect. 8.1 can be also addressed for systems with stable zero dynamics [112].
The equation for finite-time-convergent compensated dynamics given in Sect. 8.1.2 is taken form [23].
The model of the RLV is from [106] and [190]. The multiple-loop asymptotic SMC design algorithm used for the RLV is from [104]. The overall stability analysis of the double-loop SMC/SMDO is also from [104].

8.6 Notes and References

317

Fig. 8.15 Three-dimensional trajectory: continuous SMC/SMDO modulated by PWM .km/ [139]

Table 8.2 The weekly fuel consumption

Method
Vx .m=s/ Vy .m=s/ Vz .m=s/

Conventional SMC
0.212 0.203 0.203

SMC/SMDO
0.210 0.202 0.202

The description of the Keplerian orbits and the satellite fuel consumption problems are from [194]. The continuous SMC/SMDO robust controller, realized by PWM to provide a required duty cycle in the control command to the jet-thrusters and used to robustly control the satellite formation while providing low weekly fuel consumption, is reported in [139]. An analysis of the application of a broader variety of SMC/SMDO techniques to the satellite formation control problem, including a super-twisting disturbance observer and a continuous robust SMC based on integral sliding surface design, can be found in [139].
The challenging task of output tracking in systems with transmission zeros located in the right-hand side of the complex plane or, generally speaking, in systems with unstable zero dynamics, is called a nonminimum phase output tracking problem [112]. A solution to the nonminimum phase output tracking problem using sliding modes, for an aerospace example, can be found in [160]. Output tracking in nonminimum phase systems with arbitrary relative degree, using higher-order sliding mode control, is studied in [102, 164, 167].
The 2-SM controllers that are applied to the launch vehicle and missile system are discussed in [163, 165, 176]. Other aerospace applications of SMC/HOSM control and disturbance observation techniques appear in a special issue of the Journal of Franklin Institute [169].

318
8.7 Exercises

8 Disturbance Observer Based Control: Aerospace Applications

Exercise 8.1. Consider the following linear system subject to external disturbances:

xP D Ax C B.u C '/ y D Cx

where u 22 is the control input and ' is an external disturbance

2 11
AD4 0 3
10

3 0 1 5;
2

B

D

2 0
41
0

3 0 05;
1

'

D

Ä 3 C 4 sin.t/ C cos.4t/ x1 C 4 cos.t/ C sin.3t/

;

Ä C D 010
001

The vector-function ' is assumed to be unknown and is used for computer simulation only. Design a continuous decoupled SMC/SMDO that achieves asymptotic tracking y ! yc with a given settling time ts D 0:5 s, when yc D cos.t/; sin2.t/ T ; and x.0/ D OE1; 2; 3T : Support the simulation results by plotting the corresponding variables.
Exercise 8.2. Repeat Exercise 8.1 and design a finite-time SMC/SMDO that achieves tracking y ! yc with an overall given convergence time tr D 0:5 s.
Exercise 8.3. Consider Chua's circuit (Example 2.7) with an output y D x1. The unknown function f .x1/ D x1.1 x12/ is used for simulation purposes only. Design a continuous SMC/SMDO that achieves asymptotic tracking y ! yc with a given settling time of ts D 1:5 s. Simulate the control system with
yc.t/ D 10 C sin2 t .V /; x.0/ D OE0:5; 0:4; 0:2T

Support the simulation results by plotting the corresponding variables.

Exercise 8.4. Repeat Exercise 8.3 and design a finite-time SMC/SMDO that achieves tracking y ! yc with a given convergence time of tr D 1:5 s.

Exercise 8.5. The dynamics of an armature-controlled DC motor are given by

8 <

J

d! dt

D kmi

TL

:

L

d d

i t

D

iR

kb! C u

yD!

where J is the moment of inertia, i is armature current, L and R are armature inductance and resistance, respectively, ! is the motor angular speed, kb is a constant relating to back electromotive force, km is a motor torque constant, TL

8.7 Exercises

319

is load torque, and u is a control function in terms of the armature voltage. Design

a sliding mode control u that drives y D ! ! yc as time increases, assuming that y D ! is measurable. Assume all the parameters are known except for

the jTL

jloÄadLmto,rqTPuLe

TL that is assumed to be Ä LN m Design a continuous

bounded together SMC/SMDO that

with its achieves

derivative: asymptotic

tracking y ! yc with a given settling time ts. Simulate the control system with

R D 1 Ohm, L D 0:5 H, km D 5 10 2 N m=A, kb D km, J D 10 3 N m s2=rad,

TL D 10 cos.3t/ N m, yc.t/ D 60 C 50 sin.2t/; ts D 1:2 s, !.0/ D 10 rad/s, and

i.0/ D 0: Support the simulation results by plotting the corresponding variables.

Exercise 8.6. Repeat Exercise 8.5 and design a finite-convergent-time SMC/SMDO that achieves tracking y ! yc with an overall given convergence time tr D 1:2 s.

Exercise 8.7. A simplified model of the dynamics of the longitudinal motion of an underwater vehicle is given by

mxR C kxP jxP j D u C Td yDx

where x is the position of the vehicle, u is the control function (a force that is

provided by a propeller), m is the mass of the vehicle, k > 0 is the drag coefficient,

and Td is an unknown smooth disturbance bounded together with its derivative.

Assuming the value of m is known exactly, the drag coefficient is bounded k1 Ä

k Ä k2 and the position and its derivative (velocity) x; xP are measured, design a

continuous SMC/SMDO that drives y ! yc as time increases, with given settling

time ts. Simulate the control system hfor xi1.0/ D 2 m; x2.0/ D 0:5 m=s; m D

4 kg; ts D 5 s, k D 1:5 C 0:4 sin.2t/

kg ms

, Td D 104 C 103 sin.t/; and

yc .t/ D

0:1t2; if 0 Ä t Ä 10 s 10 C 2 .t 10/ ; if t > 10 s

Support the simulation results by plotting the corresponding variables.

Exercise 8.8. Repeat Exercise 8.7 and a finite-convergent-time SMC/SMDO that achieves tracking y ! yc with an overall given convergence time tc D 3s.

Exercise 8.9. The evolution of the angle of attack of a missile controlled by fin deflection can be described by a simplified system of differential equations

8

^<^

P D q 2:7 C d.t/ qP D 5:5 0:4q 19i

^^: iP D 20i C 20u C 20h.t/ y D

320

8 Disturbance Observer Based Control: Aerospace Applications

where ; i are angle of attack and fin deflection in rad , respectively; q is pitch rate in rad=s, u is the control function in rad , and d.t/ and h.t/ are smooth bounded disturbances in rad=s. The angle of attack and pitch rate are measured. Design a continuous double-loop SMC/SMDO that drives y ! yc as time increases with given settling time ts. Take pitch rate q as a "virtual" outer-loop control and u as the inner-loop control. Simulate the control system for .0/ D 0; q.0/ D 0; i.0/ D 0; h.t/ D 0:1 sin.t/ rad/s, h.t/ D 0:05 cos.2t/ rad/s, ts D 0:3 s, and

c .t/ D

0:5 sin.0:5t/; if 0 Ä t Ä 0:5; if t >

Support the simulation results by plotting the corresponding variables.
Exercise 8.10. Repeat Exercise 8.9 and design a single-loop finite-convergent-time SMC/SMDO that achieves tracking y ! yc with an overall given convergence time tc D 0:25s.

Appendix A
Mathematical Preliminaries

A.1 Linear Algebra
A.1.1 Rank and Determinant
If A is an arbitrary m n matrix over the field of real numbers R, then the row space of A is the subspace of Rn generated by the rows of A, and the column space of A is the subspace of Rm generated by the columns of A. The dimensions of the row space and of the column space are called the row rank of A and the column rank of A, respectively. The following results hold linking the row space and the column space:

Theorem A.1 The row rank and column rank of the matrix A are equal.
Row rank and column rank (since they are equal) are usually called the rank of A and written rank.A/. For arbitrary matrices A and B of appropriate dimension that the product AB exists has the property that

rank.AB/ Ä minfrank.A/; rank.B/g:

(A.1)

For every square matrix A (i.e., a matrix with the same number of rows and columns) there can be assigned a unique scalar, called its determinant, and denoted det.A/. This value can be assigned recursively as follows: first consider a scalar as matrix with one row and one column. The determinant of such a matrix is equal to the element itself. For a matrix of dimension 2 given by

Ä A D a11 a12
a21 a22

(A.2)

then the determinant of A is given (by definition) as

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

321

DOI 10.1007/978-0-8176-4893-0, © Springer Science+Business Media New York 2014

322

A Mathematical Preliminaries

det.A/ D a11a22 a12a21:

(A.3)

The determinant of a matrix A of dimension 3 may be defined by

2 a11
det 4 a21
a31

a12 a22 a32

3 a13 a23 5
a33

D

a11

Ä det a22
a32

a23 a33

Ä

Ä

a12 det

a21 a23 a31 a33

C a13 det

a21 a22 a31 a32

:

The representation above demonstrates how determinants can be defined in terms of determinants of matrices of lower order. In order to develop a specific generic formula, first define the minor Mrs of any element ars of a general matrix A of dimension n is the determinant of the matrix obtained by omitting the row and column containing ars. The cofactor of ars, here denoted by Ars, is given by
Ars D . 1/rCsMrs

With these definitions, the determinant of a general square matrix A can then be expressed (in terms of minors and cofactors) as

det.A/ D ar1Ar1 C ar2Ar2 C : : : C arnArn;

r D 1; 2; : : : ; n:

Some useful properties of determinants are:
· If A has two identical rows (columns), then det.A/ D 0. · If A is invertible then det.A/ is nonzero. · The determinant of a product of two matrices A and B is equal to the product of
their determinants, det.AB/ D det.A/ det.B/.
Define the identity matrix or order n which will be denoted as In as the matrix which has ones on the diagonal elements and zeros elsewhere. It is easy to verify that the determinant of such a matrix is unity.
The transpose of a matrix A, denoted by AT , is defined by interchanging the rows and columns, i.e., fAT gij D Aj i . A square matrix is said to be orthogonal if AT A D AAT D In.
A matrix A is a symmetric matrix if AT D A.

A.1.2 Eigenvalues and Eigenvectors
Definition A.1. If A 2 Rn n is a square matrix, then 2 C is an eigenvalue of A, if for some nonzero vector v 2 Cn,
Av D v

A.1 Linear Algebra

323

In this case v is said to be the eigenvector corresponding to the eigenvalue .
The matrix In A is called the characteristic matrix of A. The determinant of the characteristic matrix is called the characteristic polynomial of A and

det. In A/ D 0

(A.4)

is called the characteristic equation of A. This is an nth-order polynomial in . Note that the values of which constitute roots of the characteristic equation determine the eigenvalues of A.
If A is a square matrix partitioned as

Ä A D A11 A12 ;
0 A22

(A.5)

where the top left and bottom right sub-blocks (A.5) are square, then the following properties hold:
Proposition A.1 The determinant and the eigenvalues of A satisfy:
1. det.A/ D det.A11/ det.A22/ 2. .A/ D .A11/ [ .A22/

A.1.3 QR Decomposition

A frequently used decomposition is the so-called QR reduction, whereby an arbitrary matrix X 2 Rn m can be expressed as

X D QR;

(A.6)

where R is an upper triangular matrix of the same dimension as X and Q is an orthogonal matrix.

A.1.4 Norms
Definition A.2. A norm is a function which assigns to every vector x in a vector space a real number kxk such that:
1. kxk 0 2. kxk D 0 if and only if x D 0 3. kkxk D jkj kxk where k is a scalar and jkj is the absolute value of k 4. kx C yk Ä kxk C kyk

324

A Mathematical Preliminaries

Property 4 is usually called the triangle inequality. Three common vector norms are:

1. The 1-norm

kxk1 D jx1j C jx2j C : : : C jxnj:

2. The Euclidean norm (or 2-norm)

(A.7)

kxk2 D .jx1j2 C jx2j2 C C jxnj2/1=2:

(A.8)

3. The 1 norm

kxk1 D max jxji .i D 1; : : : ; n/:

(A.9)

The Euclidean norm corresponds exactly to the usual notion of distance, i.e., the length of the straight line between two points.
Corresponding to the vector norms above are three induced matrix norms:

1. The 1-norm

X kAk1 D max. jaij j/:
j i

2. The 2-norm is given by the maximum eigenvalue of AT A.

3. The 1 norm

X kAk1 D max. jaij j/:
i j

(A.10) (A.11)

For any two vectors x and y the equality

yT x D kxkkyk cos.Â /

(A.12)

holds where Â is the angle (or more formally the direction cosine) between the two

vectors and k k denotes the Euclidean norm. From the properties of the cosine

function it follows

yT x Ä kxkkyk

(A.13)

for all x and y. The inequality in Eq. (A.13) is called the Cauchy­Schwarz inequality.

A.1.5 Quadratic Forms

A quadratic form is a function Q of n real variables x1; x2; : : : ; xn such that

Xn

Q.x1; x2; : : : ; xn/ D

qij xi xj

i;j D1

qij D qj i :

(A.14)

A.1 Linear Algebra

325

Without loss of generality, the qij can be thought of as the entries of a symmetric matrix Q and the xi can be considered the components of the vector x. The quadratic form (A.14) can more conveniently be represented as

Q.x1; x2; : : : ; xn/ D xT Qx;

(A.15)

where the matrix Q 2 Rntimesn is a symmetric matrix.

Proposition A.2 Let A be a symmetric matrix, then:
1. The eigenvalues of A are all real. 2. There exists an orthogonal matrix Q such that

A D Q QT ;

(A.16)

where is a diagonal matrix formed from the eigenvalues of A and the orthogonal matrix Q is formed from the associated eigenvectors.
Quadratic forms always satisfy the Rayleigh principle, namely,

min.Q/kxk2 Ä xT Qx Ä max.Q/kxk2:

(A.17)

In particular, if min.Q/ 0 then it follows that xT Qx 0 for all x.
Definition A.3. The quadratic form xT Qx where Q is a real symmetric matrix is said to be positive semidefinite if

xT Qx 0 for all x

In particular if

xT Qx > 0 x ¤ 0

then the quadratic form is said to be positive definite

If xT Qx is positive definite then the matrix Q is said to be a positive definite matrix and this will be written Q > 0. It can be seen from the modal decomposition expression in Eq. (A.16) that a symmetric matrix Q will be positive definite if all its eigenvalues are positive. It also follows that a positive definite matrix Q is invertible since from Eq. (A.16)

Yn det.Q/ D det. / D i > 0:
i D1

Given any square matrix Q let a sequence of matrices M1 : : : Mn, termed the principal minors, be recursively defined so that M1 D Q and MiC1 is obtained from deleting the first row and first column from Mi .

326

A Mathematical Preliminaries

Theorem A.2 A necessary and sufficient condition for the quadratic form xT Qx, where Q is a square symmetric matrix, to be positive definite is that the determinant of Q be positive and the successive principal minors of the determinant of Q be positive.
Another propertythat will be exploited is that, given a symmetric matrix P and a nonsingular matrix T of the same dimension,
P > 0 , TTPT > 0
A symmetric matrix P is said to be negative definite if P is positive definite.

Appendix B
Describing Functions

B.1 Describing Function Fundamentals

The main use of describing function (DF) technique [11, 100, 171] is in studying

the stability of the nonlinear systems, in particular predicting of limit cycles and

their stability in nonlinear systems. A system with zero input that contains only one

combined nonlinearity is depicted in Fig. B.1. The transfer function G.s/ is denoted

as the plant. In general case the transfer function G.s/ can include also a transfer

function of the controller and the sensor. It is assumed that there exists a periodic

solution

e.t/ D A sin !t;

(B.1)

where ! is a frequency of self-sustained oscillations (limit cycle). The output v of the nonlinear block will be given by the Fourier series

vD

aN 0 2

X 1 C

aNn cos .n!t/ C bNn sin .n!t/

;

nD1

(B.2)

where aN0 D 0 for odd nonlinearities and

Fig. B.1 Block diagram of nonlinear system

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

327

DOI 10.1007/978-0-8176-4893-0, © Springer Science+Business Media New York 2014

328

B Describing Functions

aN n

D

!

2 R=! v.t/ cos .n!t/ dt

0

bNn

D

!

2 R=! v.t/ sin .n!t/ dt:

0

(B.3)

B.1.1 Low-Pass Filter Hypothesis and Describing Function

Assume that the transfer function of the plant, G.s/, has low-pass filter characteristics with respect to higher harmonics in the signal e.t/. It means that jG.s/j is assumed to be small with respect to the higher harmonic components for n D 2; 3; : : : of the signal v.t/ given by Eq. (B.2) compared to the value jG.s/j with respect to a fundamental component for n D 1. In this case the fundamental output v.t/ of the nonlinearity can be computed as

v D aN1 cos .!t/ C bN1 sin .!t/ D M si n.!t C '/:

(B.4)

This assumption is the foundation of the DF technique.

The DF of the nonlinearity is defined as the fundamental output (presented in a complex function or phasor format) divided by the input amplitude. This is in a

Cartesian format

N.A; !/ D aN1 C j bN1 A

(B.5)

or in polar coordinates

where

N.A; !/ D M.A; !/ ej '.A;!/; A

q

M.A; !/ D '.A; !/ D

aN12 C bN12

tan

1 bN1 aN1

:

(B.6) (B.7)

B.1.2 Limit Cycle Analysis Using Describing Functions
In order to analyze the possibility of occurrence of limit cycles in nonlinear closedloop system (Fig. B.1) we assume that the transfer function of the plant G.s/ has low-pass filter characteristics and the input e.t/ of the nonlinearity is sinusoidal and given by Eq. (B.1). Then the nonlinearity in Fig. B.1 is replaced by its DF N.A; !/ given by Eqs. (B.5) or (B.6) and (B.7), and the sinusoidal signals e.t/

B.1 Describing Function Fundamentals

329

q

and v.t/ are presented in a phasor format. Resulting system with M D aN12 C bN12,

'D

tan

1 bN1 aN1

is presented in Fig. B.2.

A steady state sinusoidal analysis is performed next. The nonlinear system will

have a limit cycle if there exists a harmonic balance in this system. It means that the

sinusoidal signal at the input of the nonlinearity will propagate through the cascade

of the nonlinear block and the linear plant and being negated at a negative feedback

will regenerate itself. Therefore, we obtain in the frequency domain:

Aej !t N.A; !/ D M ej.!tC'/ M ej.!tC'/G.j !/ D Aej !t

:

(B.8)

Equation (B.8) implies

1 C G.j !/N.A; !/ D 0 ) G.j !/ D

1

N.A; !/

(B.9)

that is known as the harmonic balance equation. If Eq. (B.9) is satisfied for A D Ac; and ! D !c; then these values give the amplitude and frequency of the predicted limit cycle. If Eq. (B.9) does not have a real-valued positive solution, the limit cycle is not predicted. We have to acknowledge that due to the previous assumptions, including low-pass filter hypothesis, and due to taking into account only the fundamental harmonic when performing the harmonic balance, we can only predict the limit cycle. The prediction is supposed to be verified via simulations. It is worth noting the stability of the predicted limit cycle must be studied separately.

B.1.3 Stability Analysis of the Limit Cycle
The DF technique can be used to analyze the stability of the limit cycles. The Nyquist criterion of stability will be also employed. Let's assume that a solution .Ac; !c/ of Eq. (B.9) exists. Figure B.3 illustrates the procedure of getting the solution graphically.

Fig. B.2 Block diagram of nonlinear system with the describing function in a frequency domain

330

B Describing Functions

Fig. B.3 Graphical solution of the harmonic balance equation
Now, assume that the perturbation of the limit cycle with the parameters .Ac; !c/ occurs such that the amplitude Ac of the limit cycle increases slightly. Then the operating point moves slightly outside of the zone encircled by the Nyquist plot (point 1 on the plot Fig. B.3). Assuming the linear plant does not have poles in the right-hand side of the complex plane, then in accordance with the Nyquist criterion of stability (that can be applied to the linearized system in the vicinity of the operating point .Ac; !c/), the system is stable, and the amplitude Ac starts decreasing moving the operating point to its original position .Ac; !c/. Let's perturb the operating point (limit cycle with the parameters .Ac; !c/) such that the amplitude of oscillations Ac decreases slightly. Then the operating point moves insight the Nyquist plot (point 2 on the plot Fig. B.3). Applying the Nyquist criterion of stability to the system linearized in the operating point .Ac; !c/ we can conclude that the linearized system now is unstable and the amplitude starts increasing moving the operating point to its original position .Ac; !c/. Therefore, for the considered case the limit cycle is stable.

Appendix C
Linear Systems Theory

C.1 Introduction
This appendix provides the necessary background in terms of systems theory that is required for the sliding mode control developments. For further details see [47,155].

C.1.1 Linear Time-Invariant Systems

Consider the linear system

xP .t/ D Ax.t/;

(C.1)

where A 2 Rn n and the state vector x 2 Rn. A necessary and sufficient condition for asymptotic stability is that the eigenvalues of A have negative real parts.
Now consider the system

xP .t/ D Ax.t/ C Bu.t/:

(C.2)

Essentially a forcing function or control input u.t/ has been introduced into the system. The general solution to this state equation may be expressed in the form

Zt x.t / D Ve t W T x.0/ C V e .t /W T Bu. / d ;
0

(C.3)

where V is a matrix whose columns consist of the linearly independent right eigenvectors corresponding to the distinct eigenvalues i , i D 1; : : : ; n of the matrix A, D diag. 1; : : : ; n/, and the rows of the matrix W T consist of the corresponding left eigenvectors, i.e., V 1 D W T . Here x.0/ represents an arbitrary
initial condition. Again the time domain characteristics of the system are determined
by the eigenvalues of A. In addition, the associated right eigenvectors determine the
"shape" of a given mode. As the solution depends upon a linear combination of

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

331

DOI 10.1007/978-0-8176-4893-0, © Springer Science+Business Media New York 2014

332

C Linear Systems Theory

functions of the form vi e i t , appropriate eigenvector entries enable the transient e i t to contribute, or not, to a particular state variable. In this way it is seen that the entire eigenstructure, and not just the eigenvalues, are effective in determining the time response of a system.

C.1.2 Controllability and Observability

Consider the linear time-invariant system

xP .t/ D Ax.t/ C Bu.t/ y.t/ D C x.t/;

(C.4) (C.5)

where A 2 Rn n; B 2 Rn m, and C 2 Rp n. The variables u.t/ and y.t/ will be referred to as the inputs and outputs, respectively. The matrices A; B, and C will be termed the system, input distribution, and output distribution matrices, respectively. For convenience the system in Eqs. (C.4) and (C.5) will be referred to as a system triple .A; B; C /.
If T 2 Rn n is nonsingular, then the change of coordinates x ! 7 T x induces a new system representation with system matrix TA T 1, input distribution matrix TB, and output distribution matrix C T 1, i.e., the triple .TA T 1; TB; C T 1/.
Definition C.1. The system is said to be completely controllable if given any initial condition x.t0/ there exists an input function on the finite interval OEt0; t1 such that x.t1/ D 0.
From this definition the following theorem can be proved.
Theorem C.1 Given any pair .A; B/ the following conditions are all equivalent:
· .A; B/ is completely controllable. · The controllability matrix OEB AB A2B : : : An 1B  has full rank. · The matrix OEsI A B  has full rank for all s 2 C. · The spectrum of .A C BF / can be assigned arbitrarily by choice of F 2 Rm n.

The third condition, which is often the most convenient method of establishing controllability, is often referred to as the Popov­Belevitch­Hautus rank test or PBH test.
Definition C.2. The linear system is said to be completely observable if the output function y.t/ over some time interval OEt0; t1 uniquely determines the initial condition x.t0/.
An important duality exists between the notions of controllability and observability which can be summarized as follows.

C.1 Introduction

333

Theorem C.2 The pair .A; C / is completely observable if and only if the pair .AT ; C T / is completely controllable.
From the theorem above, the results of Theorem C.1 can be modified to provide a list of equivalent statements for observability.
In addition to these concepts there exist two slightly weaker notions: stabilizability and detectability.
Theorem C.3 Given any pair .A; B/ the following conditions are equivalent:
· .A; B/ is stabilizable. · The matrix OEsI A B  has full rank for all s 2 CC. · There exists an F 2 Rm n such that the eigenvalues of A C BF belong to C .

The notion of detectability can be defined as the dual of stabilizability. If the pair .A; B/ in Eq. (C.4) is not controllable then there exists a change of
coordinates x 7! T x so that in the new coordinate system the new system and input

distribution matrices have the form

Ä TA T 1 D A11 0
A21 A22

Ä TB D 0 ;
B2

(C.6)

where the pair .A22; B2/ is completely controllable. Note that because of the special structure of the canonical form in Eq. (C.6) it follows

.A11/ .A C BF /
for any F 2 Rm n. Consequently, the pair .A; B/ is stabilizable if and only if A11 is stable. By duality, a similar canonical form exists for pairs .A; C / which are not observable.

C.1.3 Invariant Zeros

Consider the linear time-invariant system

xP .t/ D Ax.t/ C Bu.t/ y.t/ D C x.t/:

(C.7) (C.8)

Assume the initial state is given by x.0/. Taking Laplace transforms of the system representation yields

Ä sI A C

Ä

Ä

B

X.s/ D x.0/ :

0

U.s/

Y .s/

(C.9)

334

C Linear Systems Theory

The polynomial system matrix

Ä

P .s/ D sI A B

C

0

(C.10)

is usually referred to as Rosenbrock's system matrix. A necessary and sufficient

condition for an input

u.t/ D u.0/ezt

(C.11)

to yield rectilinear motion in the state space of the form

x.t/ D x.0/ezt

(C.12)

such that the output of the system is identically zero for all time is that z, x.0/, and

u.0/ satisfy

Ä P .z/ x.0/ D 0:
u.0/

(C.13)

This result defines a set of complex frequencies z which are associated with specific directions x.0/ and u.0/ in the state and input spaces for which the output of the system is zero. These elements are called invariant zeros. It is clear that information regarding the existence of invariant zeros comes from examining the rank of P .z/ in Eq. (C.13). For example, in the case of a square system--i.e., systems with equal numbers of inputs and outputs--in order for Eq. (C.13) to have a nonzero solution for x.0/ and u.0/, det.P .z// must be zero.

C.1.4 State Feedback Control

For the controllable state-space system represented by

xP .t/ D Ax.t/ C Bu.t/

(C.14)

a state feedback controller is defined by

u.t/ D Kx.t/;

(C.15)

where K 2 Rm n. The state equation of the closed-loop system is given by

xP .t/ D .A BK/x.t/:

(C.16)

As the system is controllable, from Theorem C.1, the closed-loop poles can be allocated to any desired location by appropriate choice of K.

C.1 Introduction

335

The linear quadratic regulator (LQR) is a particular formulation of the state feedback control problem. Given the state-space system (C.14) with given initial condition x.0/, the input signal u.t/ is sought which regulates the system state to the origin by minimizing the cost function

J

D

1

Z

1
x.t/T Qx.t/ C u.t/T Ru.t/ dt;

20

(C.17)

where Q and R are positive definite symmetric matrices which penalize the deviation of the state from the origin and the magnitude of the control signal, respectively. The optimal solution, for any initial state, is given by

u.t/ D Kx.t/ D R 1BT Xx.t/;

(C.18)

where X is the unique positive semidefinite solution (X 0), of the algebraic

Riccati equation

AT X C XA XBR 1BT X C Q D 0:

(C.19)

For further details see [8].

C.1.5 Static Output Feedback Control

It has been demonstrated in the previous section that it is possible to readily determine a state feedback-based control strategy for a controllable linear system. In practice it may not be feasible to measure all the state variables for a given system. If only a subset of state information is available, the feedback control problem must now consider the system

xP .t/ D Ax.t/ C Bu.t/ y.t/ D C x.t/;

(C.20) (C.21)

where y 2 Rp denotes an available vector of output measurements. The develop-

ment of a control law

u.t/ D KC x.t/ D Ky.t/;

(C.22)

where K 2 Rm p is needed. It is important to note that this problem has associated with it further constraints. A sufficient condition to ensure that the eigenvalues of A BKC may be placed arbitrarily close to desired locations is that the pair .A; B/ is controllable, the pair .A; C / is observable, and the dimensionality requirement

mCpC1 n

(C.23)

is satisfied. These requirements are referred to as the Kimura­Davison conditions.

Appendix D
Lyapunov Stability

Earlier the notion of stability was considered using the concept of phase portraits for second-order systems. Now a more general (and more abstract) approach will be taken. For the general nonlinear system

xP .t/ D f .t; x/;

(D.1)

where x 2 Rn, an equilibrium point in the state space is given by vectors xe

satisfying

f .t; xe/ D 0 for all t > 0:

(D.2)

In general there may be many values of xe which satisfy this condition. In terms of analyzing the stability of a particular equilibrium point it is useful to assume the point is at the origin. This can be done without loss of generality since given an equilibrium point xe the change of variables (actually just a simple translation of the origin) x ! 7 xQ where xQ D x xe implies the origin is an equilibrium point of

xPQ .t/ D f .t; xQ /

(D.3)

since f .t; xQ D 0/ D f .t; xe/ D 0. The solution to Eq. (D.1) will be written as x.t; x0/ where t signifies the
evolution of the state with respect to time and x0 represents the initial conditions-- usually the value of the state at t D 0. Note, it is usually very difficult if not impossible to obtain an analytic expression for x.t; x0/ for general nonlinear systems.
Definition D.1. The origin of Eq. .D.1/ is said to be stable if given any > 0 there exists a i > 0 such that if kx0k < i then kx.t; x0/k < for all t > 0.
Less formally the definition means that by starting close enough to the equilibrium point, the solution will always remain arbitrarily close to it.
Definition D.2. The origin of Eq. .D.1/ is said to be asymptotically stable if it is stable and the solution x.t; x0/ ! 0 as t ! 1.

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

337

DOI 10.1007/978-0-8176-4893-0, © Springer Science+Business Media New York 2014

338

D Lyapunov Stability

Less formally this definition means that by starting close enough to the equilibrium point, the solution will always remain arbitrarily close, but in addition, the trajectory will always move towards the equilibrium point.

D.1 Local Results
Consider a domain D in the state space which contains a neighborhood of the origin fx 2 Rn W kxk < rg where r is a positive scalar. In two dimensions this represents a circle centered at the origin of radius r; in three dimensions D represents a sphere of radius r.
Definition D.3. A function V W D 7! R is positive definite in the domain D if:
· V .x/ 0 for all x 2 D. · V .x/ D 0 implies x D 0.
The function is said to be positive semidefinite in the domain D if only the first condition holds. If D D Rn the function is said to be positive definite or positive semidefinite, respectively.
The function V W R2 ! 7 R given by V .x1; x2/ D x12 C x22 is positive definite. This is a special case of a generic class of functions called quadratic forms.
One version of Lyapunov's theorem is given below:
Theorem D.1 Consider the nonlinear system in Eq. (D.1). Suppose in the domain D there exists a differentiable positive definite function V W R D ! 7 R such that
VP D @V C @V f .t; x/ Ä 0 @t @x
then the origin is stable. Furthermore if VP < 0 for x ¤ 0 then the origin is asymptotically stable.

D.2 Global Results
To extend these local results to be global, intuitively all that needs to be done is to ensure the conditions of Theorem D.1 hold for D D Rn. It turns out this is not quite sufficient. A further constraint needs to be included, namely, V .x/ ! 1 as kxk ! 1. A function V with such a property is termed radially unbounded.
Theorem D.2 Consider the nonlinear system in Eq. (D.1). Suppose there exists a differentiable function V W R Rn 7! R which is radially unbounded and positive definite such that
VP D @V C @V f .t; x/ Ä 0 @t @x

D.2 Global Results

339

then the origin is globally stable. Furthermore if VP < 0 for x ¤ 0 then the origin is asymptotically stable.
Quadratic forms are functions of the type xT P x where P 2 Rn n is symmetric, i.e., P T D P . Thought of in terms of the components xi of x, a quadratic form is a weighted sum of all possible products xi xj : specifically

Xn Xn

xT P x D

pij xi xj

i D1 j Di

Consider a general linear system described by

xP .t/ D Ax.t/;

(D.4)

where A 2 Rn n. Consider a Lyapunov candidate of the form

V .x/ D xT P x;

(D.5)

where P 2 Rn n is some symmetric positive definite matrix. Differentiating Eq. (D.5) with respect to time gives

VP D xPT P x C xT P xP D xT .PA C AT P /x:

(D.6)

In order to prove that the system is asymptotically stable the symmetric matrix in Eq. (D.6) must be negative definite. Consider the matrix equation

PA C AT P D Q;

(D.7)

where Q 2 Rn n is a symmetric positive definite matrix. Given A and Q, if a symmetric positive definite matrix P exists, solving the so-called Lyapunov equation given in Eq. (D.7), then the linear system in Eq. (D.4) will be asymptotically stable.
In fact the following can be shown:
Theorem D.3 There exists a unique s.p.d matrix P satisfying Eq. (D.7) if and only if the matrix A is stable, i.e., the eigenvalues of A lie in the open left half plane.

D.2.1 Quadratic Stability
The previous section considered the special case of linear systems. This enabled an analytic expression for the solution to be obtained. For general nonlinear systems this is usually impossible. An approach for studying the stability of differential equations, without the need to obtain an explicit solution, is the method of

340

D Lyapunov Stability

Lyapunov. Loosely speaking, if a differentiable function V W Rn ! 7 R can be found which is positive except at an equilibrium point and whose total time derivative decreases along the system trajectories, then the equilibrium point is stable. The key point is that this approach obviates the need to solve the nonlinear differential equation when assessing its stability properties.
Unfortunately, no systematic way exists to synthesize Lyapunov functions for nonlinear systems. This section considers the special case when the scalar function V W Rn ! R is the quadratic form

V .x/ D xT P x;

(D.8)

where P 2 Rn n is some symmetric positive definite matrix. By construction the function is nonzero except at the origin. Next, form the function of time

V .t/ D x.t/T P x.t/;

(D.9)

where x.t/ represents the solution of the differential equation (D.1). Differentiating Eq. (D.9) with respect to time gives
VP .t/ D xP .t/T P x.t/ C x.t/T P xP .t/ D 2x.t/T P xP .t/ D 2x.t/T Pf .x; t/;

where the second equality follows because the quantities are scalars and hence xP .t/T P x.t/ D xP .t/T P x.t/ T D x.t/T P xP .t/

Definition D.4. The origin of the system .D.1/ is said to be quadratically stable if there exist symmetric positive definite matrices P; Q 2 Rn n such that the total time derivative satisfies
VP .x/ D 2xT Pf .x; t/ Ä xT Qx

The inequality above implies kx.t/k < e t where  D min.P 1Q/ and hence the origin is asymptotically stable. If f .x; t/ D Ax.t/ then it is well known that A has

stable eigenvalues if and only if, given any symmetric positive definite matrix Q,

there exists a unique symmetric positive definite matrix P satisfying the Lyapunov

equation

PA C AT P D Q:

(D.10)

Consequently, any stable linear system is quadratically stable. A symmetric positive definite matrix P satisfying Eq. (D.10) will be referred to as a Lyapunov matrix for the matrix A.
Lyapunov theory may also be used as a means of examining the robustness of a given linear system; suppose

D.2 Global Results

341

xP .t/ D Ax.t/ C .t; x/;

(D.11)

where the matrix A is stable and . / is an imprecisely known function which represents uncertainty in the system. Let the pair of positive definite matrices .P; Q/ satisfy the Lyapunov Eq. (D.10) and define

D min.Q/ max .P /
and suppose that the uncertain function satisfies

(D.12)

k

.t; x/k Ä

1 2

kx .t /k

(D.13)

then the system in Eq. (D.11) is stable. This can be established by using V D xT P x as a Lyapunov function: the derivative along the trajectories satisfies

VP D x.t/T PAx.t/ C x.t/T AT P x.t/ C 2x.t/T P .t; x/ D x.t/T Qx.t/ C 2x.t/T P .t; x/ Ä x.t/T Qx.t/ C 2kP x.t/kk .t; x/k;

(D.14)

where the Cauchy­Schwarz inequality (see Appendix A.1.4) has been used to obtain the last inequality. Now

p

p

kP xk D xT P 2x Ä max.P 2/kxk2 D max.P /kxk;

(D.15)

where the Rayleigh principle has been used to obtain the middle inequality. Also directly from the Rayleigh principle

xT Qx Ä min.Q/kxk2:

(D.16)

Thus from the inequality in Eq. (D.14) and using Eqs. (D.15) and (D.16) it follows that

VP .t/ Ä D

min.Q/kx.t /k2 C 2 max.P /kx.t /kk .t; x/k max.P /kx.t/k . kx.t/k 2k .t; x/k/

and therefore if . / satisfies Eq. (D.13) the Lyapunov derivative is always negative and stability is proved.
In view of the condition (D.13), it is natural to attempt to choose Q in an effort to maximize Eq. (D.12). It can be shown that the maximum is given by

OD 1 max .P /

(D.17)

342

D Lyapunov Stability

when Q D I . Furthermore, it can be shown that O Ä 2 max [Re .A/

(D.18)

with equality if the matrix A is normal, i.e., if it has n orthonormal eigenvectors. When dealing with uncertain systems, it may not be possible to guarantee
asymptotic stability. Consider the nonlinear system (D.1) and suppose it is subject to an imprecisely known exogenous signal . / so that

xP .t/ D f .x; t; /:

(D.19)

Let E Rn be a bounded set, then the following definition can be made. For further details see [116].
Definition D.5. The solution x. / to the uncertain system .D.19/ is said to be ultimately bounded with respect to the set E if:
· On any finite interval the solution remains bounded, i.e., if kx.t0/k < i then kx.t/k < d.i/ for any t 2 OEt0; t1/.
· In finite time the solution x.t/ enters the bounded set E and remains there for all subsequent time.
The set E is usually an acceptably small neighborhood of the origin and the concept is often termed practical stability.
For further details see [116].

Bibliography

[1] Abe, M.: Vehicle dynamics and control for improving handling and active safety: from fourwheel steering to direct yaw moment control. Proc. Inst. Mech. Eng. 213(2), 87­101 (1999)
[2] Ackermann, J., Utkin V.I.: Slidingmode control design based on Ackermann's formula. IEEE Trans. Automat. Contr. 43(2), 234­237 (1998)
[3] Acary, V., Brogliato, B., Orlov, Y.: Chattering-free digital sliding-mode control with state observer and disturbance rejection. IEEE Trans. Automat. Contr. 57(5), 1087­1101 (2012)
[4] Aguilar, L., Boiko, I., Fridman, L., Iriarte, R.: Generating self-excited oscillations for underactuated mechanical systems via two-relay controller. Int. J. Control 82(9), 1678­1691 (2009)
[5] Aguilar, L., Boiko, I., Fridman, L., Iriarte, R.: Oscillations via two-relay controller. IEEE Trans. Automat. Contr. 54(2), 416­420 (2009)
[6] Alwi, H., Edwards, C.: Fault tolerant control using sliding modes with online control allocation. Automatica 44, 1859­1866 (2008)
[7] Alwi, H., Edwards, C., Tan, C.P.: Fault Detection and Fault-tolerant Control Using Sliding Modes. Advances in Industrial Control Series. Spring, Berlin (2011)
[8] Anderson, B., Moore, J.: Optimal Control. Series Information and Systems Science. Prentice Hall, London (1990)
[9] Anosov, D.V.: On stability of equilibrium points of relay systems. Automat. Rem. Contr. 20(2), 135­149 (1959)
[10] Atassi, A.N., Khalil, H.K.: Separation results for the stabilization of nonlinear systems using different high-gain observer designs. Syst. Control Lett. 39(3), 183­191 (2000)
[11] Atherton, D.P.: Nonlinear Control Engineering ­ Describing Function Analysis and Design. Van Nostrand Company Limited, Workingham, Berkshire (1975)
[12] Baccioti, A., Rosier, L.: Lyapunov Functions and Stability in Control Theory, 2nd edn. Springer, New York (2005)
[13] Bag, S.K., Spurgeon, S.K., Edwards, C.: Output feedback sliding mode design for linear uncertain systems. Proc. IEE, Part D 144, 209­216 (1997)
[14] Bandyopadhyay, B., Janardhanan, S.: Discrete-time Sliding Mode Control: A Multi-rate Output Feedback Approach. Lecture Notes in Control and Information Sciences, vol. 323. Springer, Berlin (2006).
[15] Bartolini, G., Pisano, A., Usai, E.: First and second derivative estimation by sliding mode technique. J. Signal Proc. 4(2), 167­176 (2000)
[16] Bartolini, G., Pydynowski, P.: An improved, chattering free, V.S.C. scheme for uncertain dynamical systems. IEEE Trans. Automat. Contr. 41(8), 1221­1226 (1996)
[17] Bartolini, G., Ferrara, A., Usai, E.: Output tracking control of uncertain nonlinear secondorder systems. Automatica 33(12), 2203­2212 (1997)

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

343

DOI 10.1007/978-0-8176-4893-0, © Springer Science+Business Media New York 2014

344

Bibliography

[18] Bartolini, G., Ferrara, A., Usai, E.: Chattering avoidance by second-order sliding mode control. IEEE Trans. Automat. Contr. 43(2), 241­246 (1998)
[19] Bartolini, G., Ferrara A., Levant, A., Usai, E.: On second order sliding mode controllers. In: Young, K.D., Ozguner, U. (eds.) Variable Structure Systems, Sliding Mode and Nonlinear Control. Lecture Notes in Control and Information Sciences, vol. 247, pp. 329­350. Springer, Berlin (1999)
[20] Bartolini, G., Pisano, A., Punta, E., Usai, E.: A survey of applications of second-order sliding mode control to mechanical systems. Int. J. Control 76(9/10), 875­892 (2003)
[21] Basin, M., Rodriguez, J., Fridman, L.: Optimal and robust control for linear state-delay systems. J. Franklin Inst. 344(6), 830­845 (2007)
[22] Bhat, S.P., Bernstein, D.S.: Finite time stability of continuous autonomous systems. SIAM J. Control Optim. 38(3), 751­766 (2000)
[23] Bhat, S.P., Bernstein, D.S.: Geometric homogeneity with applications to finite time stability. Math. Control Signal. 17, 101­127 (2005)
[24] Bejarano, J., Fridman, L.: High order sliding mode observer for linear systems with unbounded unknown inputs. Int. J. Control 83(9), 1920­1929 (2010)
[25] Bejarano, J., Fridman, L., Poznyak, A.: Exact state estimation for linear systems with unknown inputs based on hierarchical super-twisting algorithm. Int. J. Robust. Nonlin. 17(18), 1734­1753 (2007)
[26] Bejarano, J., Fridman, L., Poznyak, A.: Output integral sliding mode control based on algebraic hierarchical observer. Int. J. Control 80(3), 443­453 (2007)
[27] Bejarano, J., Fridman, L., Poznyak, A.: Output integral sliding mode for min-max optimization of multi-plant linear uncertain systems. IEEE Trans. Automat. Contr. 54(11), 2611­2620 (2009)
[28] Boiko, I.: Frequency domain analysis of fast and slow motions in sliding modes. Asian J. Control 5(4), 445­453 (2003)
[29] Boiko, I.: Discontinuous Control Systems: Frequency-Domain Analysis and Design. Birkhauser, Boston (2009)
[30] Boiko, I.: On frequency-domain criterion of finite-time convergence of second-order sliding mode control algorithms. Automatica 47(9), 1969­1973 (2011)
[31] Boiko, I., Fridman, L.: Analysis of chattering in continuous sliding-mode controllers. IEEE Trans. Automat. Contr. 50(9), 1442­1446 (2005)
[32] Boiko, I., Fridman, L., Castellanos, M.I.: Analysis of second order sliding mode algorithms in the frequency domain. IEEE Trans. on Automat. Contr. 49(6), 946­950 (2004)
[33] Boiko,I., Iriarte, R., Pisano, A., Usai, E.: Parameter tuning of second-order sliding mode controllers for linear plants with dynamic actuators. Automatica 42(5), 833­839 (2006)
[34] Boiko, I., Fridman, L., Pisano, A., Usai, E.: Analysis of chattering in systems with second order sliding modes. IEEE Trans. Automat. Contr. 52(11), 2085­2102 (2007)
[35] Boiko, I., Fridman, L., Pisano, A., Usai, E.: Performance analysis of second-order slidingmode control systems with fast actuators. IEEE Trans. Automat. Contr. 52(6), 1053­1059 (2007)
[36] Boiko, I., Fridman, L., Pisano, A., Usai, E.: On the transfer properties of the generalized suboptimal second-order sliding mode control algorithm. IEEE Trans. Automat. Contr. 54(2), 399­403 (2009)
[37] Bondarev, A.G., Bondarev, S.A., Kostylyeva, N.Y., Utkin, V.I.: Sliding modes in systems with asymptotic state observers. Automatica i telemechanica (Automat. Rem. Contr.) 46(5), 679­684 (1985)
[38] Boyd, S.P., El Ghaoui, L., Feron, E. Balakrishnan V.: Linear Matrix Inequalities in Systems and Control Theory. SIAM, Philadelphia (1994).
[39] Burlington, R.S.: Handbook of Mathematical Tables and Formulas. McGraw-Hill, New York (1973)
[40] Burton, J.A., Zinober, A.S.I.: Continuous approximation of variable structure control. Int. J. Syst. Sci. 17(6), 876­885 (1986)

Bibliography

345

[41] Cannas, B., Cincotti, S., Usai, E.: An algebraic observability approach to chaos synchronisation by sliding differentiators. IEEE Trans. Circ. Systems-I: Fundamental Theory and Applications 49(7), 1000­1006 (2002)
[42] Cannas, B., Cincotti, S., Usai, E.: A chaotic modulation scheme based on algebraic observability and sliding mode differentiators. Chaos Soliton. Fract. 26(2), 363­377 (2005)
[43] Castanos, F., Fridman, L.: Analysis and design of integral sliding manifolds for systems with unmatched perturbations. IEEE Trans. Automat. Contr. 55(5), 853­858 (2006)
[44] Castanos, F., Fridman, L.: Dynamic switching surfaces for output sliding mode control: an H1 approach. Automatica 47(7), 1957­1961 (2011)
[45] Castanos, F., Xu, J.X., Fridman, L.: Integral sliding modes for systems with matched and unmatched uncertainties. In: Edwards, C., Colet, E.F., Fridman, L. (eds.) Advances in Variable Structure and Sliding Mode Control. Lecture Notes in Control and Information Sciences, vol. 334, pp. 227­246. Springer, Berlin (2006)
[46] Castellanos, M.I., Boiko, I. Fridman, L.: Parameter identification via modified twisting algorithm. Int. J. Control 81(5), 788­796 (2008)
[47] Chen, C.: Linear Systems: Theory and Design. Oxford University Press, New York (1999) [48] Chen, B.M.: Robust and H1 control. Series: Communication and Control Engineering.
Springer, Berlin (2000) [49] Chen, M.-S., Hwang, Y.-R., Tomizuka, M.: A State-Dependent Boundary Layer Design for
Sliding Mode Control. IEEE Trans. Automat. Contr. 47(10), 1677­1681 (2002) [50] Craig, J.: Introduction to Robotics: Mechanics and Control. Addison-Wesley Publishing,
Boston (1989) [51] Cruz-Zavala, E., Moreno, J., Fridman, L.: Uniform robust exact differentiator. IEEE Trans.
Automat. Contr. 56(11), 2727­2733 (2011) [52] Davila, J., Fridman, L., Levant, A.: Second-order sliding-modes observer for mechanical
systems. IEEE Trans. Automat. Contr. 50(11), 1785­1789 (2005) [53] Davila, J., Fridman, L., Pisano A., Usai, E.: Finite-time state observation for nonlinear
uncertain systems via higher order sliding modes. Int. J. Control 82(8), 1564­1574 (2009) [54] Davila, J., Rios, H., Fridman, L.: State observation for nonlinear switched systems using
non-homogeneous higher order sliding mode observers. Asian J. Control 14(4), 911­923 (2012) [55] DCCT: The Diabetes Control and Complications Trial Research Group, The effect of intensive treatment of diabetes on the development and progression of long-term complications in insulin-dependent diabetes mellitus. New Engl. J. Med. 329, 977­986 (1993) [56] DeCarlo, R.A., Zak, S.H., Matthews, G.P.: Variable structure control of nonlinear multivariable systems: a tutorial. Proc. IEEE 76(3), 212­232 (1988) [57] DeCarlo, R.A., Drakunov, S., Li, X.: A unifying characterization of sliding mode control: a Lyapunov approach. ASME J. Dyn. Syst. Meas. Control 122(4), 708­718 (2000) [58] DeCarlo, R.A., Zak, S.H., Drakunov, S.V.: Variable structure,sliding mode controller design. In: The Control Handbook, 2nd edn. Electrical Engineering Handbook Series, pp. 50.1­ 50.21. CRC Press, Boca Raton, USA (2010) [59] Defoort, M., Floquet, T., Kokosy, A., Perruquetti, W.: Integral sliding mode control for trajectory tracking of a unicycle type mobile robot. Integr. Comput. Aid. E. 13(3), 277­288 (2006) [60] DeJager, B.: Comparison of methods to eliminate chattering and avoid steady state errors in sliding mode digital control. In: Proceedings of the IEEE VSC and Lyapunov Workshop, pp. 37­42, Sheffield, UK (1992) [61] Drakunov, S.V., Utkin, V.: Sliding mode control in dynamic systems. Int. J. Control 55(4), 1029­1037 (1992) [62] Drakunov, S., Utkin, V.I.: Sliding mode observers: tutorial. In: Proceedings of the 34th IEEE Conference of Decision and Control, vol. 4, pp. 3376­3378, New Orleans, LA (1995) [63] Drakunov, S., Su, W., Ozguner, U.: Constructing discontinuity surfaces for variable structure systems: a Lyapunov approach. Automatica 32(6), 925­928 (1996)

346

Bibliography

[64] Drazenivic, B.: The invariance conditions for variable structure systems. Automatica 5(3), 287­295 (1969)
[65] Edwards, C., Spurgeon, S.K.: On the development of discontinuous observers. Int. J. Control 59(5), 1211­1229 (1994)
[66] Edwards, C., Spurgeon, S.K.: Sliding mode stabilisation of uncertain systems using only output information. Int. J. Control 62(5), 1129­1144 (1995)
[67] Edwards, C., Spurgeon, S.: Sliding Mode Control: Theory and Applications. Taylor and Francis, London (1998)
[68] Edwards, C., Spurgeon, S.: On the limitations of some variable structure output feedback controller designs. Automatica 36, 743­748 (2000)
[69] Edwards, C., Tan, C.P.: A comparison of sliding mode and unknown input observers for fault reconstruction. Eur. J. Control 16, 245­260 (2006)
[70] Edwards, C., Spurgeon, S.K, Patton, R.J.: Sliding mode observers for fault detection and isolation. Automatica 36(4), 541­553 (2000)
[71] Edwards, C., Spurgeon, S.K., Akoachere, A.: Sliding mode output feedback controller design using linear matrix inequalities. IEEE Trans. Automat. Contr. 46(1), 115­119 (2001)
[72] Edwards, C., Spurgeon, S.K., Hebden, R.G.: On the design of sliding mode output feedback controllers. Int. J. Control 76, 893­905 (2003)
[73] El-Khazali R., DeCarlo, R.A.: Output feedback variable structure control design. Automatica 31(6), 805­816 (1995)
[74] Emelyanov, S.V., Korovin, S.K.: Applying the principle of control by deviation to extend the set of possible feedback types. Sov. Phys. Dokl. 26(6), 562­564 (1981)
[75] Emelyanov, S.V., Korovin, S.K. Levantovsky, L.V.: Higher order sliding modes in the binary control systems. Sov. Phys. Dokl. 31(4), 291­293 (1986)
[76] Estrada, A., Fridman, L.: Integral HOSM semiglobal controller for finite-time exact compensation of unmatched perturbations. IEEE Trans. Automat. Contr. 55(11), 2644­2649 (2010)
[77] Estrada, A., Fridman, L.: Quasi-continuous HOSM control for systems with unmatched perturbations. Automatica 46, 1916­1919 (2010)
[78] Fan, X. Arcak, M.: Observer design for systems with multivariable monotone nonlinearities. Syst. Control Lett. 50, 319­330 (2003)
[79] Ferreira, A., Bejarano, F.J., Fridman, L.: Robust control with exact uncertainties compensation: with or without chattering? IEEE Trans. Contr. Syst. Tech. 19(5), 969­975 (2011)
[80] Ferreira, A., Bejarano, F.J., Fridman, L.: Unmatched uncertainties compensation based on high-order sliding mode observation. Int. J. Robust. Nonlin. (2012). doi: 10.1002/rnc.2795
[81] Filippov, A.: Differential Equations with Discontinuous Right-hand Sides. Kluwer Academic Publishers, Dordrecht (1988)
[82] Fisher, M.E.: A semi closed-loop algorithm for the control of blood glucose levels in diabetics. IEEE Trans. Biomed. Eng. 38(1), 57­61 (1991)
[83] Floquet, T., Barbot, J.P.: Super twisting algorithm-based step-by-step sliding mode observers for nonlinear systems with unknown inputs. Int. J. Syst. Sci. 38(10): 803­815 (2007)
[84] Floquet, T., Edwards, C., Spurgeon, S.K.: On sliding mode observers for systems with unknown inputs. Int J. Adapt. Control Signal Process. 21, 638­656 (2007)
[85] Flugge-Lotz, I.: Discontinuous Automatic Control. Princeton University Press, New Jersey (1953)
[86] Franklin, G.F., Powell, J.D., Emami-Naeini, A.: Feedback Control of Dynamic Systems. Prentice Hall, New Jersey (2002)
[87] Fridman, L.: The problem of chattering: an averaging approach. In: Young, K., Ozguner, U. (eds.) Variable Structure, Sliding Mode and Nonlinear Control. Lecture Notes in Control and Information Science, vol. 247, pp. 363­386. Springer, London (1999)
[88] Fridman, L.: An averaging approach to chattering. IEEE Trans. Automat. Contr. 46(8), 1260­ 1264 (2001)
[89] Fridman, L.: Singularly perturbed analysis of chattering in relay control systems. IEEE Trans. Automat. Contr. 47(12), 2079­2084 (2002)

Bibliography

347

[90] Fridman, L.: Chattering analysis in sliding mode systems with inertial sensors. Int. J. Control 76(9/10), 906­912 (2003)
[91] Fridman, L., Levant, A.: Higher order sliding modes as the natural phenomena of control theory. In: Garafalo, F., Glielmo, G. (eds.) Robust Control Variable Structure and Lyapunov Techniques, pp. 107­133. Springer, Berlin (1996)
[92] Fridman, L., Levant, A.: Higher order sliding modes. In: Barbot, J.P., Perruguetti, W. (eds.) Sliding Mode Control in Engineering, pp. 53­102. Dekker, New York (2002)
[93] Fridman, L., Poznyak, A., Bejarano, J.: Decompositionof the min-max multimodel problem via integral sliding mode. Int. J. Robust. Nonlin. 15(13), 559­574 (2005)
[94] Fridman, L., Levant, A., Davila, J.: Observation of linear systems with unknown inputs via high-order sliding-modes, Int. J. Syst. Sci. 38(10), 773­791 (2007)
[95] Fridman, L., Shtessel, Y., Edwards, C., Yan, X.G.: Higher-order sliding-mode observer for state estimation and input reconstruction in nonlinear systems. Int. J. Robust. Nonlin. 18(4/5), 399­413 (2008)
[96] Fridman, L., Davila, J., Levant, A.: High-order sliding-mode observation for linear systems with unknown inputs. Nonlinear Anal. Hybrid Syst. 5(2), 174­188 (2011)
[97] Furuta, K.: Sliding mode control of a discrete system. Syst. Control Lett. 14(2), 145­152 (1990)
[98] Furuta, K., Pan, Y.: Variable structure control with sliding sector. Automatica 36(2), 211­228 (2000)
[99] Gahinet, P., Nemirovski, A., Laub, A., Chilali, M.: LMI Control Toolbox, User Guide. MathWorks Inc., Natick (1995)
[100] Gelb, A., Vander Velde, W.E.: Multiple-Input Describing Functions and Nonlinear System Design. McGraw-Hill, New York (1968)
[101] Gonzalez, T., Moreno, J., Fridman, L.: Variable Gain Super-Twisting Sliding Mode Control. IEEE Trans. Automat. Contr. 57(8), 2100­2105 (2012)
[102] Gopalswamy S., Hedrick, J.K.: Tracking nonlinear non-minimum phase systems using sliding control. Int. J. Control 57(5), 1141­1158 (1993)
[103] Gutman, S.: Uncertain dynamic Systems ­ a Lyapunov min-max approach. IEEE Trans. Automat. Contr. 24(3), 437­449 (1979)
[104] Hall, C., Shtessel, Y.: Sliding mode disturbance observers-based control for a reusable launch vehicle. AIAA J. Guid. Control Dynam. 29(6), 1315­1329 (2006)
[105] Hamayun, M.T., Edwards, C. Alwi, H.: Design and analysis of an integral sliding mode fault-tolerant control scheme. IEEE Trans. Automat. Contr. 57, 1783­1789 (2012)
[106] Hanson, J., Jones, R., Krupp, D.: Advanced guidance and control methods for reusable launch vehicles: test results. AIAA Paper, pp. 2002­4561 (2002)
[107] Hautus, M.: Strong detectability and observers. Linear Algebra. Appl. 50(4), 353­368 (1983) [108] Hebden, R.G., Edwards, C., Spurgeon, S.K.: Automotive stability in a split-mu manoeuvre
using an observer based sliding mode controller. Department of Engineering Report 02­4, Leicester University (2002) [109] Heck, B.S., Ferri, A.A.: Application of output feedback to variable structure systems. J. Guid. Control Dynam. 12, 932­935 (1989) [110] Heck, B.S., Yallapragada, S.V., Fan, M.K.H.: Numerical methods to design the reaching phase of output feedback variable structure control. Automatica 31(2), 275­279 (1995) [111] Imine, H., Fridman, L., Shraim, H., Djemai, M.: Sliding mode based analysis and identification of vehicle dynamics. Lecture Notes in Control and Information Sciences, vol. 414. Springer, Berlin (2011) [112] Isidori, A.: Nonlinear Control Systems. Springer, New York (1995) [113] Itkis, Y.: Control Systems of Variable Structure. Wiley, New York (1976) [114] Jaremco J., Rorstad, O.: Advances toward the implantable artificial pancreas for treatment of diabetes. Diabetes Care 21(3), 444­450 (1998) [115] Kaveh, P., Shtessel, Y.: Blood glucose regulation using higher order sliding mode control. Int. J. Robust. Nonlin. Special Issue on Advances in Higher Order Sliding Mode Control 18(4­5), 557­569 (2008)

348

Bibliography

[116] Khalil, H.: Nonlinear Systems, 3d edn. Prentice Hall, New Jersy (2002) [117] Kobayashi, S., Furuta, K.: Frequency characteristics of Levant's differentiator and adaptive
sliding mode differentiator. Int. J. Syst. Sci. 38(10), 825­832 (2007) [118] Kochalummoottil, J., Shtessel, Y., Moreno, J.A., Fridman, L.: Adaptive twist sliding mode
control: a Lyapunov design. In: Proceedings of the 50th Conference on Decision and Control, pp. 7623­7628, Orlando, FL (2011) [119] Kochalummoottil, J., Shtessel, Y., Moreno, J.A., Fridman, L.: Output feedback adaptive twisting control: a Lyapunov design. In: Proceedings of the American Control Conference, pp. 6172­6177, Montreal, Canada (2012) [120] Kolmogoroff, A. N.: On inequalities between upper bounds of consecutive derivatives of an arbitrary function defined on an infinite interval. Amer. Math. Soc. Transl. 2, 233­242 (1962) [121] Krstic, J.M., Kanellakopoulos, I., Kokotovic, P.: Nonlinear and Adaptive Control Design. Wiley, New York (1995) [122] Krupp, D.R., Shkolnikov, I.A., Shtessel, Y.B.: 2-sliding mode control for nonlinear plants with parametric and dynamic uncertainties. In: Proceedings of Conference on Guidance Navigation and Control, AIAA paper, pp. 2000­3965, Denver, CO (2000) [123] Levant, A.: Robust exact differentiation via sliding mode technique. Automatica 34(3), 379­ 384 (1998) [124] Levant, A.: Universal SISO sliding-mode controllers with finite-time convergence. IEEE Trans. Automat. Control 46(9), 1447­1451 (2001) [125] Levant, A.: Higher-order sliding modes, differentiation and output-feedback control. Int. J. Control 76(9/10), 924­941 (2003). [126] Levant, A.: Homogeneity approach to high-order sliding mode design. Automatica 41(5), 823­830 (2005) [127] Levant, A.: Quasi-continuous high-order sliding-mode controllers. IEEE Trans. Automat. Contr. 50(11) 1812­1816 (2006) [128] Levant, A.: Construction principles of 2-sliding mode design. Automatica 43(4), 576­586 (2007) [129] Levant, A.: Finite differences in homogeneous discontinuous control. IEEE Trans. Automat. Contr. 527, 1208­1217 (2007) [130] Levant, A.: Chattering analysis. IEEE Trans. Automat. Contr. 55(6), 1380­1389 (2010) [131] Levant, A., Fridman, L.: Accuracy of Homogeneous Sliding Modes in the Presence of Fast Actuators. IEEE Trans. Automat. Contr. 55(3), 810­814 (2010) [132] Levant, A., Levantovsky, L.V.: Sliding order and sliding accuracy in sliding mode control. Int. J. Control 586, 1247­1263 (1993) [133] Levant, A., Michael, M.: Adjustment of high-order sliding-mode controllers. Int. J. Robust. Nonlin. 19(15), 1657­1672 (2009) [134] Luenberger, D.G.: Observing the state of a linear system. IEEE Trans. Mil. Electron. 8(2), 74­80 (1964) [135] Luenberger, D.G.: An introduction to observers. IEEE Trans. Automat. Contr. 16(6), 96­602 (1971) [136] Lukyanov, A.G.: Reducing dynamic systems: regular form. Automat. Rem. Contr. 41(3), 5­13 (1981) [137] Lukyanov, A.G., Utkin, V.I.: Methods for reducing equations for dynamic system to a regular form. Automat. Rem. Contr. 4, 14­18 (1981) [138] Man Z., Paplinski, A.P., Wu, H.R.: A robust MIMO terminal sliding mode control for rigid robotic manipulators. IEEE Trans. Automat. Contr. 39(12), 2464­2468 (1994) [139] Massey, T., Shtessel, Y.: Continuous traditional and high order sliding modes for satellite formation control. AIAA J. Guid. Control Dynam. 28(4), 826­831 (2005) [140] Matthews, G.P., DeCarlo, R.A.: Decentralized tracking for a class of interconnected nonlinear systems using variable structure control. Automatica 24(2), 187­193 (1988) [141] Milosavljevic, C.: Discrete-time VSS. In: Sabanovich, E., Spurgeon, S., Fridman, L. (eds.) Variable Structure systems: From Principles to Implementation. IEE Control Series, vol. 66, pp. 99­128. IEE-publisher Stevenage, UK (2004)

Bibliography

349

[142] Moreno, J.A.: Lyapunov approach to analysis and design of second order sliding mode algorithms. In: Fridman, L., Moerno, J., Iriarte, R. (eds.) Sliding Modes after the first Decade of the 21st Century. Lecture Notes in Control and Information Science, vol. 412, pp. 115­ 149. Springer, Berlin (2011)
[143] Moreno, J., Osorio, M.: Strict lyapunov functions for the super-twisting algorithm. IEEE Trans. Automat. Contr. 57(4), 1035­1040 (2012)
[144] Neatpisarnvanit, C., Boston, J.R.: Estimation of plasma insulin from plasma glucose. IEEE Trans. Biomed. Eng. 49(11), 1253­1259 (2002)
[145] Orlov, Y.: Finite time stability and robust control synthesis of uncertain switched systems. SIAM J. Cont. Optim. 43(4), 1253­1271 (2005)
[146] Orlov, Y.: Discontinuous Control. Springer, Berlin (2009) [147] Orlov, Y., Aguilar, L., Cadiou, J.C.: Switched chattering control vs. backlash/friction
phenomena in electrical servo-motors. Int. J. Control 76(9­10), 959­967 (2003) [148] Patel, N., Edwards, C., Spurgeon, S.K.: Tyre/road friction estimation - a comparative study.
Proc. Inst. Mech. Eng. Part D: J. Automob. Eng. 22, 2337­2351 (2008) [149] Petersen, I.R.: A stabilization algorithm for a class of uncertain linear systems. Syst. Control
Lett. 8(4), 351­357 (1987) [150] Pisano, A., Usai, E.: Contact force regulation in wire-actuated pantographs via variable
structure control and frequency-domain techniques. Int. J. Control 81(11), 1747­1762 (2008) [151] Plestan, F., Grizzle, J.W., Westervelt, E.R., Abba, G.: Stable walking of a 7-DOF biped robot. IEEE Trans. Robotic. Autom. 19(4), 653­668 (2009) [152] Polyakov, A.: Nonlinear feedback design for fixed-time stabilization of linear control systems. IEEE Trans. Automat. Contr. 57(8), 2106­2110 (2012) [153] Polyakov, A., Poznyak, A.: Reaching time estimation for super-twisting second order sliding mode controller via Lyapunov function designing. IEEE Trans. Automat. Contr. 54(8), 1951­ 1955 (2009) [154] Poznyak, A., Fridman, L., Bejarano, F.: Mini-max integral sliding mode control for multimodel linear uncertain systems. IEEE Trans. Automat. Contr. 49(1), 97­102 (2004) [155] Rosenbrock, H.H.: State Space and Multivariable Theory. Wiley, New York (1970) [156] Rubagotti, M., Estrada, A., Castanos, F., Ferrara, A., Fridman, L.: Integral sliding mode control for nonlinear systems with matched and unmatched perturbations. IEEE Trans. Automat. Contr. 56(11), 2699­2704 (2011) [157] Ryan, E.P., Corless, M.: Ultimate boundedness and asymptotic stability of a class of uncertain dynamical systems via continuous and discontinuous control. IMA J. Math. Control Inform. 1(3), 223­242 (1984) [158] Saks, S.: Theory of the integral. Dover Publ. Inc., New York (1964) [159] Sastry, S., Bodson, M.: Adaptive Control: Stability, Convergence, and Robustness. PrenticeHall Advanced Reference Series (Engineering). Prentice-Hall, New Jersey (1994) [160] Shkolnikov, I.A., Shtessel, Y.B.: Aircraft Nonminimum Phase Control in Dynamic Sliding Manifolds. AIAA J. Guid. Control Dynam. 24(3), 566­572 (2001) [161] Shtessel, Y.B., Lee, Y.J.: New approach to chattering analysis in systems with sliding modes. In: Proceedings of 35th IEEE Conference on Decision and Control, pp. 4014­4019, Kobe, Japan (1996) [162] Shtessel, Y., Buffington, J., Banda, S.: Tailless aircraft flight control using multiple time scale re-configurable sliding modes. IEEE Trans. Contr. Syst. Tech. 10, 288­296 (2002) [163] Shtessel, Y., Shkolnikov, I., Levant, A.: Smooth second order sliding modes: Missile guidance application. Automatica 43(8), 1470­1476 (2007) [164] Shtessel, Y., Baev, S., Shkolnikov, I.: Nonminimum-phase output tracking in causal systems using higher order sliding modes. Int. J. Robust. Nonlin. Special Issue on Advances in Higher Order Sliding Mode Control 18(4­5), 454­467 (2008) [165] Shtessel, Y., Shkolnikov, I., Levant, A.: Guidance and control of missile interceptor using second order sliding modes. IEEE Trans. Aero. Elec. Syst. 45(1), 110­124 (2009)

350

Bibliography

[166] Shtessel, Y., Baev, S., Edwards, C., Spurgeon, S.: HOSM observer for a class of non-minimum phase causal nonlinear systems. IEEE Trans. Automat. Contr. 55(2),543­ 548(2010)
[167] Shtessel, Y., Baev, S., Edwards, C., Spurgeon, S.: Output feedback tracking in causal nonminimum-phase nonlinear systems using higher order sliding modes. Int. J. Robust. Nonlin. 20(16), 1866­1878 (2010)
[168] Shtessel, Y., Taleb, M., Plestan, F.: A novel adaptive-gain super-twisting sliding mode controller: methodology and application. Automatica 48(5), 759­769 (2012)
[169] Shtessel, Y., Tournes, C., Fridman, L.: Advances in guidance and control of aerospace vehicles using sliding mode control and observation techniques. J. Fraklin Inst. 349(2), 391­ 396 (2012)
[170] Shtessel. Y., Kochalummoottil, J., Edwards, C., Spurgeon, S.: Continuous adaptive finite reaching time control and second order sliding modes. IMA J. Math. Control Inform. (2012). doi: 10.1093/imamci/dns013
[171] Slotine, J.-J., Li, W.: Applied Nonlinear Control. Prentice Hall, New Jersey (1991) [172] Slotine, J.J.E., Hedrick, J.K., Misawa, E.A.: On sliding observers for nonlinear systems.
Trans. ASME: J. Dyn. Syst. Meas. Control 109, 245­252 (1987) [173] Soderstrom, T., Stoica, P.: System Identification. Prentice Hall International, Cambridge
(1989) [174] Spurgeon, S.: Sliding mode observers - a survey. Int. J. Syst. Sci. 39(8), 751­764 (2008) [175] Steinberg, A., Corless, M.J.: Output feedback stabilisation of uncertain dynamical systems.
IEEE Trans. Automat. Contr. 30(10), 1025­1027 (1985) [176] Stott, J., Shtessel, Y.: Launch vehicle attitude control using sliding mode control and
observation techniques. J. Franklin Inst. Special Issue on Advances in Guidance and Control of Aerospace Vehicles using Sliding Mode Control and Observation Techniques 349(2), 397­412 (2012) [177] Strang, G.: Linear Algebra and its Applications. Harcourt Brace Jovanovich, London (1988) [178] Tan, C.P. Edwards, C.: Sliding mode observers for robust detection and reconstruction of actuator and sensor faults. Int. J. Robust. Nonlin. 13, 443­463 (2003) [179] Tan, C.P. Edwards, C.: Robust fault reconstruction in linear uncertain systems using multiple sliding mode observers in cascade. IEEE Trans. Automat. Contr. 55, 855­867 (2010) [180] Tomei, P. Marino, R.: Nonlinear Control Design: Geometric, Adaptive and Robust. Prentice Hall, London (1995) [181] Tsypkin, Y.Z.: Relay Control Systems. Cambridge University press, Cambridge (1984) [182] Utkin, V.I.: Sliding Modes in Optimization and Control Problems. Springer, New York (1992) [183] Utkin, V.I.: Variable structure systems with sliding modes. IEEE Trans. Automat. Contr. 22(2), 212­222 (1977) [184] Utkin, V.I.: First stage of VSS: peolpe and events. In: Yu, X., Xu, J. (eds.) Variable Structure Systems: Towards the 21st Century. Lecture Notes in Control and Information Sciences, vol. 247, pp. 1­33. Springer, Berlin (2002) [185] Utkin, V.I., Shi, J.: Integral sliding mode in systems operating under uncertainty conditions. In: Proceedings of the 35th IEEE Conference on Decision and Control, pp. 4591­4596, Kobe, Japan (1996) [186] Utkin, V., Guldner, J., Shi, J.: Sliding Mode Control in Electromechanical Systems. Taylor and Francis, London (1999) [187] Utkin, V.I, Guldner, J., Shi, J.: Sliding Mode Control in Electro-Mechanical Systems, 2nd edn. CRC Press, Boca Raton (2009) [188] Walcott, B.L., Zak, S.H.: State observation of nonlinear uncertain dynamical systems. IEEE Trans. Automat. Contr. 32(2), 166­170 (1987) [189] Walcott, B.L., Corless, M.J., Zak, S.H.: Comparative study of nonlinear state observation techniques. Int. J. Control 45(6), 2109­2132 (1987) [190] Wise, K.A., Broy, D.J.: Agile missile dynamics and control. AIAA J. Guid. Control Dynam. 21(3), 441­449 (1998)

Bibliography

351

[191] Xu, J.X., Pan, Y.J., Lee, T.H., Fridman, L.: On nonlinear hinfty sliding mode control for a class of nonlinear cascade systems. Int. J. Syst. Sci. 36(15), 983­992 (2005)
[192] Xu, J.X., Abidi, K. On the discrete-time integralsliding-mode control. IEEE Trans. Automat. Contr. 52(4), 709­715 (2007)
[193] Yan, X.G., Edwards, C.: Nonlinear robust fault reconstruction and estimation using a sliding mode observer. Automatica 43(9), 1605­1614 (2007)
[194] Yeh, H., Nelson, E., Sparks, A.: Nonlinear tracking control for satellite formations. J. Guid. Control Dynam. 25(2), 376­386 (2002)
[195] Young, K.D., Utkin, V.I., Ozguner, U.: A control engineer's guide to sliding mode control. IEEE Trans. Contr. Syst. Tech. 7(3), 328­342 (1999)
[196] Zubov, V.I.: Methods of A. M. Lyapunov and Their Applications. Noordhoff International, Groningen (1964)

Index

Symbols 1-norm, 324 2-sliding controllers, 147
A Accuracy, 10, 18, 35, 143, 153, 155 Arbitrary order robust exact differentiation,
213, 228 Asymptotic sliding mode, 13, 15 Asymptotic stability, 2, 4, 124, 331, 340

Controllable, 332 Conventional sliding mode, 28
observer, 105 Convergence
asymptotic, 2, 3, 6, 120, 293 finite time, 1, 4, 6, 10, 13, 152, 221, 229,
255, 293 Coordinate
change, 332 transformation, 122

B Bi-wing aircraft, 211
C Canonical form, 55, 78­80, 82, 84, 88, 98 Cauchy­Schwarz inequality, 324, 341 Characteristic
equation, 323 matrix, 323 polynomial, 323 Chattering, 8, 14, 228 attenuation, 12­14, 163, 247 elimination, 9, 169 Chua's circuit, 140 Cofactor, 322 Column rank, 321 space, 321 Comparisons of 2-sliding control algorithms,
205 Continuous
SMC, 11, 34, 291 SMC driven by SMDO, 295, 298

D DC motor, 9, 42, 49 DC-to-DC converter, 27 Describing function technique, 184
existence of the periodic solutions, 198 ideal sliding mode analysis, 186 prescribed convergence law analysis, 201 real sliding mode analysis, 189, 190 stability of periodic solution, 200 sub-optimal algorithm analysis, 203 super-twisting algorithm analysis, 196, 197 twisting algorithm analysis, 194 Detectability, 59, 79, 333 Determinant, 321 Differential inclusion, 145, 217 Differentiator based observers, 274, 275,
290 Differentiators, 1, 16, 143, 159, 228, 251, 270,
293 Dilation, 218, 221 Disturbance
identification/reconstruction, 278, 280 rejection, 112 Dynamic systems, 27

Y. Shtessel et al., Sliding Mode Control and Observation, Control Engineering,

353

DOI 10.1007/978-0-8176-4893-0, © Springer Science+Business Media New York 2014

354

Index

E Eigenstructure, 332 Eigenvalue, 322
placement method, 55 Eigenvectors, 323, 325 Equivalent
control, 17­20, 31, 94 output error injection, 108, 110, 113 output injection, 255, 263 Euclidean norm, 324
F Filippov
inclusion, 214, 221 trajectory, 214 Flight simulation results and analysis, 305 Frequency analysis, 183 of conventional sliding mode controller,
186 of second order sliding mode controllers,
193
G Generic Sliding Mode Observer, 121
H High frequency switching, 108, 112 Higher order sliding mode (HOSM), 25
blood glucose regulation, 237 Bergman minimal model, 240
car steering control, 234 control, 213 observation/identification in mechanical
systems, 252 observers/differentiators, 239, 251, 274 output feedback control, 228 quasi-continuous controllers, 243 tuning of the controllers, 233 Homogeneity, 222 Homogeneous 2-sliding modes accuracy, 223 Homogeneous inclusion, 227, 229 Hyperplane, 43, 50, 56 Dynamic Output Feedback Design, 85 Static Output Feedback Design, 78, 83
I Ideal sliding motion, 112 Identity matrix, 322 Induced matrix norm, 324 Infinity-norm, 324

Injection term, 106, 253, 255 Input distribution matrix, 50, 54, 332 Insensitivity, 9, 19 Integral sliding mode, 92
compensation of unmatched disturbances, 94
linear case, 91 Invariant zeros, 123, 334
K Keplerian orbits, 310, 317 Kimura­Davison conditions, 335
L Leader/Follower Satellite Formation
Mathematical Model, 310 Lie derivatives, 292 Linear
quadratic regulator, 335 time invariant system, 332 Low pass filter, 17, 296 Luenberger observer, 112 Lyapunov equation, 340 function, 4, 124, 125 matrix, 124, 340 methods, 340
M Majoring trajectory, 158 Matched uncertainty, 53, 62 Matching condition, 20, 27 Minor, 322 Modal decomposition, 325 Multiple loop asymptotic SMC-SMDO design,
301
N Negative definite, 326 Norm, 323 Normal matrix, 342 Null space, 122 Nyquist plot, 195, 330
O Observability, 106, 269, 271, 332
strong, 267, 268

Index

355

Observation and Identification via HOSMObservers, 251
mechanical systems, 255, 286 perturbation identification, 258 Super-twisting observer, 263, 286 Observers for single output linear systems, 265 single output nonlinear systems, 274 Orthogonal, 122 eigenvectors, 342 matrix, 325 Output distribution matrix, 332 Output tracking, 27­30, 33, 35, 36, 38, 39, 42,
292 with Integral Action, 75, 77
P Parameter identification, 264 Parasitic dynamics, 183 PBH rank test, 123, 332 Pendulum Control, 92, 143 Perturbation identification, 257, 258 Popov­Belevitch­Hautus test, see PBH rank
test Positive
definite matrix, 325 semidefinite matrix, 325, 335 Practical stability, 342 Prescribed convergence law, 25, 36, 38, 39 Principal dynamics, 183, 184 Pseudo-inverse, 122
Q QR decomposition, 323 Quadratic
form, 324, 340 minimization, 55, 58, 89 stability, 340
R Rank, 321 Rayleigh principle, 325, 341 Reachability condition, 110, 112, 117 Regular form, 53, 56 Relative degree, 27
total, 292 vector, 292, 313 Relay Control, 61, 67 Reusable Launch Vehicle Control, 298, 300

Riccati algebraic equation, 93 equation, 335
Robustness, 1, 10, 19, 340 of Sliding Mode Observers, 111
Rosenbrock's system matrix, 334 Row
rank, 321 space, 321
S Satellite Formation Control, 291, 309, 310,
313, 317 Second order sliding mode control, 1, 23, 25,
26, 35 prescribed convergence law, 152 quasi continuous control, 153 sub-optimal control, 151 super-twisting control, 35, 38, 156 twisting control, 159 Sigmoid function, 9, 41 Simple sliding mode observer, 106 Simulation study, 314 Sliding mode control, vii, 1, 3, 6, 12, 17, 32 differentiator
arbitrary order exact differentiators, 182 first order, 159 second order, 161, 169 disturbance observer, 251, 278, 279, 295 perturbation term reconstruction, 294,
295 super-twisting, 253, 258, 287 Sliding surface, 5, 6, 10, 17­19, 25, 106 Sliding variable, 5, 6, 10, 13, 18, 20, 22­24, 26,
28, 30, 32­35, 38, 39 disturbed dynamics, 294 stability, 217, 221
global uniform, 220, 247 Stabilisability, 333 State feedback control, 2, 334 State variable, 1, 21 Static output feedback pole placement, 335 Strong detectability, 267 Strongly observable systems, 268, 271, 289 Super-twisting
variable gain control, 170, 173 Symmetric
matrix, 322, 325 positive definite matrix, 116

356

Systems Linear time invariant (LTI), 50, 91 matrix, 332 Multi input multi output (MIMO), 48, 67 Single input single output (SISO), 55, 61, 62 time response, 332 triple, 332
T Trade-off, 114 Triangle inequality, 324 Twisting algorithm analysis, 193

U Ultimate boundedness, 342 Uncertainty, 341 Unit-Vector Control design, 68, 82 Unmatched
disturbance, 95 uncertainty, 59, 73 Unobservable modes, 123 Utkin, viii, 113
V Variable structure system, vii Vector norm, 323

Index

