% ==============================================================================
% MASTER TEMPLATE (FA) FOR PODCAST EPISODE CHEATSHEET PDFs
% ==============================================================================
% Purpose: Farsi (RTL) version of the cheatsheet template
% Requires: XeLaTeX
% ==============================================================================

\documentclass[11pt,a4paper]{article}

% ------------------------------------------------------------------------------
% GEOMETRY & LAYOUT
% ------------------------------------------------------------------------------
\usepackage[top=1.5cm, bottom=1.5cm, left=1.5cm, right=1.5cm, headheight=14pt]{geometry}
\usepackage{multicol}
\usepackage{fancyhdr}
\pagestyle{fancy}

% ------------------------------------------------------------------------------
% RTL + FONTS
% ------------------------------------------------------------------------------
\usepackage{fontspec}
\usepackage{polyglossia}
\setmainlanguage{farsi}
\setotherlanguage{english}
\setmainfont{B Nazanin}
\newfontfamily\englishfont{Latin Modern Roman}
\newfontfamily\englishfontsf{Latin Modern Sans}
\newfontfamily\englishfonttt{Latin Modern Mono}

% ------------------------------------------------------------------------------
% COLOR PALETTE
% ------------------------------------------------------------------------------
\usepackage{xcolor}
\definecolor{primary}{RGB}{41, 128, 185}
\definecolor{secondary}{RGB}{39, 174, 96}
\definecolor{accent}{RGB}{230, 126, 34}
\definecolor{warning}{RGB}{231, 76, 60}
\definecolor{background}{RGB}{236, 240, 241}
\definecolor{codeblock}{RGB}{44, 62, 80}
\definecolor{highlight}{RGB}{241, 196, 15}

% ------------------------------------------------------------------------------
% TIKZ & GRAPHICS
% ------------------------------------------------------------------------------
\usepackage{tikz}
\usetikzlibrary{shapes, arrows, positioning, calc, shadows, decorations.pathreplacing, backgrounds, fit}
\usepackage{graphicx}
\usepackage{float}

% TikZ styles
\tikzstyle{block} = [rectangle, draw, fill=primary!20, text width=5em, text centered, rounded corners, minimum height=3em, drop shadow]
\tikzstyle{arrow} = [thick,->,>=stealth]
\tikzstyle{process} = [rectangle, draw, fill=secondary!20, text width=6em, text centered, rounded corners, minimum height=3em]
\tikzstyle{decision} = [diamond, draw, fill=accent!20, text width=4.5em, text badly centered, inner sep=0pt]
\tikzstyle{cloud} = [ellipse, draw, fill=background, text width=5em, text centered, minimum height=2.5em]

% ------------------------------------------------------------------------------
% BOXES & CALLOUTS
% ------------------------------------------------------------------------------
\usepackage{tcolorbox}
\tcbuselibrary{skins, breakable, raster}

\newtcolorbox{keypoint}{
    enhanced,
    colback=primary!10,
    colframe=primary,
    fonttitle=\bfseries,
    title=\faLightbulb\ نکتهٔ کلیدی,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=primary},
    breakable
}

\newtcolorbox{example}{
    enhanced,
    colback=secondary!10,
    colframe=secondary,
    fonttitle=\bfseries,
    title=\faCode\ مثال,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=secondary},
    breakable
}

\newtcolorbox{warning}{
    enhanced,
    colback=warning!10,
    colframe=warning,
    fonttitle=\bfseries,
    title=\faExclamationTriangle\ دامِ رایج,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=warning},
    breakable
}

\newtcolorbox{tip}{
    enhanced,
    colback=accent!10,
    colframe=accent,
    fonttitle=\bfseries,
    title=\faLightbulb\ نکتهٔ حرفه‌ای,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=accent},
    breakable
}

\newtcolorbox{summary}{
    enhanced,
    colback=background,
    colframe=codeblock,
    fonttitle=\bfseries,
    title=\faListUl\ خلاصهٔ سریع,
    attach boxed title to top left={yshift=-2mm, xshift=5mm},
    boxed title style={colback=codeblock},
    breakable
}

% ------------------------------------------------------------------------------
% ICONS & SYMBOLS
% ------------------------------------------------------------------------------
\usepackage{fontawesome5}

\newcommand{\iconKey}{\textcolor{primary}{\faLightbulb}}
\newcommand{\iconCode}{\textcolor{secondary}{\faCode}}
\newcommand{\iconWarning}{\textcolor{warning}{\faExclamationTriangle}}
\newcommand{\iconTip}{\textcolor{accent}{\faInfoCircle}}
\newcommand{\iconLink}{\textcolor{primary}{\faLink}}
\newcommand{\iconBook}{\textcolor{secondary}{\faBook}}
\newcommand{\iconTarget}{\textcolor{accent}{\faBullseye}}

% ------------------------------------------------------------------------------
% TYPOGRAPHY
% ------------------------------------------------------------------------------
\usepackage{titlesec}
\titleformat{\section}{\Large\bfseries\color{primary}}{\thesection}{1em}{}[\titlerule]
\titleformat{\subsection}{\large\bfseries\color{secondary}}{\thesubsection}{1em}{}

% ------------------------------------------------------------------------------
% CODE LISTINGS
% ------------------------------------------------------------------------------
\usepackage{listings}
\lstset{
    basicstyle=\ttfamily\footnotesize\color{white},
    backgroundcolor=\color{codeblock},
    keywordstyle=\color{primary!80},
    commentstyle=\color{secondary!60}\itshape,
    stringstyle=\color{accent!80},
    numbers=left,
    numberstyle=\tiny\color{white!50},
    stepnumber=1,
    numbersep=8pt,
    frame=single,
    rulecolor=\color{codeblock},
    breaklines=true,
    breakatwhitespace=true,
    tabsize=4,
    captionpos=b
}

\lstdefinestyle{python}{
    language=Python,
    morekeywords={self, def, class, import, from, as, return, if, else, elif, for, while, True, False, None}
}

\lstdefinestyle{yaml}{
    basicstyle=\ttfamily\footnotesize,
    showstringspaces=false,
    commentstyle=\color{secondary!60}\itshape,
    keywordstyle=\color{primary!80}
}

% ------------------------------------------------------------------------------
% HYPERLINKS
% ------------------------------------------------------------------------------
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=primary,
    urlcolor=secondary,
    citecolor=accent
}

% ------------------------------------------------------------------------------
% HEADER & FOOTER
% ------------------------------------------------------------------------------
\fancyhf{}
\fancyhead[L]{\textcolor{primary}{\textbf{برگهٔ تقلب پادکست DIP-SMC-PSO}}}
\fancyhead[R]{\textcolor{secondary}{\episodetitle}}
\fancyfoot[C]{\textcolor{primary}{\thepage}}
\renewcommand{\headrulewidth}{0.5pt}
\renewcommand{\footrulewidth}{0.5pt}

% ------------------------------------------------------------------------------
% CUSTOM COMMANDS
% ------------------------------------------------------------------------------
\newcommand{\episodetitle}{عنوان قسمت}

\newcommand{\learningobjective}[1]{%
    \begin{center}
    \begin{tcolorbox}[colback=highlight!30, colframe=accent, width=0.9\textwidth]
    \iconTarget\ \textbf{هدف یادگیری:} #1
    \end{tcolorbox}
    \end{center}
}

\newcommand{\quickref}[2]{%
    \begin{tcolorbox}[colback=background, colframe=primary, title=\faBookmark\ مرجع سریع: #1]
    #2
    \end{tcolorbox}
}

\newcommand{\resourcelink}[2]{%
    \iconLink\ \href{#1}{\textcolor{secondary}{#2}}
}

% ------------------------------------------------------------------------------
% TITLE PAGE
% ------------------------------------------------------------------------------
\usepackage{afterpage}

\newcommand{\makeepisodetitle}[4]{%
    \begin{titlepage}
    \begin{tikzpicture}[remember picture, overlay]
        \fill[primary!20] (current page.south west) rectangle (current page.north east);

        \node[
            fill=white,
            rounded corners=10pt,
            drop shadow,
            text width=0.8\paperwidth,
            align=center
        ] at (current page.center) {
            \Huge\bfseries\color{primary} #1 \\[1em]
            \Large\color{secondary} #2 \\[2em]
            \large\color{codeblock} بخش #3 $\cdot$ مدت: #4 \\[1em]
            \normalsize\color{codeblock} \textit{راهنمای بصری ساده و دوستانه}
        };

        \node[
            anchor=south,
            text width=0.9\paperwidth,
            align=center
        ] at (current page.south) {
            \color{primary}\rule{0.8\paperwidth}{0.5pt} \\[0.5em]
            \small\color{codeblock}
            \textbf{مخزن:} \url{https://github.com/theSadeQ/dip-smc-pso} \\
            \textbf{مسیر:} academic/paper/presentations/podcasts/episodes/ \\[1em]
        };
    \end{tikzpicture}
    \end{titlepage}
}

% ------------------------------------------------------------------------------
% MATH & EQUATIONS
% ------------------------------------------------------------------------------
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}

\newcommand{\eqbox}[1]{%
    \begin{tcolorbox}[colback=primary!5, colframe=primary, boxrule=1pt]
    \begin{equation}
    #1
    \end{equation}
    \end{tcolorbox}
}

% ------------------------------------------------------------------------------
% TABLES
% ------------------------------------------------------------------------------
\usepackage{booktabs}
\usepackage{array}
\usepackage{multirow}
\usepackage{colortbl}

\newcommand{\tableheadcolor}{\rowcolor{primary!30}}

% ------------------------------------------------------------------------------
% END OF PREAMBLE
% ------------------------------------------------------------------------------
